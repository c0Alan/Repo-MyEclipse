/*
 * Artery JS Library 2.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
window.undefined=window.undefined;Ext={version:"3.0"};Ext.apply=function(C,D,B){if(B){Ext.apply(C,B)}if(C&&D&&typeof D=="object"){for(var A in D){C[A]=D[A]}}return C};(function(){var F=0,U=Object.prototype.toString,T=function(e){if(Ext.isArray(e)||e.callee){return true}if(/NodeList|HTMLCollection/.test(U.call(e))){return true}return((e.nextNode||e.item)&&Ext.isNumber(e.length))},V=navigator.userAgent.toLowerCase(),a=function(e){return e.test(V)},H=document,K=H.compatMode=="CSS1Compat",d=a(/opera/),G=a(/chrome/),W=a(/webkit/),Z=!G&&a(/safari/),E=Z&&a(/applewebkit\/4/),B=Z&&a(/version\/3/),g=Z&&a(/version\/4/),S=!(d)&&(a(/msie/)||V.match(/rv:([\d.]+)\) like gecko/)?true:false),Q=S&&a(/msie 7/),P=S&&a(/msie 8/),O=S&&a(/msie 9/),L=S&&a(/msie 10/),R=S&&!Q&&!P&&!O&&!L,N=!W&&a(/gecko/),D=N&&a(/rv:1\.8/),A=N&&a(/rv:1\.9/),X=S&&!K,b=a(/windows|win32/),J=a(/macintosh|mac os x/),I=a(/adobeair/),M=a(/linux/),C=/^https/i.test(window.location.protocol);if(R){try{H.execCommand("BackgroundImageCache",false,true)}catch(Y){}}Ext.apply(Ext,{SSL_SECURE_URL:"javascript:false",isStrict:K,isSecure:C,isReady:false,enableGarbageCollector:true,enableListenerCollection:false,USE_NATIVE_JSON:false,applyIf:function(h,i){if(h){for(var e in i){if(Ext.isEmpty(h[e])){h[e]=i[e]}}}return h},id:function(e,h){return(e=Ext.getDom(e)||{}).id=e.id||(h||"ext-gen")+(++F)},extend:function(){var h=function(j){for(var i in j){this[i]=j[i]}};var e=Object.prototype.constructor;return function(o,k,n){if(Ext.isObject(k)){n=k;k=o;o=n.constructor!=e?n.constructor:function(){k.apply(this,arguments)}}var j=function(){},m,i=k.prototype;j.prototype=i;m=o.prototype=new j();m.constructor=o;o.superclass=i;if(i.constructor==e){i.constructor=k}o.override=function(q){Ext.override(o,q)};m.superclass=m.supr=(function(){return i});m.override=h;Ext.override(o,n);o.extend=function(q){Ext.extend(o,q)};return o}}(),override:function(e,i){if(i){var h=e.prototype;Ext.apply(h,i);if(Ext.isIE&&i.toString!=e.toString){h.toString=i.toString}}},namespace:function(){var h,e;Ext.each(arguments,function(i){e=i.split(".");h=window[e[0]]=window[e[0]]||{};Ext.each(e.slice(1),function(j){h=h[j]=h[j]||{}})});return h},urlEncode:function(n,m){var j,h=[],i,k=encodeURIComponent;for(i in n){j=!Ext.isDefined(n[i]);Ext.each(j?i:n[i],function(o,e){h.push("&",k(i),"=",(o!=i||!j)?k(o):"")})}if(!m){h.shift();m=""}return m+h.join("")},urlDecode:function(i,h){var m={},k=i.split("&"),n=decodeURIComponent,e,j;Ext.each(k,function(o){o=o.split("=");e=n(o[0]);j=n(o[1]);m[e]=h||m[e]==undefined?j:[].concat(m[e]).concat(j)});return m},urlAppend:function(e,h){if(!Ext.isEmpty(h)){return e+(e.indexOf("?")===-1?"?":"&")+h}return e},toArray:function(){return S?function(e,m,h,k){k=[];Ext.each(e,function(i){k.push(i)});return k.slice(m||0,h||k.length)}:function(e,k,h){return Array.prototype.slice.call(e,k||0,h||e.length)}}(),each:function(m,k,j){if(Ext.isEmpty(m,true)){return }if(!T(m)||Ext.isPrimitive(m)){m=[m]}for(var h=0,e=m.length;h<e;h++){if(k.call(j||m[h],m[h],h,m)===false){return h}}},iterate:function(i,h,e){if(T(i)){Ext.each(i,h,e);return }else{if(Ext.isObject(i)){for(var j in i){if(i.hasOwnProperty(j)){if(h.call(e||i,j,i[j])===false){return }}}}}},getDom:function(e){if(!e||!H){return null}return e.dom?e.dom:(Ext.isString(e)?H.getElementById(e):e)},getBody:function(){return Ext.get(H.body||H.documentElement)},removeNode:S?function(){var e;return function(h){if(h&&h.tagName!="BODY"){e=e||H.createElement("div");e.appendChild(h);e.innerHTML=""}}}():function(e){if(e&&e.parentNode&&e.tagName!="BODY"){e.parentNode.removeChild(e)}},isEmpty:function(h,e){return h===null||h===undefined||((Ext.isArray(h)&&!h.length))||(!e?h==="":false)},isArray:function(e){return U.apply(e)==="[object Array]"},isObject:function(e){return e&&typeof e=="object"},isPrimitive:function(e){return Ext.isString(e)||Ext.isNumber(e)||Ext.isBoolean(e)},isFunction:function(e){return U.apply(e)==="[object Function]"},isNumber:function(e){return typeof e==="number"&&isFinite(e)},isString:function(e){return typeof e==="string"},isBoolean:function(e){return typeof e==="boolean"},isDefined:function(e){return typeof e!=="undefined"},isOpera:d,isWebKit:W,isChrome:G,isSafari:Z,isSafari3:B,isSafari4:g,isSafari2:E,isIE:S,isIE6:R,isIE7:Q,isIE8:P,isGecko:N,isGecko2:D,isGecko3:A,isBorderBox:X,isLinux:M,isWindows:b,isMac:J,isAir:I});Ext.ns=Ext.namespace})();Ext.ns("Ext","Ext.util","Ext.lib","Ext.data");Ext.apply(Function.prototype,{createInterceptor:function(B,A){var C=this;return !Ext.isFunction(B)?this:function(){var E=this,D=arguments;B.target=E;B.method=C;return(B.apply(A||E||window,D)!==false)?C.apply(E||window,D):null}},createCallback:function(){var A=arguments,B=this;return function(){return B.apply(window,A)}},createDelegate:function(C,B,A){var D=this;return function(){var F=B||arguments;if(A===true){F=Array.prototype.slice.call(arguments,0);F=F.concat(B)}else{if(Ext.isNumber(A)){F=Array.prototype.slice.call(arguments,0);var E=[A,0].concat(B);Array.prototype.splice.apply(F,E)}}return D.apply(C||window,F)}},defer:function(C,E,B,A){var D=this.createDelegate(E,B,A);if(C>0){return setTimeout(D,C)}D();return 0}});Ext.applyIf(String,{format:function(B){var A=Ext.toArray(arguments,1);return B.replace(/\{(\d+)\}/g,function(C,D){return A[D]})}});Ext.applyIf(Array.prototype,{indexOf:function(C){for(var B=0,A=this.length;B<A;B++){if(this[B]==C){return B}}return -1},remove:function(B){var A=this.indexOf(B);if(A!=-1){this.splice(A,1)}return this}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ns("Ext.grid","Ext.dd","Ext.tree","Ext.form","Ext.menu","Ext.state","Ext.layout","Ext.app","Ext.ux","Ext.chart","Ext.direct");Ext.apply(Ext,function(){var B=Ext,A=0;return{emptyFn:function(){},BLANK_IMAGE_URL:Ext.isIE6||Ext.isIE7?"http://extjs.com/s.gif":"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",extendX:function(C,D){return Ext.extend(C,D(C.prototype))},getDoc:function(){return Ext.get(document)},isDate:function(C){return Object.prototype.toString.apply(C)==="[object Date]"},num:function(D,C){D=Number(D===null||typeof D=="boolean"?NaN:D);return isNaN(D)?C:D},value:function(E,C,D){return Ext.isEmpty(E,D)?C:E},escapeRe:function(C){return C.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},sequence:function(F,C,E,D){F[C]=F[C].createSequence(E,D)},addBehaviors:function(G){if(!Ext.isReady){Ext.onReady(function(){Ext.addBehaviors(G)})}else{var D={},F,C,E;for(C in G){if((F=C.split("@"))[1]){E=F[0];if(!D[E]){D[E]=Ext.select(E)}D[E].on(F[1],G[C])}}D=null}},combine:function(){var E=arguments,D=E.length,G=[];for(var F=0;F<D;F++){var C=E[F];if(Ext.isArray(C)){G=G.concat(C)}else{if(C.length!==undefined&&!C.substr){G=G.concat(Array.prototype.slice.call(C,0))}else{G.push(C)}}}return G},copyTo:function(C,D,E){if(typeof E=="string"){E=E.split(/[,;\s]/)}Ext.each(E,function(F){if(D.hasOwnProperty(F)){C[F]=D[F]}},this);return C},destroy:function(){Ext.each(arguments,function(C){if(C){if(Ext.isArray(C)){this.destroy.apply(this,C)}else{if(Ext.isFunction(C.destroy)){C.destroy()}else{if(C.dom){C.remove()}}}}},this)},destroyMembers:function(I,G,E,F){for(var H=1,D=arguments,C=D.length;H<C;H++){Ext.destroy(I[D[H]]);delete I[D[H]]}},clean:function(C){var D=[];Ext.each(C,function(E){if(!!E){D.push(E)}});return D},unique:function(C){var D=[],E={};Ext.each(C,function(F){if(!E[F]){D.push(F)}E[F]=true});return D},flatten:function(C){var E=[];function D(F){Ext.each(F,function(G){if(Ext.isArray(G)){D(G)}else{E.push(G)}});return E}return D(C)},min:function(C,D){var E=C[0];D=D||function(G,F){return G<F?-1:1};Ext.each(C,function(F){E=D(E,F)==-1?E:F});return E},max:function(C,D){var E=C[0];D=D||function(G,F){return G>F?1:-1};Ext.each(C,function(F){E=D(E,F)==1?E:F});return E},mean:function(C){return Ext.sum(C)/C.length},sum:function(C){var D=0;Ext.each(C,function(E){D+=E});return D},partition:function(C,D){var E=[[],[]];Ext.each(C,function(G,H,F){E[(D&&D(G,H,F))||(!D&&G)?0:1].push(G)});return E},invoke:function(C,D){var F=[],E=Array.prototype.slice.call(arguments,2);Ext.each(C,function(G,H){if(G&&typeof G[D]=="function"){F.push(G[D].apply(G,E))}else{F.push(undefined)}});return F},pluck:function(C,E){var D=[];Ext.each(C,function(F){D.push(F[E])});return D},zip:function(){var J=Ext.partition(arguments,function(K){return !Ext.isFunction(K)}),G=J[0],I=J[1][0],C=Ext.max(Ext.pluck(G,"length")),F=[];for(var H=0;H<C;H++){F[H]=[];if(I){F[H]=I.apply(I,Ext.pluck(G,H))}else{for(var E=0,D=G.length;E<D;E++){F[H].push(G[E][H])}}}return F},getCmp:function(C){return Ext.ComponentMgr.get(C)},useShims:B.isIE6||(B.isMac&&B.isGecko2),type:function(D){if(D===undefined||D===null){return false}if(D.htmlElement){return"element"}var C=typeof D;if(C=="object"&&D.nodeName){switch(D.nodeType){case 1:return"element";case 3:return(/\S/).test(D.nodeValue)?"textnode":"whitespace"}}if(C=="object"||C=="function"){switch(D.constructor){case Array:return"array";case RegExp:return"regexp";case Date:return"date"}if(typeof D.length=="number"&&typeof D.item=="function"){return"nodelist"}}return C},intercept:function(F,C,E,D){F[C]=F[C].createInterceptor(E,D)},callback:function(C,F,E,D){if(Ext.isFunction(C)){if(D){C.defer(D,F,E||[])}else{C.apply(F,E||[])}}}}}());Ext.apply(Function.prototype,{createSequence:function(B,A){var C=this;return !Ext.isFunction(B)?this:function(){var D=C.apply(this||window,arguments);B.apply(A||this||window,arguments);return D}}});Ext.applyIf(String,{escape:function(A){return A.replace(/('|\\)/g,"\\$1")},leftPad:function(D,B,C){var A=String(D);if(!C){C=" "}while(A.length<B){A=C+A}return A}});String.prototype.toggle=function(B,A){return this==B?A:B};String.prototype.trim=function(){var A=/^\s+|\s+$/g;return function(){return this.replace(A,"")}}();Date.prototype.getElapsed=function(A){return Math.abs((A||new Date()).getTime()-this.getTime())};Ext.applyIf(Number.prototype,{constrain:function(B,A){return Math.min(Math.max(this,B),A)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.util.TaskRunner=function(E){E=E||10;var F=[],A=[],B=0,G=false,D=function(){G=false;clearInterval(B);B=0},H=function(){if(!G){G=true;B=setInterval(I,E)}},C=function(J){A.push(J);if(J.onStop){J.onStop.apply(J.scope||J)}},I=function(){var L=A.length,N=new Date().getTime();if(L>0){for(var P=0;P<L;P++){F.remove(A[P])}A=[];if(F.length<1){D();return }}for(var P=0,O,K,M,J=F.length;P<J;++P){O=F[P];K=N-O.taskRunTime;if(O.interval<=K){M=O.run.apply(O.scope||O,O.args||[++O.taskRunCount]);O.taskRunTime=N;if(M===false||O.taskRunCount===O.repeat){C(O);return }}if(O.duration&&O.duration<=(N-O.taskStartTime)){C(O)}}};this.start=function(J){F.push(J);J.taskStartTime=new Date().getTime();J.taskRunTime=0;J.taskRunCount=0;H();return J};this.stop=function(J){C(J);return J};this.stopAll=function(){D();for(var K=0,J=F.length;K<J;K++){if(F[K].onStop){F[K].onStop()}}F=[];A=[]}};Ext.TaskMgr=new Ext.util.TaskRunner();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var libFlyweight;function fly(el){if(!libFlyweight){libFlyweight=new Ext.Element.Flyweight()}libFlyweight.dom=el;return libFlyweight}
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var doc=document,isCSS1=doc.compatMode=="CSS1Compat",MAX=Math.max,PARSEINT=parseInt;Ext.lib.Dom={isAncestor:function(p,c){var ret=false;p=Ext.getDom(p);c=Ext.getDom(c);if(p&&c){if(p.contains){return p.contains(c)}else{if(p.compareDocumentPosition){return !!(p.compareDocumentPosition(c)&16)}else{while(c=c.parentNode){ret=c==p||ret}}}}return ret},getViewWidth:function(full){return full?this.getDocumentWidth():this.getViewportWidth()},getViewHeight:function(full){return full?this.getDocumentHeight():this.getViewportHeight()},getDocumentHeight:function(){return MAX(!isCSS1?doc.body.scrollHeight:doc.documentElement.scrollHeight,this.getViewportHeight())},getDocumentWidth:function(){return MAX(!isCSS1?doc.body.scrollWidth:doc.documentElement.scrollWidth,this.getViewportWidth())},getViewportHeight:function(){return Ext.isIE?(Ext.isStrict?doc.documentElement.clientHeight:doc.body.clientHeight):self.innerHeight},getViewportWidth:function(){return !Ext.isStrict&&!Ext.isOpera?doc.body.clientWidth:Ext.isIE?doc.documentElement.clientWidth:self.innerWidth},getY:function(el){return this.getXY(el)[1]},getX:function(el){return this.getXY(el)[0]},getXY:function(el){var p,pe,b,bt,bl,dbd,x=0,y=0,scroll,hasAbsolute,bd=(doc.body||doc.documentElement),ret=[0,0];el=Ext.getDom(el);if(el!=bd){if(el.getBoundingClientRect){try{b=el.getBoundingClientRect()}catch(e){b={left:0,top:0}}scroll=fly(document).getScroll();ret=[b.left+scroll.left,b.top+scroll.top]}else{p=el;hasAbsolute=fly(el).isStyle("position","absolute");while(p){pe=fly(p);x+=p.offsetLeft;y+=p.offsetTop;hasAbsolute=hasAbsolute||pe.isStyle("position","absolute");if(Ext.isGecko){y+=bt=PARSEINT(pe.getStyle("borderTopWidth"),10)||0;x+=bl=PARSEINT(pe.getStyle("borderLeftWidth"),10)||0;if(p!=el&&!pe.isStyle("overflow","visible")){x+=bl;y+=bt}}p=p.offsetParent}if(Ext.isSafari&&hasAbsolute){x-=bd.offsetLeft;y-=bd.offsetTop}if(Ext.isGecko&&!hasAbsolute){dbd=fly(bd);x+=PARSEINT(dbd.getStyle("borderLeftWidth"),10)||0;y+=PARSEINT(dbd.getStyle("borderTopWidth"),10)||0}p=el.parentNode;while(p&&p!=bd){if(!Ext.isOpera||(p.tagName!="TR"&&!fly(p).isStyle("display","inline"))){x-=p.scrollLeft;y-=p.scrollTop}p=p.parentNode}ret=[x,y]}}return ret},setXY:function(el,xy){(el=Ext.fly(el,"_setXY")).position();var pts=el.translatePoints(xy),style=el.dom.style,pos;for(pos in pts){if(!isNaN(pts[pos])){style[pos]=pts[pos]+"px"}}},setX:function(el,x){this.setXY(el,[x,false])},setY:function(el,y){this.setXY(el,[false,y])}}})();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.lib.Dom.getRegion=function(el){return Ext.lib.Region.getRegion(el)};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.lib.Event=function(){var loadComplete=false,listeners=[],unloadListeners=[],retryCount=0,onAvailStack=[],_interval,locked=false,win=window,doc=document,POLL_RETRYS=200,POLL_INTERVAL=20,EL=0,TYPE=1,FN=2,WFN=3,OBJ=3,ADJ_SCOPE=4,SCROLLLEFT="scrollLeft",SCROLLTOP="scrollTop",UNLOAD="unload",MOUSEOVER="mouseover",MOUSEOUT="mouseout",doAdd=function(){var ret;if(win.addEventListener){ret=function(el,eventName,fn,capture){if(eventName=="mouseenter"){fn=fn.createInterceptor(checkRelatedTarget);el.addEventListener(MOUSEOVER,fn,(capture))}else{if(eventName=="mouseleave"){fn=fn.createInterceptor(checkRelatedTarget);el.addEventListener(MOUSEOUT,fn,(capture))}else{el.addEventListener(eventName,fn,(capture))}}return fn}}else{if(win.attachEvent){ret=function(el,eventName,fn,capture){el.attachEvent("on"+eventName,fn);return fn}}else{ret=function(){}}}return ret}(),doRemove=function(){var ret;if(win.removeEventListener){ret=function(el,eventName,fn,capture){if(eventName=="mouseenter"){eventName=MOUSEOVER}else{if(eventName=="mouseleave"){eventName=MOUSEOUT}}el.removeEventListener(eventName,fn,(capture))}}else{if(win.detachEvent){ret=function(el,eventName,fn){el.detachEvent("on"+eventName,fn)}}else{ret=function(){}}}return ret}();var isXUL=Ext.isGecko?function(node){return Object.prototype.toString.call(node)=="[object XULElement]"}:function(){};var isTextNode=Ext.isGecko?function(node){try{return node.nodeType==3}catch(e){return false}}:function(node){return node.nodeType==3};function checkRelatedTarget(e){var related=pub.getRelatedTarget(e);return !(isXUL(related)||elContains(e.currentTarget,related))}function elContains(parent,child){if(parent&&parent.firstChild){while(child){if(child===parent){return true}try{child=child.parentNode}catch(e){return false}if(child&&(child.nodeType!=1)){child=null}}}return false}function _getCacheIndex(el,eventName,fn){var index=-1;Ext.each(listeners,function(v,i){if(v&&v[FN]==fn&&v[EL]==el&&v[TYPE]==eventName){index=i}});return index}function _tryPreloadAttach(){var ret=false,notAvail=[],element,tryAgain=!loadComplete||(retryCount>0);if(!locked){locked=true;Ext.each(onAvailStack,function(v,i,a){if(v&&(element=doc.getElementById(v.id))){if(!v.checkReady||loadComplete||element.nextSibling||(doc&&doc.body)){element=v.override?(v.override===true?v.obj:v.override):element;v.fn.call(element,v.obj);onAvailStack[i]=null}else{notAvail.push(v)}}});retryCount=(notAvail.length===0)?0:retryCount-1;if(tryAgain){startInterval()}else{clearInterval(_interval);_interval=null}ret=!(locked=false)}return ret}function startInterval(){if(!_interval){var callback=function(){_tryPreloadAttach()};_interval=setInterval(callback,POLL_INTERVAL)}}function getScroll(){var dd=doc.documentElement,db=doc.body;if(dd&&(dd[SCROLLTOP]||dd[SCROLLLEFT])){return[dd[SCROLLLEFT],dd[SCROLLTOP]]}else{if(db){return[db[SCROLLLEFT],db[SCROLLTOP]]}else{return[0,0]}}}function getPageCoord(ev,xy){ev=ev.browserEvent||ev;var coord=ev["page"+xy];if(!coord&&coord!==0){coord=ev["client"+xy]||0;if(Ext.isIE){coord+=getScroll()[xy=="X"?0:1]}}return coord}var pub={onAvailable:function(p_id,p_fn,p_obj,p_override){onAvailStack.push({id:p_id,fn:p_fn,obj:p_obj,override:p_override,checkReady:false});retryCount=POLL_RETRYS;startInterval()},addListener:function(el,eventName,fn){var ret;el=Ext.getDom(el);if(el&&fn){if(UNLOAD==eventName){ret=!!(unloadListeners[unloadListeners.length]=[el,eventName,fn])}else{listeners.push([el,eventName,fn,ret=doAdd(el,eventName,fn,false)])}}return !!ret},removeListener:function(el,eventName,fn){var ret=false,index,cacheItem;el=Ext.getDom(el);if(!fn){ret=this.purgeElement(el,false,eventName)}else{if(UNLOAD==eventName){Ext.each(unloadListeners,function(v,i,a){if(v&&v[0]==el&&v[1]==eventName&&v[2]==fn){unloadListeners.splice(i,1);ret=true}})}else{index=arguments[3]||_getCacheIndex(el,eventName,fn);cacheItem=listeners[index];if(el&&cacheItem){doRemove(el,eventName,cacheItem[WFN],false);cacheItem[WFN]=cacheItem[FN]=null;listeners.splice(index,1);ret=true}}}return ret},getTarget:function(ev){ev=ev.browserEvent||ev;return this.resolveTextNode(ev.target||ev.srcElement)},resolveTextNode:function(node){return node&&!isXUL(node)&&isTextNode(node)?node.parentNode:node},getRelatedTarget:function(ev){ev=ev.browserEvent||ev;return this.resolveTextNode(ev.relatedTarget||(ev.type==MOUSEOUT?ev.toElement:ev.type==MOUSEOVER?ev.fromElement:null))},getPageX:function(ev){return getPageCoord(ev,"X")},getPageY:function(ev){return getPageCoord(ev,"Y")},getXY:function(ev){return[this.getPageX(ev),this.getPageY(ev)]},stopEvent:function(ev){this.stopPropagation(ev);this.preventDefault(ev)},stopPropagation:function(ev){ev=ev.browserEvent||ev;if(ev.stopPropagation){ev.stopPropagation()}else{ev.cancelBubble=true}},preventDefault:function(ev){ev=ev.browserEvent||ev;if(ev.preventDefault){ev.preventDefault()}else{ev.returnValue=false}},getEvent:function(e){e=e||win.event;if(!e){var c=this.getEvent.caller;while(c){e=c.arguments[0];if(e&&Event==e.constructor){break}c=c.caller}}return e},getCharCode:function(ev){ev=ev.browserEvent||ev;return ev.charCode||ev.keyCode||0},_load:function(e){loadComplete=true;var EU=Ext.lib.Event;if(Ext.isIE&&e!==true){doRemove(win,"load",arguments.callee)}},purgeElement:function(el,recurse,eventName){var me=this;Ext.each(me.getListeners(el,eventName),function(v){if(v){me.removeListener(el,v.type,v.fn)}});if(recurse&&el&&el.childNodes){Ext.each(el.childNodes,function(v){me.purgeElement(v,recurse,eventName)})}},getListeners:function(el,eventName){var me=this,results=[],searchLists;if(eventName){searchLists=eventName==UNLOAD?unloadListeners:listeners}else{searchLists=listeners.concat(unloadListeners)}Ext.each(searchLists,function(v,i){if(v&&v[EL]==el&&(!eventName||eventName==v[TYPE])){results.push({type:v[TYPE],fn:v[FN],obj:v[OBJ],adjust:v[ADJ_SCOPE],index:i})}});return results.length?results:null},_unload:function(e){var EU=Ext.lib.Event,i,j,l,len,index,scope;Ext.each(unloadListeners,function(v){if(v){try{scope=v[ADJ_SCOPE]?(v[ADJ_SCOPE]===true?v[OBJ]:v[ADJ_SCOPE]):win;v[FN].call(scope,EU.getEvent(e),v[OBJ])}catch(ex){}}});unloadListeners=null;if(listeners&&(j=listeners.length)){while(j){if((l=listeners[index=--j])){EU.removeListener(l[EL],l[TYPE],l[FN],index)}}}doRemove(win,UNLOAD,EU._unload)}};pub.on=pub.addListener;pub.un=pub.removeListener;if(doc&&doc.body){pub._load(true)}else{doAdd(win,"load",pub._load)}doAdd(win,UNLOAD,pub._unload);_tryPreloadAttach();return pub}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.lib.Ajax=function(){var activeX=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],CONTENTTYPE="Content-Type";function setHeader(o){var conn=o.conn,prop;function setTheHeaders(conn,headers){for(prop in headers){if(headers.hasOwnProperty(prop)){conn.setRequestHeader(prop,headers[prop])}}}if(pub.defaultHeaders){setTheHeaders(conn,pub.defaultHeaders)}if(pub.headers){setTheHeaders(conn,pub.headers);pub.headers=null}}function createExceptionObject(tId,callbackArg,isAbort,isTimeout){return{tId:tId,status:isAbort?-1:0,statusText:isAbort?"transaction aborted":"communication failure",isAbort:true,isTimeout:true,argument:callbackArg}}function initHeader(label,value){(pub.headers=pub.headers||{})[label]=value}function createResponseObject(o,callbackArg){var headerObj={},headerStr,conn=o.conn,t,s;try{headerStr=o.conn.getAllResponseHeaders();Ext.each(headerStr.replace(/\r\n/g,"\n").split("\n"),function(v){t=v.indexOf(":");if(t>=0){s=v.substr(0,t).toLowerCase();if(v.charAt(t+1)==" "){++t}headerObj[s]=v.substr(t+1)}})}catch(e){}return{tId:o.tId,status:conn.status,statusText:conn.statusText,getResponseHeader:function(header){return headerObj[header.toLowerCase()]},getAllResponseHeaders:function(){return headerStr},responseText:conn.responseText,responseXML:conn.responseXML,argument:callbackArg}}function releaseObject(o){o.conn=null;o=null}function handleTransactionResponse(o,callback,isAbort,isTimeout){if(!callback){releaseObject(o);return }var httpStatus,responseObject;try{if(o.conn.status!==undefined&&o.conn.status!=0){httpStatus=o.conn.status}else{httpStatus=13030}}catch(e){httpStatus=13030}if((httpStatus>=200&&httpStatus<300)||(Ext.isIE&&httpStatus==1223)){responseObject=createResponseObject(o,callback.argument);if(callback.success){if(!callback.scope){callback.success(responseObject)}else{callback.success.apply(callback.scope,[responseObject])}}}else{switch(httpStatus){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:responseObject=createExceptionObject(o.tId,callback.argument,(isAbort?isAbort:false),isTimeout);if(callback.failure){if(!callback.scope){callback.failure(responseObject)}else{callback.failure.apply(callback.scope,[responseObject])}}break;default:responseObject=createResponseObject(o,callback.argument);if(callback.failure){if(!callback.scope){callback.failure(responseObject)}else{callback.failure.apply(callback.scope,[responseObject])}}}}releaseObject(o);responseObject=null}function handleReadyState(o,callback){callback=callback||{};var conn=o.conn,tId=o.tId,poll=pub.poll,cbTimeout=callback.timeout||null;if(cbTimeout){pub.timeout[tId]=setTimeout(function(){pub.abort(o,callback,true)},cbTimeout)}poll[tId]=setInterval(function(){if(conn&&conn.readyState==4){clearInterval(poll[tId]);poll[tId]=null;if(cbTimeout){clearTimeout(pub.timeout[tId]);pub.timeout[tId]=null}handleTransactionResponse(o,callback)}},pub.pollInterval)}function asyncRequest(method,uri,callback,postData){var o=getConnectionObject()||null;if(o){o.conn.open(method,uri,true);if(pub.useDefaultXhrHeader){initHeader("X-Requested-With",pub.defaultXhrHeader)}if(postData&&pub.useDefaultHeader&&(!pub.headers||!pub.headers[CONTENTTYPE])){initHeader(CONTENTTYPE,pub.defaultPostHeader)}if(pub.defaultHeaders||pub.headers){setHeader(o)}handleReadyState(o,callback);o.conn.send(postData||null)}return o}function getConnectionObject(){var o;try{if(o=createXhrObject(pub.transactionId)){pub.transactionId++}}catch(e){}finally{return o}}function createXhrObject(transactionId){var http;try{http=new XMLHttpRequest()}catch(e){for(var i=0;i<activeX.length;++i){try{http=new ActiveXObject(activeX[i]);break}catch(e){}}}finally{return{conn:http,tId:transactionId}}}var pub={request:function(method,uri,cb,data,options){if(options){var me=this,xmlData=options.xmlData,jsonData=options.jsonData,hs;Ext.applyIf(me,options);if(xmlData||jsonData){hs=me.headers;if(!hs||!hs[CONTENTTYPE]){initHeader(CONTENTTYPE,xmlData?"text/xml":"application/json")}data=xmlData||(Ext.isObject(jsonData)?Ext.encode(jsonData):jsonData)}}return asyncRequest(method||options.method||"POST",uri,cb,data)},serializeForm:function(form){var fElements=form.elements||(document.forms[form]||Ext.getDom(form)).elements,hasSubmit=false,encoder=encodeURIComponent,element,options,name,val,data="",type;Ext.each(fElements,function(element){name=element.name;type=element.type;if(!element.disabled&&name){if(/select-(one|multiple)/i.test(type)){Ext.each(element.options,function(opt){if(opt.selected){data+=String.format("{0}={1}&",encoder(name),(opt.hasAttribute?opt.hasAttribute("value"):opt.getAttributeNode("value").specified)?opt.value:opt.text)}})}else{if(!/file|undefined|reset|button/i.test(type)){if(!(/radio|checkbox/i.test(type)&&!element.checked)&&!(type=="submit"&&hasSubmit)){data+=encoder(name)+"="+encoder(element.value)+"&";hasSubmit=/submit/i.test(type)}}}}});return data.substr(0,data.length-1)},useDefaultHeader:true,defaultPostHeader:"application/x-www-form-urlencoded; charset=UTF-8",useDefaultXhrHeader:true,defaultXhrHeader:"XMLHttpRequest",poll:{},timeout:{},pollInterval:50,transactionId:0,abort:function(o,callback,isTimeout){var me=this,tId=o.tId,isAbort=false;if(me.isCallInProgress(o)){o.conn.abort();clearInterval(me.poll[tId]);me.poll[tId]=null;if(isTimeout){me.timeout[tId]=null}handleTransactionResponse(o,callback,(isAbort=true),isTimeout)}return isAbort},isCallInProgress:function(o){return o.conn&&!{0:true,4:true}[o.conn.readyState]}};return pub}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.lib.Region=function(t,r,b,l){var me=this;me.top=t;me[1]=t;me.right=r;me.bottom=b;me.left=l;me[0]=l};Ext.lib.Region.prototype={contains:function(region){var me=this;return(region.left>=me.left&&region.right<=me.right&&region.top>=me.top&&region.bottom<=me.bottom)},getArea:function(){var me=this;return((me.bottom-me.top)*(me.right-me.left))},intersect:function(region){var me=this,t=Math.max(me.top,region.top),r=Math.min(me.right,region.right),b=Math.min(me.bottom,region.bottom),l=Math.max(me.left,region.left);if(b>=t&&r>=l){return new Ext.lib.Region(t,r,b,l)}},union:function(region){var me=this,t=Math.min(me.top,region.top),r=Math.max(me.right,region.right),b=Math.max(me.bottom,region.bottom),l=Math.min(me.left,region.left);return new Ext.lib.Region(t,r,b,l)},constrainTo:function(r){var me=this;me.top=me.top.constrain(r.top,r.bottom);me.bottom=me.bottom.constrain(r.top,r.bottom);me.left=me.left.constrain(r.left,r.right);me.right=me.right.constrain(r.left,r.right);return me},adjust:function(t,l,b,r){var me=this;me.top+=t;me.left+=l;me.right+=r;me.bottom+=b;return me}};Ext.lib.Region.getRegion=function(el){var p=Ext.lib.Dom.getXY(el),t=p[1],r=p[0]+el.offsetWidth,b=p[1]+el.offsetHeight,l=p[0];return new Ext.lib.Region(t,r,b,l)};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.lib.Point=function(x,y){if(Ext.isArray(x)){y=x[1];x=x[0]}var me=this;me.x=me.right=me.left=me[0]=x;me.y=me.top=me.bottom=me[1]=y};Ext.lib.Point.prototype=new Ext.lib.Region();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var EXTLIB=Ext.lib,noNegatives=/width|height|opacity|padding/i,offsetAttribute=/^((width|height)|(top|left))$/,defaultUnit=/width|height|top$|bottom$|left$|right$/i,offsetUnit=/\d+(em|%|en|ex|pt|in|cm|mm|pc)$/i,isset=function(v){return typeof v!=="undefined"},now=function(){return new Date()};EXTLIB.Anim={motion:function(el,args,duration,easing,cb,scope){return this.run(el,args,duration,easing,cb,scope,Ext.lib.Motion)},run:function(el,args,duration,easing,cb,scope,type){type=type||Ext.lib.AnimBase;if(typeof easing=="string"){easing=Ext.lib.Easing[easing]}var anim=new type(el,args,duration,easing);anim.animateX(function(){if(Ext.isFunction(cb)){cb.call(scope)}});return anim}};EXTLIB.AnimBase=function(el,attributes,duration,method){if(el){this.init(el,attributes,duration,method)}};EXTLIB.AnimBase.prototype={doMethod:function(attr,start,end){var me=this;return me.method(me.curFrame,start,end-start,me.totalFrames)},setAttr:function(attr,val,unit){if(noNegatives.test(attr)&&val<0){val=0}Ext.fly(this.el,"_anim").setStyle(attr,val+unit)},getAttr:function(attr){var el=Ext.fly(this.el),val=el.getStyle(attr),a=offsetAttribute.exec(attr)||[];if(val!=="auto"&&!offsetUnit.test(val)){return parseFloat(val)}return(!!(a[2])||(el.getStyle("position")=="absolute"&&!!(a[3])))?el.dom["offset"+a[0].charAt(0).toUpperCase()+a[0].substr(1)]:0},getDefaultUnit:function(attr){return defaultUnit.test(attr)?"px":""},animateX:function(callback,scope){var me=this,f=function(){me.onComplete.removeListener(f);if(Ext.isFunction(callback)){callback.call(scope||me,me)}};me.onComplete.addListener(f,me);me.animate()},setRunAttr:function(attr){var me=this,a=this.attributes[attr],to=a.to,by=a.by,from=a.from,unit=a.unit,ra=(this.runAttrs[attr]={}),end;if(!isset(to)&&!isset(by)){return false}var start=isset(from)?from:me.getAttr(attr);if(isset(to)){end=to}else{if(isset(by)){if(Ext.isArray(start)){end=[];Ext.each(start,function(v,i){end[i]=v+by[i]})}else{end=start+by}}}Ext.apply(ra,{start:start,end:end,unit:isset(unit)?unit:me.getDefaultUnit(attr)})},init:function(el,attributes,duration,method){var me=this,actualFrames=0,mgr=EXTLIB.AnimMgr;Ext.apply(me,{isAnimated:false,startTime:null,el:Ext.getDom(el),attributes:attributes||{},duration:duration||1,method:method||EXTLIB.Easing.easeNone,useSec:true,curFrame:0,totalFrames:mgr.fps,runAttrs:{},animate:function(){var me=this,d=me.duration;if(me.isAnimated){return false}me.curFrame=0;me.totalFrames=me.useSec?Math.ceil(mgr.fps*d):d;mgr.registerElement(me)},stop:function(finish){var me=this;if(finish){me.curFrame=me.totalFrames;me._onTween.fire()}mgr.stop(me)}});var onStart=function(){var me=this,attr;me.onStart.fire();me.runAttrs={};for(attr in this.attributes){this.setRunAttr(attr)}me.isAnimated=true;me.startTime=now();actualFrames=0};var onTween=function(){var me=this;me.onTween.fire({duration:now()-me.startTime,curFrame:me.curFrame});var ra=me.runAttrs;for(var attr in ra){this.setAttr(attr,me.doMethod(attr,ra[attr].start,ra[attr].end),ra[attr].unit)}++actualFrames};var onComplete=function(){var me=this,actual=(now()-me.startTime)/1000,data={duration:actual,frames:actualFrames,fps:actualFrames/actual};me.isAnimated=false;actualFrames=0;me.onComplete.fire(data)};me.onStart=new Ext.util.Event(me);me.onTween=new Ext.util.Event(me);me.onComplete=new Ext.util.Event(me);(me._onStart=new Ext.util.Event(me)).addListener(onStart);(me._onTween=new Ext.util.Event(me)).addListener(onTween);(me._onComplete=new Ext.util.Event(me)).addListener(onComplete)}};Ext.lib.AnimMgr=new function(){var me=this,thread=null,queue=[],tweenCount=0;Ext.apply(me,{fps:1000,delay:1,registerElement:function(tween){queue.push(tween);++tweenCount;tween._onStart.fire();me.start()},unRegister:function(tween,index){tween._onComplete.fire();index=index||getIndex(tween);if(index!=-1){queue.splice(index,1)}if(--tweenCount<=0){me.stop()}},start:function(){if(thread===null){thread=setInterval(me.run,me.delay)}},stop:function(tween){if(!tween){clearInterval(thread);for(var i=0,len=queue.length;i<len;++i){if(queue[0].isAnimated){me.unRegister(queue[0],0)}}queue=[];thread=null;tweenCount=0}else{me.unRegister(tween)}},run:function(){var tf;Ext.each(queue,function(tween){if(tween&&tween.isAnimated){tf=tween.totalFrames;if(tween.curFrame<tf||tf===null){++tween.curFrame;if(tween.useSec){correctFrame(tween)}tween._onTween.fire()}else{me.stop(tween)}}},me)}});var getIndex=function(anim){var out=-1;Ext.each(queue,function(item,idx){if(item==anim){out=idx;return false}});return out};var correctFrame=function(tween){var frames=tween.totalFrames,frame=tween.curFrame,duration=tween.duration,expected=(frame*duration*1000/frames),elapsed=(now()-tween.startTime),tweak=0;if(elapsed<duration*1000){tweak=Math.round((elapsed/expected-1)*frame)}else{tweak=frames-(frame+1)}if(tweak>0&&isFinite(tweak)){if(tween.curFrame+tweak>=frames){tweak=frames-(frame+1)}tween.curFrame+=tweak}}};EXTLIB.Bezier=new function(){this.getPosition=function(points,t){var n=points.length,tmp=[],c=1-t,i,j;for(i=0;i<n;++i){tmp[i]=[points[i][0],points[i][1]]}for(j=1;j<n;++j){for(i=0;i<n-j;++i){tmp[i][0]=c*tmp[i][0]+t*tmp[parseInt(i+1,10)][0];tmp[i][1]=c*tmp[i][1]+t*tmp[parseInt(i+1,10)][1]}}return[tmp[0][0],tmp[0][1]]}};EXTLIB.Easing={easeNone:function(t,b,c,d){return c*t/d+b},easeIn:function(t,b,c,d){return c*(t/=d)*t+b},easeOut:function(t,b,c,d){return -c*(t/=d)*(t-2)+b}};(function(){EXTLIB.Motion=function(el,attributes,duration,method){if(el){EXTLIB.Motion.superclass.constructor.call(this,el,attributes,duration,method)}};Ext.extend(EXTLIB.Motion,Ext.lib.AnimBase);var superclass=EXTLIB.Motion.superclass,proto=EXTLIB.Motion.prototype,pointsRe=/^points$/i;Ext.apply(EXTLIB.Motion.prototype,{setAttr:function(attr,val,unit){var me=this,setAttr=superclass.setAttr;if(pointsRe.test(attr)){unit=unit||"px";setAttr.call(me,"left",val[0],unit);setAttr.call(me,"top",val[1],unit)}else{setAttr.call(me,attr,val,unit)}},getAttr:function(attr){var me=this,getAttr=superclass.getAttr;return pointsRe.test(attr)?[getAttr.call(me,"left"),getAttr.call(me,"top")]:getAttr.call(me,attr)},doMethod:function(attr,start,end){var me=this;return pointsRe.test(attr)?EXTLIB.Bezier.getPosition(me.runAttrs[attr],me.method(me.curFrame,0,100,me.totalFrames)/100):superclass.doMethod.call(me,attr,start,end)},setRunAttr:function(attr){if(pointsRe.test(attr)){var me=this,el=this.el,points=this.attributes.points,control=points.control||[],from=points.from,to=points.to,by=points.by,DOM=EXTLIB.Dom,start,i,end,len,ra;if(control.length>0&&!Ext.isArray(control[0])){control=[control]}else{}Ext.fly(el,"_anim").position();DOM.setXY(el,isset(from)?from:DOM.getXY(el));start=me.getAttr("points");if(isset(to)){end=translateValues.call(me,to,start);for(i=0,len=control.length;i<len;++i){control[i]=translateValues.call(me,control[i],start)}}else{if(isset(by)){end=[start[0]+by[0],start[1]+by[1]];for(i=0,len=control.length;i<len;++i){control[i]=[start[0]+control[i][0],start[1]+control[i][1]]}}}ra=this.runAttrs[attr]=[start];if(control.length>0){ra=ra.concat(control)}ra[ra.length]=end}else{superclass.setRunAttr.call(this,attr)}}});var translateValues=function(val,start){var pageXY=EXTLIB.Dom.getXY(this.el);return[val[0]-pageXY[0]+start[0],val[1]-pageXY[1]+start[1]]}})()})();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var abs=Math.abs,pi=Math.PI,asin=Math.asin,pow=Math.pow,sin=Math.sin,EXTLIB=Ext.lib;Ext.apply(EXTLIB.Easing,{easeBoth:function(t,b,c,d){return((t/=d/2)<1)?c/2*t*t+b:-c/2*((--t)*(t-2)-1)+b},easeInStrong:function(t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutStrong:function(t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b},easeBothStrong:function(t,b,c,d){return((t/=d/2)<1)?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},elasticIn:function(t,b,c,d,a,p){if(t==0||(t/=d)==1){return t==0?b:b+c}p=p||(d*0.3);var s;if(a>=abs(c)){s=p/(2*pi)*asin(c/a)}else{a=c;s=p/4}return -(a*pow(2,10*(t-=1))*sin((t*d-s)*(2*pi)/p))+b},elasticOut:function(t,b,c,d,a,p){if(t==0||(t/=d)==1){return t==0?b:b+c}p=p||(d*0.3);var s;if(a>=abs(c)){s=p/(2*pi)*asin(c/a)}else{a=c;s=p/4}return a*pow(2,-10*t)*sin((t*d-s)*(2*pi)/p)+c+b},elasticBoth:function(t,b,c,d,a,p){if(t==0||(t/=d/2)==2){return t==0?b:b+c}p=p||(d*(0.3*1.5));var s;if(a>=abs(c)){s=p/(2*pi)*asin(c/a)}else{a=c;s=p/4}return t<1?-0.5*(a*pow(2,10*(t-=1))*sin((t*d-s)*(2*pi)/p))+b:a*pow(2,-10*(t-=1))*sin((t*d-s)*(2*pi)/p)*0.5+c+b},backIn:function(t,b,c,d,s){s=s||1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},backOut:function(t,b,c,d,s){if(!s){s=1.70158}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},backBoth:function(t,b,c,d,s){s=s||1.70158;return((t/=d/2)<1)?c/2*(t*t*(((s*=(1.525))+1)*t-s))+b:c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b},bounceIn:function(t,b,c,d){return c-EXTLIB.Easing.bounceOut(d-t,0,c,d)+b},bounceOut:function(t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else{if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b}else{if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b}}}return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b},bounceBoth:function(t,b,c,d){return(t<d/2)?EXTLIB.Easing.bounceIn(t*2,0,c,d)*0.5+b:EXTLIB.Easing.bounceOut(t*2-d,0,c,d)*0.5+c*0.5+b}})})();(function(){var EXTLIB=Ext.lib;EXTLIB.Anim.color=function(el,args,duration,easing,cb,scope){return EXTLIB.Anim.run(el,args,duration,easing,cb,scope,EXTLIB.ColorAnim)};EXTLIB.ColorAnim=function(el,attributes,duration,method){EXTLIB.ColorAnim.superclass.constructor.call(this,el,attributes,duration,method)};Ext.extend(EXTLIB.ColorAnim,EXTLIB.AnimBase);var superclass=EXTLIB.ColorAnim.superclass,colorRE=/color$/i,transparentRE=/^transparent|rgba\(0, 0, 0, 0\)$/,rgbRE=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,hexRE=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,hex3RE=/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,isset=function(v){return typeof v!=="undefined"};function parseColor(s){var pi=parseInt,base,out=null,c;if(s.length==3){return s}Ext.each([hexRE,rgbRE,hex3RE],function(re,idx){base=(idx%2==0)?16:10;c=re.exec(s);if(c&&c.length==4){out=[pi(c[1],base),pi(c[2],base),pi(c[3],base)];return false}});return out}Ext.apply(EXTLIB.ColorAnim.prototype,{getAttr:function(attr){var me=this,el=me.el,val;if(colorRE.test(attr)){while(el&&transparentRE.test(val=Ext.fly(el).getStyle(attr))){el=el.parentNode;val="fff"}}else{val=superclass.getAttr.call(me,attr)}return val},doMethod:function(attr,start,end){var me=this,val,floor=Math.floor;if(colorRE.test(attr)){val=[];Ext.each(start,function(v,i){val[i]=superclass.doMethod.call(me,attr,v,end[i])});val="rgb("+floor(val[0])+","+floor(val[1])+","+floor(val[2])+")"}else{val=superclass.doMethod.call(me,attr,start,end)}return val},setRunAttr:function(attr){var me=this,a=me.attributes[attr],to=a.to,by=a.by,ra;superclass.setRunAttr.call(me,attr);ra=me.runAttrs[attr];if(colorRE.test(attr)){var start=parseColor(ra.start),end=parseColor(ra.end);if(!isset(to)&&isset(by)){end=parseColor(by);Ext.each(start,function(item,i){end[i]=item+end[i]})}ra.start=start;ra.end=end}}})})();(function(){var EXTLIB=Ext.lib;EXTLIB.Anim.scroll=function(el,args,duration,easing,cb,scope){return EXTLIB.Anim.run(el,args,duration,easing,cb,scope,EXTLIB.Scroll)};EXTLIB.Scroll=function(el,attributes,duration,method){if(el){EXTLIB.Scroll.superclass.constructor.call(this,el,attributes,duration,method)}};Ext.extend(EXTLIB.Scroll,EXTLIB.ColorAnim);var superclass=EXTLIB.Scroll.superclass,SCROLL="scroll";Ext.apply(EXTLIB.Scroll.prototype,{doMethod:function(attr,start,end){var val,me=this,curFrame=me.curFrame,totalFrames=me.totalFrames;if(attr==SCROLL){val=[me.method(curFrame,start[0],end[0]-start[0],totalFrames),me.method(curFrame,start[1],end[1]-start[1],totalFrames)]}else{val=superclass.doMethod.call(me,attr,start,end)}return val},getAttr:function(attr){var me=this;if(attr==SCROLL){return[me.el.scrollLeft,me.el.scrollTop]}else{return superclass.getAttr.call(me,attr)}},setAttr:function(attr,val,unit){var me=this;if(attr==SCROLL){me.el.scrollLeft=val[0];me.el.scrollTop=val[1]}else{superclass.setAttr.call(me,attr,val,unit)}}})})();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
if(Ext.isIE){function fnCleanUp(){var p=Function.prototype;delete p.createSequence;delete p.defer;delete p.createDelegate;delete p.createCallback;delete p.createInterceptor;window.detachEvent("onunload",fnCleanUp)}if(window.attachEvent){window.attachEvent("onunload",fnCleanUp)}else{if(window.addEventListener){window.addEventListener("onunload",fnCleanUp)}}}})();
/*
 * Artery JS Library 2.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.DomHelper=function(){var R=null,I=/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i,K=/^table|tbody|tr|td$/i,O,L="afterbegin",M="afterend",C="beforebegin",N="beforeend",A="<table>",G="</table>",B=A+"<tbody>",H="</tbody>"+G,J=B+"<tr>",Q="</tr>"+H;function F(V,X,W,Y,U,S){var T=O.insertHtml(Y,Ext.getDom(V),P(X));return W?Ext.get(T,true):T}function P(X){var U="",T,W,V,S,Y;if(typeof X=="string"){U=X}else{if(Ext.isArray(X)){Ext.each(X,function(Z){U+=P(Z)})}else{U+="<"+(X.tag=X.tag||"div");Ext.iterate(X,function(Z,a){if(!/tag|children|cn|html$/i.test(Z)){if(Ext.isObject(a)){U+=" "+Z+"='";Ext.iterate(a,function(d,b){U+=d+":"+b+";"});U+="'"}else{U+=" "+({cls:"class",htmlFor:"for"}[Z]||Z)+"='"+a+"'"}}});if(I.test(X.tag)){U+="/>"}else{U+=">";if((Y=X.children||X.cn)){U+=P(Y)}else{if(X.html){U+=X.html}}U+="</"+X.tag+">"}}}return U}function E(X,V,U,W){R.innerHTML=[V,U,W].join("");var S=-1,T=R;while(++S<X){T=T.firstChild}return T}function D(S,T,V,U){var W,X;R=R||document.createElement("div");if(S=="td"&&(T==L||T==N)||!/td|tr|tbody/i.test(S)&&(T==C||T==M)){return }X=T==C?V:T==M?V.nextSibling:T==L?V.firstChild:null;if(T==C||T==M){V=V.parentNode}if(S=="td"||(S=="tr"&&(T==N||T==L))){W=E(4,J,U,Q)}else{if((S=="tbody"&&(T==N||T==L))||(S=="tr"&&(T==C||T==M))){W=E(3,B,U,H)}else{W=E(2,A,U,G)}}V.insertBefore(W,X);return W}O={markup:function(S){return P(S)},insertHtml:function(X,S,Y){var W={},U,a,Z,b,V,T;X=X.toLowerCase();W[C]=["BeforeBegin","previousSibling"];W[M]=["AfterEnd","nextSibling"];if(S.insertAdjacentHTML){if(K.test(S.tagName)&&(T=D(S.tagName.toLowerCase(),X,S,Y))){return T}W[L]=["AfterBegin","firstChild"];W[N]=["BeforeEnd","lastChild"];if((U=W[X])){S.insertAdjacentHTML(U[0],Y);return S[U[1]]}}else{Z=S.ownerDocument.createRange();a="setStart"+(/end/i.test(X)?"After":"Before");if(W[X]){Z[a](S);b=Z.createContextualFragment(Y);S.parentNode.insertBefore(b,X==C?S:S.nextSibling);return S[(X==C?"previous":"next")+"Sibling"]}else{V=(X==L?"first":"last")+"Child";if(S.firstChild){Z[a](S[V]);b=Z.createContextualFragment(Y);if(X==L){S.insertBefore(b,S.firstChild)}else{S.appendChild(b)}}else{S.innerHTML=Y}return S[V]}}throw'Illegal insertion point -> "'+X+'"'},insertBefore:function(S,U,T){return F(S,U,T,C)},insertAfter:function(S,U,T){return F(S,U,T,M,"nextSibling")},insertFirst:function(S,U,T){return F(S,U,T,L,"firstChild")},append:function(S,U,T){return F(S,U,T,N,"",true)},overwrite:function(S,U,T){S=Ext.getDom(S);S.innerHTML=P(U);return T?Ext.get(S.firstChild):S.firstChild},createHtml:P};return O}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.apply(Ext.DomHelper,function(){var D,A="afterbegin",F="afterend",G="beforebegin",C="beforeend";function E(K,M,L,N,J,H){K=Ext.getDom(K);var I;if(D.useDom){I=B(M,null);if(H){K.appendChild(I)}else{(J=="firstChild"?K:K.parentNode).insertBefore(I,K[J]||K)}}else{I=Ext.DomHelper.insertHtml(N,K,Ext.DomHelper.createHtml(M))}return L?Ext.get(I,true):I}function B(N,I){var K,L=document,J,H,M,O;if(Ext.isArray(N)){K=L.createDocumentFragment();Ext.each(N,function(P){B(P,K)})}else{if(Ext.isString(N)){K=L.createTextNode(N)}else{K=L.createElement(N.tag||"div");J=!!K.setAttribute;Ext.iterate(N,function(P,Q){if(!/tag|children|cn|html|style/.test(P)){if(P=="cls"){K.className=Q}else{if(J){K.setAttribute(P,Q)}else{K[P]=Q}}}});D.applyStyles(K,N.style);if((O=N.children||N.cn)){B(O,K)}else{if(N.html){K.innerHTML=N.html}}}}if(I){I.appendChild(K)}return K}D={createTemplate:function(I){var H=Ext.DomHelper.createHtml(I);return new Ext.Template(H)},useDom:false,applyStyles:function(K,L){if(L){var I=0,H,J;K=Ext.fly(K);if(Ext.isFunction(L)){L=L.call()}if(Ext.isString(L)){L=L.trim().split(/\s*(?::|;)\s*/);for(H=L.length;I<H;){K.setStyle(L[I++],L[I++])}}else{if(Ext.isObject(L)){K.setStyle(L)}}}},insertBefore:function(H,J,I){return E(H,J,I,G)},insertAfter:function(H,J,I){return E(H,J,I,F,"nextSibling")},insertFirst:function(H,J,I){return E(H,J,I,A,"firstChild")},append:function(H,J,I){return E(H,J,I,C,"",true)},createDom:B};return D}());
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Template=function(C){var D=this,A=arguments,B=[];if(Ext.isArray(C)){C=C.join("")}else{if(A.length>1){Ext.each(A,function(E){if(Ext.isObject(E)){Ext.apply(D,E)}else{B.push(E)}});C=B.join("")}}D.html=C;if(D.compiled){D.compile()}};Ext.Template.prototype={applyTemplate:function(A){var B=this;return B.compiled?B.compiled(A):B.html.replace(B.re,function(C,D){return A[D]!==undefined?A[D]:""})},set:function(A,C){var B=this;B.html=A;B.compiled=null;return C?B.compile():B},re:/\{([\w-]+)\}/g,compile:function(){var me=this,sep=Ext.isGecko?"+":",";function fn(m,name){name="values['"+name+"']";return"'"+sep+"("+name+" == undefined ? '' : "+name+")"+sep+"'"}eval("this.compiled = function(values){ return "+(Ext.isGecko?"'":"['")+me.html.replace(/\\/g,"\\\\").replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn)+(Ext.isGecko?"';};":"'].join('');};"));return me},insertFirst:function(B,A,C){return this.doInsert("afterBegin",B,A,C)},insertBefore:function(B,A,C){return this.doInsert("beforeBegin",B,A,C)},insertAfter:function(B,A,C){return this.doInsert("afterEnd",B,A,C)},append:function(B,A,C){return this.doInsert("beforeEnd",B,A,C)},doInsert:function(C,E,B,A){E=Ext.getDom(E);var D=Ext.DomHelper.insertHtml(C,E,this.applyTemplate(B));return A?Ext.get(D,true):D},overwrite:function(B,A,C){B=Ext.getDom(B);B.innerHTML=this.applyTemplate(A);return C?Ext.get(B.firstChild,true):B.firstChild}};Ext.Template.prototype.apply=Ext.Template.prototype.applyTemplate;Ext.Template.from=function(B,A){B=Ext.getDom(B);return new Ext.Template(B.value||B.innerHTML,A||"")};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.apply(Ext.Template.prototype,{applyTemplate:function(B){var F=this,A=F.disableFormats!==true,E=Ext.util.Format,C=F;if(F.compiled){return F.compiled(B)}function D(H,J,M,I){if(M&&A){if(M.substr(0,5)=="this."){return C.call(M.substr(5),B[J],B)}else{if(I){var L=/^\s*['"](.*)["']\s*$/;I=I.split(",");for(var K=0,G=I.length;K<G;K++){I[K]=I[K].replace(L,"$1")}I=[B[J]].concat(I)}else{I=[B[J]]}return E[M].apply(E,I)}}else{return B[J]!==undefined?B[J]:""}}return F.html.replace(F.re,D)},disableFormats:false,re:/\{([\w-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,compile:function(){var me=this,fm=Ext.util.Format,useF=me.disableFormats!==true,sep=Ext.isGecko?"+":",",body;function fn(m,name,format,args){if(format&&useF){args=args?","+args:"";if(format.substr(0,5)!="this."){format="fm."+format+"("}else{format='this.call("'+format.substr(5)+'", ';args=", values"}}else{args="";format="(values['"+name+"'] == undefined ? '' : "}return"'"+sep+format+"values['"+name+"']"+args+")"+sep+"'"}if(Ext.isGecko){body="this.compiled = function(values){ return '"+me.html.replace(/\\/g,"\\\\").replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn)+"';};"}else{body=["this.compiled = function(values){ return ['"];body.push(me.html.replace(/\\/g,"\\\\").replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn));body.push("'].join('');};");body=body.join("")}eval(body);return me},call:function(C,B,A){return this[C](B,A)}});Ext.Template.prototype.apply=Ext.Template.prototype.applyTemplate;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.DomQuery=function(){var cache={},simpleCache={},valueCache={},nonSpace=/\S/,trimRe=/^\s+|\s+$/g,tplRe=/\{(\d+)\}/g,modeRe=/^(\s?[\/>+~]\s?|\s|$)/,tagTokenRe=/^(#)?([\w-\*]+)/,nthRe=/(\d*)n\+?(\d*)/,nthRe2=/\D/,isIE=window.ActiveXObject?true:false,isOpera=Ext.isOpera,key=30803;eval("var batch = 30803;");function child(p,index){var i=0,n=p.firstChild;while(n){if(n.nodeType==1){if(++i==index){return n}}n=n.nextSibling}return null}function next(n){while((n=n.nextSibling)&&n.nodeType!=1){}return n}function prev(n){while((n=n.previousSibling)&&n.nodeType!=1){}return n}function children(d){var n=d.firstChild,ni=-1,nx;while(n){nx=n.nextSibling;if(n.nodeType==3&&!nonSpace.test(n.nodeValue)){d.removeChild(n)}else{n.nodeIndex=++ni}n=nx}return this}function byClassName(c,a,v){if(!v){return c}var r=[],ri=-1,cn;for(var i=0,ci;ci=c[i];i++){if((" "+ci.className+" ").indexOf(v)!=-1){r[++ri]=ci}}return r}function attrValue(n,attr){if(!n.tagName&&typeof n.length!="undefined"){n=n[0]}if(!n){return null}if(attr=="for"){return n.htmlFor}if(attr=="class"||attr=="className"){return n.className}return n.getAttribute(attr)||n[attr]}function getNodes(ns,mode,tagName){var result=[],ri=-1,cs;if(!ns){return result}tagName=tagName||"*";if(typeof ns.getElementsByTagName!="undefined"){ns=[ns]}if(!mode){for(var i=0,ni;ni=ns[i];i++){cs=ni.getElementsByTagName(tagName);for(var j=0,ci;ci=cs[j];j++){result[++ri]=ci}}}else{if(mode=="/"||mode==">"){var utag=tagName.toUpperCase();for(var i=0,ni,cn;ni=ns[i];i++){cn=isOpera?ni.childNodes:(ni.children||ni.childNodes);for(var j=0,cj;cj=cn[j];j++){if(cj.nodeName==utag||cj.nodeName==tagName||tagName=="*"){result[++ri]=cj}}}}else{if(mode=="+"){var utag=tagName.toUpperCase();for(var i=0,n;n=ns[i];i++){while((n=n.nextSibling)&&n.nodeType!=1){}if(n&&(n.nodeName==utag||n.nodeName==tagName||tagName=="*")){result[++ri]=n}}}else{if(mode=="~"){var utag=tagName.toUpperCase();for(var i=0,n;n=ns[i];i++){while((n=n.nextSibling)){if(n.nodeName==utag||n.nodeName==tagName||tagName=="*"){result[++ri]=n}}}}}}}return result}function concat(a,b){if(b.slice){return a.concat(b)}for(var i=0,l=b.length;i<l;i++){a[a.length]=b[i]}return a}function byTag(cs,tagName){if(cs.tagName||cs==document){cs=[cs]}if(!tagName){return cs}var r=[],ri=-1;tagName=tagName.toLowerCase();for(var i=0,ci;ci=cs[i];i++){if(ci.nodeType==1&&ci.tagName.toLowerCase()==tagName){r[++ri]=ci}}return r}function byId(cs,attr,id){if(cs.tagName||cs==document){cs=[cs]}if(!id){return cs}var r=[],ri=-1;for(var i=0,ci;ci=cs[i];i++){if(ci&&ci.id==id){r[++ri]=ci;return r}}return r}function byAttribute(cs,attr,value,op,custom){var r=[],ri=-1,st=custom=="{",f=Ext.DomQuery.operators[op];for(var i=0,ci;ci=cs[i];i++){if(ci.nodeType!=1){continue}var a;if(st){a=Ext.DomQuery.getStyle(ci,attr)}else{if(attr=="class"||attr=="className"){a=ci.className}else{if(attr=="for"){a=ci.htmlFor}else{if(attr=="href"){a=ci.getAttribute("href",2)}else{a=ci.getAttribute(attr)}}}}if((f&&f(a,value))||(!f&&a)){r[++ri]=ci}}return r}function byPseudo(cs,name,value){return Ext.DomQuery.pseudos[name](cs,value)}function nodupIEXml(cs){var d=++key,r;cs[0].setAttribute("_nodup",d);r=[cs[0]];for(var i=1,len=cs.length;i<len;i++){var c=cs[i];if(!c.getAttribute("_nodup")!=d){c.setAttribute("_nodup",d);r[r.length]=c}}for(var i=0,len=cs.length;i<len;i++){cs[i].removeAttribute("_nodup")}return r}function nodup(cs){if(!cs){return[]}var len=cs.length,c,i,r=cs,cj,ri=-1;if(!len||typeof cs.nodeType!="undefined"||len==1){return cs}if(isIE&&typeof cs[0].selectSingleNode!="undefined"){return nodupIEXml(cs)}var d=++key;cs[0]._nodup=d;for(i=1;c=cs[i];i++){if(c._nodup!=d){c._nodup=d}else{r=[];for(var j=0;j<i;j++){r[++ri]=cs[j]}for(j=i+1;cj=cs[j];j++){if(cj._nodup!=d){cj._nodup=d;r[++ri]=cj}}return r}}return r}function quickDiffIEXml(c1,c2){var d=++key,r=[];for(var i=0,len=c1.length;i<len;i++){c1[i].setAttribute("_qdiff",d)}for(var i=0,len=c2.length;i<len;i++){if(c2[i].getAttribute("_qdiff")!=d){r[r.length]=c2[i]}}for(var i=0,len=c1.length;i<len;i++){c1[i].removeAttribute("_qdiff")}return r}function quickDiff(c1,c2){var len1=c1.length,d=++key,r=[];if(!len1){return c2}if(isIE&&c1[0].selectSingleNode){return quickDiffIEXml(c1,c2)}for(var i=0;i<len1;i++){c1[i]._qdiff=d}for(var i=0,len=c2.length;i<len;i++){if(c2[i]._qdiff!=d){r[r.length]=c2[i]}}return r}function quickId(ns,mode,root,id){if(ns==root){var d=root.ownerDocument||root;return d.getElementById(id)}ns=getNodes(ns,mode,"*");return byId(ns,null,id)}return{getStyle:function(el,name){return Ext.fly(el).getStyle(name)},compile:function(path,type){type=type||"select";var fn=["var f = function(root){\n var mode; ++batch; var n = root || document;\n"],q=path,mode,lq,tk=Ext.DomQuery.matchers,tklen=tk.length,mm,lmode=q.match(modeRe);if(lmode&&lmode[1]){fn[fn.length]='mode="'+lmode[1].replace(trimRe,"")+'";';q=q.replace(lmode[1],"")}while(path.substr(0,1)=="/"){path=path.substr(1)}while(q&&lq!=q){lq=q;var tm=q.match(tagTokenRe);if(type=="select"){if(tm){if(tm[1]=="#"){fn[fn.length]='n = quickId(n, mode, root, "'+tm[2]+'");'}else{fn[fn.length]='n = getNodes(n, mode, "'+tm[2]+'");'}q=q.replace(tm[0],"")}else{if(q.substr(0,1)!="@"){fn[fn.length]='n = getNodes(n, mode, "*");'}}}else{if(tm){if(tm[1]=="#"){fn[fn.length]='n = byId(n, null, "'+tm[2]+'");'}else{fn[fn.length]='n = byTag(n, "'+tm[2]+'");'}q=q.replace(tm[0],"")}}while(!(mm=q.match(modeRe))){var matched=false;for(var j=0;j<tklen;j++){var t=tk[j];var m=q.match(t.re);if(m){fn[fn.length]=t.select.replace(tplRe,function(x,i){return m[i]});q=q.replace(m[0],"");matched=true;break}}if(!matched){throw'Error parsing selector, parsing failed at "'+q+'"'}}if(mm[1]){fn[fn.length]='mode="'+mm[1].replace(trimRe,"")+'";';q=q.replace(mm[1],"")}}fn[fn.length]="return nodup(n);\n}";eval(fn.join(""));return f},select:function(path,root,type){if(!root||root==document){root=document}if(typeof root=="string"){root=document.getElementById(root)}var paths=path.split(","),results=[];for(var i=0,len=paths.length;i<len;i++){var p=paths[i].replace(trimRe,"");if(!cache[p]){cache[p]=Ext.DomQuery.compile(p);if(!cache[p]){throw p+" is not a valid selector"}}var result=cache[p](root);if(result&&result!=document){results=results.concat(result)}}if(paths.length>1){return nodup(results)}return results},selectNode:function(path,root){return Ext.DomQuery.select(path,root)[0]},selectValue:function(path,root,defaultValue){path=path.replace(trimRe,"");if(!valueCache[path]){valueCache[path]=Ext.DomQuery.compile(path,"select")}var n=valueCache[path](root),v;n=n[0]?n[0]:n;v=(n&&n.firstChild?n.firstChild.nodeValue:null);return((v===null||v===undefined||v==="")?defaultValue:v)},selectNumber:function(path,root,defaultValue){var v=Ext.DomQuery.selectValue(path,root,defaultValue||0);return parseFloat(v)},is:function(el,ss){if(typeof el=="string"){el=document.getElementById(el)}var isArray=Ext.isArray(el),result=Ext.DomQuery.filter(isArray?el:[el],ss);return isArray?(result.length==el.length):(result.length>0)},filter:function(els,ss,nonMatches){ss=ss.replace(trimRe,"");if(!simpleCache[ss]){simpleCache[ss]=Ext.DomQuery.compile(ss,"simple")}var result=simpleCache[ss](els);return nonMatches?quickDiff(result,els):result},matchers:[{re:/^\.([\w-]+)/,select:'n = byClassName(n, null, " {1} ");'},{re:/^\:([\w-]+)(?:\(((?:[^\s>\/]*|.*?))\))?/,select:'n = byPseudo(n, "{1}", "{2}");'},{re:/^(?:([\[\{])(?:@)?([\w-]+)\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]\}])/,select:'n = byAttribute(n, "{2}", "{4}", "{3}", "{1}");'},{re:/^#([\w-]+)/,select:'n = byId(n, null, "{1}");'},{re:/^@([\w-]+)/,select:'return {firstChild:{nodeValue:attrValue(n, "{1}")}};'}],operators:{"=":function(a,v){return a==v},"!=":function(a,v){return a!=v},"^=":function(a,v){return a&&a.substr(0,v.length)==v},"$=":function(a,v){return a&&a.substr(a.length-v.length)==v},"*=":function(a,v){return a&&a.indexOf(v)!==-1},"%=":function(a,v){return(a%v)==0},"|=":function(a,v){return a&&(a==v||a.substr(0,v.length+1)==v+"-")},"~=":function(a,v){return a&&(" "+a+" ").indexOf(" "+v+" ")!=-1}},pseudos:{"first-child":function(c){var r=[],ri=-1,n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.previousSibling)&&n.nodeType!=1){}if(!n){r[++ri]=ci}}return r},"last-child":function(c){var r=[],ri=-1,n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.nextSibling)&&n.nodeType!=1){}if(!n){r[++ri]=ci}}return r},"nth-child":function(c,a){var r=[],ri=-1,m=nthRe.exec(a=="even"&&"2n"||a=="odd"&&"2n+1"||!nthRe2.test(a)&&"n+"+a||a),f=(m[1]||1)-0,l=m[2]-0;for(var i=0,n;n=c[i];i++){var pn=n.parentNode;if(batch!=pn._batch){var j=0;for(var cn=pn.firstChild;cn;cn=cn.nextSibling){if(cn.nodeType==1){cn.nodeIndex=++j}}pn._batch=batch}if(f==1){if(l==0||n.nodeIndex==l){r[++ri]=n}}else{if((n.nodeIndex+l)%f==0){r[++ri]=n}}}return r},"only-child":function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(!prev(ci)&&!next(ci)){r[++ri]=ci}}return r},empty:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var cns=ci.childNodes,j=0,cn,empty=true;while(cn=cns[j]){++j;if(cn.nodeType==1||cn.nodeType==3){empty=false;break}}if(empty){r[++ri]=ci}}return r},contains:function(c,v){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if((ci.textContent||ci.innerText||"").indexOf(v)!=-1){r[++ri]=ci}}return r},nodeValue:function(c,v){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(ci.firstChild&&ci.firstChild.nodeValue==v){r[++ri]=ci}}return r},checked:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(ci.checked==true){r[++ri]=ci}}return r},not:function(c,ss){return Ext.DomQuery.filter(c,ss,true)},any:function(c,selectors){var ss=selectors.split("|"),r=[],ri=-1,s;for(var i=0,ci;ci=c[i];i++){for(var j=0;s=ss[j];j++){if(Ext.DomQuery.is(ci,s)){r[++ri]=ci;break}}}return r},odd:function(c){return this["nth-child"](c,"odd")},even:function(c){return this["nth-child"](c,"even")},nth:function(c,a){return c[a-1]||[]},first:function(c){return c[0]||[]},last:function(c){return c[c.length-1]||[]},has:function(c,ss){var s=Ext.DomQuery.select,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(s(ss,ci).length>0){r[++ri]=ci}}return r},next:function(c,ss){var is=Ext.DomQuery.is,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var n=next(ci);if(n&&is(n,ss)){r[++ri]=ci}}return r},prev:function(c,ss){var is=Ext.DomQuery.is,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var n=prev(ci);if(n&&is(n,ss)){r[++ri]=ci}}return r}}}}();Ext.query=Ext.DomQuery.select;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var H=Ext.util,K=Ext.toArray,J=Ext.each,A=Ext.isObject,G=true,I=false;H.Observable=function(){var L=this,M=L.events;if(L.listeners){L.on(L.listeners);delete L.listeners}L.events=M||{}};H.Observable.prototype=function(){var M=/^(?:scope|delay|buffer|single)$/,L=function(N){return N.toLowerCase()};return{fireEvent:function(){var N=K(arguments),P=L(N[0]),Q=this,O=G,S=Q.events[P],R,T;if(Q.eventsSuspended===G){if(R=Q.suspendedEventsQueue){R.push(N)}}else{if(A(S)&&S.bubble){if(S.fire.apply(S,N.slice(1))===I){return I}T=Q.getBubbleTarget&&Q.getBubbleTarget();if(T&&T.enableBubble){T.enableBubble(P);return T.fireEvent.apply(T,N)}}else{if(A(S)){N.shift();O=S.fire.apply(S,N)}}}return O},addListener:function(P,S,U,O){var R=this,Q,V,T,N;if(A(P)){O=P;for(Q in O){V=O[Q];if(!M.test(Q)){R.addListener(Q,V.fn||V,V.scope||O.scope,V.fn?V:O)}}}else{P=L(P);N=R.events[P]||G;if(typeof N=="boolean"){R.events[P]=N=new H.Event(R,P)}N.addListener(S,U,A(O)?O:{})}},removeListener:function(N,P,O){var Q=this.events[L(N)];if(A(Q)){Q.removeListener(P,O)}},purgeListeners:function(){var P=this.events,N,O;for(O in P){N=P[O];if(A(N)){N.clearListeners()}}},addEvents:function(O){var N=this;N.events=N.events||{};if(typeof O=="string"){J(arguments,function(P){N.events[P]=N.events[P]||G})}else{Ext.applyIf(N.events,O)}},hasListener:function(N){var O=this.events[N];return A(O)&&O.listeners.length>0},suspendEvents:function(N){this.eventsSuspended=G;if(N){this.suspendedEventsQueue=[]}},resumeEvents:function(){var N=this;N.eventsSuspended=!delete N.suspendedEventQueue;J(N.suspendedEventsQueue,function(O){N.fireEvent.apply(N,O)})}}}();var E=H.Observable.prototype;E.on=E.addListener;E.un=E.removeListener;H.Observable.releaseCapture=function(L){L.fireEvent=E.fireEvent};function F(M,N,L){return function(){if(N.target==arguments[0]){M.apply(L,K(arguments))}}}function C(N,O,M){var L=new H.DelayedTask();return function(){L.delay(O.buffer,N,M,K(arguments))}}function D(N,O,M,L){return function(){O.removeListener(M,L);return N.apply(L,arguments)}}function B(M,N,L){return function(){var O=K(arguments);(function(){M.apply(L,O)}).defer(N.delay||10)}}H.Event=function(M,L){this.name=L;this.obj=M;this.listeners=[]};H.Event.prototype={addListener:function(O,N,M){var P=this,L;N=N||P.obj;if(!P.isListening(O,N)){L=P.createListener(O,N,M);if(P.firing){P.listeners=P.listeners.slice(0)}P.listeners.push(L)}},createListener:function(O,N,P){P=P||{},N=N||this.obj;var L={fn:O,scope:N,options:P},M=O;if(P.target){M=F(M,P,N)}if(P.delay){M=B(M,P,N)}if(P.single){M=D(M,this,O,N)}if(P.buffer){M=C(M,P,N)}L.fireFn=M;return L},findListener:function(O,N){var M,L=-1;J(this.listeners,function(P,Q){M=P.scope;if(P.fn==O&&(M==N||M==this.obj)){L=Q;return I}},this);return L},isListening:function(M,L){return this.findListener(M,L)!=-1},removeListener:function(O,N){var M,P=this,L=I;if((M=P.findListener(O,N))!=-1){if(P.firing){P.listeners=P.listeners.slice(0)}P.listeners.splice(M,1);L=G}return L},clearListeners:function(){this.listeners=[]},fire:function(){var N=this,M=K(arguments),L=G;J(N.listeners,function(O){N.firing=G;if(O.fireFn.apply(O.scope||N.obj||window,M)===I){return L=N.firing=I}});N.firing=I;return L}}})();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.apply(Ext.util.Observable.prototype,function(){function A(H){var G=(this.methodEvents=this.methodEvents||{})[H],D,C,E,F=this;if(!G){this.methodEvents[H]=G={};G.originalFn=this[H];G.methodName=H;G.before=[];G.after=[];var B=function(K,J,I){if(!Ext.isEmpty(C=K.apply(J||F,I))){if(Ext.isObject(C)){D=!Ext.isEmpty(C.returnValue)?C.returnValue:C;E=!!C.cancel}else{if(C===false){E=true}else{D=C}}}};this[H]=function(){var I=Ext.toArray(arguments);D=C=undefined;E=false;Ext.each(G.before,function(J){B(J.fn,J.scope,I);if(E){return D}});if(!Ext.isEmpty(C=G.originalFn.apply(F,I))){D=C}Ext.each(G.after,function(J){B(J.fn,J.scope,I);if(E){return D}});return D}}return G}return{beforeMethod:function(D,C,B){A.call(this,D).before.push({fn:C,scope:B})},afterMethod:function(D,C,B){A.call(this,D).after.push({fn:C,scope:B})},removeMethodListener:function(F,C,B){var E=A.call(this,F),D=false;Ext.each(E.before,function(H,I,G){if(H.fn==C&&H.scope==B){G.splice(I,1);D=true;return false}});if(!D){Ext.each(E.after,function(H,I,G){if(H.fn==C&&H.scope==B){G.splice(I,1);return false}})}},relayEvents:function(E,B){var D=this;function C(F){return function(){return D.fireEvent.apply(D,[F].concat(Ext.toArray(arguments)))}}Ext.each(B,function(F){D.events[F]=D.events[F]||true;E.on(F,C(F),D)})},enableBubble:function(B){var C=this;B=Ext.isArray(B)?B:Ext.toArray(arguments);Ext.each(B,function(D){D=D.toLowerCase();var E=C.events[D]||true;if(typeof E=="boolean"){E=new Ext.util.Event(C,D);C.events[D]=E}E.bubble=true})}}}());Ext.util.Observable.capture=function(C,B,A){C.fireEvent=C.fireEvent.createInterceptor(B,A)};Ext.util.Observable.observeClass=function(A){Ext.apply(A,new Ext.util.Observable());A.prototype.fireEvent=function(){return(A.fireEvent.apply(A,arguments)!==false)&&(Ext.util.Observable.prototype.fireEvent.apply(this,arguments)!==false)}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.EventManager=function(){var V,O,L=false,N=Ext.lib.Event,P=Ext.lib.Dom,B=document,W=window,I="ie-deferred-loader",Q="DOMContentLoaded",H={},J=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/;function M(b,E,a,Z,Y){var e=Ext.id(b),d=H[e]=H[e]||{};(d[E]=d[E]||[]).push([a,Z,Y]);N.on(b,E,Z);if(E=="mousewheel"&&b.addEventListener){var D=["DOMMouseScroll",Z,false];b.addEventListener.apply(b,D);N.on(window,"unload",function(){b.removeEventListener.apply(b,D)})}if(E=="mousedown"&&b==document){Ext.EventManager.stoppedMouseDownEvent.addListener(Z)}}function C(){if(!L){Ext.isReady=L=true;if(O){clearInterval(O)}if(Ext.isGecko||Ext.isOpera){B.removeEventListener(Q,C,false)}if(Ext.isIE&&X.bindIE){B.detachEvent("onreadystatechange",X)}if(V){V.fire();V.clearListeners()}}}function F(){if(window!=top){return false}try{B.documentElement.doScroll("left")}catch(D){return false}C();return true}function X(D){var E="complete";if(Ext.isIE&&F()){return true}if(B.readyState==E){C();return true}L||(O=setTimeout(arguments.callee,2));return false}function A(){var D="complete";V=new Ext.util.Event();if(Ext.isGecko||Ext.isOpera){B.addEventListener(Q,C,false)}else{if(Ext.isIE){if(!X()){X.bindIE=true;B.attachEvent("onreadystatechange",X)}}else{if(Ext.isWebKit){O=setInterval(function(){if(B.readyState==D){C()}},10)}}}N.on(W,"load",C)}function U(D,E){return function(){var Y=Ext.toArray(arguments);if(E.target==Ext.EventObject.setEvent(Y[0]).target){D.apply(this,Y)}}}function T(E,Y){var D=new Ext.util.DelayedTask(E);return function(Z){D.delay(Y.buffer,E,null,[new Ext.EventObjectImpl(Z)])}}function R(a,Z,D,Y,E){return function(b){Ext.EventManager.removeListener(Z,D,Y,E);a(b)}}function G(D,E){return function(Y){Y=new Ext.EventObjectImpl(Y);setTimeout(function(){D(Y)},E.delay||10)}}function K(Y,E,D,d,b){var e=!Ext.isObject(D)?{}:D,a=Ext.getDom(Y);d=d||e.fn;b=b||e.scope;if(!a){throw'Error listening for "'+E+'". Element "'+Y+"\" doesn't exist."}function Z(h){if(!Ext){return }h=Ext.EventObject.setEvent(h);var g;if(e.delegate){if(!(g=h.getTarget(e.delegate,a))){return }}else{g=h.target}if(e.stopEvent){h.stopEvent()}if(e.preventDefault){h.preventDefault()}if(e.stopPropagation){h.stopPropagation()}if(e.normalized){h=h.browserEvent}d.call(b||a,h,g,e)}if(e.target){Z=U(Z,e)}if(e.delay){Z=G(Z,e)}if(e.single){Z=R(Z,a,E,d,b)}if(e.buffer){Z=T(Z,e)}M(a,E,d,Z,b);return Z}var S={addListener:function(Y,D,a,Z,E){if(Ext.isObject(D)){var g=D,b,d;for(b in g){d=g[b];if(!J.test(b)){if(Ext.isFunction(d)){K(Y,b,g,d,g.scope)}else{K(Y,b,d)}}}}else{K(Y,D,E,a,Z)}},removeListener:function(E,D,b,a){var Z=Ext.getDom(E),d=Ext.id(Z),Y;Ext.each((H[d]||{})[D],function(g,h,e){if(Ext.isArray(g)&&g[0]==b&&(!a||g[2]==a)){N.un(Z,D,Y=g[1]);e.splice(h,1);return false}});if(D=="mousewheel"&&Z.addEventListener&&Y){Z.removeEventListener("DOMMouseScroll",Y,false)}if(D=="mousedown"&&Z==B&&Y){Ext.EventManager.stoppedMouseDownEvent.removeListener(Y)}},removeAll:function(E){var Z=Ext.id(E=Ext.getDom(E)),Y=H[Z],D;for(D in Y){if(Y.hasOwnProperty(D)){Ext.each(Y[D],function(a){N.un(E,D,a.wrap)})}}H[Z]=null},onDocumentReady:function(Y,E,D){if(L){V.addListener(Y,E,D);V.fire();V.clearListeners()}else{if(!V){A()}D=D||{};D.delay=D.delay||1;V.addListener(Y,E,D)}},elHash:H};S.on=S.addListener;S.un=S.removeListener;S.stoppedMouseDownEvent=new Ext.util.Event();return S}();Ext.onReady=Ext.EventManager.onDocumentReady;(function(){var A=function(){var C=document.body||document.getElementsByTagName("body")[0];if(!C){return false}var B=[" ",Ext.isIE?"ext-ie "+(Ext.isIE6?"ext-ie6":(Ext.isIE7?"ext-ie7":"ext-ie8")):Ext.isGecko?"ext-gecko "+(Ext.isGecko2?"ext-gecko2":"ext-gecko3"):Ext.isOpera?"ext-opera":Ext.isWebKit?"ext-webkit":""];if(Ext.isSafari){B.push("ext-safari "+(Ext.isSafari2?"ext-safari2":(Ext.isSafari3?"ext-safari3":"ext-safari4")))}else{if(Ext.isChrome){B.push("ext-chrome")}}if(Ext.isMac){B.push("ext-mac")}if(Ext.isLinux){B.push("ext-linux")}if(Ext.isStrict||Ext.isBorderBox){var D=C.parentNode;if(D){D.className+=Ext.isStrict?" ext-strict":" ext-border-box"}}C.className+=B.join(" ");return true};if(!A()){Ext.onReady(A)}})();Ext.EventObject=function(){var B=Ext.lib.Event,A={3:13,63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35},C=Ext.isIE?{1:0,4:1,2:2}:(Ext.isWebKit?{1:0,2:1,3:2}:{0:0,1:1,2:2});Ext.EventObjectImpl=function(D){if(D){this.setEvent(D.browserEvent||D)}};Ext.EventObjectImpl.prototype={setEvent:function(E){var D=this;if(E==D||(E&&E.browserEvent)){return E}D.browserEvent=E;if(E){D.button=E.button?C[E.button]:(E.which?E.which-1:-1);if(E.type=="click"&&D.button==-1){D.button=0}D.type=E.type;D.shiftKey=E.shiftKey;D.ctrlKey=E.ctrlKey||E.metaKey||false;D.altKey=E.altKey;D.keyCode=E.keyCode;D.charCode=E.charCode;D.target=B.getTarget(E);D.xy=B.getXY(E)}else{D.button=-1;D.shiftKey=false;D.ctrlKey=false;D.altKey=false;D.keyCode=0;D.charCode=0;D.target=null;D.xy=[0,0]}return D},stopEvent:function(){var D=this;if(D.browserEvent){if(D.browserEvent.type=="mousedown"){Ext.EventManager.stoppedMouseDownEvent.fire(D)}B.stopEvent(D.browserEvent)}},preventDefault:function(){if(this.browserEvent){B.preventDefault(this.browserEvent)}},stopPropagation:function(){var D=this;if(D.browserEvent){if(D.browserEvent.type=="mousedown"){Ext.EventManager.stoppedMouseDownEvent.fire(D)}B.stopPropagation(D.browserEvent)}},getCharCode:function(){return this.charCode||this.keyCode},getKey:function(){return this.normalizeKey(this.keyCode||this.charCode)},normalizeKey:function(D){return Ext.isSafari?(A[D]||D):D},getPageX:function(){return this.xy[0]},getPageY:function(){return this.xy[1]},getXY:function(){return this.xy},getTarget:function(E,F,D){return E?Ext.fly(this.target).findParent(E,F,D):(D?Ext.get(this.target):this.target)},getRelatedTarget:function(){return this.browserEvent?B.getRelatedTarget(this.browserEvent):null},getWheelDelta:function(){var D=this.browserEvent;var E=0;if(D.wheelDelta){E=D.wheelDelta/120}else{if(D.detail){E=-D.detail/3}}return E},within:function(F,G,D){if(F){var E=this[G?"getRelatedTarget":"getTarget"]();return E&&((D?(E==Ext.getDom(F)):false)||Ext.fly(F).contains(E))}return false}};return new Ext.EventObjectImpl()}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.apply(Ext.EventManager,function(){var C,K,G,B,A=Ext.lib.Dom,L=Ext.lib.Event,J=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/,I=0,H=0,F=Ext.isSafari?Ext.num(navigator.userAgent.toLowerCase().match(/version\/(\d+\.\d)/)[1]||2)>=3.1:!((Ext.isGecko&&!Ext.isWindows)||Ext.isOpera);return{doResizeEvent:function(){var E=A.getViewHeight(),D=A.getViewWidth();if(H!=E||I!=D){C.fire(I=D,H=E)}},onWindowResize:function(M,E,D){if(!C){C=new Ext.util.Event();K=new Ext.util.DelayedTask(this.doResizeEvent);L.on(window,"resize",this.fireWindowResize,this)}C.addListener(M,E,D)},fireWindowResize:function(){if(C){if((Ext.isIE||Ext.isAir)&&K){K.delay(50)}else{C.fire(A.getViewWidth(),A.getViewHeight())}}},onTextResize:function(N,M,D){if(!G){G=new Ext.util.Event();var E=new Ext.Element(document.createElement("div"));E.dom.className="x-text-resize";E.dom.innerHTML="X";E.appendTo(document.body);B=E.dom.offsetHeight;setInterval(function(){if(E.dom.offsetHeight!=B){G.fire(B,B=E.dom.offsetHeight)}},this.textResizeInterval)}G.addListener(N,M,D)},removeResizeListener:function(E,D){if(C){C.removeListener(E,D)}},fireResize:function(){if(C){C.fire(A.getViewWidth(),A.getViewHeight())}},textResizeInterval:50,ieDeferSrc:false,useKeydown:F}}());Ext.EventManager.on=Ext.EventManager.addListener;Ext.apply(Ext.EventObjectImpl.prototype,{BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,CONTROL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGEUP:33,PAGE_DOWN:34,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,isNavKeyPress:function(){var B=this,A=this.normalizeKey(B.keyCode);return(A>=33&&A<=40)||A==B.RETURN||A==B.TAB||A==B.ESC},isSpecialKey:function(){var A=this.normalizeKey(this.keyCode);return(this.type=="keypress"&&this.ctrlKey)||this.isNavKeyPress()||(A==this.BACKSPACE)||(A>=16&&A<=20)||(A>=44&&A<=45)},getPoint:function(){return new Ext.lib.Point(this.xy[0],this.xy[1])},hasModifier:function(){return((this.ctrlKey||this.altKey)||this.shiftKey)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var K=document;Ext.Element=function(A,D){var E=typeof A=="string"?K.getElementById(A):A,P;if(!E){return null}P=E.id;if(!D&&P&&Ext.Element.cache[P]){return Ext.Element.cache[P]}this.dom=E;this.id=P||Ext.id(E)};var B=Ext.lib.Dom,H=Ext.DomHelper,N=Ext.lib.Event,G=Ext.lib.Anim,I=Ext.Element;I.prototype={set:function(Q,D){var E=this.dom,A,P;for(A in Q){P=Q[A];if(A!="style"&&!Ext.isFunction(P)){if(A=="cls"){E.className=P}else{if(Q.hasOwnProperty(A)){if(D||!!E.setAttribute){E.setAttribute(A,P)}else{E[A]=P}}}}}if(Q.style){Ext.DomHelper.applyStyles(E,Q.style)}return this},defaultUnit:"px",is:function(A){return Ext.DomQuery.is(this.dom,A)},focus:function(P,E){var A=this,E=E||A.dom;try{if(Number(P)){A.focus.defer(P,null,[null,E])}else{E.focus()}}catch(D){}return A},blur:function(){try{this.dom.blur()}catch(A){}return this},getValue:function(A){var D=this.dom.value;return A?parseInt(D,10):D},addListener:function(A,P,E,D){Ext.EventManager.on(this.dom,A,P,E||this,D);return this},removeListener:function(A,E,D){Ext.EventManager.removeListener(this.dom,A,E,D||this);return this},removeAllListeners:function(){Ext.EventManager.removeAll(this.dom);return this},addUnits:function(A){if(A===""||A=="auto"||A===undefined){A=A||""}else{if(!isNaN(A)||!L.test(A)){A=A+(this.defaultUnit||"px")}}return A},load:function(D,E,A){Ext.Ajax.request(Ext.apply({params:E,url:D.url||D,callback:A,el:this.dom,indicatorText:D.indicatorText||""},Ext.isObject(D)?D:{}));return this},isBorderBox:function(){return J[(this.dom.tagName||"").toLowerCase()]||Ext.isBorderBox},remove:function(){var A=this,D=A.dom;A.removeAllListeners();delete I.cache[D.id];delete I.dataCache[D.id];Ext.removeNode(D)},hover:function(D,A,P,E){var Q=this;Q.on("mouseenter",D,P||Q.dom,E);Q.on("mouseleave",A,P||Q.dom,E);return Q},contains:function(A){return !A?false:Ext.lib.Dom.isAncestor(this.dom,A.dom?A.dom:A)},getAttributeNS:function(D,A){return this.getAttribute(A,D)},getAttribute:Ext.isIE?function(A,E){var P=this.dom,D=typeof P[E+":"+A];if(["undefined","unknown"].indexOf(D)==-1){return P[E+":"+A]}D=typeof P[A];if(["undefined","unknown"].indexOf(D)==-1){return P[A]}return P.getAttributeNS(E,A)||P.getAttribute(E+":"+A)||P.getAttribute(A)||P[A]}:function(A,D){var E=this.dom;return E.getAttributeNS(D,A)||E.getAttribute(D+":"+A)||E.getAttribute(A)||E[A]},update:function(A){this.dom.innerHTML=A;return this}};var O=I.prototype;I.addMethods=function(A){Ext.apply(O,A)};O.on=O.addListener;O.un=O.removeListener;O.autoBoxAdjust=true;var L=/\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i,F;I.cache={};I.dataCache={};I.get=function(D){var A,Q,P;if(!D){return null}if(typeof D=="string"){if(!(Q=K.getElementById(D))){return null}if(A=I.cache[D]){A.dom=Q}else{A=I.cache[D]=new I(Q)}return A}else{if(D.tagName){if(!(P=D.id)){P=Ext.id(D)}if(A=I.cache[P]){A.dom=D}else{A=I.cache[P]=new I(D)}return A}else{if(D instanceof I){if(D!=F){D.dom=K.getElementById(D.id)||D.dom;I.cache[D.id]=D}return D}else{if(D.isComposite){return D}else{if(Ext.isArray(D)){return I.select(D)}else{if(D==K){if(!F){var E=function(){};E.prototype=I.prototype;F=new E();F.dom=K}return F}}}}}}return null};I.data=function(D,A,E){var P=I.dataCache[D.id];if(!P){P=I.dataCache[D.id]={}}if(arguments.length==2){return P[A]}else{P[A]=E}};function M(){if(!Ext.enableGarbageCollector){clearInterval(I.collectorThread)}else{var A,D,E;for(A in I.cache){D=I.cache[A];E=D.dom;if(!E||!E.parentNode||(!E.offsetParent&&!K.getElementById(A))){delete I.cache[A];if(E&&Ext.enableListenerCollection){Ext.EventManager.removeAll(E)}}}}}var C=function(){};C.prototype=I.prototype;I.Flyweight=function(A){this.dom=A};I.Flyweight.prototype=new C();I.Flyweight.prototype.isFlyweight=true;I._flyweights={};I.fly=function(E,A){var D=null;A=A||"_global";if(E=Ext.getDom(E)){(I._flyweights[A]=I._flyweights[A]||new I.Flyweight()).dom=E;D=I._flyweights[A]}return D};Ext.get=I.get;Ext.fly=I.fly;var J=Ext.isStrict?{select:1}:{input:1,select:1,textarea:1};if(Ext.isIE||Ext.isGecko){J.button=1}Ext.EventManager.on(window,"unload",function(){delete I.cache;delete I.dataCache;delete I._flyweights})})();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods({swallowEvent:function(A,B){var D=this;function C(E){E.stopPropagation();if(B){E.preventDefault()}}if(Ext.isArray(A)){Ext.each(A,function(E){D.on(E,C)});return D}D.on(A,C);return D},relayEvent:function(A,B){this.on(A,function(C){B.fireEvent(A,C)})},clean:function(B){var D=this,E=D.dom,F=E.firstChild,C=-1;if(Ext.Element.data(E,"isCleaned")&&B!==true){return D}while(F){var A=F.nextSibling;if(F.nodeType==3&&!/\S/.test(F.nodeValue)){E.removeChild(F)}else{F.nodeIndex=++C}F=A}Ext.Element.data(E,"isCleaned",true);return D},load:function(){var A=this.getUpdater();A.update.apply(A,arguments);return this},getUpdater:function(){return this.updateManager||(this.updateManager=new Ext.Updater(this))},update:function(html,loadScripts,callback){html=html||"";if(loadScripts!==true){this.dom.innerHTML=html;if(Ext.isFunction(callback)){callback()}return this}var id=Ext.id(),dom=this.dom;html+='<span id="'+id+'"></span>';Ext.lib.Event.onAvailable(id,function(){var DOC=document,hd=DOC.getElementsByTagName("head")[0],re=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/ig,srcRe=/\ssrc=([\'\"])(.*?)\1/i,typeRe=/\stype=([\'\"])(.*?)\1/i,match,attrs,srcMatch,typeMatch,el,s;while((match=re.exec(html))){attrs=match[1];srcMatch=attrs?attrs.match(srcRe):false;if(srcMatch&&srcMatch[2]){s=DOC.createElement("script");s.src=srcMatch[2];typeMatch=attrs.match(typeRe);if(typeMatch&&typeMatch[2]){s.type=typeMatch[2]}hd.appendChild(s)}else{if(match[2]&&match[2].length>0){if(window.execScript){window.execScript(match[2])}else{window.eval(match[2])}}}}el=DOC.getElementById(id);if(el){Ext.removeNode(el)}if(Ext.isFunction(callback)){callback()}});dom.innerHTML=html.replace(/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,"");return this},createProxy:function(A,E,D){A=Ext.isObject(A)?A:{tag:"div",cls:A};var C=this,B=E?Ext.DomHelper.append(E,A,true):Ext.DomHelper.insertBefore(C.dom,A,true);if(D&&C.setBox&&C.getBox){B.setBox(C.getBox())}return B}});Ext.Element.prototype.getUpdateManager=Ext.Element.prototype.getUpdater;Ext.Element.uncache=function(D){for(var C=0,B=arguments,A=B.length;C<A;C++){if(B[C]){delete Ext.Element.cache[B[C].id||B[C]]}}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods({getAnchorXY:function(E,J,N){E=(E||"tl").toLowerCase();N=N||{};var I=this,B=I.dom==document.body||I.dom==document,L=N.width||B?Ext.lib.Dom.getViewWidth():I.getWidth(),G=N.height||B?Ext.lib.Dom.getViewHeight():I.getHeight(),M,A=Math.round,C=I.getXY(),K=I.getScroll(),H=B?K.left:!J?C[0]:0,F=B?K.top:!J?C[1]:0,D={c:[A(L*0.5),A(G*0.5)],t:[A(L*0.5),0],l:[0,A(G*0.5)],r:[L,A(G*0.5)],b:[A(L*0.5),G],tl:[0,0],bl:[0,G],br:[L,G],tr:[L,0]};M=D[E];return[M[0]+H,M[1]+F]},anchorTo:function(B,F,C,A,H,I){var G=this,E=G.dom;function D(){Ext.fly(E).alignTo(B,F,C,A);Ext.callback(I,Ext.fly(E))}Ext.EventManager.onWindowResize(D,G);if(!Ext.isEmpty(H)){Ext.EventManager.on(window,"scroll",D,G,{buffer:!isNaN(H)?H:50})}D.call(G);return G},getAlignToXY:function(D,P,Q){D=Ext.get(D);if(!D||!D.dom){throw"Element.alignToXY with an element that doesn't exist"}Q=Q||[0,0];P=(P=="?"?"tl-bl?":(!/-/.test(P)&&P!==""?"tl-"+P:P||"tl-bl")).toLowerCase();var Z=this,W=Z.dom,b,a,I,H,K,U,N,L=Ext.lib.Dom.getViewWidth()-10,V=Ext.lib.Dom.getViewHeight()-10,B,E,F,G,M,O,e=document,Y=e.documentElement,J=e.body,T=(Y.scrollLeft||J.scrollLeft||0)+5,S=(Y.scrollTop||J.scrollTop||0)+5,X=false,C="",A="",R=P.match(/^([a-z]+)-([a-z]+)(\?)?$/);if(!R){throw"Element.alignTo with an invalid alignment "+P}C=R[1];A=R[2];X=!!R[3];b=Z.getAnchorXY(C,true);a=D.getAnchorXY(A,false);I=a[0]-b[0]+Q[0];H=a[1]-b[1]+Q[1];if(X){K=Z.getWidth();U=Z.getHeight();N=D.getRegion();B=C.charAt(0);E=C.charAt(C.length-1);F=A.charAt(0);G=A.charAt(A.length-1);M=((B=="t"&&F=="b")||(B=="b"&&F=="t"));O=((E=="r"&&G=="l")||(E=="l"&&G=="r"));if(I+K>L+T){I=O?N.left-K:L+T-K}if(I<T){I=O?N.right:T}if(H+U>V+S){H=M?N.top-U:V+S-U}if(H<S){H=M?N.bottom:S}}return[I,H]},alignTo:function(C,A,E,B){var D=this;return D.setXY(D.getAlignToXY(C,A,E),D.preanim&&!!B?D.preanim(arguments,3):false)},adjustForConstraints:function(C,A,B){return this.getConstrainToXY(A||document,false,B,C)||C},getConstrainToXY:function(B,A,C,E){var D={top:0,left:0,bottom:0,right:0};return function(G,T,I,K){G=Ext.get(G);I=I?Ext.applyIf(I,D):D;var S,W,R=0,Q=0;if(G.dom==document.body||G.dom==document){S=Ext.lib.Dom.getViewWidth();W=Ext.lib.Dom.getViewHeight()}else{S=G.dom.clientWidth;W=G.dom.clientHeight;if(!T){var P=G.getXY();R=P[0];Q=P[1]}}var O=G.getScroll();R+=I.left+O.left;Q+=I.top+O.top;S-=I.right;W-=I.bottom;var U=R+S;var F=Q+W;var H=K||(!T?this.getXY():[this.getLeft(true),this.getTop(true)]);var M=H[0],L=H[1];var N=this.dom.offsetWidth,V=this.dom.offsetHeight;var J=false;if((M+N)>U){M=U-N;J=true}if((L+V)>F){L=F-V;J=true}if(M<R){M=R;J=true}if(L<Q){L=Q;J=true}return J?[M,L]:false}}(),getCenterXY:function(){return this.getAlignToXY(document,"c-c")},center:function(A){return this.alignTo(A||document,"c-c")}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods(function(){var D="parentNode",B="nextSibling",C="previousSibling",E=Ext.DomQuery,A=Ext.get;return{findParent:function(L,K,G){var I=this.dom,F=document.body,J=0,H;if(Ext.isGecko&&Object.prototype.toString.call(I)=="[object XULElement]"){return null}K=K||50;if(isNaN(K)){H=Ext.getDom(K);K=Number.MAX_VALUE}while(I&&I.nodeType==1&&J<K&&I!=F&&I!=H){if(E.is(I,L)){return G?A(I):I}J++;I=I.parentNode}return null},findParentNode:function(I,H,F){var G=Ext.fly(this.dom.parentNode,"_internal");return G?G.findParent(I,H,F):null},up:function(G,F){return this.findParentNode(G,F,true)},select:function(F,G){return Ext.Element.select(F,G,this.dom)},query:function(F,G){return E.select(F,this.dom)},child:function(F,G){var H=E.selectNode(F,this.dom);return G?H:A(H)},down:function(F,G){var H=E.selectNode(" > "+F,this.dom);return G?H:A(H)},parent:function(F,G){return this.matchNode(D,D,F,G)},next:function(F,G){return this.matchNode(B,B,F,G)},prev:function(F,G){return this.matchNode(C,C,F,G)},first:function(F,G){return this.matchNode(B,"firstChild",F,G)},last:function(F,G){return this.matchNode(C,"lastChild",F,G)},matchNode:function(G,J,F,H){var I=this.dom[J];while(I){if(I.nodeType==1&&(!F||E.is(I,F))){return !H?A(I):I}I=I[G]}return null}}}());
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods(function(){var D=Ext.getDom,A=Ext.get,C=Ext.DomHelper,B=function(E){return(E.nodeType||E.dom||typeof E=="string")};return{appendChild:function(E){return A(E).appendTo(this)},appendTo:function(E){D(E).appendChild(this.dom);return this},insertBefore:function(E){(E=D(E)).parentNode.insertBefore(this.dom,E);return this},insertAfter:function(E){(E=D(E)).parentNode.insertBefore(this.dom,E.nextSibling);return this},insertFirst:function(F,E){F=F||{};if(B(F)){F=D(F);this.dom.insertBefore(F,this.dom.firstChild);return !E?A(F):F}else{return this.createChild(F,this.dom.firstChild,E)}},replace:function(E){E=A(E);this.insertBefore(E);E.remove();return this},replaceWith:function(F){var G=this,E=Ext.Element;if(B(F)){F=D(F);G.dom.parentNode.insertBefore(F,G.dom)}else{F=C.insertBefore(G.dom,F)}delete E.cache[G.id];Ext.removeNode(G.dom);G.id=Ext.id(G.dom=F);return E.cache[G.id]=G},createChild:function(F,E,G){F=F||{tag:"div"};return E?C.insertBefore(E,F,G!==true):C[!this.dom.firstChild?"overwrite":"append"](this.dom,F,G!==true)},wrap:function(E,F){var G=C.insertBefore(this.dom,E||{tag:"div"},!F);G.dom?G.dom.appendChild(this.dom):G.appendChild(this.dom);return G},insertHtml:function(F,G,E){var H=C.insertHtml(F,this.dom,G);return E?Ext.get(H):H}}}());
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.apply(Ext.Element.prototype,function(){var C=Ext.getDom,A=Ext.get,B=Ext.DomHelper;return{insertSibling:function(G,E,F){var H=this,D;if(Ext.isArray(G)){Ext.each(G,function(I){D=H.insertSibling(I,E,F)});return D}E=(E||"before").toLowerCase();G=G||{};if(G.nodeType||G.dom){D=H.dom.parentNode.insertBefore(C(G),E=="before"?H.dom:H.dom.nextSibling);if(!F){D=A(D)}}else{if(E=="after"&&!H.dom.nextSibling){D=B.append(H.dom.parentNode,G,!F)}else{D=B[E=="after"?"insertAfter":"insertBefore"](H.dom,G,!F)}}return D}}}());
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods(function(){var G={},X=/(-[a-z])/gi,B={},S=document.defaultView,U=Ext.isIE?"styleFloat":"cssFloat",d=/alpha\(opacity=(.*)\)/i,K=/^\s+|\s+$/g,a=Ext.Element,D="padding",C="margin",Y="border",T="-left",Q="-right",W="-top",N="-bottom",I="-width",R=Math,Z="hidden",E="isClipped",J="overflow",M="overflow-x",L="overflow-y",b="originalClip",H={l:Y+T+I,r:Y+Q+I,t:Y+W+I,b:Y+N+I},F={l:D+T,r:D+Q,t:D+W,b:D+N},A={l:C+T,r:C+Q,t:C+W,b:C+N},e=Ext.Element.data;function P(g,h){return h.charAt(1).toUpperCase()}function O(h,g){var i=0;Ext.each(h.match(/\w/g),function(j){if(j=parseInt(this.getStyle(g[j]),10)){i+=R.abs(j)}},this);return i}function V(g){return G[g]||(G[g]=g=="float"?U:g.replace(X,P))}return{adjustWidth:function(g){var h=this;var i=(typeof g=="number");if(i&&h.autoBoxAdjust&&!h.isBorderBox()){g-=(h.getBorderWidth("lr")+h.getPadding("lr"))}return(i&&g<0)?0:g},adjustHeight:function(g){var h=this;var i=(typeof g=="number");if(i&&h.autoBoxAdjust&&!h.isBorderBox()){g-=(h.getBorderWidth("tb")+h.getPadding("tb"))}return(i&&g<0)?0:g},addClass:function(g){var h=this;Ext.each(g,function(i){h.dom.className+=(!h.hasClass(i)&&i?" "+i:"")});return h},radioClass:function(g){Ext.each(this.dom.parentNode.childNodes,function(h){if(h.nodeType==1){Ext.fly(h,"_internal").removeClass(g)}});return this.addClass(g)},removeClass:function(g){var h=this;if(h.dom.className){Ext.each(g,function(i){h.dom.className=h.dom.className.replace(B[i]=B[i]||new RegExp("(?:^|\\s+)"+i+"(?:\\s+|$)","g")," ")})}return h},toggleClass:function(g){return this.hasClass(g)?this.removeClass(g):this.addClass(g)},hasClass:function(g){return g&&(" "+this.dom.className+" ").indexOf(" "+g+" ")!=-1},replaceClass:function(h,g){return this.removeClass(h).addClass(g)},isStyle:function(g,h){return this.getStyle(g)==h},getStyle:function(){return S&&S.getComputedStyle?function(j){var i=this.dom,g,h;if(i==document){return null}j=V(j);return(g=i.style[j])?g:(h=S.getComputedStyle(i,""))?h[j]:null}:function(k){var i=this.dom,g,h;if(i==document){return null}if(k=="opacity"){if(i.style.filter.match){if(g=i.style.filter.match(d)){var j=parseFloat(g[1]);if(!isNaN(j)){return j?j/100:0}}}return 1}k=V(k);return i.style[k]||((h=i.currentStyle)?h[k]:null)}}(),getColor:function(g,i,n){var k=this.getStyle(g),j=n||"#",m;if(!k||/transparent|inherit/.test(k)){return i}if(/^r/.test(k)){Ext.each(k.slice(4,k.length-1).split(","),function(h){m=parseInt(h,10);j+=(m<16?"0":"")+m.toString(16)})}else{k=k.replace("#","");j+=k.length==3?k.replace(/^(\w)(\w)(\w)$/,"$1$1$2$2$3$3"):k}return(j.length>5?j.toLowerCase():i)},setStyle:function(k,j){var h,i,g;if(!Ext.isObject(k)){h={};h[k]=j;k=h}for(i in k){j=k[i];i=="opacity"?this.setOpacity(j):this.dom.style[V(i)]=j}return this},setOpacity:function(h,g){var k=this,i=k.dom.style;if(!g||!k.anim){if(Ext.isIE){var j=h<1?"alpha(opacity="+h*100+")":"",m=i.filter.replace(d,"").replace(K,"");i.zoom=1;i.filter=m+(m.length>0?" ":"")+j}else{i.opacity=h}}else{k.anim({opacity:{to:h}},k.preanim(arguments,1),null,0.35,"easeIn")}return k},clearOpacity:function(){var g=this.dom.style;if(Ext.isIE){if(!Ext.isEmpty(g.filter)){g.filter=g.filter.replace(d,"").replace(K,"")}}else{g.opacity=g["-moz-opacity"]=g["-khtml-opacity"]=""}return this},getHeight:function(j){var i=this,k=i.dom,g=R.max(k.offsetHeight,k.clientHeight)||0;g=!j?g:g-i.getBorderWidth("tb")-i.getPadding("tb");return g<0?0:g},getWidth:function(h){var i=this,j=i.dom,g=R.max(j.offsetWidth,j.clientWidth)||0;g=!h?g:g-i.getBorderWidth("lr")-i.getPadding("lr");return g<0?0:g},setWidth:function(h,g){var i=this;h=i.adjustWidth(h);!g||!i.anim?i.dom.style.width=i.addUnits(h):i.anim({width:{to:h}},i.preanim(arguments,1));return i},setHeight:function(g,h){var i=this;g=i.adjustHeight(g);!h||!i.anim?i.dom.style.height=i.addUnits(g):i.anim({height:{to:g}},i.preanim(arguments,1));return i},getBorderWidth:function(g){return O.call(this,g,H)},getPadding:function(g){return O.call(this,g,F)},clip:function(){var g=this,h=g.dom;if(!e(h,E)){e(h,E,true);e(h,b,{o:g.getStyle(J),x:g.getStyle(M),y:g.getStyle(L)});g.setStyle(J,Z);g.setStyle(M,Z);g.setStyle(L,Z)}return g},unclip:function(){var g=this,i=g.dom;if(e(i,E)){e(i,E,false);var h=e(i,b);if(h.o){g.setStyle(J,h.o)}if(h.x){g.setStyle(M,h.x)}if(h.y){g.setStyle(L,h.y)}}return g},addStyles:O,margins:A}}());
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.boxMarkup='<div class="{0}-tl"><div class="{0}-tr"><div class="{0}-tc"></div></div></div><div class="{0}-ml"><div class="{0}-mr"><div class="{0}-mc"></div></div></div><div class="{0}-bl"><div class="{0}-br"><div class="{0}-bc"></div></div></div>';Ext.Element.addMethods(function(){var A="_internal";return{applyStyles:function(B){Ext.DomHelper.applyStyles(this.dom,B);return this},getStyles:function(){var B={};Ext.each(arguments,function(C){B[C]=this.getStyle(C)},this);return B},getStyleSize:function(){var E=this,B,D,F=this.dom,C=F.style;if(C.width&&C.width!="auto"){B=parseInt(C.width,10);if(E.isBorderBox()){B-=E.getFrameWidth("lr")}}if(C.height&&C.height!="auto"){D=parseInt(C.height,10);if(E.isBorderBox()){D-=E.getFrameWidth("tb")}}return{width:B||E.getWidth(true),height:D||E.getHeight(true)}},setOverflow:function(B){var C=this.dom;if(B=="auto"&&Ext.isMac&&Ext.isGecko2){C.style.overflow="hidden";(function(){C.style.overflow="auto"}).defer(1)}else{C.style.overflow=B}},boxWrap:function(B){B=B||"x-box";var C=Ext.get(this.insertHtml("beforeBegin","<div class='"+B+"'>"+String.format(Ext.Element.boxMarkup,B)+"</div>"));Ext.DomQuery.selectNode("."+B+"-mc",C.dom).appendChild(this.dom);return C},setSize:function(D,B,C){var E=this;if(Ext.isObject(D)){B=D.height;D=D.width}D=E.adjustWidth(D);B=E.adjustHeight(B);if(!C||!E.anim){E.dom.style.width=E.addUnits(D);E.dom.style.height=E.addUnits(B)}else{E.anim({width:{to:D},height:{to:B}},E.preanim(arguments,2))}return E},getComputedHeight:function(){var C=this,B=Math.max(C.dom.offsetHeight,C.dom.clientHeight);if(!B){B=parseInt(C.getStyle("height"),10)||0;if(!C.isBorderBox()){B+=C.getFrameWidth("tb")}}return B},getComputedWidth:function(){var B=Math.max(this.dom.offsetWidth,this.dom.clientWidth);if(!B){B=parseInt(this.getStyle("width"),10)||0;if(!this.isBorderBox()){B+=this.getFrameWidth("lr")}}return B},getFrameWidth:function(C,B){return B&&this.isBorderBox()?0:(this.getPadding(C)+this.getBorderWidth(C))},addClassOnOver:function(B){this.hover(function(){Ext.fly(this,A).addClass(B)},function(){Ext.fly(this,A).removeClass(B)});return this},addClassOnFocus:function(B){this.on("focus",function(){Ext.fly(this,A).addClass(B)},this.dom);this.on("blur",function(){Ext.fly(this,A).removeClass(B)},this.dom);return this},addClassOnClick:function(B){var C=this.dom;this.on("mousedown",function(){Ext.fly(C,A).addClass(B);var E=Ext.getDoc(),D=function(){Ext.fly(C,A).removeClass(B);E.removeListener("mouseup",D)};E.on("mouseup",D)});return this},getViewSize:function(){var D=document,E=this.dom,C=Ext.lib.Dom,B=(E==D||E==D.body);return{width:(B?C.getViewWidth():E.clientWidth),height:(B?C.getViewHeight():E.clientHeight)}},getSize:function(B){return{width:this.getWidth(B),height:this.getHeight(B)}},repaint:function(){var B=this.dom;this.addClass("x-repaint");setTimeout(function(){Ext.fly(B).removeClass("x-repaint")},1);return this},unselectable:function(){this.dom.unselectable="on";return this.swallowEvent("selectstart",true).applyStyles("-moz-user-select:none;-khtml-user-select:none;").addClass("x-unselectable")},getMargins:function(C){var D=this,B,E={t:"top",l:"left",r:"right",b:"bottom"},F={};if(!C){for(B in D.margins){F[E[B]]=parseInt(D.getStyle(D.margins[B]),10)||0}return F}else{return D.addStyles.call(D,C,D.margins)}}}}());
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var A=Ext.lib.Dom,B="left",G="right",E="top",I="bottom",H="position",C="static",F="relative",J="auto",K="z-index";function L(M,D,N){return this.preanim&&!!D?this.preanim(M,N):false}Ext.Element.addMethods({getX:function(){return A.getX(this.dom)},getY:function(){return A.getY(this.dom)},getXY:function(){return A.getXY(this.dom)},getOffsetsTo:function(D){var N=this.getXY(),M=Ext.fly(D,"_internal").getXY();return[N[0]-M[0],N[1]-M[1]]},setX:function(D,M){return this.setXY([D,this.getY()],L.call(this,arguments,M,1))},setY:function(M,D){return this.setXY([this.getX(),M],L.call(this,arguments,D,1))},setLeft:function(D){this.setStyle(B,this.addUnits(D));return this},setTop:function(D){this.setStyle(E,this.addUnits(D));return this},setRight:function(D){this.setStyle(G,this.addUnits(D));return this},setBottom:function(D){this.setStyle(I,this.addUnits(D));return this},setXY:function(N,D){var M=this;if(!D||!M.anim){A.setXY(M.dom,N)}else{M.anim({points:{to:N}},M.preanim(arguments,1),"motion")}return M},setLocation:function(D,N,M){return this.setXY([D,N],L.call(this,arguments,M,2))},moveTo:function(D,N,M){return this.setXY([D,N],L.call(this,arguments,M,2))},getLeft:function(D){return !D?this.getX():parseInt(this.getStyle(B),10)||0},getRight:function(D){var M=this;return !D?M.getX()+M.getWidth():(M.getLeft(true)+M.getWidth())||0},getTop:function(D){return !D?this.getY():parseInt(this.getStyle(E),10)||0},getBottom:function(D){var M=this;return !D?M.getY()+M.getHeight():(M.getTop(true)+M.getHeight())||0},position:function(P,O,D,N){var M=this;if(!P&&M.isStyle(H,C)){M.setStyle(H,F)}else{if(P){M.setStyle(H,P)}}if(O){M.setStyle(K,O)}if(D||N){M.setXY([D||false,N||false])}},clearPositioning:function(D){D=D||"";this.setStyle({left:D,right:D,top:D,bottom:D,"z-index":"",position:C});return this},getPositioning:function(){var D=this.getStyle(B);var M=this.getStyle(E);return{position:this.getStyle(H),left:D,right:D?"":this.getStyle(G),top:M,bottom:M?"":this.getStyle(I),"z-index":this.getStyle(K)}},setPositioning:function(D){var N=this,M=N.dom.style;N.setStyle(D);if(D.right==J){M.right=""}if(D.bottom==J){M.bottom=""}return N},translatePoints:function(D,R){R=isNaN(D[1])?R:D[1];D=isNaN(D[0])?D:D[0];var O=this,P=O.isStyle(H,F),Q=O.getXY(),M=parseInt(O.getStyle(B),10),N=parseInt(O.getStyle(E),10);M=!isNaN(M)?M:(P?0:O.dom.offsetLeft);N=!isNaN(N)?N:(P?0:O.dom.offsetTop);return{left:(D-Q[0]+M),top:(R-Q[1]+N)}},animTest:L})})();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods({setBox:function(E,F,B){var D=this,A=E.width,C=E.height;if((F&&!D.autoBoxAdjust)&&!D.isBorderBox()){A-=(D.getBorderWidth("lr")+D.getPadding("lr"));C-=(D.getBorderWidth("tb")+D.getPadding("tb"))}D.setBounds(E.x,E.y,A,C,D.animTest.call(D,arguments,B,2));return D},getBox:function(G,L){var I=this,P,D,K,C=I.getBorderWidth,M=I.getPadding,E,A,O,J;if(!L){P=I.getXY()}else{D=parseInt(I.getStyle("left"),10)||0;K=parseInt(I.getStyle("top"),10)||0;P=[D,K]}var B=I.dom,N=B.offsetWidth,F=B.offsetHeight,H;if(!G){H={x:P[0],y:P[1],0:P[0],1:P[1],width:N,height:F}}else{E=C.call(I,"l")+M.call(I,"l");A=C.call(I,"r")+M.call(I,"r");O=C.call(I,"t")+M.call(I,"t");J=C.call(I,"b")+M.call(I,"b");H={x:P[0]+E,y:P[1]+O,0:P[0]+E,1:P[1]+O,width:N-(E+A),height:F-(O+J)}}H.right=H.x+H.width;H.bottom=H.y+H.height;return H},move:function(I,B,C){var F=this,L=F.getXY(),J=L[0],H=L[1],D=[J-B,H],K=[J+B,H],G=[J,H-B],A=[J,H+B],E={l:D,left:D,r:K,right:K,t:G,top:G,up:G,b:A,bottom:A,down:A};I=I.toLowerCase();F.moveTo(E[I][0],E[I][1],F.animTest.call(F,arguments,C,2))},setLeftTop:function(D,C){var B=this,A=B.dom.style;A.left=B.addUnits(D);A.top=B.addUnits(C);return B},getRegion:function(){return Ext.lib.Dom.getRegion(this.dom)},setBounds:function(B,F,D,A,C){var E=this;if(!C||!E.anim){E.setSize(D,A);E.setLocation(B,F)}else{E.anim({points:{to:[B,F]},width:{to:E.adjustWidth(D)},height:{to:E.adjustHeight(A)}},E.preanim(arguments,4),"motion")}return E},setRegion:function(B,A){return this.setBounds(B.left,B.top,B.right-B.left,B.bottom-B.top,this.animTest.call(this,arguments,A,1))}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods({isScrollable:function(){var A=this.dom;return A.scrollHeight>A.clientHeight||A.scrollWidth>A.clientWidth},scrollTo:function(A,B){this.dom["scroll"+(/top/i.test(A)?"Top":"Left")]=B;return this},getScroll:function(){var G=this.dom,F=document,A=F.body,C=F.documentElement,B,E,D;if(G==F||G==A){if(Ext.isIE&&Ext.isStrict){B=C.scrollLeft;E=C.scrollTop}else{B=window.pageXOffset;E=window.pageYOffset}D={left:B||(A?A.scrollLeft:0),top:E||(A?A.scrollTop:0)}}else{D={left:G.scrollLeft,top:G.scrollTop}}return D}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods({scrollTo:function(C,E,B){var A=/top/i,G="scroll"+(A.test(C)?"Top":"Left"),D=this,F=D.dom;if(!B||!D.anim){F[G]=E}else{D.anim({scroll:{to:A.test(G)?[F[G],E]:[E,F[G]]}},D.preanim(arguments,2),"scroll")}return D},scrollIntoView:function(C,F){var K=Ext.getDom(C)||Ext.getBody().dom,E=this.dom,D=this.getOffsetsTo(K),H=D[0]+K.scrollLeft,N=D[1]+K.scrollTop,L=N+E.offsetHeight,B=H+E.offsetWidth,A=K.clientHeight,I=parseInt(K.scrollTop,10),M=parseInt(K.scrollLeft,10),G=I+A,J=M+K.clientWidth;if(E.offsetHeight>A||N<I){K.scrollTop=N}else{if(L>G){K.scrollTop=L-A}}K.scrollTop=K.scrollTop;if(F!==false){if(E.offsetWidth>K.clientWidth||H<M){K.scrollLeft=H}else{if(B>J){K.scrollLeft=B-K.clientWidth}}K.scrollLeft=K.scrollLeft}return this},scrollChildIntoView:function(B,A){Ext.fly(B,"_scrollChildIntoView").scrollIntoView(this,A)},scroll:function(J,B,D){if(!this.isScrollable()){return }var E=this.dom,F=E.scrollLeft,M=E.scrollTop,K=E.scrollWidth,I=E.scrollHeight,G=E.clientWidth,A=E.clientHeight,C=false,L,H={l:Math.min(F+B,K-G),r:L=Math.max(F-B,0),t:Math.max(M-B,0),b:Math.min(M+B,I-A)};H.d=H.b;H.u=H.t;J=J.substr(0,1);if((L=H[J])>-1){C=true;this.scrollTo(J=="l"||J=="r"?"left":"top",L,this.preanim(arguments,2))}return C}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.VISIBILITY=1;Ext.Element.DISPLAY=2;Ext.Element.addMethods(function(){var G="visibility",D="display",B="hidden",I="none",A="originalDisplay",C="visibilityMode",E=Ext.Element.DISPLAY,F=Ext.Element.data,H=function(L){var K=F(L,A);if(K===undefined){F(L,A,K="")}return K},J=function(L){var K=F(L,C);if(K===undefined){F(L,C,K=1)}return K};return{originalDisplay:"",visibilityMode:1,setVisibilityMode:function(K){F(this.dom,C,K);return this},animate:function(L,N,M,O,K){this.anim(L,{duration:N,callback:M,easing:O},K);return this},anim:function(N,O,L,Q,M,K){L=L||"run";O=O||{};var P=this,R=Ext.lib.Anim[L](P.dom,N,(O.duration||Q)||0.35,(O.easing||M)||"easeOut",function(){if(K){K.call(P)}if(O.callback){O.callback.call(O.scope||P,P,O)}},P);O.anim=R;return R},preanim:function(K,L){return !K[L]?false:(Ext.isObject(K[L])?K[L]:{duration:K[L+1],callback:K[L+2],easing:K[L+3]})},isVisible:function(){return !this.isStyle(G,B)&&!this.isStyle(D,I)},setVisible:function(O,L){var M=this,N=M.dom,K=J(this.dom)==E;if(!L||!M.anim){if(K){M.setDisplayed(O)}else{M.fixDisplay();N.style.visibility=O?"visible":B}}else{if(O){M.setOpacity(0.01);M.setVisible(true)}M.anim({opacity:{to:(O?1:0)}},M.preanim(arguments,1),null,0.35,"easeIn",function(){if(!O){N.style[K?D:G]=(K)?I:B;Ext.fly(N).setOpacity(1)}})}return M},toggle:function(K){var L=this;L.setVisible(!L.isVisible(),L.preanim(arguments,0));return L},setDisplayed:function(K){if(typeof K=="boolean"){K=K?H(this.dom):I}this.setStyle(D,K);return this},fixDisplay:function(){var K=this;if(K.isStyle(D,I)){K.setStyle(G,B);K.setStyle(D,H(this.dom));if(K.isStyle(D,I)){K.setStyle(D,"block")}}},hide:function(K){this.setVisible(false,this.preanim(arguments,0));return this},show:function(K){this.setVisible(true,this.preanim(arguments,0));return this}}}());
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods(function(){var D="visibility",B="display",A="hidden",G="none",C="x-masked",F="x-masked-relative",E=Ext.Element.data;return{isVisible:function(H){var I=!this.isStyle(D,A)&&!this.isStyle(B,G),J=this.dom.parentNode;if(H!==true||!I){return I}while(J&&!/body/i.test(J.tagName)){if(!Ext.fly(J,"_isVisible").isVisible()){return false}J=J.parentNode}return true},isDisplayed:function(){return !this.isStyle(B,G)},enableDisplayMode:function(H){this.setVisibilityMode(Ext.Element.DISPLAY);if(!Ext.isEmpty(H)){E(this.dom,"originalDisplay",H)}return this},mask:function(I,M){var O=this,K=O.dom,N=Ext.DomHelper,L="ext-el-mask-msg",H,P;if(O.getStyle("position")=="static"){O.addClass(F)}if((H=E(K,"maskMsg"))){H.remove()}if((H=E(K,"mask"))){H.remove()}P=N.append(K,{cls:"ext-el-mask"},true);E(K,"mask",P);O.addClass(C);P.setDisplayed(true);if(typeof I=="string"){var J=N.append(K,{cls:L,cn:{tag:"div"}},true);E(K,"maskMsg",J);J.dom.className=M?L+" "+M:L;J.dom.firstChild.innerHTML=I;J.setDisplayed(true);J.center(O)}if(Ext.isIE&&!(Ext.isIE7&&Ext.isStrict)&&O.getStyle("height")=="auto"){P.setSize(undefined,O.getHeight())}return P},unmask:function(){var J=this,K=J.dom,H=E(K,"mask"),I=E(K,"maskMsg");if(H){if(I){I.remove();E(K,"maskMsg",undefined)}H.remove();E(K,"mask",undefined)}J.removeClass([C,F])},isMasked:function(){var H=E(this.dom,"mask");return H&&H.isVisible()},createShim:function(){var H=document.createElement("iframe"),I;H.frameBorder="0";H.className="ext-shim";if(Ext.isIE&&Ext.isSecure){H.src=Ext.SSL_SECURE_URL}I=Ext.get(this.dom.parentNode.insertBefore(H,this.dom));I.autoBoxAdjust=false;return I}}}());
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods({addKeyListener:function(B,D,C){var A;if(!Ext.isObject(B)||Ext.isArray(B)){A={key:B,fn:D,scope:C}}else{A={key:B.key,shift:B.shift,ctrl:B.ctrl,alt:B.alt,fn:D,scope:C}}return new Ext.KeyMap(this,A)},addKeyMap:function(A){return new Ext.KeyMap(this,A)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var X=null,Z=undefined,J=true,S=false,I="setX",G="setY",A="setXY",M="left",K="bottom",R="top",L="right",P="height",F="width",H="points",V="hidden",Y="absolute",T="visible",E="motion",N="position",Q="easeOut",D=new Ext.Element.Flyweight(),U={},W=function(a){return a||{}},O=function(a){D.dom=a;D.id=Ext.id(a);return D},C=function(a){if(!U[a]){U[a]=[]}return U[a]},B=function(b,a){U[b]=a};Ext.enableFx=J;Ext.Fx={switchStatements:function(b,d,a){return d.apply(this,a[b])},slideIn:function(j,g){g=W(g);var m=this,i=m.dom,s=i.style,u,a,q,e,d,s,k,t,n,h;j=j||"t";m.queueFx(g,function(){u=O(i).getXY();O(i).fixDisplay();a=O(i).getFxRestore();q={x:u[0],y:u[1],0:u[0],1:u[1],width:i.offsetWidth,height:i.offsetHeight};q.right=q.x+q.width;q.bottom=q.y+q.height;O(i).setWidth(q.width).setHeight(q.height);e=O(i).fxWrap(a.pos,g,V);s.visibility=T;s.position=Y;function b(){O(i).fxUnwrap(e,a.pos,g);s.width=a.width;s.height=a.height;O(i).afterFx(g)}t={to:[q.x,q.y]};n={to:q.width};h={to:q.height};function o(z,r,AA,x,AC,AE,AH,AG,AF,AB,y){var AD={};O(z).setWidth(AA).setHeight(x);if(O(z)[AC]){O(z)[AC](AE)}r[AH]=r[AG]="0";if(AF){AD.width=AF}if(AB){AD.height=AB}if(y){AD.points=y}return AD}k=O(i).switchStatements(j.toLowerCase(),o,{t:[e,s,q.width,0,X,X,M,K,X,h,X],l:[e,s,0,q.height,X,X,L,R,n,X,X],r:[e,s,q.width,q.height,I,q.right,M,R,X,X,t],b:[e,s,q.width,q.height,G,q.bottom,M,R,X,h,t],tl:[e,s,0,0,X,X,L,K,n,h,t],bl:[e,s,0,0,G,q.y+q.height,L,R,n,h,t],br:[e,s,0,0,A,[q.right,q.bottom],M,R,n,h,t],tr:[e,s,0,0,I,q.x+q.width,M,K,n,h,t]});s.visibility=T;O(e).show();arguments.callee.anim=O(e).fxanim(k,g,E,0.5,Q,b)});return m},slideOut:function(i,g){g=W(g);var k=this,h=k.dom,q=h.style,s=k.getXY(),e,d,m,n,j={to:0};i=i||"t";k.queueFx(g,function(){d=O(h).getFxRestore();m={x:s[0],y:s[1],0:s[0],1:s[1],width:h.offsetWidth,height:h.offsetHeight};m.right=m.x+m.width;m.bottom=m.y+m.height;O(h).setWidth(m.width).setHeight(m.height);e=O(h).fxWrap(d.pos,g,T);q.visibility=T;q.position=Y;O(e).setWidth(m.width).setHeight(m.height);function a(){g.useDisplay?O(h).setDisplayed(S):O(h).hide();O(h).fxUnwrap(e,d.pos,g);q.width=d.width;q.height=d.height;O(h).afterFx(g)}function b(o,AA,y,AB,w,z,u,x,t){var r={};o[AA]=o[y]="0";r[AB]=w;if(z){r[z]=u}if(x){r[x]=t}return r}n=O(h).switchStatements(i.toLowerCase(),b,{t:[q,M,K,P,j],l:[q,L,R,F,j],r:[q,M,R,F,j,H,{to:[m.right,m.y]}],b:[q,M,R,P,j,H,{to:[m.x,m.bottom]}],tl:[q,L,K,F,j,P,j],bl:[q,L,R,F,j,P,j,H,{to:[m.x,m.bottom]}],br:[q,M,R,F,j,P,j,H,{to:[m.x+m.width,m.bottom]}],tr:[q,M,K,F,j,P,j,H,{to:[m.right,m.y]}]});arguments.callee.anim=O(e).fxanim(n,g,E,0.5,Q,a)});return k},puff:function(i){i=W(i);var g=this,h=g.dom,b=h.style,d,a,e;g.queueFx(i,function(){d=O(h).getWidth();a=O(h).getHeight();O(h).clearOpacity();O(h).show();e=O(h).getFxRestore();function j(){i.useDisplay?O(h).setDisplayed(S):O(h).hide();O(h).clearOpacity();O(h).setPositioning(e.pos);b.width=e.width;b.height=e.height;b.fontSize="";O(h).afterFx(i)}arguments.callee.anim=O(h).fxanim({width:{to:O(h).adjustWidth(d*2)},height:{to:O(h).adjustHeight(a*2)},points:{by:[-d*0.5,-a*0.5]},opacity:{to:0},fontSize:{to:200,unit:"%"}},i,E,0.5,Q,j)});return g},switchOff:function(g){g=W(g);var d=this,e=d.dom,a=e.style,b;d.queueFx(g,function(){O(e).clearOpacity();O(e).clip();b=O(e).getFxRestore();function h(){g.useDisplay?O(e).setDisplayed(S):O(e).hide();O(e).clearOpacity();O(e).setPositioning(b.pos);a.width=b.width;a.height=b.height;O(e).afterFx(g)}O(e).fxanim({opacity:{to:0.3}},X,X,0.1,X,function(){O(e).clearOpacity();(function(){O(e).fxanim({height:{to:1},points:{by:[0,O(e).getHeight()*0.5]}},g,E,0.3,"easeIn",h)}).defer(100)})});return d},highlight:function(e,j){j=W(j);var h=this,i=h.dom,b=j.attr||"backgroundColor",d={},g;h.queueFx(j,function(){O(i).clearOpacity();O(i).show();function a(){i.style[b]=g;O(i).afterFx(j)}g=i.style[b];d[b]={from:e||"ffff9c",to:j.endColor||O(i).getColor(b)||"ffffff"};arguments.callee.anim=O(i).fxanim(d,j,"color",1,"easeIn",a)});return h},frame:function(a,e,i){i=W(i);var d=this,h=d.dom,b,g;d.queueFx(i,function(){a=a||"#C3DAF9";if(a.length==6){a="#"+a}e=e||1;O(h).show();var n=O(h).getXY(),k={x:n[0],y:n[1],0:n[0],1:n[1],width:h.offsetWidth,height:h.offsetHeight},j=function(){b=O(document.body||document.documentElement).createChild({style:{visbility:V,position:Y,"z-index":35000,border:"0px solid "+a}});return b.queueFx({},m)};arguments.callee.anim={isAnimated:true,stop:function(){e=0;b.stopFx()}};function m(){var o=Ext.isBorderBox?2:1;g=b.anim({top:{from:k.y,to:k.y-20},left:{from:k.x,to:k.x-20},borderWidth:{from:0,to:10},opacity:{from:1,to:0},height:{from:k.height,to:k.height+20*o},width:{from:k.width,to:k.width+20*o}},{duration:i.duration||1,callback:function(){b.remove();--e>0?j():O(h).afterFx(i)}});arguments.callee.anim={isAnimated:true,stop:function(){g.stop()}}}j()});return d},pause:function(d){var b=this.dom,a;this.queueFx({},function(){a=setTimeout(function(){O(b).afterFx({})},d*1000);arguments.callee.anim={isAnimated:true,stop:function(){clearTimeout(a);O(b).afterFx({})}}});return this},fadeIn:function(d){d=W(d);var a=this,b=a.dom,e=d.endOpacity||1;a.queueFx(d,function(){O(b).setOpacity(0);O(b).fixDisplay();b.style.visibility=T;arguments.callee.anim=O(b).fxanim({opacity:{to:e}},d,X,0.5,Q,function(){if(e==1){O(b).clearOpacity()}O(b).afterFx(d)})});return a},fadeOut:function(e){e=W(e);var b=this,d=b.dom,a=d.style,g=e.endOpacity||0;b.queueFx(e,function(){arguments.callee.anim=O(d).fxanim({opacity:{to:g}},e,X,0.5,Q,function(){if(g==0){Ext.Element.data(d,"visibilityMode")==Ext.Element.DISPLAY||e.useDisplay?a.display="none":a.visibility=V;O(d).clearOpacity()}O(d).afterFx(e)})});return b},scale:function(a,b,d){this.shift(Ext.apply({},d,{width:a,height:b}));return this},shift:function(e){e=W(e);var d=this.dom,b={};this.queueFx(e,function(){for(var a in e){if(e[a]!=Z){b[a]={to:e[a]}}}b.width?b.width.to=O(d).adjustWidth(e.width):b;b.height?b.height.to=O(d).adjustWidth(e.height):b;if(b.x||b.y||b.xy){b.points=b.xy||{to:[b.x?b.x.to:O(d).getX(),b.y?b.y.to:O(d).getY()]}}arguments.callee.anim=O(d).fxanim(b,e,E,0.35,Q,function(){O(d).afterFx(e)})});return this},ghost:function(g,d){d=W(d);var j=this,e=j.dom,n=e.style,k={opacity:{to:0},points:{}},q=k.points,b,m,i;g=g||"b";j.queueFx(d,function(){b=O(e).getFxRestore();m=O(e).getWidth();i=O(e).getHeight();function a(){d.useDisplay?O(e).setDisplayed(S):O(e).hide();O(e).clearOpacity();O(e).setPositioning(b.pos);n.width=b.width;n.height=b.height;O(e).afterFx(d)}q.by=O(e).switchStatements(g.toLowerCase(),function(o,h){return[o,h]},{t:[0,-i],l:[-m,0],r:[m,0],b:[0,i],tl:[-m,-i],bl:[-m,i],br:[m,i],tr:[m,-i]});arguments.callee.anim=O(e).fxanim(k,d,E,0.5,Q,a)});return j},syncFx:function(){var a=this;a.fxDefaults=Ext.apply(a.fxDefaults||{},{block:S,concurrent:J,stopFx:S});return a},sequenceFx:function(){var a=this;a.fxDefaults=Ext.apply(a.fxDefaults||{},{block:S,concurrent:S,stopFx:S});return a},nextFx:function(){var a=C(this.dom.id)[0];if(a){a.call(this)}},hasActiveFx:function(){return C(this.dom.id)[0]},stopFx:function(a){var b=this,e=b.dom.id;if(b.hasActiveFx()){var d=C(e)[0];if(d&&d.anim){if(d.anim.isAnimated){B(e,[d]);d.anim.stop(a!==undefined?a:J)}else{B(e,[])}}}return b},beforeFx:function(a){if(this.hasActiveFx()&&!a.concurrent){if(a.stopFx){this.stopFx();return J}return S}return J},hasFxBlock:function(){var a=C(this.dom.id);return a&&a[0]&&a[0].block},queueFx:function(e,a){var b=this;if(!b.hasFxBlock()){Ext.applyIf(e,b.fxDefaults);if(!e.concurrent){var d=b.beforeFx(e);a.block=e.block;C(b.dom.id).push(a);if(d){b.nextFx()}}else{a.call(b)}}return b},fxWrap:function(i,g,d){var e=this.dom,b,a;if(!g.wrap||!(b=Ext.getDom(g.wrap))){if(g.fixPosition){a=O(e).getXY()}var h=document.createElement("div");h.style.visibility=d;b=e.parentNode.insertBefore(h,e);O(b).setPositioning(i);if(O(b).isStyle(N,"static")){O(b).position("relative")}O(e).clearPositioning("auto");O(b).clip();b.appendChild(e);if(a){O(b).setXY(a)}}return b},fxUnwrap:function(a,e,d){var b=this.dom;O(b).clearPositioning();O(b).setPositioning(e);if(!d.wrap){a.parentNode.insertBefore(b,a);O(a).remove()}},getFxRestore:function(){var a=this.dom.style;return{pos:this.getPositioning(),width:a.width,height:a.height}},afterFx:function(b){var a=this.dom,e=a.id,d=!b.concurrent;if(b.afterStyle){O(a).setStyle(b.afterStyle)}if(b.afterCls){O(a).addClass(b.afterCls)}if(b.remove==J){O(a).remove()}if(d){C(e).shift()}if(b.callback){b.callback.call(b.scope,O(a))}if(d){O(a).nextFx()}},fxanim:function(e,g,b,h,d,a){b=b||"run";g=g||{};var i=Ext.lib.Anim[b](this.dom,e,(g.duration||h)||0.35,(g.easing||d)||Q,a,this);g.anim=i;return i}};Ext.Fx.resize=Ext.Fx.scale;Ext.Element.addMethods(Ext.Fx)})();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.CompositeElementLite=function(B,A){this.elements=[];this.add(B,A);this.el=new Ext.Element.Flyweight()};Ext.CompositeElementLite.prototype={isComposite:true,getCount:function(){return this.elements.length},add:function(B){if(B){if(Ext.isArray(B)){this.elements=this.elements.concat(B)}else{var A=this.elements;Ext.each(B,function(C){A.push(C)})}}return this},invoke:function(D,A){var B=this.elements,C=this.el;Ext.each(B,function(E){C.dom=E;Ext.Element.prototype[D].apply(C,A)});return this},item:function(A){var B=this;if(!B.elements[A]){return null}B.el.dom=B.elements[A];return B.el},addListener:function(A,D,C,B){Ext.each(this.elements,function(E){Ext.EventManager.on(E,A,D,C||E,B)});return this},each:function(C,B){var D=this,A=D.el;Ext.each(D.elements,function(F,E){A.dom=F;return C.call(B||A,A,D,E)});return D},indexOf:function(A){return this.elements.indexOf(Ext.getDom(A))},replaceElement:function(D,C,A){var B=!isNaN(D)?D:this.indexOf(D),E;if(B>-1){C=Ext.getDom(C);if(A){E=this.elements[B];E.parentNode.insertBefore(C,E);Ext.removeNode(E)}this.elements.splice(B,1,C)}return this},clear:function(){this.elements=[]}};Ext.CompositeElementLite.prototype.on=Ext.CompositeElementLite.prototype.addListener;(function(){var C,B=Ext.Element.prototype,A=Ext.CompositeElementLite.prototype;for(C in B){if(Ext.isFunction(B[C])){(function(D){A[D]=A[D]||function(){return this.invoke(D,arguments)}}).call(A,C)}}})();if(Ext.DomQuery){Ext.Element.selectorFunction=Ext.DomQuery.select}Ext.Element.select=function(A,D,B){var C;if(typeof A=="string"){C=Ext.Element.selectorFunction(A,B)}else{if(A.length!==undefined){C=A}else{throw"Invalid selector"}}return new Ext.CompositeElementLite(C)};Ext.select=Ext.Element.select;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.apply(Ext.CompositeElementLite.prototype,{addElements:function(C,A){if(!C){return this}if(typeof C=="string"){C=Ext.Element.selectorFunction(C,A)}var B=this.elements;Ext.each(C,function(D){B.push(Ext.get(D))});return this},fill:function(A){this.elements=[];this.add(A);return this},first:function(){return this.item(0)},last:function(){return this.item(this.getCount()-1)},contains:function(A){return this.indexOf(A)!=-1},filter:function(A){var B=[];this.each(function(C){if(C.is(A)){B[B.length]=C.dom}});this.fill(B);return this},removeElement:function(D,E){var C=this,A=this.elements,B;Ext.each(D,function(F){if((B=(A[F]||A[F=C.indexOf(F)]))){if(E){if(B.dom){B.remove()}else{Ext.removeNode(B)}}A.splice(F,1)}});return this}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.CompositeElement=function(B,A){this.elements=[];this.add(B,A)};Ext.extend(Ext.CompositeElement,Ext.CompositeElementLite,{invoke:function(B,A){Ext.each(this.elements,function(C){Ext.Element.prototype[B].apply(C,A)});return this},add:function(C,A){if(!C){return this}if(typeof C=="string"){C=Ext.Element.selectorFunction(C,A)}var B=this.elements;Ext.each(C,function(D){B.push(Ext.get(D))});return this},item:function(A){return this.elements[A]||null},indexOf:function(A){return this.elements.indexOf(Ext.get(A))},filter:function(A){var C=this,B=[];Ext.each(C.elements,function(D){if(D.is(A)){B.push(Ext.get(D))}});C.elements=B;return C},each:function(B,A){Ext.each(this.elements,function(D,C){return B.call(A||D,D,this,C)},this);return this}});Ext.Element.select=function(A,D,B){var C;if(typeof A=="string"){C=Ext.Element.selectorFunction(A,B)}else{if(A.length!==undefined){C=A}else{throw"Invalid selector"}}return(D===true)?new Ext.CompositeElement(C):new Ext.CompositeElementLite(C)};Ext.select=Ext.Element.select;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var C="beforerequest",K="requestcomplete",J="requestexception",E=undefined,H="load",G="POST",I="GET",F=window;Ext.data.Connection=function(L){Ext.apply(this,L);this.addEvents(C,K,J);Ext.data.Connection.superclass.constructor.call(this)};function B(L){this.transId=false;var M=L.argument.options;L.argument=M?M.argument:null;this.fireEvent(K,this,L,M);if(M.success){M.success.call(M.scope,L,M)}if(M.callback){M.callback.call(M.scope,M,true,L)}}function D(L,N){this.transId=false;var M=L.argument.options;L.argument=M?M.argument:null;this.fireEvent(J,this,L,M,N);if(M.failure){M.failure.call(M.scope,L,M)}if(M.callback){M.callback.call(M.scope,M,false,L)}}function A(R,L,M){var N=Ext.id(),X=document,S=X.createElement("iframe"),O=Ext.getDom(R.form),W=[],V,Q="multipart/form-data",P={target:O.target,method:O.method,encoding:O.encoding,enctype:O.enctype,action:O.action};Ext.apply(S,{id:N,name:N,className:"x-hidden",src:Ext.SSL_SECURE_URL});X.body.appendChild(S);if(Ext.isIE){document.frames[N].name=N}Ext.apply(O,{target:N,method:G,enctype:Q,encoding:Q,action:M||P.action});L=Ext.urlDecode(L,false);for(var U in L){if(L.hasOwnProperty(U)){V=X.createElement("input");V.type="hidden";V.value=L[V.name=U];O.appendChild(V);W.push(V)}}function T(){var a=this,Z={responseText:"",responseXML:null,argument:R.argument},g,d;try{g=S.contentWindow.document||S.contentDocument||F.frames[N].document;if(g){if(g.body){if(/textarea/i.test((d=g.body.firstChild||{}).tagName)){Z.responseText=d.value}else{Z.responseText=g.body.innerHTML}}Z.responseXML=g.XMLDocument||g}}catch(b){}Ext.EventManager.removeListener(S,H,T,a);a.fireEvent(K,a,Z,R);function Y(i,h,e){if(Ext.isFunction(i)){i.apply(h,e)}}Y(R.success,R.scope,[Z,R]);Y(R.callback,R.scope,[R,true,Z]);if(!a.debugUploads){setTimeout(function(){try{Ext.removeNode(S)}catch(h){}},100)}}Ext.EventManager.on(S,H,T,this);O.submit();Ext.apply(O,P);Ext.each(W,function(Y){Ext.removeNode(Y)})}Ext.extend(Ext.data.Connection,Ext.util.Observable,{timeout:30000,autoAbort:false,disableCaching:true,disableCachingParam:"_dc",request:function(P){var S=this;if(S.fireEvent(C,S,P)){if(P.el){if(!Ext.isEmpty(P.indicatorText)){S.indicatorText='<div class="loading-indicator">'+P.indicatorText+"</div>"}if(S.indicatorText){Ext.getDom(P.el).innerHTML=S.indicatorText}P.success=(Ext.isFunction(P.success)?P.success:function(){}).createInterceptor(function(U){Ext.getDom(P.el).innerHTML=U.responseText})}var N=P.params,M=P.url||S.url,L,Q={success:B,failure:D,scope:S,argument:{options:P},timeout:P.timeout||S.timeout},O,T;if(Ext.isFunction(N)){N=N.call(P.scope||F,P)}N=Ext.urlEncode(S.extraParams,Ext.isObject(N)?Ext.urlEncode(N):N);if(Ext.isFunction(M)){M=M.call(P.scope||F,P)}if((O=Ext.getDom(P.form))){M=M||O.action;if(P.isUpload||/multipart\/form-data/i.test(O.getAttribute("enctype"))){return A.call(S,P,N,M)}T=Ext.lib.Ajax.serializeForm(O);N=N?(N+"&"+T):T}L=P.method||S.method||((N||P.xmlData||P.jsonData)?G:I);if(L===I&&(S.disableCaching&&P.disableCaching!==false)||P.disableCaching===true){var R=P.disableCachingParam||S.disableCachingParam;M=Ext.urlAppend(M,R+"="+(new Date().getTime()))}P.headers=Ext.apply(P.headers||{},S.defaultHeaders||{});if(P.autoAbort===true||S.autoAbort){S.abort()}if((L==I||P.xmlData||P.jsonData)&&N){M=Ext.urlAppend(M,N);N=""}return(S.transId=Ext.lib.Ajax.request(L,M,Q,N,P))}else{return P.callback?P.callback.apply(P.scope,[P,E,E]):null}},isLoading:function(L){return L?Ext.lib.Ajax.isCallInProgress(L):!!this.transId},abort:function(L){if(L||this.isLoading()){Ext.lib.Ajax.abort(L||this.transId)}}})})();Ext.Ajax=new Ext.data.Connection({autoAbort:false,serializeForm:function(A){return Ext.lib.Ajax.serializeForm(A)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.UpdateManager=Ext.Updater=Ext.extend(Ext.util.Observable,function(){var B="beforeupdate",D="update",C="failure";function A(G){var H=this;H.transaction=null;if(G.argument.form&&G.argument.reset){try{G.argument.form.reset()}catch(I){}}if(H.loadScripts){H.renderer.render(H.el,G,H,F.createDelegate(H,[G]))}else{H.renderer.render(H.el,G,H);F.call(H,G)}}function F(G,H,I){this.fireEvent(H||D,this.el,G);if(Ext.isFunction(G.argument.callback)){G.argument.callback.call(G.argument.scope,this.el,Ext.isEmpty(I)?true:false,G,G.argument.options)}}function E(G){F.call(this,G,C,!!(this.transaction=null))}return{constructor:function(H,G){var I=this;H=Ext.get(H);if(!G&&H.updateManager){return H.updateManager}I.el=H;I.defaultUrl=null;I.addEvents(B,D,C);Ext.apply(I,Ext.Updater.defaults);I.transaction=null;I.refreshDelegate=I.refresh.createDelegate(I);I.updateDelegate=I.update.createDelegate(I);I.formUpdateDelegate=(I.formUpdate||function(){}).createDelegate(I);I.renderer=I.renderer||I.getDefaultRenderer();Ext.Updater.superclass.constructor.call(I)},setRenderer:function(G){this.renderer=G},getRenderer:function(){return this.renderer},getDefaultRenderer:function(){return new Ext.Updater.BasicRenderer()},setDefaultUrl:function(G){this.defaultUrl=G},getEl:function(){return this.el},update:function(H,M,N,K){var J=this,G,I;if(J.fireEvent(B,J.el,H,M)!==false){if(Ext.isObject(H)){G=H;H=G.url;M=M||G.params;N=N||G.callback;K=K||G.discardUrl;I=G.scope;if(!Ext.isEmpty(G.nocache)){J.disableCaching=G.nocache}if(!Ext.isEmpty(G.text)){J.indicatorText='<div class="loading-indicator">'+G.text+"</div>"}if(!Ext.isEmpty(G.scripts)){J.loadScripts=G.scripts}if(!Ext.isEmpty(G.timeout)){J.timeout=G.timeout}}J.showLoading();if(!K){J.defaultUrl=H}if(Ext.isFunction(H)){H=H.call(J)}var L=Ext.apply({},{url:H,params:(Ext.isFunction(M)&&I)?M.createDelegate(I):M,success:A,failure:E,scope:J,callback:undefined,timeout:(J.timeout*1000),disableCaching:J.disableCaching,argument:{options:G,url:H,form:null,callback:N,scope:I||window,params:M}},G);J.transaction=Ext.Ajax.request(L)}},formUpdate:function(J,G,I,K){var H=this;if(H.fireEvent(B,H.el,J,G)!==false){if(Ext.isFunction(G)){G=G.call(H)}J=Ext.getDom(J);H.transaction=Ext.Ajax.request({form:J,url:G,success:A,failure:E,scope:H,timeout:(H.timeout*1000),argument:{url:G,form:J,callback:K,reset:I}});H.showLoading.defer(1,H)}},startAutoRefresh:function(H,I,K,L,G){var J=this;if(G){J.update(I||J.defaultUrl,K,L,true)}if(J.autoRefreshProcId){clearInterval(J.autoRefreshProcId)}J.autoRefreshProcId=setInterval(J.update.createDelegate(J,[I||J.defaultUrl,K,L,true]),H*1000)},stopAutoRefresh:function(){if(this.autoRefreshProcId){clearInterval(this.autoRefreshProcId);delete this.autoRefreshProcId}},isAutoRefreshing:function(){return !!this.autoRefreshProcId},showLoading:function(){if(this.showLoadIndicator){this.el.dom.innerHTML=this.indicatorText}},abort:function(){if(this.transaction){Ext.Ajax.abort(this.transaction)}},isUpdating:function(){return this.transaction?Ext.Ajax.isLoading(this.transaction):false},refresh:function(G){if(this.defaultUrl){this.update(this.defaultUrl,null,G,true)}}}}());Ext.Updater.defaults={timeout:30,disableCaching:false,showLoadIndicator:true,indicatorText:'<div class="loading-indicator">Loading...</div>',loadScripts:false,sslBlankUrl:(Ext.SSL_SECURE_URL||"javascript:false")};Ext.Updater.updateElement=function(D,C,E,B){var A=Ext.get(D).getUpdater();Ext.apply(A,B);A.update(C,E,B?B.callback:null)};Ext.Updater.BasicRenderer=function(){};Ext.Updater.BasicRenderer.prototype={render:function(C,A,B,D){C.update(A.responseText,B.loadScripts,D)}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){Date.useStrict=false;function B(D){var C=Array.prototype.slice.call(arguments,1);return D.replace(/\{(\d+)\}/g,function(E,F){return C[F]})}Date.formatCodeToRegex=function(D,C){var E=Date.parseCodes[D];if(E){E=typeof E=="function"?E():E;Date.parseCodes[D]=E}return E?Ext.applyIf({c:E.c?B(E.c,C||"{0}"):E.c},E):{g:0,c:null,s:Ext.escapeRe(D)}};var A=Date.formatCodeToRegex;Ext.apply(Date,{parseFunctions:{"M$":function(D,C){var E=new RegExp("\\/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\/");var F=(D||"").match(E);return F?new Date(((F[1]||"")+F[2])*1):null}},parseRegexes:[],formatFunctions:{"M$":function(){return"\\/Date("+this.getTime()+")\\/"}},y2kYear:50,MILLI:"ms",SECOND:"s",MINUTE:"mi",HOUR:"h",DAY:"d",MONTH:"mo",YEAR:"y",defaults:{},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNumbers:{Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},getShortMonthName:function(C){return Date.monthNames[C].substring(0,3)},getShortDayName:function(C){return Date.dayNames[C].substring(0,3)},getMonthNumber:function(C){return Date.monthNumbers[C.substring(0,1).toUpperCase()+C.substring(1,3).toLowerCase()]},formatCodes:{d:"String.leftPad(this.getDate(), 2, '0')",D:"Date.getShortDayName(this.getDay())",j:"this.getDate()",l:"Date.dayNames[this.getDay()]",N:"(this.getDay() ? this.getDay() : 7)",S:"this.getSuffix()",w:"this.getDay()",z:"this.getDayOfYear()",W:"String.leftPad(this.getWeekOfYear(), 2, '0')",F:"Date.monthNames[this.getMonth()]",m:"String.leftPad(this.getMonth() + 1, 2, '0')",M:"Date.getShortMonthName(this.getMonth())",n:"(this.getMonth() + 1)",t:"this.getDaysInMonth()",L:"(this.isLeapYear() ? 1 : 0)",o:"(this.getFullYear() + (this.getWeekOfYear() == 1 && this.getMonth() > 0 ? +1 : (this.getWeekOfYear() >= 52 && this.getMonth() < 11 ? -1 : 0)))",Y:"this.getFullYear()",y:"('' + this.getFullYear()).substring(2, 4)",a:"(this.getHours() < 12 ? 'am' : 'pm')",A:"(this.getHours() < 12 ? 'AM' : 'PM')",g:"((this.getHours() % 12) ? this.getHours() % 12 : 12)",G:"this.getHours()",h:"String.leftPad((this.getHours() % 12) ? this.getHours() % 12 : 12, 2, '0')",H:"String.leftPad(this.getHours(), 2, '0')",i:"String.leftPad(this.getMinutes(), 2, '0')",s:"String.leftPad(this.getSeconds(), 2, '0')",u:"String.leftPad(this.getMilliseconds(), 3, '0')",O:"this.getGMTOffset()",P:"this.getGMTOffset(true)",T:"this.getTimezone()",Z:"(this.getTimezoneOffset() * -60)",c:function(){for(var G="Y-m-dTH:i:sP",E=[],D=0,C=G.length;D<C;++D){var F=G.charAt(D);E.push(F=="T"?"'T'":Date.getFormatCode(F))}return E.join(" + ")},U:"Math.round(this.getTime() / 1000)"},isValid:function(J,C,I,G,E,F,D){G=G||0;E=E||0;F=F||0;D=D||0;var H=new Date(J,C-1,I,G,E,F,D);return J==H.getFullYear()&&C==H.getMonth()+1&&I==H.getDate()&&G==H.getHours()&&E==H.getMinutes()&&F==H.getSeconds()&&D==H.getMilliseconds()},parseDate:function(D,F,C){var E=Date.parseFunctions;if(E[F]==null){Date.createParser(F)}return E[F](D,Ext.isDefined(C)?C:Date.useStrict)},getFormatCode:function(D){var C=Date.formatCodes[D];if(C){C=typeof C=="function"?C():C;Date.formatCodes[D]=C}return C||("'"+String.escape(D)+"'")},createFormat:function(G){var F=[],C=false,E="";for(var D=0;D<G.length;++D){E=G.charAt(D);if(!C&&E=="\\"){C=true}else{if(C){C=false;F.push("'"+String.escape(E)+"'")}else{F.push(Date.getFormatCode(E))}}}Date.formatFunctions[G]=new Function("return "+F.join("+"))},createParser:function(){var C=["var dt, y, m, d, h, i, s, ms, o, z, zz, u, v,","def = Date.defaults,","results = String(input).match(Date.parseRegexes[{0}]);","if(results){","{1}","if(u != null){","v = new Date(u * 1000);","}else{","dt = (new Date()).clearTime();","y = y >= 0? y : Ext.num(def.y, dt.getFullYear());","m = m >= 0? m : Ext.num(def.m - 1, dt.getMonth());","d = d >= 0? d : Ext.num(def.d, dt.getDate());","h  = h || Ext.num(def.h, dt.getHours());","i  = i || Ext.num(def.i, dt.getMinutes());","s  = s || Ext.num(def.s, dt.getSeconds());","ms = ms || Ext.num(def.ms, dt.getMilliseconds());","if(z >= 0 && y >= 0){","v = new Date(y, 0, 1, h, i, s, ms);","v = !strict? v : (strict === true && (z <= 364 || (v.isLeapYear() && z <= 365))? v.add(Date.DAY, z) : null);","}else if(strict === true && !Date.isValid(y, m + 1, d, h, i, s, ms)){","v = null;","}else{","v = new Date(y, m, d, h, i, s, ms);","}","}","}","if(v){","if(zz != null){","v = v.add(Date.SECOND, -v.getTimezoneOffset() * 60 - zz);","}else if(o){","v = v.add(Date.MINUTE, -v.getTimezoneOffset() + (sn == '+'? -1 : 1) * (hr * 60 + mn));","}","}","return v;"].join("\n");return function(K){var E=Date.parseRegexes.length,L=1,F=[],J=[],I=false,D="";for(var H=0;H<K.length;++H){D=K.charAt(H);if(!I&&D=="\\"){I=true}else{if(I){I=false;J.push(String.escape(D))}else{var G=A(D,L);L+=G.g;J.push(G.s);if(G.g&&G.c){F.push(G.c)}}}}Date.parseRegexes[E]=new RegExp("^"+J.join("")+"$","i");Date.parseFunctions[K]=new Function("input","strict",B(C,E,F.join("")))}}(),parseCodes:{d:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},j:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(\\d{1,2})"},D:function(){for(var C=[],D=0;D<7;C.push(Date.getShortDayName(D)),++D){}return{g:0,c:null,s:"(?:"+C.join("|")+")"}},l:function(){return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"}},N:{g:0,c:null,s:"[1-7]"},S:{g:0,c:null,s:"(?:st|nd|rd|th)"},w:{g:0,c:null,s:"[0-6]"},z:{g:1,c:"z = parseInt(results[{0}], 10);\n",s:"(\\d{1,3})"},W:{g:0,c:null,s:"(?:\\d{2})"},F:function(){return{g:1,c:"m = parseInt(Date.getMonthNumber(results[{0}]), 10);\n",s:"("+Date.monthNames.join("|")+")"}},M:function(){for(var C=[],D=0;D<12;C.push(Date.getShortMonthName(D)),++D){}return Ext.applyIf({s:"("+C.join("|")+")"},A("F"))},m:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(\\d{2})"},n:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(\\d{1,2})"},t:{g:0,c:null,s:"(?:\\d{2})"},L:{g:0,c:null,s:"(?:1|0)"},o:function(){return A("Y")},Y:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},y:{g:1,c:"var ty = parseInt(results[{0}], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"},a:{g:1,c:"if (results[{0}] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"},A:{g:1,c:"if (results[{0}] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"},g:function(){return A("G")},G:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(\\d{1,2})"},h:function(){return A("H")},H:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},i:{g:1,c:"i = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},s:{g:1,c:"s = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},u:{g:1,c:"ms = results[{0}]; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n",s:"(\\d+)"},O:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60),","mn = o.substring(3,5) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + String.leftPad(hr, 2, '0') + String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{4})"},P:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60),","mn = o.substring(4,6) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + String.leftPad(hr, 2, '0') + String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{2}:\\d{2})"},T:{g:0,c:null,s:"[A-Z]{1,4}"},Z:{g:1,c:"zz = results[{0}] * 1;\nzz = (-43200 <= zz && zz <= 50400)? zz : null;\n",s:"([+-]?\\d{1,5})"},c:function(){var E=[],C=[A("Y",1),A("m",2),A("d",3),A("h",4),A("i",5),A("s",6),{c:"ms = results[7] || '0'; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n"},{c:["if(results[8]) {","if(results[8] == 'Z'){","zz = 0;","}else if (results[8].indexOf(':') > -1){",A("P",8).c,"}else{",A("O",8).c,"}","}"].join("\n")}];for(var F=0,D=C.length;F<D;++F){E.push(C[F].c)}return{g:1,c:E.join(""),s:[C[0].s,"(?:","-",C[1].s,"(?:","-",C[2].s,"(?:","(?:T| )?",C[3].s,":",C[4].s,"(?::",C[5].s,")?","(?:(?:\\.|,)(\\d+))?","(Z|(?:[-+]\\d{2}(?::)?\\d{2}))?",")?",")?",")?"].join("")}},U:{g:1,c:"u = parseInt(results[{0}], 10);\n",s:"(-?\\d+)"}}})}());Ext.apply(Date.prototype,{dateFormat:function(A){if(Date.formatFunctions[A]==null){Date.createFormat(A)}return Date.formatFunctions[A].call(this)},getTimezone:function(){return this.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,4})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getGMTOffset:function(A){return(this.getTimezoneOffset()>0?"-":"+")+String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset())/60),2,"0")+(A?":":"")+String.leftPad(Math.abs(this.getTimezoneOffset()%60),2,"0")},getDayOfYear:function(){var C=0,B=0,D=this.clone(),A=this.getMonth();for(C=0,D.setMonth(0);C<A;D.setMonth(++C)){B+=D.getDaysInMonth()}return B+this.getDate()-1},getWeekOfYear:function(){var A=86400000,B=7*A;return function(){var D=Date.UTC(this.getFullYear(),this.getMonth(),this.getDate()+3)/A,C=Math.floor(D/7),E=new Date(C*B).getUTCFullYear();return C-Math.floor(Date.UTC(E,0,7)/B)+1}}(),isLeapYear:function(){var A=this.getFullYear();return !!((A&3)==0&&(A%100||(A%400==0&&A)))},getFirstDayOfMonth:function(){var A=(this.getDay()-(this.getDate()-1))%7;return(A<0)?(A+7):A},getLastDayOfMonth:function(){return this.getLastDateOfMonth().getDay()},getFirstDateOfMonth:function(){return new Date(this.getFullYear(),this.getMonth(),1)},getLastDateOfMonth:function(){return new Date(this.getFullYear(),this.getMonth(),this.getDaysInMonth())},getDaysInMonth:function(){var A=[31,28,31,30,31,30,31,31,30,31,30,31];return function(){var B=this.getMonth();return B==1&&this.isLeapYear()?29:A[B]}}(),getSuffix:function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},clone:function(){return new Date(this.getTime())},isDST:function(){return new Date(this.getFullYear(),0,1).getTimezoneOffset()!=this.getTimezoneOffset()},clearTime:function(D){if(D){return this.clone().clearTime()}var B=this.getDate();this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);if(this.getDate()!=B){for(var A=1,C=this.add(Date.HOUR,A);C.getDate()!=B;A++,C=this.add(Date.HOUR,A)){}this.setDate(B);this.setHours(C.getHours())}return this},add:function(B,C){var D=this.clone();if(!B||C===0){return D}switch(B.toLowerCase()){case Date.MILLI:D.setMilliseconds(this.getMilliseconds()+C);break;case Date.SECOND:D.setSeconds(this.getSeconds()+C);break;case Date.MINUTE:D.setMinutes(this.getMinutes()+C);break;case Date.HOUR:D.setHours(this.getHours()+C);break;case Date.DAY:D.setDate(this.getDate()+C);break;case Date.MONTH:var A=this.getDate();if(A>28){A=Math.min(A,this.getFirstDateOfMonth().add("mo",C).getLastDateOfMonth().getDate())}D.setDate(A);D.setMonth(this.getMonth()+C);break;case Date.YEAR:D.setFullYear(this.getFullYear()+C);break}return D},between:function(C,A){var B=this.getTime();return C.getTime()<=B&&B<=A.getTime()}});Date.prototype.format=Date.prototype.dateFormat;if(Ext.isSafari&&(navigator.userAgent.match(/WebKit\/(\d+)/)[1]||NaN)<420){Ext.apply(Date.prototype,{_xMonth:Date.prototype.setMonth,_xDate:Date.prototype.setDate,setMonth:function(A){if(A<=-1){var D=Math.ceil(-A),C=Math.ceil(D/12),B=(D%12)?12-D%12:0;this.setFullYear(this.getFullYear()-C);return this._xMonth(B)}else{return this._xMonth(A)}},setDate:function(A){return this.setTime(this.getTime()-(this.getDate()-A)*86400000)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
}Ext.util.DelayedTask=function(D,C,A){var E=this,F,B=function(){clearInterval(F);F=null;D.apply(C,A||[])};E.delay=function(H,J,I,G){E.cancel();D=J||D;C=I||C;A=G||A;F=setInterval(B,H)};E.cancel=function(){if(F){clearInterval(F);F=null}}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.util.MixedCollection=function(B,A){this.items=[];this.map={};this.keys=[];this.length=0;this.addEvents("clear","add","replace","remove","sort");this.allowFunctions=B===true;if(A){this.getKey=A}Ext.util.MixedCollection.superclass.constructor.call(this)};Ext.extend(Ext.util.MixedCollection,Ext.util.Observable,{allowFunctions:false,add:function(B,C){if(arguments.length==1){C=arguments[0];B=this.getKey(C)}if(typeof B!="undefined"&&B!==null){var A=this.map[B];if(typeof A!="undefined"){return this.replace(B,C)}this.map[B]=C}this.length++;this.items.push(C);this.keys.push(B);this.fireEvent("add",this.length-1,C,B);return C},getKey:function(A){return A.id},replace:function(C,D){if(arguments.length==1){D=arguments[0];C=this.getKey(D)}var A=this.map[C];if(typeof C=="undefined"||C===null||typeof A=="undefined"){return this.add(C,D)}var B=this.indexOfKey(C);this.items[B]=D;this.map[C]=D;this.fireEvent("replace",C,A,D);return D},addAll:function(E){if(arguments.length>1||Ext.isArray(E)){var B=arguments.length>1?arguments:E;for(var D=0,A=B.length;D<A;D++){this.add(B[D])}}else{for(var C in E){if(this.allowFunctions||typeof E[C]!="function"){this.add(C,E[C])}}}},each:function(E,D){var B=[].concat(this.items);for(var C=0,A=B.length;C<A;C++){if(E.call(D||B[C],B[C],C,A)===false){break}}},eachKey:function(D,C){for(var B=0,A=this.keys.length;B<A;B++){D.call(C||window,this.keys[B],this.items[B],B,A)}},find:function(D,C){for(var B=0,A=this.items.length;B<A;B++){if(D.call(C||window,this.items[B],this.keys[B])){return this.items[B]}}return null},insert:function(A,B,C){if(arguments.length==2){C=arguments[1];B=this.getKey(C)}if(this.containsKey(B)){this.suspendEvents();this.removeKey(B);this.resumeEvents()}if(A>=this.length){return this.add(B,C)}this.length++;this.items.splice(A,0,C);if(typeof B!="undefined"&&B!==null){this.map[B]=C}this.keys.splice(A,0,B);this.fireEvent("add",A,C,B);return C},remove:function(A){return this.removeAt(this.indexOf(A))},removeAt:function(A){if(A<this.length&&A>=0){this.length--;var C=this.items[A];this.items.splice(A,1);var B=this.keys[A];if(typeof B!="undefined"){delete this.map[B]}this.keys.splice(A,1);this.fireEvent("remove",C,B);return C}return false},removeKey:function(A){return this.removeAt(this.indexOfKey(A))},getCount:function(){return this.length},indexOf:function(A){return this.items.indexOf(A)},indexOfKey:function(A){return this.keys.indexOf(A)},item:function(B){var A=this.map[B],C=A!==undefined?A:(typeof B=="number")?this.items[B]:undefined;return !Ext.isFunction(C)||this.allowFunctions?C:null},itemAt:function(A){return this.items[A]},key:function(A){return this.map[A]},contains:function(A){return this.indexOf(A)!=-1},containsKey:function(A){return typeof this.map[A]!="undefined"},clear:function(){this.length=0;this.items=[];this.keys=[];this.map={};this.fireEvent("clear")},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},_sort:function(I,A,H){var D,E,C=String(A).toUpperCase()=="DESC"?-1:1,G=[],B=this.keys,F=this.items;H=H||function(K,J){return K-J};for(D=0,E=F.length;D<E;D++){G[G.length]={key:B[D],value:F[D],index:D}}G.sort(function(K,J){var L=H(K[I],J[I])*C;if(L===0){L=(K.index<J.index?-1:1)}return L});for(D=0,E=G.length;D<E;D++){F[D]=G[D].value;B[D]=G[D].key}this.fireEvent("sort",this)},sort:function(A,B){this._sort("value",A,B)},keySort:function(A,B){this._sort("key",A,B||function(D,C){var F=String(D).toUpperCase(),E=String(C).toUpperCase();return F>E?1:(F<E?-1:0)})},getRange:function(E,A){var B=this.items;if(B.length<1){return[]}E=E||0;A=Math.min(typeof A=="undefined"?this.length-1:A,this.length-1);var C,D=[];if(E<=A){for(C=E;C<=A;C++){D[D.length]=B[C]}}else{for(C=E;C>=A;C--){D[D.length]=B[C]}}return D},filter:function(C,B,D,A){if(Ext.isEmpty(B,false)){return this.clone()}B=this.createValueMatcher(B,D,A);return this.filterBy(function(E){return E&&B.test(E[C])})},filterBy:function(F,E){var G=new Ext.util.MixedCollection();G.getKey=this.getKey;var B=this.keys,D=this.items;for(var C=0,A=D.length;C<A;C++){if(F.call(E||this,D[C],B[C])){G.add(B[C],D[C])}}return G},findIndex:function(C,B,E,D,A){if(Ext.isEmpty(B,false)){return -1}B=this.createValueMatcher(B,D,A);return this.findIndexBy(function(F){return F&&B.test(F[C])},null,E)},findIndexBy:function(F,E,G){var B=this.keys,D=this.items;for(var C=(G||0),A=D.length;C<A;C++){if(F.call(E||this,D[C],B[C])){return C}}return -1},createValueMatcher:function(B,C,A){if(!B.exec){B=String(B);B=new RegExp((C===true?"":"^")+Ext.escapeRe(B),A?"":"i")}return B},clone:function(){var E=new Ext.util.MixedCollection();var B=this.keys,D=this.items;for(var C=0,A=D.length;C<A;C++){E.add(B[C],D[C])}E.getKey=this.getKey;return E}});Ext.util.MixedCollection.prototype.get=Ext.util.MixedCollection.prototype.item;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.util.JSON=new (function(){var useHasOwn=!!{}.hasOwnProperty,isNative=function(){var useNative=null;return function(){if(useNative===null){useNative=Ext.USE_NATIVE_JSON&&window.JSON&&JSON.toString()=="[object JSON]"}return useNative}}(),pad=function(n){return n<10?"0"+n:n},doDecode=function(json){return eval("("+json+")")},doEncode=function(o){if(typeof o=="undefined"||o===null){return"null"}else{if(Ext.isArray(o)){return encodeArray(o)}else{if(Object.prototype.toString.apply(o)==="[object Date]"){return Ext.util.JSON.encodeDate(o)}else{if(typeof o=="string"){return encodeString(o)}else{if(typeof o=="number"){return isFinite(o)?String(o):"null"}else{if(typeof o=="boolean"){return String(o)}else{var a=["{"],b,i,v;for(i in o){if(!useHasOwn||o.hasOwnProperty(i)){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(",")}a.push(doEncode(i),":",v===null?"null":doEncode(v));b=true}}}a.push("}");return a.join("")}}}}}}},m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},encodeString=function(s){if(/["\\\x00-\x1f]/.test(s)){return'"'+s.replace(/([\x00-\x1f\\"])/g,function(a,b){var c=m[b];if(c){return c}c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+s+'"'},encodeArray=function(o){var a=["["],b,i,l=o.length,v;for(i=0;i<l;i+=1){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(",")}a.push(v===null?"null":Ext.util.JSON.encode(v));b=true}}a.push("]");return a.join("")};this.encodeDate=function(o){return'"'+o.getFullYear()+"-"+pad(o.getMonth()+1)+"-"+pad(o.getDate())+"T"+pad(o.getHours())+":"+pad(o.getMinutes())+":"+pad(o.getSeconds())+'"'};this.encode=function(){var ec;return function(o){if(!ec){ec=isNative()?JSON.stringify:doEncode}return ec(o)}}();this.decode=function(){var dc;return function(json){if(!dc){dc=isNative()?JSON.parse:doDecode}return dc(json)}}()})();Ext.encode=Ext.util.JSON.encode;Ext.decode=Ext.util.JSON.decode;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.util.Format=function(){var trimRe=/^\s+|\s+$/g;return{ellipsis:function(value,len,word){if(value&&value.length>len){if(word){var vs=value.substr(0,len-2);var index=Math.max(vs.lastIndexOf(" "),vs.lastIndexOf("."),vs.lastIndexOf("!"),vs.lastIndexOf("?"));if(index==-1||index<(len-15)){return value.substr(0,len-3)+"..."}else{return vs.substr(0,index)+"..."}}else{return value.substr(0,len-3)+"..."}}return value},undef:function(value){return value!==undefined?value:""},defaultValue:function(value,defaultValue){return value!==undefined&&value!==""?value:defaultValue},htmlEncode:function(value){return !value?value:String(value).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},htmlDecode:function(value){return !value?value:String(value).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},trim:function(value){return String(value).replace(trimRe,"")},substr:function(value,start,length){return String(value).substr(start,length)},lowercase:function(value){return String(value).toLowerCase()},uppercase:function(value){return String(value).toUpperCase()},capitalize:function(value){return !value?value:value.charAt(0).toUpperCase()+value.substr(1).toLowerCase()},call:function(value,fn){if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);args.unshift(value);return eval(fn).apply(window,args)}else{return eval(fn).call(window,value)}},usMoney:function(v){v=(Math.round((v-0)*100))/100;v=(v==Math.floor(v))?v+".00":((v*10==Math.floor(v*10))?v+"0":v);v=String(v);var ps=v.split(".");var whole=ps[0];var sub=ps[1]?"."+ps[1]:".00";var r=/(\d+)(\d{3})/;while(r.test(whole)){whole=whole.replace(r,"$1,$2")}v=whole+sub;if(v.charAt(0)=="-"){return"-$"+v.substr(1)}return"$"+v},date:function(v,format){if(!v){return""}if(!Ext.isDate(v)){v=new Date(Date.parse(v))}return v.dateFormat(format||"m/d/Y")},dateRenderer:function(format){return function(v){return Ext.util.Format.date(v,format)}},stripTagsRE:/<\/?[^>]+>/gi,stripTags:function(v){return !v?v:String(v).replace(this.stripTagsRE,"")},stripScriptsRe:/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,stripScripts:function(v){return !v?v:String(v).replace(this.stripScriptsRe,"")},fileSize:function(size){if(size<1024){return size+" bytes"}else{if(size<1048576){return(Math.round(((size*10)/1024))/10)+" KB"}else{return(Math.round(((size*10)/1048576))/10)+" MB"}}},math:function(){var fns={};return function(v,a){if(!fns[a]){fns[a]=new Function("v","return v "+a+";")}return fns[a](v)}}(),round:function(value,precision){var result=Number(value);if(typeof precision=="number"){precision=Math.pow(10,precision);result=Math.round(value*precision)/precision}return result},number:function(v,format){if(!format){return v}v=Ext.num(v,NaN);if(isNaN(v)){return""}var comma=",",dec=".",i18n=false,neg=v<0;v=Math.abs(v);if(format.substr(format.length-2)=="/i"){format=format.substr(0,format.length-2);i18n=true;comma=".";dec=","}var hasComma=format.indexOf(comma)!=-1,psplit=(i18n?format.replace(/[^\d\,]/g,""):format.replace(/[^\d\.]/g,"")).split(dec);if(1<psplit.length){v=v.toFixed(psplit[1].length)}else{if(2<psplit.length){throw ("NumberFormatException: invalid format, formats should have no more than 1 period: "+format)}else{v=v.toFixed(0)}}var fnum=v.toString();if(hasComma){psplit=fnum.split(".");var cnum=psplit[0],parr=[],j=cnum.length,m=Math.floor(j/3),n=cnum.length%3||3;for(var i=0;i<j;i+=n){if(i!=0){n=3}parr[parr.length]=cnum.substr(i,n);m-=1}fnum=parr.join(comma);if(psplit[1]){fnum+=dec+psplit[1]}}return(neg?"-":"")+format.replace(/[\d,?\.?]+/,fnum)},numberRenderer:function(format){return function(v){return Ext.util.Format.number(v,format)}},plural:function(v,s,p){return v+" "+(v==1?s:(p?p:s+"s"))},nl2br:function(v){return v===undefined||v===null?"":v.replace(/\n/g,"<br/>")}}}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.XTemplate=function(){Ext.XTemplate.superclass.constructor.apply(this,arguments);var T=this,H=T.html,N=/<tpl\b[^>]*>((?:(?=([^<]+))\2|<(?!tpl\b[^>]*>))*?)<\/tpl>/,D=/^<tpl\b[^>]*?for="(.*?)"/,Q=/^<tpl\b[^>]*?if="(.*?)"/,S=/^<tpl\b[^>]*?exec="(.*?)"/,O,M=0,I=[],L="values",R="parent",J="xindex",K="xcount",E="return ",C="with(values){ ";H=["<tpl>",H,"</tpl>"].join("");while((O=H.match(N))){var B=O[0].match(D),A=O[0].match(Q),V=O[0].match(S),F=null,G=null,P=null,U=B&&B[1]?B[1]:"";if(A){F=A&&A[1]?A[1]:null;if(F){G=new Function(L,R,J,K,C+E+(Ext.util.Format.htmlDecode(F))+"; }")}}if(V){F=V&&V[1]?V[1]:null;if(F){P=new Function(L,R,J,K,C+(Ext.util.Format.htmlDecode(F))+"; }")}}if(U){switch(U){case".":U=new Function(L,R,C+E+L+"; }");break;case"..":U=new Function(L,R,C+E+R+"; }");break;default:U=new Function(L,R,C+E+U+"; }")}}I.push({id:M,target:U,exec:P,test:G,body:O[1]||""});H=H.replace(O[0],"{xtpl"+M+"}");++M}Ext.each(I,function(W){T.compileTpl(W)});T.master=I[I.length-1];T.tpls=I};Ext.extend(Ext.XTemplate,Ext.Template,{re:/\{([\w-\.\#]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?(\s?[\+\-\*\\]\s?[\d\.\+\-\*\\\(\)]+)?\}/g,codeRe:/\{\[((?:\\\]|.|\n)*?)\]\}/g,applySubTemplate:function(A,H,G,D,C){var F=this,E,J=F.tpls[A],I,B=[];if((J.test&&!J.test.call(F,H,G,D,C))||(J.exec&&J.exec.call(F,H,G,D,C))){return""}I=J.target?J.target.call(F,H,G):H;E=I.length;G=J.target?H:G;if(J.target&&Ext.isArray(I)){Ext.each(I,function(K,L){B[B.length]=J.compiled.call(F,K,G,L+1,E)});return B.join("")}return J.compiled.call(F,I,G,D,C)},compileTpl:function(tpl){var fm=Ext.util.Format,useF=this.disableFormats!==true,sep=Ext.isGecko?"+":",",body;function fn(m,name,format,args,math){if(name.substr(0,4)=="xtpl"){return"'"+sep+"this.applySubTemplate("+name.substr(4)+", values, parent, xindex, xcount)"+sep+"'"}var v;if(name==="."){v="values"}else{if(name==="#"){v="xindex"}else{if(name.indexOf(".")!=-1){v=name}else{v="values['"+name+"']"}}}if(math){v="("+v+math+")"}if(format&&useF){args=args?","+args:"";if(format.substr(0,5)!="this."){format="fm."+format+"("}else{format='this.call("'+format.substr(5)+'", ';args=", values"}}else{args="";format="("+v+" === undefined ? '' : "}return"'"+sep+format+v+args+")"+sep+"'"}function codeFn(m,code){return"'"+sep+"("+code+")"+sep+"'"}if(Ext.isGecko){body="tpl.compiled = function(values, parent, xindex, xcount){ return '"+tpl.body.replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn).replace(this.codeRe,codeFn)+"';};"}else{body=["tpl.compiled = function(values, parent, xindex, xcount){ return ['"];body.push(tpl.body.replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn).replace(this.codeRe,codeFn));body.push("'].join('');};");body=body.join("")}eval(body);return this},applyTemplate:function(A){return this.master.compiled.call(this,A,{},1,1)},compile:function(){return this}});Ext.XTemplate.prototype.apply=Ext.XTemplate.prototype.applyTemplate;Ext.XTemplate.from=function(A){A=Ext.getDom(A);return new Ext.XTemplate(A.value||A.innerHTML)};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.util.CSS=function(){var D=null;var C=document;var B=/(-[a-z])/gi;var A=function(E,F){return F.charAt(1).toUpperCase()};return{createStyleSheet:function(G,J){var F;var E=C.getElementsByTagName("head")[0];var I=C.createElement("style");I.setAttribute("type","text/css");if(J){I.setAttribute("id",J)}if(Ext.isIE){E.appendChild(I);F=I.styleSheet;F.cssText=G}else{try{I.appendChild(C.createTextNode(G))}catch(H){I.cssText=G}E.appendChild(I);F=I.styleSheet?I.styleSheet:(I.sheet||C.styleSheets[C.styleSheets.length-1])}this.cacheStyleSheet(F);return F},removeStyleSheet:function(F){var E=C.getElementById(F);if(E){E.parentNode.removeChild(E)}},swapStyleSheet:function(G,E){this.removeStyleSheet(G);var F=C.createElement("link");F.setAttribute("rel","stylesheet");F.setAttribute("type","text/css");F.setAttribute("id",G);F.setAttribute("href",E);C.getElementsByTagName("head")[0].appendChild(F)},refreshCache:function(){return this.getRules(true)},cacheStyleSheet:function(F){if(!D){D={}}try{var H=F.cssRules||F.rules;for(var E=H.length-1;E>=0;--E){D[H[E].selectorText]=H[E]}}catch(G){}},getRules:function(F){if(D===null||F){D={};var H=C.styleSheets;for(var G=0,E=H.length;G<E;G++){try{this.cacheStyleSheet(H[G])}catch(I){}}}return D},getRule:function(E,G){var F=this.getRules(G);if(!Ext.isArray(E)){return F[E]}for(var H=0;H<E.length;H++){if(F[E[H]]){return F[E[H]]}}return null},updateRule:function(E,H,G){if(!Ext.isArray(E)){var I=this.getRule(E);if(I){I.style[H.replace(B,A)]=G;return true}}else{for(var F=0;F<E.length;F++){if(this.updateRule(E[F],H,G)){return true}}}return false}}}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.util.ClickRepeater=function(B,A){this.el=Ext.get(B);this.el.unselectable();Ext.apply(this,A);this.addEvents("mousedown","click","mouseup");if(!this.disabled){this.disabled=true;this.enable()}if(this.handler){this.on("click",this.handler,this.scope||this)}Ext.util.ClickRepeater.superclass.constructor.call(this)};Ext.extend(Ext.util.ClickRepeater,Ext.util.Observable,{interval:20,delay:250,preventDefault:true,stopDefault:false,timer:0,enable:function(){if(this.disabled){this.el.on("mousedown",this.handleMouseDown,this);if(this.preventDefault||this.stopDefault){this.el.on("click",this.eventOptions,this)}}this.disabled=false},disable:function(A){if(A||!this.disabled){clearTimeout(this.timer);if(this.pressClass){this.el.removeClass(this.pressClass)}Ext.getDoc().un("mouseup",this.handleMouseUp,this);this.el.removeAllListeners()}this.disabled=true},setDisabled:function(A){this[A?"disable":"enable"]()},eventOptions:function(A){if(this.preventDefault){A.preventDefault()}if(this.stopDefault){A.stopEvent()}},destroy:function(){this.disable(true);Ext.destroy(this.el);this.purgeListeners()},handleMouseDown:function(){clearTimeout(this.timer);this.el.blur();if(this.pressClass){this.el.addClass(this.pressClass)}this.mousedownTime=new Date();Ext.getDoc().on("mouseup",this.handleMouseUp,this);this.el.on("mouseout",this.handleMouseOut,this);this.fireEvent("mousedown",this);this.fireEvent("click",this);if(this.accelerate){this.delay=400}this.timer=this.click.defer(this.delay||this.interval,this)},click:function(){this.fireEvent("click",this);this.timer=this.click.defer(this.accelerate?this.easeOutExpo(this.mousedownTime.getElapsed(),400,-390,12000):this.interval,this)},easeOutExpo:function(B,A,D,C){return(B==C)?A+D:D*(-Math.pow(2,-10*B/C)+1)+A},handleMouseOut:function(){clearTimeout(this.timer);if(this.pressClass){this.el.removeClass(this.pressClass)}this.el.on("mouseover",this.handleMouseReturn,this)},handleMouseReturn:function(){this.el.un("mouseover",this.handleMouseReturn,this);if(this.pressClass){this.el.addClass(this.pressClass)}this.click()},handleMouseUp:function(){clearTimeout(this.timer);this.el.un("mouseover",this.handleMouseReturn,this);this.el.un("mouseout",this.handleMouseOut,this);Ext.getDoc().un("mouseup",this.handleMouseUp,this);this.el.removeClass(this.pressClass);this.fireEvent("mouseup",this)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.KeyNav=function(B,A){this.el=Ext.get(B);Ext.apply(this,A);if(!this.disabled){this.disabled=true;this.enable()}};Ext.KeyNav.prototype={disabled:false,defaultEventAction:"stopEvent",forceKeyDown:false,prepareEvent:function(C){var A=C.getKey();var B=this.keyToHandler[A];if(Ext.isSafari2&&B&&A>=37&&A<=40){C.stopEvent()}},relay:function(C){var A=C.getKey();var B=this.keyToHandler[A];if(B&&this[B]){if(this.doRelay(C,this[B],B)!==true){C[this.defaultEventAction]()}}},doRelay:function(C,B,A){return B.call(this.scope||this,C)},enter:false,left:false,right:false,up:false,down:false,tab:false,esc:false,pageUp:false,pageDown:false,del:false,home:false,end:false,keyToHandler:{37:"left",39:"right",38:"up",40:"down",33:"pageUp",34:"pageDown",46:"del",36:"home",35:"end",13:"enter",27:"esc",9:"tab"},enable:function(){if(this.disabled){if(this.isKeydown()){this.el.on("keydown",this.relay,this)}else{this.el.on("keydown",this.prepareEvent,this);this.el.on("keypress",this.relay,this)}this.disabled=false}},disable:function(){if(!this.disabled){if(this.isKeydown()){this.el.un("keydown",this.relay,this)}else{this.el.un("keydown",this.prepareEvent,this);this.el.un("keypress",this.relay,this)}this.disabled=true}},setDisabled:function(A){this[A?"disable":"enable"]()},isKeydown:function(){return this.forceKeyDown||Ext.EventManager.useKeydown}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.KeyMap=function(C,B,A){this.el=Ext.get(C);this.eventName=A||"keydown";this.bindings=[];if(B){this.addBinding(B)}this.enable()};Ext.KeyMap.prototype={stopEvent:false,addBinding:function(B){if(Ext.isArray(B)){Ext.each(B,function(K){this.addBinding(K)},this);return }var I=B.key,F=B.fn||B.handler,J=B.scope;if(B.stopEvent){this.stopEvent=B.stopEvent}if(typeof I=="string"){var G=[];var E=I.toUpperCase();for(var C=0,D=E.length;C<D;C++){G.push(E.charCodeAt(C))}I=G}var A=Ext.isArray(I);var H=function(N){if(this.checkModifiers(B,N)){var L=N.getKey();if(A){for(var M=0,K=I.length;M<K;M++){if(I[M]==L){if(this.stopEvent){N.stopEvent()}F.call(J||window,L,N);return }}}else{if(L==I){if(this.stopEvent){N.stopEvent()}F.call(J||window,L,N)}}}};this.bindings.push(H)},checkModifiers:function(B,F){var G,D,E=["shift","ctrl","alt"];for(var C=0,A=E.length;C<A;++C){D=E[C];G=B[D];if(!(G===undefined||(G===F[D+"Key"]))){return false}}return true},on:function(B,D,C){var G,A,E,F;if(typeof B=="object"&&!Ext.isArray(B)){G=B.key;A=B.shift;E=B.ctrl;F=B.alt}else{G=B}this.addBinding({key:G,shift:A,ctrl:E,alt:F,fn:D,scope:C})},handleKeyDown:function(D){if(this.enabled){var B=this.bindings;for(var C=0,A=B.length;C<A;C++){B[C].call(this,D)}}},isEnabled:function(){return this.enabled},enable:function(){if(!this.enabled){this.el.on(this.eventName,this.handleKeyDown,this);this.enabled=true}},disable:function(){if(this.enabled){this.el.removeListener(this.eventName,this.handleKeyDown,this);this.enabled=false}},setDisabled:function(A){this[A?"disable":"enable"]()}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.util.TextMetrics=function(){var A;return{measure:function(B,C,D){if(!A){A=Ext.util.TextMetrics.Instance(B,D)}A.bind(B);A.setFixedWidth(D||"auto");return A.getSize(C)},createInstance:function(B,C){return Ext.util.TextMetrics.Instance(B,C)}}}();Ext.util.TextMetrics.Instance=function(B,D){var C=new Ext.Element(document.createElement("div"));document.body.appendChild(C.dom);C.position("absolute");C.setLeftTop(-1000,-1000);C.hide();if(D){C.setWidth(D)}var A={getSize:function(F){C.update(F);var E=C.getSize();C.update("");return E},bind:function(E){C.setStyle(Ext.fly(E).getStyles("font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"))},setFixedWidth:function(E){C.setWidth(E)},getWidth:function(E){C.dom.style.width="auto";return this.getSize(E).width},getHeight:function(E){return this.getSize(E).height}};A.bind(B);return A};Ext.Element.addMethods({getTextWidth:function(C,B,A){return(Ext.util.TextMetrics.measure(this.dom,Ext.value(C,this.dom.innerHTML,true)).width).constrain(B||0,A||1000000)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.util.Cookies={set:function(C,E){var A=arguments;var H=arguments.length;var B=(H>2)?A[2]:null;var G=(H>3)?A[3]:"/";var D=(H>4)?A[4]:null;var F=(H>5)?A[5]:false;document.cookie=C+"="+escape(E)+((B===null)?"":("; expires="+B.toGMTString()))+((G===null)?"":("; path="+G))+((D===null)?"":("; domain="+D))+((F===true)?"; secure":"")},get:function(D){var B=D+"=";var F=B.length;var A=document.cookie.length;var E=0;var C=0;while(E<A){C=E+F;if(document.cookie.substring(E,C)==B){return Ext.util.Cookies.getCookieVal(C)}E=document.cookie.indexOf(" ",E)+1;if(E===0){break}}return null},clear:function(A){if(Ext.util.Cookies.get(A)){document.cookie=A+"=; expires=Thu, 01-Jan-70 00:00:01 GMT"}},getCookieVal:function(B){var A=document.cookie.indexOf(";",B);if(A==-1){A=document.cookie.length}return unescape(document.cookie.substring(B,A))}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.handleError=function(A){throw A};Ext.Error=function(A){this.message=(this.lang[A])?this.lang[A]:A};Ext.Error.prototype=new Error();Ext.apply(Ext.Error.prototype,{lang:{},name:"Ext.Error",getName:function(){return this.name},getMessage:function(){return this.message},toJson:function(){return Ext.encode(this)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ComponentMgr=function(){var C=new Ext.util.MixedCollection();var B={};var A={};return{register:function(D){C.add(D)},unregister:function(D){C.remove(D)},get:function(D){return C.get(D)},onAvailable:function(F,E,D){C.on("add",function(G,H){if(H.id==F){E.call(D||H,H);C.un("add",E,D)}})},all:C,isRegistered:function(D){return B[D]!==undefined},registerType:function(E,D){B[E]=D;D.xtype=E},create:function(D,E){return D.render?D:new B[D.xtype||E](D)},registerPlugin:function(E,D){A[E]=D;D.ptype=E},createPlugin:function(D,E){return new A[D.ptype||E](D)}}}();Ext.reg=Ext.ComponentMgr.registerType;Ext.preg=Ext.ComponentMgr.registerPlugin;Ext.create=Ext.ComponentMgr.create;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Component=function(B){B=B||{};if(B.initialConfig){if(B.isAction){this.baseAction=B}B=B.initialConfig}else{if(B.tagName||B.dom||Ext.isString(B)){B={applyTo:B,id:B.id||B}}}this.initialConfig=B;Ext.apply(this,B);this.addEvents("disable","enable","beforeshow","show","beforehide","hide","beforerender","render","afterrender","beforedestroy","destroy","beforestaterestore","staterestore","beforestatesave","statesave");this.getId();Ext.ComponentMgr.register(this);Ext.Component.superclass.constructor.call(this);if(this.baseAction){this.baseAction.addComponent(this)}this.initComponent();if(this.plugins){if(Ext.isArray(this.plugins)){for(var C=0,A=this.plugins.length;C<A;C++){this.plugins[C]=this.initPlugin(this.plugins[C])}}else{this.plugins=this.initPlugin(this.plugins)}}if(this.stateful!==false){this.initState(B)}if(this.applyTo){this.applyToMarkup(this.applyTo);delete this.applyTo}else{if(this.renderTo){this.render(this.renderTo);delete this.renderTo}}};Ext.Component.AUTO_ID=1000;Ext.extend(Ext.Component,Ext.util.Observable,{disabled:false,hidden:false,autoEl:"div",disabledClass:"x-item-disabled",allowDomMove:true,autoShow:false,hideMode:"display",hideParent:false,rendered:false,ctype:"Ext.Component",actionMode:"el",getActionEl:function(){return this[this.actionMode]},initPlugin:function(A){if(A.ptype&&!Ext.isFunction(A.init)){A=Ext.ComponentMgr.createPlugin(A)}else{if(Ext.isString(A)){A=Ext.ComponentMgr.createPlugin({ptype:A})}}A.init(this);return A},initComponent:Ext.emptyFn,render:function(B,A){if(!this.rendered&&this.fireEvent("beforerender",this)!==false){if(!B&&this.el){this.el=Ext.get(this.el);B=this.el.dom.parentNode;this.allowDomMove=false}this.container=Ext.get(B);if(this.ctCls){this.container.addClass(this.ctCls)}this.rendered=true;if(A!==undefined){if(Ext.isNumber(A)){A=this.container.dom.childNodes[A]}else{A=Ext.getDom(A)}}this.onRender(this.container,A||null);if(this.autoShow){this.el.removeClass(["x-hidden","x-hide-"+this.hideMode])}if(this.cls){this.el.addClass(this.cls);delete this.cls}if(this.style){this.el.applyStyles(this.style);delete this.style}if(this.overCls){this.el.addClassOnOver(this.overCls)}this.fireEvent("render",this);this.afterRender(this.container);if(this.hidden){this.doHide()}if(this.disabled){this.disable(true)}if(this.stateful!==false){this.initStateEvents()}this.initRef();this.fireEvent("afterrender",this)}return this},initRef:function(){if(this.ref){var D=this.ref.split("/");var C=D.length,B=0;var A=this;while(B<C){if(A.ownerCt){A=A.ownerCt}B++}A[D[--B]]=this}},initState:function(A){if(Ext.state.Manager){var C=this.getStateId();if(C){var B=Ext.state.Manager.get(C);if(B){if(this.fireEvent("beforestaterestore",this,B)!==false){this.applyState(B);this.fireEvent("staterestore",this,B)}}}}},getStateId:function(){return this.stateId||((this.id.indexOf("ext-comp-")==0||this.id.indexOf("ext-gen")==0)?null:this.id)},initStateEvents:function(){if(this.stateEvents){for(var A=0,B;B=this.stateEvents[A];A++){this.on(B,this.saveState,this,{delay:100})}}},applyState:function(B,A){if(B){Ext.apply(this,B)}},getState:function(){return null},saveState:function(){if(Ext.state.Manager&&this.stateful!==false){var B=this.getStateId();if(B){var A=this.getState();if(this.fireEvent("beforestatesave",this,A)!==false){Ext.state.Manager.set(B,A);this.fireEvent("statesave",this,A)}}}},applyToMarkup:function(A){this.allowDomMove=false;this.el=Ext.get(A);this.render(this.el.dom.parentNode)},addClass:function(A){if(this.el){this.el.addClass(A)}else{this.cls=this.cls?this.cls+" "+A:A}return this},removeClass:function(A){if(this.el){this.el.removeClass(A)}else{if(this.cls){this.cls=this.cls.split(" ").remove(A).join(" ")}}return this},onRender:function(B,A){if(!this.el&&this.autoEl){if(Ext.isString(this.autoEl)){this.el=document.createElement(this.autoEl)}else{var C=document.createElement("div");Ext.DomHelper.overwrite(C,this.autoEl);this.el=C.firstChild}if(!this.el.id){this.el.id=this.getId()}}if(this.el){this.el=Ext.get(this.el);if(this.allowDomMove!==false){B.dom.insertBefore(this.el.dom,A)}}},getAutoCreate:function(){var A=Ext.isObject(this.autoCreate)?this.autoCreate:Ext.apply({},this.defaultAutoCreate);if(this.id&&!A.id){A.id=this.id}return A},afterRender:Ext.emptyFn,destroy:function(){if(this.fireEvent("beforedestroy",this)!==false){this.beforeDestroy();if(this.rendered){this.el.removeAllListeners();this.el.remove();if(this.actionMode=="container"||this.removeMode=="container"){this.container.remove()}}this.onDestroy();Ext.ComponentMgr.unregister(this);this.fireEvent("destroy",this);this.purgeListeners()}},beforeDestroy:Ext.emptyFn,onDestroy:Ext.emptyFn,getEl:function(){return this.el},getId:function(){return this.id||(this.id="ext-comp-"+(++Ext.Component.AUTO_ID))},getItemId:function(){return this.itemId||this.getId()},focus:function(B,A){if(A){this.focus.defer(Ext.isNumber(A)?A:10,this,[B,false]);return }if(this.rendered){this.el.focus();if(B===true){this.el.dom.select()}}return this},blur:function(){if(this.rendered){this.el.blur()}return this},disable:function(A){if(this.rendered){this.onDisable()}this.disabled=true;if(A!==true){this.fireEvent("disable",this)}return this},onDisable:function(){this.getActionEl().addClass(this.disabledClass);this.el.dom.disabled=true},enable:function(){if(this.rendered){this.onEnable()}this.disabled=false;this.fireEvent("enable",this);return this},onEnable:function(){this.getActionEl().removeClass(this.disabledClass);this.el.dom.disabled=false},setDisabled:function(A){return this[A?"disable":"enable"]()},show:function(){if(this.fireEvent("beforeshow",this)!==false){this.hidden=false;if(this.autoRender){this.render(Ext.isBoolean(this.autoRender)?Ext.getBody():this.autoRender)}if(this.rendered){this.onShow()}this.fireEvent("show",this)}return this},onShow:function(){this.getVisibiltyEl().removeClass("x-hide-"+this.hideMode)},hide:function(){if(this.fireEvent("beforehide",this)!==false){this.doHide();this.fireEvent("hide",this)}return this},doHide:function(){this.hidden=true;if(this.rendered){this.onHide()}},onHide:function(){this.getVisibiltyEl().addClass("x-hide-"+this.hideMode)},getVisibiltyEl:function(){return this.hideParent?this.container:this.getActionEl()},setVisible:function(A){return this[A?"show":"hide"]()},isVisible:function(){return this.rendered&&this.getVisibiltyEl().isVisible()},cloneConfig:function(B){B=B||{};var C=B.id||Ext.id();var A=Ext.applyIf(B,this.initialConfig);A.id=C;return new this.constructor(A)},getXType:function(){return this.constructor.xtype},isXType:function(B,A){if(Ext.isFunction(B)){B=B.xtype}else{if(Ext.isObject(B)){B=B.constructor.xtype}}return !A?("/"+this.getXTypes()+"/").indexOf("/"+B+"/")!=-1:this.constructor.xtype==B},getXTypes:function(){var A=this.constructor;if(!A.xtypes){var C=[],B=this;while(B&&B.constructor.xtype){C.unshift(B.constructor.xtype);B=B.constructor.superclass}A.xtypeChain=C;A.xtypes=C.join("/")}return A.xtypes},findParentBy:function(A){for(var B=this.ownerCt;(B!=null)&&!A(B,this);B=B.ownerCt){}return B||null},findParentByType:function(A){return Ext.isFunction(A)?this.findParentBy(function(B){return B.constructor===A}):this.findParentBy(function(B){return B.constructor.xtype===A})},getDomPositionEl:function(){return this.getPositionEl?this.getPositionEl():this.getEl()},purgeListeners:function(){Ext.Component.superclass.purgeListeners.call(this);if(this.mons){this.on("beforedestroy",this.clearMons,this,{single:true})}},clearMons:function(){Ext.each(this.mons,function(A){A.item.un(A.ename,A.fn,A.scope)},this);this.mons=[]},mon:function(E,B,D,C,A){if(!this.mons){this.mons=[];this.on("beforedestroy",this.clearMons,this,{single:true})}if(Ext.isObject(B)){var H=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/;var G=B;for(var F in G){if(H.test(F)){continue}if(Ext.isFunction(G[F])){this.mons.push({item:E,ename:F,fn:G[F],scope:G.scope});E.on(F,G[F],G.scope,G)}else{this.mons.push({item:E,ename:F,fn:G[F],scope:G.scope});E.on(F,G[F])}}return }this.mons.push({item:E,ename:B,fn:D,scope:C});E.on(B,D,C,A)},mun:function(G,C,F,E){var H,D;for(var B=0,A=this.mons.length;B<A;++B){D=this.mons[B];if(G===D.item&&C==D.ename&&F===D.fn&&E===D.scope){this.mons.splice(B,1);G.un(C,F,E);H=true;break}}return H},nextSibling:function(){if(this.ownerCt){var A=this.ownerCt.items.indexOf(this);if(A!=-1&&A+1<this.ownerCt.items.getCount()){return this.ownerCt.items.itemAt(A+1)}}return null},previousSibling:function(){if(this.ownerCt){var A=this.ownerCt.items.indexOf(this);if(A>0){return this.ownerCt.items.itemAt(A-1)}}return null},getBubbleTarget:function(){return this.ownerCt}});Ext.reg("component",Ext.Component);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Action=function(A){this.initialConfig=A;this.itemId=A.itemId=(A.itemId||A.id||Ext.id());this.items=[]};Ext.Action.prototype={isAction:true,setText:function(A){this.initialConfig.text=A;this.callEach("setText",[A])},getText:function(){return this.initialConfig.text},setIconClass:function(A){this.initialConfig.iconCls=A;this.callEach("setIconClass",[A])},getIconClass:function(){return this.initialConfig.iconCls},setDisabled:function(A){this.initialConfig.disabled=A;this.callEach("setDisabled",[A])},enable:function(){this.setDisabled(false)},disable:function(){this.setDisabled(true)},isDisabled:function(){return this.initialConfig.disabled},setHidden:function(A){this.initialConfig.hidden=A;this.callEach("setVisible",[!A])},show:function(){this.setHidden(false)},hide:function(){this.setHidden(true)},isHidden:function(){return this.initialConfig.hidden},setHandler:function(B,A){this.initialConfig.handler=B;this.initialConfig.scope=A;this.callEach("setHandler",[B,A])},each:function(B,A){Ext.each(this.items,B,A)},callEach:function(E,B){var D=this.items;for(var C=0,A=D.length;C<A;C++){D[C][E].apply(D[C],B)}},addComponent:function(A){this.items.push(A);A.on("destroy",this.removeComponent,this)},removeComponent:function(A){this.items.remove(A)},execute:function(){this.initialConfig.handler.apply(this.initialConfig.scope||window,arguments)}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){Ext.Layer=function(D,C){D=D||{};var E=Ext.DomHelper;var G=D.parentEl,F=G?Ext.getDom(G):document.body;if(C){this.dom=Ext.getDom(C)}if(!this.dom){var H=D.dh||{tag:"div",cls:"x-layer"};this.dom=E.append(F,H)}if(D.cls){this.addClass(D.cls)}this.constrain=D.constrain!==false;this.setVisibilityMode(Ext.Element.VISIBILITY);if(D.id){this.id=this.dom.id=D.id}else{this.id=Ext.id(this.dom)}this.zindex=D.zindex||this.getZIndex();this.position("absolute",this.zindex);if(D.shadow){this.shadowOffset=D.shadowOffset||4;this.shadow=new Ext.Shadow({offset:this.shadowOffset,mode:D.shadow})}else{this.shadowOffset=0}this.useShim=D.shim!==false&&Ext.useShims;this.useDisplay=D.useDisplay;this.hide()};var A=Ext.Element.prototype;var B=[];Ext.extend(Ext.Layer,Ext.Element,{getZIndex:function(){return this.zindex||parseInt((this.getShim()||this).getStyle("z-index"),10)||11000},getShim:function(){if(!this.useShim){return null}if(this.shim){return this.shim}var D=B.shift();if(!D){D=this.createShim();D.enableDisplayMode("block");D.dom.style.display="none";D.dom.style.visibility="visible"}var C=this.dom.parentNode;if(D.dom.parentNode!=C){C.insertBefore(D.dom,this.dom)}D.setStyle("z-index",this.getZIndex()-2);this.shim=D;return D},hideShim:function(){if(this.shim){this.shim.setDisplayed(false);B.push(this.shim);delete this.shim}},disableShadow:function(){if(this.shadow){this.shadowDisabled=true;this.shadow.hide();this.lastShadowOffset=this.shadowOffset;this.shadowOffset=0}},enableShadow:function(C){if(this.shadow){this.shadowDisabled=false;this.shadowOffset=this.lastShadowOffset;delete this.lastShadowOffset;if(C){this.sync(true)}}},sync:function(C){var I=this.shadow;if(!this.updating&&this.isVisible()&&(I||this.useShim)){var F=this.getShim();var H=this.getWidth(),E=this.getHeight();var D=this.getLeft(true),J=this.getTop(true);if(I&&!this.shadowDisabled){if(C&&!I.isVisible()){I.show(this)}else{I.realign(D,J,H,E)}if(F){if(C){F.show()}var G=I.adjusts,K=F.dom.style;K.left=(Math.min(D,D+G.l))+"px";K.top=(Math.min(J,J+G.t))+"px";K.width=(H+G.w)+"px";K.height=(E+G.h)+"px"}}else{if(F){if(C){F.show()}F.setSize(H,E);F.setLeftTop(D,J)}}}},destroy:function(){this.hideShim();if(this.shadow){this.shadow.hide()}this.removeAllListeners();Ext.removeNode(this.dom);Ext.Element.uncache(this.id)},remove:function(){this.destroy()},beginUpdate:function(){this.updating=true},endUpdate:function(){this.updating=false;this.sync(true)},hideUnders:function(C){if(this.shadow){this.shadow.hide()}this.hideShim()},constrainXY:function(){if(this.constrain){var H=Ext.lib.Dom.getViewWidth(),D=Ext.lib.Dom.getViewHeight();var M=Ext.getDoc().getScroll();var L=this.getXY();var I=L[0],G=L[1];var C=this.shadowOffset;var J=this.dom.offsetWidth+C,E=this.dom.offsetHeight+C;var F=false;if((I+J)>H+M.left){I=H-J-C;F=true}if((G+E)>D+M.top){G=D-E-C;F=true}if(I<M.left){I=M.left;F=true}if(G<M.top){G=M.top;F=true}if(F){if(this.avoidY){var K=this.avoidY;if(G<=K&&(G+E)>=K){G=K-E-5}}L=[I,G];this.storeXY(L);A.setXY.call(this,L);this.sync()}}return this},isVisible:function(){return this.visible},showAction:function(){this.visible=true;if(this.useDisplay===true){this.setDisplayed("")}else{if(this.lastXY){A.setXY.call(this,this.lastXY)}else{if(this.lastLT){A.setLeftTop.call(this,this.lastLT[0],this.lastLT[1])}}}},hideAction:function(){this.visible=false;if(this.useDisplay===true){this.setDisplayed(false)}else{this.setLeftTop(-10000,-10000)}},setVisible:function(E,D,G,H,F){if(E){this.showAction()}if(D&&E){var C=function(){this.sync(true);if(H){H()}}.createDelegate(this);A.setVisible.call(this,true,true,G,C,F)}else{if(!E){this.hideUnders(true)}var C=H;if(D){C=function(){this.hideAction();if(H){H()}}.createDelegate(this)}A.setVisible.call(this,E,D,G,C,F);if(E){this.sync(true)}else{if(!D){this.hideAction()}}}return this},storeXY:function(C){delete this.lastLT;this.lastXY=C},storeLeftTop:function(D,C){delete this.lastXY;this.lastLT=[D,C]},beforeFx:function(){this.beforeAction();return Ext.Layer.superclass.beforeFx.apply(this,arguments)},afterFx:function(){Ext.Layer.superclass.afterFx.apply(this,arguments);this.sync(this.isVisible())},beforeAction:function(){if(!this.updating&&this.shadow){this.shadow.hide()}},setLeft:function(C){this.storeLeftTop(C,this.getTop(true));A.setLeft.apply(this,arguments);this.sync();return this},setTop:function(C){this.storeLeftTop(this.getLeft(true),C);A.setTop.apply(this,arguments);this.sync();return this},setLeftTop:function(D,C){this.storeLeftTop(D,C);A.setLeftTop.apply(this,arguments);this.sync();return this},setXY:function(F,D,G,H,E){this.fixDisplay();this.beforeAction();this.storeXY(F);var C=this.createCB(H);A.setXY.call(this,F,D,G,C,E);if(!D){C()}return this},createCB:function(D){var C=this;return function(){C.constrainXY();C.sync(true);if(D){D()}}},setX:function(C,D,F,G,E){this.setXY([C,this.getY()],D,F,G,E);return this},setY:function(G,C,E,F,D){this.setXY([this.getX(),G],C,E,F,D);return this},setSize:function(E,F,D,H,I,G){this.beforeAction();var C=this.createCB(I);A.setSize.call(this,E,F,D,H,C,G);if(!D){C()}return this},setWidth:function(E,D,G,H,F){this.beforeAction();var C=this.createCB(H);A.setWidth.call(this,E,D,G,C,F);if(!D){C()}return this},setHeight:function(E,D,G,H,F){this.beforeAction();var C=this.createCB(H);A.setHeight.call(this,E,D,G,C,F);if(!D){C()}return this},setBounds:function(J,H,K,D,I,F,G,E){this.beforeAction();var C=this.createCB(G);if(!I){this.storeXY([J,H]);A.setXY.call(this,[J,H]);A.setSize.call(this,K,D,I,F,C,E);C()}else{A.setBounds.call(this,J,H,K,D,I,F,C,E)}return this},setZIndex:function(C){this.zindex=C;this.setStyle("z-index",C+2);if(this.shadow){this.shadow.setZIndex(C+1)}if(this.shim){this.shim.setStyle("z-index",C)}return this}})})();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Shadow=function(C){Ext.apply(this,C);if(typeof this.mode!="string"){this.mode=this.defaultMode}var D=this.offset,B={h:0};var A=Math.floor(this.offset/2);switch(this.mode.toLowerCase()){case"drop":B.w=0;B.l=B.t=D;B.t-=1;if(Ext.isIE){B.l-=this.offset+A;B.t-=this.offset+A;B.w-=A;B.h-=A;B.t+=1}break;case"sides":B.w=(D*2);B.l=-D;B.t=D-1;if(Ext.isIE){B.l-=(this.offset-A);B.t-=this.offset+A;B.l+=1;B.w-=(this.offset-A)*2;B.w-=A+1;B.h-=1}break;case"frame":B.w=B.h=(D*2);B.l=B.t=-D;B.t+=1;B.h-=2;if(Ext.isIE){B.l-=(this.offset-A);B.t-=(this.offset-A);B.l+=1;B.w-=(this.offset+A+1);B.h-=(this.offset+A);B.h+=1}break}this.adjusts=B};Ext.Shadow.prototype={offset:4,defaultMode:"drop",show:function(A){A=Ext.get(A);if(!this.el){this.el=Ext.Shadow.Pool.pull();if(this.el.dom.nextSibling!=A.dom){this.el.insertBefore(A)}}this.el.setStyle("z-index",this.zIndex||parseInt(A.getStyle("z-index"),10)-1);if(Ext.isIE){this.el.dom.style.filter="progid:DXImageTransform.Microsoft.alpha(opacity=50) progid:DXImageTransform.Microsoft.Blur(pixelradius="+(this.offset)+")"}this.realign(A.getLeft(true),A.getTop(true),A.getWidth(),A.getHeight());this.el.dom.style.display="block"},isVisible:function(){return this.el?true:false},realign:function(A,M,L,D){if(!this.el){return }var I=this.adjusts,G=this.el.dom,N=G.style;var E=0;N.left=(A+I.l)+"px";N.top=(M+I.t)+"px";var K=(L+I.w),C=(D+I.h),F=K+"px",J=C+"px";if(N.width!=F||N.height!=J){N.width=F;N.height=J;if(!Ext.isIE){var H=G.childNodes;var B=Math.max(0,(K-12))+"px";H[0].childNodes[1].style.width=B;H[1].childNodes[1].style.width=B;H[2].childNodes[1].style.width=B;H[1].style.height=Math.max(0,(C-12))+"px"}}},hide:function(){if(this.el){this.el.dom.style.display="none";Ext.Shadow.Pool.push(this.el);delete this.el}},setZIndex:function(A){this.zIndex=A;if(this.el){this.el.setStyle("z-index",A)}}};Ext.Shadow.Pool=function(){var B=[];var A=Ext.isIE?'<div class="x-ie-shadow"></div>':'<div class="x-shadow"><div class="xst"><div class="xstl"></div><div class="xstc"></div><div class="xstr"></div></div><div class="xsc"><div class="xsml"></div><div class="xsmc"></div><div class="xsmr"></div></div><div class="xsb"><div class="xsbl"></div><div class="xsbc"></div><div class="xsbr"></div></div></div>';return{pull:function(){var C=B.shift();if(!C){C=Ext.get(Ext.DomHelper.insertHtml("beforeBegin",document.body.firstChild,A));C.autoBoxAdjust=false}return C},push:function(C){B.push(C)}}}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.BoxComponent=Ext.extend(Ext.Component,{initComponent:function(){Ext.BoxComponent.superclass.initComponent.call(this);this.addEvents("resize","move")},boxReady:false,deferHeight:false,setSize:function(B,D){if(typeof B=="object"){D=B.height;B=B.width}if(!this.boxReady){this.width=B;this.height=D;return this}if(this.cacheSizes!==false&&this.lastSize&&this.lastSize.width==B&&this.lastSize.height==D){return this}this.lastSize={width:B,height:D};var C=this.adjustSize(B,D);var F=C.width,A=C.height;if(F!==undefined||A!==undefined){var E=this.getResizeEl();if(!this.deferHeight&&F!==undefined&&A!==undefined){E.setSize(F,A)}else{if(!this.deferHeight&&A!==undefined){E.setHeight(A)}else{if(F!==undefined){E.setWidth(F)}}}this.onResize(F,A,B,D);this.fireEvent("resize",this,F,A,B,D)}return this},setWidth:function(A){return this.setSize(A)},setHeight:function(A){return this.setSize(undefined,A)},getSize:function(){return this.getResizeEl().getSize()},getWidth:function(){return this.getResizeEl().getWidth()},getHeight:function(){return this.getResizeEl().getHeight()},getOuterSize:function(){var A=this.getResizeEl();return{width:A.getWidth()+A.getMargins("lr"),height:A.getHeight()+A.getMargins("tb")}},getPosition:function(A){var B=this.getPositionEl();if(A===true){return[B.getLeft(true),B.getTop(true)]}return this.xy||B.getXY()},getBox:function(A){var C=this.getPosition(A);var B=this.getSize();B.x=C[0];B.y=C[1];return B},updateBox:function(A){this.setSize(A.width,A.height);this.setPagePosition(A.x,A.y);return this},getResizeEl:function(){return this.resizeEl||this.el},getPositionEl:function(){return this.positionEl||this.el},setPosition:function(A,F){if(A&&typeof A[1]=="number"){F=A[1];A=A[0]}this.x=A;this.y=F;if(!this.boxReady){return this}var B=this.adjustPosition(A,F);var E=B.x,D=B.y;var C=this.getPositionEl();if(E!==undefined||D!==undefined){if(E!==undefined&&D!==undefined){C.setLeftTop(E,D)}else{if(E!==undefined){C.setLeft(E)}else{if(D!==undefined){C.setTop(D)}}}this.onPosition(E,D);this.fireEvent("move",this,E,D)}return this},setPagePosition:function(A,C){if(A&&typeof A[1]=="number"){C=A[1];A=A[0]}this.pageX=A;this.pageY=C;if(!this.boxReady){return }if(A===undefined||C===undefined){return }var B=this.getPositionEl().translatePoints(A,C);this.setPosition(B.left,B.top);return this},onRender:function(B,A){Ext.BoxComponent.superclass.onRender.call(this,B,A);if(this.resizeEl){this.resizeEl=Ext.get(this.resizeEl)}if(this.positionEl){this.positionEl=Ext.get(this.positionEl)}},afterRender:function(){Ext.BoxComponent.superclass.afterRender.call(this);this.boxReady=true;this.setSize(this.width,this.height);if(this.x||this.y){this.setPosition(this.x,this.y)}else{if(this.pageX||this.pageY){this.setPagePosition(this.pageX,this.pageY)}}},syncSize:function(){delete this.lastSize;this.setSize(this.autoWidth?undefined:this.getResizeEl().getWidth(),this.autoHeight?undefined:this.getResizeEl().getHeight());return this},onResize:function(D,B,A,C){},onPosition:function(A,B){},adjustSize:function(A,B){if(this.autoWidth){A="auto"}if(this.autoHeight){B="auto"}return{width:A,height:B}},adjustPosition:function(A,B){return{x:A,y:B}}});Ext.reg("box",Ext.BoxComponent);Ext.Spacer=Ext.extend(Ext.BoxComponent,{autoEl:"div"});Ext.reg("spacer",Ext.Spacer);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.SplitBar=function(C,E,B,D,A){this.el=Ext.get(C,true);this.el.dom.unselectable="on";this.resizingEl=Ext.get(E,true);this.orientation=B||Ext.SplitBar.HORIZONTAL;this.minSize=0;this.maxSize=2000;this.animate=false;this.useShim=false;this.shim=null;if(!A){this.proxy=Ext.SplitBar.createProxy(this.orientation)}else{this.proxy=Ext.get(A).dom}this.dd=new Ext.dd.DDProxy(this.el.dom.id,"XSplitBars",{dragElId:this.proxy.id});this.dd.b4StartDrag=this.onStartProxyDrag.createDelegate(this);this.dd.endDrag=this.onEndProxyDrag.createDelegate(this);this.dragSpecs={};this.adapter=new Ext.SplitBar.BasicLayoutAdapter();this.adapter.init(this);if(this.orientation==Ext.SplitBar.HORIZONTAL){this.placement=D||(this.el.getX()>this.resizingEl.getX()?Ext.SplitBar.LEFT:Ext.SplitBar.RIGHT);this.el.addClass("x-splitbar-h")}else{this.placement=D||(this.el.getY()>this.resizingEl.getY()?Ext.SplitBar.TOP:Ext.SplitBar.BOTTOM);this.el.addClass("x-splitbar-v")}this.addEvents("resize","moved","beforeresize","beforeapply");Ext.SplitBar.superclass.constructor.call(this)};Ext.extend(Ext.SplitBar,Ext.util.Observable,{onStartProxyDrag:function(A,E){this.fireEvent("beforeresize",this);this.overlay=Ext.DomHelper.append(document.body,{cls:"x-drag-overlay",html:"&#160;"},true);this.overlay.unselectable();this.overlay.setSize(Ext.lib.Dom.getViewWidth(true),Ext.lib.Dom.getViewHeight(true));this.overlay.show();Ext.get(this.proxy).setDisplayed("block");var C=this.adapter.getElementSize(this);this.activeMinSize=this.getMinimumSize();this.activeMaxSize=this.getMaximumSize();var D=C-this.activeMinSize;var B=Math.max(this.activeMaxSize-C,0);if(this.orientation==Ext.SplitBar.HORIZONTAL){this.dd.resetConstraints();this.dd.setXConstraint(this.placement==Ext.SplitBar.LEFT?D:B,this.placement==Ext.SplitBar.LEFT?B:D,this.tickSize);this.dd.setYConstraint(0,0)}else{this.dd.resetConstraints();this.dd.setXConstraint(0,0);this.dd.setYConstraint(this.placement==Ext.SplitBar.TOP?D:B,this.placement==Ext.SplitBar.TOP?B:D,this.tickSize)}this.dragSpecs.startSize=C;this.dragSpecs.startPoint=[A,E];Ext.dd.DDProxy.prototype.b4StartDrag.call(this.dd,A,E)},onEndProxyDrag:function(C){Ext.get(this.proxy).setDisplayed(false);var B=Ext.lib.Event.getXY(C);if(this.overlay){Ext.destroy(this.overlay);delete this.overlay}var A;if(this.orientation==Ext.SplitBar.HORIZONTAL){A=this.dragSpecs.startSize+(this.placement==Ext.SplitBar.LEFT?B[0]-this.dragSpecs.startPoint[0]:this.dragSpecs.startPoint[0]-B[0])}else{A=this.dragSpecs.startSize+(this.placement==Ext.SplitBar.TOP?B[1]-this.dragSpecs.startPoint[1]:this.dragSpecs.startPoint[1]-B[1])}A=Math.min(Math.max(A,this.activeMinSize),this.activeMaxSize);if(A!=this.dragSpecs.startSize){if(this.fireEvent("beforeapply",this,A)!==false){this.adapter.setElementSize(this,A);this.fireEvent("moved",this,A);this.fireEvent("resize",this,A)}}},getAdapter:function(){return this.adapter},setAdapter:function(A){this.adapter=A;this.adapter.init(this)},getMinimumSize:function(){return this.minSize},setMinimumSize:function(A){this.minSize=A},getMaximumSize:function(){return this.maxSize},setMaximumSize:function(A){this.maxSize=A},setCurrentSize:function(B){var A=this.animate;this.animate=false;this.adapter.setElementSize(this,B);this.animate=A},destroy:function(A){Ext.destroy(this.shim,Ext.get(this.proxy));this.dd.unreg();if(A){this.el.remove()}this.purgeListeners()}});Ext.SplitBar.createProxy=function(B){var C=new Ext.Element(document.createElement("div"));C.unselectable();var A="x-splitbar-proxy";C.addClass(A+" "+(B==Ext.SplitBar.HORIZONTAL?A+"-h":A+"-v"));document.body.appendChild(C.dom);return C.dom};Ext.SplitBar.BasicLayoutAdapter=function(){};Ext.SplitBar.BasicLayoutAdapter.prototype={init:function(A){},getElementSize:function(A){if(A.orientation==Ext.SplitBar.HORIZONTAL){return A.resizingEl.getWidth()}else{return A.resizingEl.getHeight()}},setElementSize:function(B,A,C){if(B.orientation==Ext.SplitBar.HORIZONTAL){if(!B.animate){B.resizingEl.setWidth(A);if(C){C(B,A)}}else{B.resizingEl.setWidth(A,true,0.1,C,"easeOut")}}else{if(!B.animate){B.resizingEl.setHeight(A);if(C){C(B,A)}}else{B.resizingEl.setHeight(A,true,0.1,C,"easeOut")}}}};Ext.SplitBar.AbsoluteLayoutAdapter=function(A){this.basic=new Ext.SplitBar.BasicLayoutAdapter();this.container=Ext.get(A)};Ext.SplitBar.AbsoluteLayoutAdapter.prototype={init:function(A){this.basic.init(A)},getElementSize:function(A){return this.basic.getElementSize(A)},setElementSize:function(B,A,C){this.basic.setElementSize(B,A,this.moveSplitter.createDelegate(this,[B]))},moveSplitter:function(A){var B=Ext.SplitBar;switch(A.placement){case B.LEFT:A.el.setX(A.resizingEl.getRight());break;case B.RIGHT:A.el.setStyle("right",(this.container.getWidth()-A.resizingEl.getLeft())+"px");break;case B.TOP:A.el.setY(A.resizingEl.getBottom());break;case B.BOTTOM:A.el.setY(A.resizingEl.getTop()-A.el.getHeight());break}}};Ext.SplitBar.VERTICAL=1;Ext.SplitBar.HORIZONTAL=2;Ext.SplitBar.LEFT=1;Ext.SplitBar.RIGHT=2;Ext.SplitBar.TOP=3;Ext.SplitBar.BOTTOM=4;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Container=Ext.extend(Ext.BoxComponent,{bufferResize:100,autoDestroy:true,forceLayout:false,defaultType:"panel",initComponent:function(){Ext.Container.superclass.initComponent.call(this);this.addEvents("afterlayout","beforeadd","beforeremove","add","remove");this.enableBubble("add","remove");var A=this.items;if(A){delete this.items;if(Ext.isArray(A)&&A.length>0){this.add.apply(this,A)}else{this.add(A)}}},initItems:function(){if(!this.items){this.items=new Ext.util.MixedCollection(false,this.getComponentId);this.getLayout()}},setLayout:function(A){if(this.layout&&this.layout!=A){this.layout.setContainer(null)}this.initItems();this.layout=A;A.setContainer(this)},render:function(){Ext.Container.superclass.render.apply(this,arguments);if(this.layout){if(Ext.isObject(this.layout)&&!this.layout.layout){this.layoutConfig=this.layout;this.layout=this.layoutConfig.type}if(typeof this.layout=="string"){this.layout=new Ext.Container.LAYOUTS[this.layout.toLowerCase()](this.layoutConfig)}this.setLayout(this.layout);if(this.activeItem!==undefined){var A=this.activeItem;delete this.activeItem;this.layout.setActiveItem(A)}}if(!this.ownerCt){this.doLayout(false,true)}if(this.monitorResize===true){Ext.EventManager.onWindowResize(this.doLayout,this,[false])}},getLayoutTarget:function(){return this.el},getComponentId:function(A){return A.getItemId()},add:function(A){this.initItems();var B=arguments.length>1;if(B||Ext.isArray(A)){Ext.each(B?arguments:A,function(E){this.add(E)},this);return }var D=this.lookupComponent(this.applyDefaults(A));var C=this.items.length;if(this.fireEvent("beforeadd",this,D,C)!==false&&this.onBeforeAdd(D)!==false){this.items.add(D);D.ownerCt=this;this.fireEvent("add",this,D,C)}return D},insert:function(D,C){this.initItems();var B=arguments,A=B.length;if(A>2){for(var E=A-1;E>=1;--E){this.insert(D,B[E])}return }var F=this.lookupComponent(this.applyDefaults(C));if(F.ownerCt==this&&this.items.indexOf(F)<D){--D}if(this.fireEvent("beforeadd",this,F,D)!==false&&this.onBeforeAdd(F)!==false){this.items.insert(D,F);F.ownerCt=this;this.fireEvent("add",this,F,D)}return F},applyDefaults:function(A){if(this.defaults){if(typeof A=="string"){A=Ext.ComponentMgr.get(A);Ext.apply(A,this.defaults)}else{if(!A.events){Ext.applyIf(A,this.defaults)}else{Ext.apply(A,this.defaults)}}}return A},onBeforeAdd:function(A){if(A.ownerCt){A.ownerCt.remove(A,false)}if(this.hideBorders===true){A.border=(A.border===true)}},remove:function(A,B){this.initItems();var C=this.getComponent(A);if(C&&this.fireEvent("beforeremove",this,C)!==false){this.items.remove(C);delete C.ownerCt;if(B===true||(B!==false&&this.autoDestroy)){C.destroy()}if(this.layout&&this.layout.activeItem==C){delete this.layout.activeItem}this.fireEvent("remove",this,C)}return C},removeAll:function(C){this.initItems();var E,F=[],B=[];this.items.each(function(G){F.push(G)});for(var D=0,A=F.length;D<A;++D){E=F[D];this.remove(E,C);if(E.ownerCt!==this){B.push(E)}}return B},getComponent:function(A){if(Ext.isObject(A)){return A}return this.items.get(A)},lookupComponent:function(A){if(typeof A=="string"){return Ext.ComponentMgr.get(A)}else{if(!A.events){return this.createComponent(A)}}return A},createComponent:function(A){return Ext.create(A,this.defaultType)},doLayout:function(E,D){var H=this.rendered,G=this.forceLayout;if(!this.isVisible()||this.collapsed){this.deferLayout=this.deferLayout||!E;if(!(D||G)){return }E=E&&!this.deferLayout}else{delete this.deferLayout}if(H&&this.layout){this.layout.layout()}if(E!==true&&this.items){var C=this.items.items;for(var B=0,A=C.length;B<A;B++){var F=C[B];if(F.doLayout){F.forceLayout=G;F.doLayout()}}}if(H){this.onLayout(E,D)}delete this.forceLayout},onLayout:Ext.emptyFn,onShow:function(){Ext.Container.superclass.onShow.call(this);if(this.deferLayout!==undefined){this.doLayout(true)}},getLayout:function(){if(!this.layout){var A=new Ext.layout.ContainerLayout(this.layoutConfig);this.setLayout(A)}return this.layout},beforeDestroy:function(){if(this.items){Ext.destroy.apply(Ext,this.items.items)}if(this.monitorResize){Ext.EventManager.removeResizeListener(this.doLayout,this)}Ext.destroy(this.layout);Ext.Container.superclass.beforeDestroy.call(this)},bubble:function(C,B,A){var D=this;while(D){if(C.apply(B||D,A||[D])===false){break}D=D.ownerCt}return this},cascade:function(F,E,B){if(F.apply(E||this,B||[this])!==false){if(this.items){var D=this.items.items;for(var C=0,A=D.length;C<A;C++){if(D[C].cascade){D[C].cascade(F,E,B)}else{F.apply(E||D[C],B||[D[C]])}}}}return this},findById:function(C){var A,B=this;this.cascade(function(D){if(B!=D&&D.id===C){A=D;return false}});return A||null},findByType:function(B,A){return this.findBy(function(C){return C.isXType(B,A)})},find:function(B,A){return this.findBy(function(C){return C[B]===A})},findBy:function(D,C){var A=[],B=this;this.cascade(function(E){if(B!=E&&D.call(C||E,E,B)===true){A.push(E)}});return A},get:function(A){return this.items.get(A)}});Ext.Container.LAYOUTS={};Ext.reg("container",Ext.Container);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.ContainerLayout=function(A){Ext.apply(this,A)};Ext.layout.ContainerLayout.prototype={monitorResize:false,activeItem:null,layout:function(){var A=this.container.getLayoutTarget();this.onLayout(this.container,A);this.container.fireEvent("afterlayout",this.container,this)},onLayout:function(A,B){this.renderAll(A,B)},isValidParent:function(B,A){return A&&B.getDomPositionEl().dom.parentNode==(A.dom||A)},renderAll:function(D,E){var B=D.items.items;for(var C=0,A=B.length;C<A;C++){var F=B[C];if(F&&(!F.rendered||!this.isValidParent(F,E))){this.renderItem(F,C,E)}}},renderItem:function(C,A,B){if(C&&!C.rendered){C.render(B,A);this.configureItem(C,A)}else{if(C&&!this.isValidParent(C,B)){if(typeof A=="number"){A=B.dom.childNodes[A]}B.dom.insertBefore(C.getDomPositionEl().dom,A||null);C.container=B;this.configureItem(C,A)}}},configureItem:function(C,A){if(this.extraCls){var B=C.getPositionEl?C.getPositionEl():C;B.addClass(this.extraCls)}if(this.renderHidden&&C!=this.activeItem){C.hide()}if(C.doLayout){C.doLayout(false,this.forceLayout)}},onResize:function(){if(this.container.collapsed){return }var A=this.container.bufferResize;if(A){if(!this.resizeTask){this.resizeTask=new Ext.util.DelayedTask(this.runLayout,this);this.resizeBuffer=typeof A=="number"?A:100}this.resizeTask.delay(this.resizeBuffer)}else{this.runLayout()}},runLayout:function(){this.layout();this.container.onLayout()},setContainer:function(A){if(this.monitorResize&&A!=this.container){if(this.container){this.container.un("resize",this.onResize,this);this.container.un("bodyresize",this.onResize,this)}if(A){A.on({scope:this,resize:this.onResize,bodyresize:this.onResize})}}this.container=A},parseMargins:function(B){if(typeof B=="number"){B=B.toString()}var C=B.split(" ");var A=C.length;if(A==1){C[1]=C[0];C[2]=C[0];C[3]=C[0]}if(A==2){C[2]=C[0];C[3]=C[1]}if(A==3){C[3]=C[1]}return{top:parseInt(C[0],10)||0,right:parseInt(C[1],10)||0,bottom:parseInt(C[2],10)||0,left:parseInt(C[3],10)||0}},fieldTpl:(function(){var A=new Ext.Template('<div class="x-form-item {itemCls}" tabIndex="-1">','<label for="{id}" style="{labelStyle}" class="x-form-item-label">{label}{labelSeparator}</label>','<div class="x-form-element" id="x-form-el-{id}" style="{elementStyle}">','</div><div class="{clearCls}"></div>',"</div>");A.disableFormats=true;return A.compile()})(),destroy:Ext.emptyFn};Ext.Container.LAYOUTS.auto=Ext.layout.ContainerLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.FitLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,onLayout:function(A,C){Ext.layout.FitLayout.superclass.onLayout.call(this,A,C);if(!this.container.collapsed){var B=(Ext.isIE6&&Ext.isStrict&&C.dom==document.body)?C.getViewSize():C.getStyleSize();this.setItemSize(this.activeItem||A.items.itemAt(0),B)}},setItemSize:function(B,A){if(B&&A.height>0){B.setSize(A)}}});Ext.Container.LAYOUTS.fit=Ext.layout.FitLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.CardLayout=Ext.extend(Ext.layout.FitLayout,{deferredRender:false,layoutOnCardChange:false,renderHidden:true,constructor:function(A){Ext.layout.CardLayout.superclass.constructor.call(this,A);this.forceLayout=(this.deferredRender===false)},setActiveItem:function(A){A=this.container.getComponent(A);if(this.activeItem!=A){if(this.activeItem){this.activeItem.hide()}this.activeItem=A;A.show();this.container.doLayout();if(this.layoutOnCardChange&&A.doLayout){A.doLayout()}}},renderAll:function(A,B){if(this.deferredRender){this.renderItem(this.activeItem,undefined,B)}else{Ext.layout.CardLayout.superclass.renderAll.call(this,A,B)}}});Ext.Container.LAYOUTS.card=Ext.layout.CardLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.AnchorLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,getAnchorViewSize:function(A,B){return B.dom==document.body?B.getViewSize():B.getStyleSize()},onLayout:function(F,I){Ext.layout.AnchorLayout.superclass.onLayout.call(this,F,I);var O=this.getAnchorViewSize(F,I);var M=O.width,E=O.height;if(M<20&&E<20){return }var B,K;if(F.anchorSize){if(typeof F.anchorSize=="number"){B=F.anchorSize}else{B=F.anchorSize.width;K=F.anchorSize.height}}else{B=F.initialConfig.width;K=F.initialConfig.height}var H=F.items.items,G=H.length,D,J,L,C,A;for(D=0;D<G;D++){J=H[D];if(J.anchor){L=J.anchorSpec;if(!L){var N=J.anchor.split(" ");J.anchorSpec=L={right:this.parseAnchor(N[0],J.initialConfig.width,B),bottom:this.parseAnchor(N[1],J.initialConfig.height,K)}}C=L.right?this.adjustWidthAnchor(L.right(M),J):undefined;A=L.bottom?this.adjustHeightAnchor(L.bottom(E),J):undefined;if(C||A){J.setSize(C||undefined,A||undefined)}}}},parseAnchor:function(B,F,A){if(B&&B!="none"){var D;if(/^(r|right|b|bottom)$/i.test(B)){var E=A-F;return function(G){if(G!==D){D=G;return G-E}}}else{if(B.indexOf("%")!=-1){var C=parseFloat(B.replace("%",""))*0.01;return function(G){if(G!==D){D=G;return Math.floor(G*C)}}}else{B=parseInt(B,10);if(!isNaN(B)){return function(G){if(G!==D){D=G;return G+B}}}}}}return false},adjustWidthAnchor:function(B,A){return B},adjustHeightAnchor:function(B,A){return B}});Ext.Container.LAYOUTS.anchor=Ext.layout.AnchorLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.ColumnLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,extraCls:"x-column",scrollOffset:0,isValidParent:function(B,A){return(B.getPositionEl?B.getPositionEl():B.getEl()).dom.parentNode==this.innerCt.dom},onLayout:function(C,F){var D=C.items.items,E=D.length,G,A;if(!this.innerCt){F.addClass("x-column-layout-ct");this.innerCt=F.createChild({cls:"x-column-inner"});this.innerCt.createChild({cls:"x-clear"})}this.renderAll(C,this.innerCt);var J=Ext.isIE&&F.dom!=Ext.getBody().dom?F.getStyleSize():F.getViewSize();if(J.width<1&&J.height<1){return }var H=J.width-F.getPadding("lr")-this.scrollOffset,B=J.height-F.getPadding("tb"),I=H;this.innerCt.setWidth(H);for(A=0;A<E;A++){G=D[A];if(!G.columnWidth){I-=(G.getSize().width+G.getEl().getMargins("lr"))}}I=I<0?0:I;for(A=0;A<E;A++){G=D[A];if(G.columnWidth){G.setSize(Math.floor(G.columnWidth*I)-G.getEl().getMargins("lr"))}}}});Ext.Container.LAYOUTS.column=Ext.layout.ColumnLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.BorderLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,rendered:false,onLayout:function(B,X){var C;if(!this.rendered){X.addClass("x-border-layout-ct");var M=B.items.items;C=[];for(var Q=0,R=M.length;Q<R;Q++){var U=M[Q];var F=U.region;if(U.collapsed){C.push(U)}U.collapsed=false;if(!U.rendered){U.cls=U.cls?U.cls+" x-border-panel":"x-border-panel";U.render(X,Q)}this[F]=F!="center"&&U.split?new Ext.layout.BorderLayout.SplitRegion(this,U.initialConfig,F):new Ext.layout.BorderLayout.Region(this,U.initialConfig,F);this[F].render(X,U)}this.rendered=true}var L=X.getViewSize();if(L.width<20||L.height<20){if(C){this.restoreCollapsed=C}return }else{if(this.restoreCollapsed){C=this.restoreCollapsed;delete this.restoreCollapsed}}var J=L.width,S=L.height;var I=J,P=S,G=0,H=0;var N=this.north,K=this.south,E=this.west,T=this.east,U=this.center;if(!U&&Ext.layout.BorderLayout.WARN!==false){throw"No center region defined in BorderLayout "+B.id}if(N&&N.isVisible()){var W=N.getSize();var O=N.getMargins();W.width=J-(O.left+O.right);W.x=O.left;W.y=O.top;G=W.height+W.y+O.bottom;P-=G;N.applyLayout(W)}if(K&&K.isVisible()){var W=K.getSize();var O=K.getMargins();W.width=J-(O.left+O.right);W.x=O.left;var V=(W.height+O.top+O.bottom);W.y=S-V+O.top;P-=V;K.applyLayout(W)}if(E&&E.isVisible()){var W=E.getSize();var O=E.getMargins();W.height=P-(O.top+O.bottom);W.x=O.left;W.y=G+O.top;var A=(W.width+O.left+O.right);H+=A;I-=A;E.applyLayout(W)}if(T&&T.isVisible()){var W=T.getSize();var O=T.getMargins();W.height=P-(O.top+O.bottom);var A=(W.width+O.left+O.right);W.x=J-A+O.left;W.y=G+O.top;I-=A;T.applyLayout(W)}if(U){var O=U.getMargins();var D={x:H+O.left,y:G+O.top,width:I-(O.left+O.right),height:P-(O.top+O.bottom)};U.applyLayout(D)}if(C){for(var Q=0,R=C.length;Q<R;Q++){C[Q].collapse(false)}}if(Ext.isIE&&Ext.isStrict){X.repaint()}},destroy:function(){var B=["north","south","east","west"];for(var A=0;A<B.length;A++){var C=this[B[A]];if(C){if(C.destroy){C.destroy()}else{if(C.split){C.split.destroy(true)}}}}Ext.layout.BorderLayout.superclass.destroy.call(this)}});Ext.layout.BorderLayout.Region=function(B,A,C){Ext.apply(this,A);this.layout=B;this.position=C;this.state={};if(typeof this.margins=="string"){this.margins=this.layout.parseMargins(this.margins)}this.margins=Ext.applyIf(this.margins||{},this.defaultMargins);if(this.collapsible){if(typeof this.cmargins=="string"){this.cmargins=this.layout.parseMargins(this.cmargins)}if(this.collapseMode=="mini"&&!this.cmargins){this.cmargins={left:0,top:0,right:0,bottom:0}}else{this.cmargins=Ext.applyIf(this.cmargins||{},C=="north"||C=="south"?this.defaultNSCMargins:this.defaultEWCMargins)}}};Ext.layout.BorderLayout.Region.prototype={collapsible:false,split:false,floatable:true,minWidth:50,minHeight:50,defaultMargins:{left:0,top:0,right:0,bottom:0},defaultNSCMargins:{left:5,top:5,right:5,bottom:5},defaultEWCMargins:{left:5,top:0,right:5,bottom:0},floatingZIndex:100,isCollapsed:false,render:function(B,C){this.panel=C;C.el.enableDisplayMode();this.targetEl=B;this.el=C.el;var A=C.getState,D=this.position;C.getState=function(){return Ext.apply(A.call(C)||{},this.state)}.createDelegate(this);if(D!="center"){C.allowQueuedExpand=false;C.on({beforecollapse:this.beforeCollapse,collapse:this.onCollapse,beforeexpand:this.beforeExpand,expand:this.onExpand,hide:this.onHide,show:this.onShow,scope:this});if(this.collapsible||this.floatable){C.collapseEl="el";C.slideAnchor=this.getSlideAnchor()}if(C.tools&&C.tools.toggle){C.tools.toggle.addClass("x-tool-collapse-"+D);C.tools.toggle.addClassOnOver("x-tool-collapse-"+D+"-over")}}},getCollapsedEl:function(){if(!this.collapsedEl){if(!this.toolTemplate){var B=new Ext.Template('<div class="x-tool x-tool-{id}">&#160;</div>');B.disableFormats=true;B.compile();Ext.layout.BorderLayout.Region.prototype.toolTemplate=B}this.collapsedEl=this.targetEl.createChild({cls:"x-layout-collapsed x-layout-collapsed-"+this.position,id:this.panel.id+"-xcollapsed"});this.collapsedEl.enableDisplayMode("block");if(this.collapseMode=="mini"){this.collapsedEl.addClass("x-layout-cmini-"+this.position);this.miniCollapsedEl=this.collapsedEl.createChild({cls:"x-layout-mini x-layout-mini-"+this.position,html:"&#160;"});this.miniCollapsedEl.addClassOnOver("x-layout-mini-over");this.collapsedEl.addClassOnOver("x-layout-collapsed-over");this.collapsedEl.on("click",this.onExpandClick,this,{stopEvent:true})}else{if(this.collapsible!==false&&!this.hideCollapseTool){var A=this.toolTemplate.append(this.collapsedEl.dom,{id:"expand-"+this.position},true);A.addClassOnOver("x-tool-expand-"+this.position+"-over");A.on("click",this.onExpandClick,this,{stopEvent:true})}if(this.floatable!==false||this.titleCollapse){this.collapsedEl.addClassOnOver("x-layout-collapsed-over");this.collapsedEl.on("click",this[this.floatable?"collapseClick":"onExpandClick"],this)}}}return this.collapsedEl},onExpandClick:function(A){if(this.isSlid){this.afterSlideIn();this.panel.expand(false)}else{this.panel.expand()}},onCollapseClick:function(A){this.panel.collapse()},beforeCollapse:function(B,A){this.lastAnim=A;if(this.splitEl){this.splitEl.hide()}this.getCollapsedEl().show();this.panel.el.setStyle("z-index",100);this.isCollapsed=true;this.layout.layout()},onCollapse:function(A){this.panel.el.setStyle("z-index",1);if(this.lastAnim===false||this.panel.animCollapse===false){this.getCollapsedEl().dom.style.visibility="visible"}else{this.getCollapsedEl().slideIn(this.panel.slideAnchor,{duration:0.2})}this.state.collapsed=true;this.panel.saveState()},beforeExpand:function(A){var B=this.getCollapsedEl();this.el.show();if(this.position=="east"||this.position=="west"){this.panel.setSize(undefined,B.getHeight())}else{this.panel.setSize(B.getWidth(),undefined)}B.hide();B.dom.style.visibility="hidden";this.panel.el.setStyle("z-index",this.floatingZIndex)},onExpand:function(){this.isCollapsed=false;if(this.splitEl){this.splitEl.show()}this.layout.layout();this.panel.el.setStyle("z-index",1);this.state.collapsed=false;this.panel.saveState()},collapseClick:function(A){if(this.isSlid){A.stopPropagation();this.slideIn()}else{A.stopPropagation();this.slideOut()}},onHide:function(){if(this.isCollapsed){this.getCollapsedEl().hide()}else{if(this.splitEl){this.splitEl.hide()}}},onShow:function(){if(this.isCollapsed){this.getCollapsedEl().show()}else{if(this.splitEl){this.splitEl.show()}}},isVisible:function(){return !this.panel.hidden},getMargins:function(){return this.isCollapsed&&this.cmargins?this.cmargins:this.margins},getSize:function(){return this.isCollapsed?this.getCollapsedEl().getSize():this.panel.getSize()},setPanel:function(A){this.panel=A},getMinWidth:function(){return this.minWidth},getMinHeight:function(){return this.minHeight},applyLayoutCollapsed:function(A){var B=this.getCollapsedEl();B.setLeftTop(A.x,A.y);B.setSize(A.width,A.height)},applyLayout:function(A){if(this.isCollapsed){this.applyLayoutCollapsed(A)}else{this.panel.setPosition(A.x,A.y);this.panel.setSize(A.width,A.height)}},beforeSlide:function(){this.panel.beforeEffect()},afterSlide:function(){this.panel.afterEffect()},initAutoHide:function(){if(this.autoHide!==false){if(!this.autoHideHd){var A=new Ext.util.DelayedTask(this.slideIn,this);this.autoHideHd={mouseout:function(B){if(!B.within(this.el,true)){A.delay(500)}},mouseover:function(B){A.cancel()},scope:this}}this.el.on(this.autoHideHd)}},clearAutoHide:function(){if(this.autoHide!==false){this.el.un("mouseout",this.autoHideHd.mouseout);this.el.un("mouseover",this.autoHideHd.mouseover)}},clearMonitor:function(){Ext.getDoc().un("click",this.slideInIf,this)},slideOut:function(){if(this.isSlid||this.el.hasActiveFx()){return }this.isSlid=true;var A=this.panel.tools;if(A&&A.toggle){A.toggle.hide()}this.el.show();if(this.position=="east"||this.position=="west"){this.panel.setSize(undefined,this.collapsedEl.getHeight())}else{this.panel.setSize(this.collapsedEl.getWidth(),undefined)}this.restoreLT=[this.el.dom.style.left,this.el.dom.style.top];this.el.alignTo(this.collapsedEl,this.getCollapseAnchor());this.el.setStyle("z-index",this.floatingZIndex+2);this.panel.el.replaceClass("x-panel-collapsed","x-panel-floating");if(this.animFloat!==false){this.beforeSlide();this.el.slideIn(this.getSlideAnchor(),{callback:function(){this.afterSlide();this.initAutoHide();Ext.getDoc().on("click",this.slideInIf,this)},scope:this,block:true})}else{this.initAutoHide();Ext.getDoc().on("click",this.slideInIf,this)}},afterSlideIn:function(){this.clearAutoHide();this.isSlid=false;this.clearMonitor();this.el.setStyle("z-index","");this.panel.el.replaceClass("x-panel-floating","x-panel-collapsed");this.el.dom.style.left=this.restoreLT[0];this.el.dom.style.top=this.restoreLT[1];var A=this.panel.tools;if(A&&A.toggle){A.toggle.show()}},slideIn:function(A){if(!this.isSlid||this.el.hasActiveFx()){Ext.callback(A);return }this.isSlid=false;if(this.animFloat!==false){this.beforeSlide();this.el.slideOut(this.getSlideAnchor(),{callback:function(){this.el.hide();this.afterSlide();this.afterSlideIn();Ext.callback(A)},scope:this,block:true})}else{this.el.hide();this.afterSlideIn()}},slideInIf:function(A){if(!A.within(this.el)){this.slideIn()}},anchors:{west:"left",east:"right",north:"top",south:"bottom"},sanchors:{west:"l",east:"r",north:"t",south:"b"},canchors:{west:"tl-tr",east:"tr-tl",north:"tl-bl",south:"bl-tl"},getAnchor:function(){return this.anchors[this.position]},getCollapseAnchor:function(){return this.canchors[this.position]},getSlideAnchor:function(){return this.sanchors[this.position]},getAlignAdj:function(){var A=this.cmargins;switch(this.position){case"west":return[0,0];break;case"east":return[0,0];break;case"north":return[0,0];break;case"south":return[0,0];break}},getExpandAdj:function(){var B=this.collapsedEl,A=this.cmargins;switch(this.position){case"west":return[-(A.right+B.getWidth()+A.left),0];break;case"east":return[A.right+B.getWidth()+A.left,0];break;case"north":return[0,-(A.top+A.bottom+B.getHeight())];break;case"south":return[0,A.top+A.bottom+B.getHeight()];break}}};Ext.layout.BorderLayout.SplitRegion=function(B,A,C){Ext.layout.BorderLayout.SplitRegion.superclass.constructor.call(this,B,A,C);this.applyLayout=this.applyFns[C]};Ext.extend(Ext.layout.BorderLayout.SplitRegion,Ext.layout.BorderLayout.Region,{splitTip:"Drag to resize.",collapsibleSplitTip:"Drag to resize. Double click to hide.",useSplitTips:false,splitSettings:{north:{orientation:Ext.SplitBar.VERTICAL,placement:Ext.SplitBar.TOP,maxFn:"getVMaxSize",minProp:"minHeight",maxProp:"maxHeight"},south:{orientation:Ext.SplitBar.VERTICAL,placement:Ext.SplitBar.BOTTOM,maxFn:"getVMaxSize",minProp:"minHeight",maxProp:"maxHeight"},east:{orientation:Ext.SplitBar.HORIZONTAL,placement:Ext.SplitBar.RIGHT,maxFn:"getHMaxSize",minProp:"minWidth",maxProp:"maxWidth"},west:{orientation:Ext.SplitBar.HORIZONTAL,placement:Ext.SplitBar.LEFT,maxFn:"getHMaxSize",minProp:"minWidth",maxProp:"maxWidth"}},applyFns:{west:function(C){if(this.isCollapsed){return this.applyLayoutCollapsed(C)}var D=this.splitEl.dom,B=D.style;this.panel.setPosition(C.x,C.y);var A=D.offsetWidth;B.left=(C.x+C.width-A)+"px";B.top=(C.y)+"px";B.height=Math.max(0,C.height)+"px";this.panel.setSize(C.width-A,C.height)},east:function(C){if(this.isCollapsed){return this.applyLayoutCollapsed(C)}var D=this.splitEl.dom,B=D.style;var A=D.offsetWidth;this.panel.setPosition(C.x+A,C.y);B.left=(C.x)+"px";B.top=(C.y)+"px";B.height=Math.max(0,C.height)+"px";this.panel.setSize(C.width-A,C.height)},north:function(C){if(this.isCollapsed){return this.applyLayoutCollapsed(C)}var D=this.splitEl.dom,B=D.style;var A=D.offsetHeight;this.panel.setPosition(C.x,C.y);B.left=(C.x)+"px";B.top=(C.y+C.height-A)+"px";B.width=Math.max(0,C.width)+"px";this.panel.setSize(C.width,C.height-A)},south:function(C){if(this.isCollapsed){return this.applyLayoutCollapsed(C)}var D=this.splitEl.dom,B=D.style;var A=D.offsetHeight;this.panel.setPosition(C.x,C.y+A);B.left=(C.x)+"px";B.top=(C.y)+"px";B.width=Math.max(0,C.width)+"px";this.panel.setSize(C.width,C.height-A)}},render:function(A,C){Ext.layout.BorderLayout.SplitRegion.superclass.render.call(this,A,C);var D=this.position;this.splitEl=A.createChild({cls:"x-layout-split x-layout-split-"+D,html:"&#160;",id:this.panel.id+"-xsplit"});if(this.collapseMode=="mini"){this.miniSplitEl=this.splitEl.createChild({cls:"x-layout-mini x-layout-mini-"+D,html:"&#160;"});this.miniSplitEl.addClassOnOver("x-layout-mini-over");this.miniSplitEl.on("click",this.onCollapseClick,this,{stopEvent:true})}var B=this.splitSettings[D];this.split=new Ext.SplitBar(this.splitEl.dom,C.el,B.orientation);this.split.tickSize=this.tickSize;this.split.placement=B.placement;this.split.getMaximumSize=this[B.maxFn].createDelegate(this);this.split.minSize=this.minSize||this[B.minProp];this.split.on("beforeapply",this.onSplitMove,this);this.split.useShim=this.useShim===true;this.maxSize=this.maxSize||this[B.maxProp];if(C.hidden){this.splitEl.hide()}if(this.useSplitTips){this.splitEl.dom.title=this.collapsible?this.collapsibleSplitTip:this.splitTip}if(this.collapsible){this.splitEl.on("dblclick",this.onCollapseClick,this)}},getSize:function(){if(this.isCollapsed){return this.collapsedEl.getSize()}var A=this.panel.getSize();if(this.position=="north"||this.position=="south"){A.height+=this.splitEl.dom.offsetHeight}else{A.width+=this.splitEl.dom.offsetWidth}return A},getHMaxSize:function(){var B=this.maxSize||10000;var A=this.layout.center;return Math.min(B,(this.el.getWidth()+A.el.getWidth())-A.getMinWidth())},getVMaxSize:function(){var B=this.maxSize||10000;var A=this.layout.center;return Math.min(B,(this.el.getHeight()+A.el.getHeight())-A.getMinHeight())},onSplitMove:function(B,A){var C=this.panel.getSize();this.lastSplitSize=A;if(this.position=="north"||this.position=="south"){this.panel.setSize(C.width,A);this.state.height=A}else{this.panel.setSize(A,C.height);this.state.width=A}this.layout.layout();this.panel.saveState();return false},getSplitBar:function(){return this.split},destroy:function(){Ext.destroy(this.miniSplitEl,this.split,this.splitEl)}});Ext.Container.LAYOUTS.border=Ext.layout.BorderLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.FormLayout=Ext.extend(Ext.layout.AnchorLayout,{labelSeparator:":",setContainer:function(A){Ext.layout.FormLayout.superclass.setContainer.call(this,A);if(A.labelAlign){A.addClass("x-form-label-"+A.labelAlign)}if(A.hideLabels){this.labelStyle="display:none";this.elementStyle="padding-left:0;";this.labelAdjust=0}else{this.labelSeparator=A.labelSeparator||this.labelSeparator;A.labelWidth=A.labelWidth||100;if(typeof A.labelWidth=="number"){var B=(typeof A.labelPad=="number"?A.labelPad:5);this.labelAdjust=A.labelWidth+B;this.labelStyle="width:"+A.labelWidth+"px;";this.elementStyle="padding-left:"+(A.labelWidth+B)+"px"}if(A.labelAlign=="top"){this.labelStyle="width:auto;";this.labelAdjust=0;this.elementStyle="padding-left:0;"}}},getLabelStyle:function(E){var B="",C=[this.labelStyle,E];for(var D=0,A=C.length;D<A;++D){if(C[D]){B+=C[D];if(B.substr(-1,1)!=";"){B+=";"}}}return B},renderItem:function(D,A,C){if(D&&!D.rendered&&(D.isFormField||D.fieldLabel)&&D.inputType!="hidden"){var B=this.getTemplateArgs(D);if(typeof A=="number"){A=C.dom.childNodes[A]||null}if(A){this.fieldTpl.insertBefore(A,B)}else{this.fieldTpl.append(C,B)}D.render("x-form-el-"+D.id)}else{Ext.layout.FormLayout.superclass.renderItem.apply(this,arguments)}},getTemplateArgs:function(B){var A=!B.fieldLabel||B.hideLabel;return{id:B.id,label:B.fieldLabel,labelStyle:B.labelStyle||this.labelStyle||"",elementStyle:this.elementStyle||"",labelSeparator:A?"":(typeof B.labelSeparator=="undefined"?this.labelSeparator:B.labelSeparator),itemCls:(B.itemCls||this.container.itemCls||"")+(B.hideLabel?" x-hide-label":""),clearCls:B.clearCls||"x-form-clear-left"}},adjustWidthAnchor:function(B,A){return B-(A.isFormField||A.fieldLabel?(A.hideLabel?0:this.labelAdjust):0)},isValidParent:function(B,A){return true}});Ext.Container.LAYOUTS.form=Ext.layout.FormLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.AccordionLayout=Ext.extend(Ext.layout.FitLayout,{fill:true,autoWidth:true,titleCollapse:true,hideCollapseTool:false,collapseFirst:false,animate:false,sequence:false,activeOnTop:false,renderItem:function(A){if(this.animate===false){A.animCollapse=false}A.collapsible=true;if(this.autoWidth){A.autoWidth=true}if(this.titleCollapse){A.titleCollapse=true}if(this.hideCollapseTool){A.hideCollapseTool=true}if(this.collapseFirst!==undefined){A.collapseFirst=this.collapseFirst}if(!this.activeItem&&!A.collapsed){this.activeItem=A}else{if(this.activeItem&&this.activeItem!=A){A.collapsed=true}}Ext.layout.AccordionLayout.superclass.renderItem.apply(this,arguments);A.header.addClass("x-accordion-hd");A.on("beforeexpand",this.beforeExpand,this)},beforeExpand:function(C,B){var A=this.activeItem;if(A){if(this.sequence){delete this.activeItem;if(!A.collapsed){A.collapse({callback:function(){C.expand(B||true)},scope:this});return false}}else{A.collapse(this.animate)}}this.activeItem=C;if(this.activeOnTop){C.el.dom.parentNode.insertBefore(C.el.dom,C.el.dom.parentNode.firstChild)}this.layout()},setItemSize:function(C,B){if(this.fill&&C){var A=0;this.container.items.each(function(D){if(D!=C){A+=D.header.getHeight()}});B.height-=A;C.setSize(B)}},setActiveItem:function(A){A=this.container.getComponent(A);if(this.activeItem!=A){if(A.rendered&&A.collapsed){A.expand()}else{this.activeItem=A}}}});Ext.Container.LAYOUTS.accordion=Ext.layout.AccordionLayout;Ext.layout.Accordion=Ext.layout.AccordionLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.TableLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:false,tableAttrs:null,setContainer:function(A){Ext.layout.TableLayout.superclass.setContainer.call(this,A);this.currentRow=0;this.currentColumn=0;this.cells=[]},onLayout:function(C,E){var D=C.items.items,A=D.length,F,B;if(!this.table){E.addClass("x-table-layout-ct");this.table=E.createChild(Ext.apply({tag:"table",cls:"x-table-layout",cellspacing:0,cn:{tag:"tbody"}},this.tableAttrs),null,true)}this.renderAll(C,E)},getRow:function(A){var B=this.table.tBodies[0].childNodes[A];if(!B){B=document.createElement("tr");this.table.tBodies[0].appendChild(B)}return B},getNextCell:function(H){var A=this.getNextNonSpan(this.currentColumn,this.currentRow);var E=this.currentColumn=A[0],D=this.currentRow=A[1];for(var G=D;G<D+(H.rowspan||1);G++){if(!this.cells[G]){this.cells[G]=[]}for(var C=E;C<E+(H.colspan||1);C++){this.cells[G][C]=true}}var F=document.createElement("td");if(H.cellId){F.id=H.cellId}var B="x-table-layout-cell";if(H.cellCls){B+=" "+H.cellCls}F.className=B;if(H.colspan){F.colSpan=H.colspan}if(H.rowspan){F.rowSpan=H.rowspan}this.getRow(D).appendChild(F);return F},getNextNonSpan:function(A,C){var B=this.columns;while((B&&A>=B)||(this.cells[C]&&this.cells[C][A])){if(B&&A>=B){C++;A=0}else{A++}}return[A,C]},renderItem:function(D,A,C){if(D&&!D.rendered){D.render(this.getNextCell(D));if(this.extraCls){var B=D.getPositionEl?D.getPositionEl():D;B.addClass(this.extraCls)}}},isValidParent:function(B,A){return true}});Ext.Container.LAYOUTS.table=Ext.layout.TableLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.AbsoluteLayout=Ext.extend(Ext.layout.AnchorLayout,{extraCls:"x-abs-layout-item",onLayout:function(A,B){B.position();this.paddingLeft=B.getPadding("l");this.paddingTop=B.getPadding("t");Ext.layout.AbsoluteLayout.superclass.onLayout.call(this,A,B)},adjustWidthAnchor:function(B,A){return B?B-A.getPosition(true)[0]+this.paddingLeft:B},adjustHeightAnchor:function(B,A){return B?B-A.getPosition(true)[1]+this.paddingTop:B}});Ext.Container.LAYOUTS.absolute=Ext.layout.AbsoluteLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.BoxLayout=Ext.extend(Ext.layout.ContainerLayout,{defaultMargins:{left:0,top:0,right:0,bottom:0},padding:"0",pack:"start",monitorResize:true,scrollOffset:0,extraCls:"x-box-item",ctCls:"x-box-layout-ct",innerCls:"x-box-inner",isValidParent:function(B,A){return B.getEl().dom.parentNode==this.innerCt.dom},onLayout:function(D,G){var E=D.items.items,B=E.length,H,C,F=B-1,A;if(!this.innerCt){G.addClass(this.ctCls);this.innerCt=G.createChild({cls:this.innerCls});this.padding=this.parseMargins(this.padding)}this.renderAll(D,this.innerCt)},renderItem:function(A){if(typeof A.margins=="string"){A.margins=this.parseMargins(A.margins)}else{if(!A.margins){A.margins=this.defaultMargins}}Ext.layout.BoxLayout.superclass.renderItem.apply(this,arguments)},getTargetSize:function(A){return(Ext.isIE6&&Ext.isStrict&&A.dom==document.body)?A.getStyleSize():A.getViewSize()},getItems:function(B){var A=[];B.items.each(function(C){if(C.isVisible()){A.push(C)}});return A}});Ext.layout.VBoxLayout=Ext.extend(Ext.layout.BoxLayout,{align:"left",onLayout:function(E,Z){Ext.layout.VBoxLayout.superclass.onLayout.call(this,E,Z);var F=this.getItems(E),H,J,N,O=this.getTargetSize(Z),I=O.width-Z.getPadding("lr")-this.scrollOffset,T=O.height-Z.getPadding("tb"),P=this.padding.left,K=this.padding.top,G=this.pack=="start",R=["stretch","stretchmax"].indexOf(this.align)==-1,W=I-(this.padding.left+this.padding.right),L=0,V=0,Q=0,X=0,D=0;Ext.each(F,function(a){H=a.margins;Q+=a.flex||0;J=a.getHeight();N=H.top+H.bottom;L+=J+N;X+=N+(a.flex?0:J);V=Math.max(V,a.getWidth()+H.left+H.right)});L=T-L-this.padding.top-this.padding.bottom;var A=V+this.padding.left+this.padding.right;switch(this.align){case"stretch":this.innerCt.setSize(I,T);break;case"stretchmax":case"left":this.innerCt.setSize(A,T);break;case"center":this.innerCt.setSize(I=Math.max(I,A),T);break}var C=Math.max(0,T-this.padding.top-this.padding.bottom-X),Y=C,U=[],S=[],M=0,B=Math.max(0,I-this.padding.left-this.padding.right);Ext.each(F,function(a){if(G&&a.flex){J=Math.floor(C*(a.flex/Q));Y-=J;U.push(J)}});if(this.pack=="center"){K+=L?L/2:0}else{if(this.pack=="end"){K+=L}}Ext.each(F,function(a){H=a.margins;K+=H.top;a.setPosition(P+H.left,K);if(G&&a.flex){J=Math.max(0,U[M++]+(Y-->0?1:0));if(R){S.push(a.getWidth())}a.setSize(B,J)}else{J=a.getHeight()}K+=J+H.bottom});M=0;Ext.each(F,function(b){H=b.margins;if(this.align=="stretch"){b.setWidth((W-(H.left+H.right)).constrain(b.minWidth||0,b.maxWidth||1000000))}else{if(this.align=="stretchmax"){b.setWidth((V-(H.left+H.right)).constrain(b.minWidth||0,b.maxWidth||1000000))}else{if(this.align=="center"){var a=B-(b.getWidth()+H.left+H.right);if(a>0){b.setPosition(P+H.left+(a/2),b.y)}}if(G&&b.flex){b.setWidth(S[M++])}}}},this)}});Ext.Container.LAYOUTS.vbox=Ext.layout.VBoxLayout;Ext.layout.HBoxLayout=Ext.extend(Ext.layout.BoxLayout,{align:"top",onLayout:function(D,Z){Ext.layout.HBoxLayout.superclass.onLayout.call(this,D,Z);var E=this.getItems(D),H,C,N,O=this.getTargetSize(Z),J=O.width-Z.getPadding("lr")-this.scrollOffset,W=O.height-Z.getPadding("tb"),Q=this.padding.left,L=this.padding.top,G=this.pack=="start",U=["stretch","stretchmax"].indexOf(this.align)==-1,K=W-(this.padding.top+this.padding.bottom),X=0,P=0,R=0,B=0,F=0;Ext.each(E,function(a){H=a.margins;R+=a.flex||0;C=a.getWidth();N=H.left+H.right;X+=C+N;B+=N+(a.flex?0:C);P=Math.max(P,a.getHeight()+H.top+H.bottom)});X=J-X-this.padding.left-this.padding.right;var T=P+this.padding.top+this.padding.bottom;switch(this.align){case"stretch":this.innerCt.setSize(J,W);break;case"stretchmax":case"top":this.innerCt.setSize(J,T);break;case"middle":this.innerCt.setSize(J,W=Math.max(W,T));break}var S=Math.max(0,J-this.padding.left-this.padding.right-B),Y=S,I=[],V=[],M=0,A=Math.max(0,W-this.padding.top-this.padding.bottom);Ext.each(E,function(a){if(G&&a.flex){C=Math.floor(S*(a.flex/R));Y-=C;I.push(C)}});if(this.pack=="center"){Q+=X?X/2:0}else{if(this.pack=="end"){Q+=X}}Ext.each(E,function(a){H=a.margins;Q+=H.left;a.setPosition(Q,L+H.top);if(G&&a.flex){C=Math.max(0,I[M++]+(Y-->0?1:0));if(U){V.push(a.getHeight())}a.setSize(C,A)}else{C=a.getWidth()}Q+=C+H.right});M=0;Ext.each(E,function(d){var a=d.margins;if(this.align=="stretch"){d.setHeight((K-(a.top+a.bottom)).constrain(d.minHeight||0,d.maxHeight||1000000))}else{if(this.align=="stretchmax"){d.setHeight((P-(a.top+a.bottom)).constrain(d.minHeight||0,d.maxHeight||1000000))}else{if(this.align=="middle"){var b=A-(d.getHeight()+a.top+a.bottom);if(b>0){d.setPosition(d.x,L+a.top+(b/2))}}if(G&&d.flex){d.setHeight(V[M++])}}}},this)}});Ext.Container.LAYOUTS.hbox=Ext.layout.HBoxLayout;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Viewport=Ext.extend(Ext.Container,{initComponent:function(){Ext.Viewport.superclass.initComponent.call(this);document.getElementsByTagName("html")[0].className+=" x-viewport";this.el=Ext.getBody();this.el.setHeight=Ext.emptyFn;this.el.setWidth=Ext.emptyFn;this.el.setSize=Ext.emptyFn;this.el.dom.scroll="no";this.allowDomMove=false;this.autoWidth=true;this.autoHeight=true;Ext.EventManager.onWindowResize(this.fireResize,this);this.renderTo=this.el},fireResize:function(A,B){this.fireEvent("resize",this,A,B,A,B)}});Ext.reg("viewport",Ext.Viewport);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Panel=Ext.extend(Ext.Container,{baseCls:"x-panel",collapsedCls:"x-panel-collapsed",maskDisabled:true,animCollapse:Ext.enableFx,headerAsText:true,buttonAlign:"right",collapsed:false,collapseFirst:true,minButtonWidth:75,elements:"body",preventBodyReset:false,toolTarget:"header",collapseEl:"bwrap",slideAnchor:"t",disabledClass:"",deferHeight:true,expandDefaults:{duration:0.25},collapseDefaults:{duration:0.25},initComponent:function(){Ext.Panel.superclass.initComponent.call(this);this.addEvents("bodyresize","titlechange","iconchange","collapse","expand","beforecollapse","beforeexpand","beforeclose","close","activate","deactivate");if(this.unstyled){this.baseCls="x-plain"}if(this.tbar){this.elements+=",tbar";if(Ext.isObject(this.tbar)){this.topToolbar=this.tbar}delete this.tbar}if(this.bbar){this.elements+=",bbar";if(Ext.isObject(this.bbar)){this.bottomToolbar=this.bbar}delete this.bbar}if(this.header===true){this.elements+=",header";delete this.header}else{if(this.headerCfg||(this.title&&this.header!==false)){this.elements+=",header"}}if(this.footerCfg||this.footer===true){this.elements+=",footer";delete this.footer}if(this.buttons){this.elements+=",footer";var C=this.buttons;this.buttons=[];for(var B=0,A=C.length;B<A;B++){if(C[B].render){this.buttons.push(C[B])}else{if(C[B].xtype){this.buttons.push(Ext.create(C[B],"button"))}else{this.addButton(C[B])}}}}if(this.fbar){this.elements+=",footer"}if(this.autoLoad){this.on("render",this.doAutoLoad,this,{delay:10})}},createElement:function(A,C){if(this[A]){C.appendChild(this[A].dom);return }if(A==="bwrap"||this.elements.indexOf(A)!=-1){if(this[A+"Cfg"]){this[A]=Ext.fly(C).createChild(this[A+"Cfg"])}else{var B=document.createElement("div");B.className=this[A+"Cls"];this[A]=Ext.get(C.appendChild(B))}if(this[A+"CssClass"]){this[A].addClass(this[A+"CssClass"])}if(this[A+"Style"]){this[A].applyStyles(this[A+"Style"])}}},onRender:function(E,D){Ext.Panel.superclass.onRender.call(this,E,D);this.createClasses();var A=this.el,G=A.dom,I;A.addClass(this.baseCls);if(G.firstChild){this.header=A.down("."+this.headerCls);this.bwrap=A.down("."+this.bwrapCls);var H=this.bwrap?this.bwrap:A;this.tbar=H.down("."+this.tbarCls);this.body=H.down("."+this.bodyCls);this.bbar=H.down("."+this.bbarCls);this.footer=H.down("."+this.footerCls);this.fromMarkup=true}if(this.preventBodyReset===true){A.addClass("x-panel-reset")}if(this.cls){A.addClass(this.cls)}if(this.buttons){this.elements+=",footer"}if(this.frame){A.insertHtml("afterBegin",String.format(Ext.Element.boxMarkup,this.baseCls));this.createElement("header",G.firstChild.firstChild.firstChild);this.createElement("bwrap",G);I=this.bwrap.dom;var C=G.childNodes[1],B=G.childNodes[2];I.appendChild(C);I.appendChild(B);var J=I.firstChild.firstChild.firstChild;this.createElement("tbar",J);this.createElement("body",J);this.createElement("bbar",J);this.createElement("footer",I.lastChild.firstChild.firstChild);if(!this.footer){this.bwrap.dom.lastChild.className+=" x-panel-nofooter"}}else{this.createElement("header",G);this.createElement("bwrap",G);I=this.bwrap.dom;this.createElement("tbar",I);this.createElement("body",I);this.createElement("bbar",I);this.createElement("footer",I);if(!this.header){this.body.addClass(this.bodyCls+"-noheader");if(this.tbar){this.tbar.addClass(this.tbarCls+"-noheader")}}}if(this.padding!==undefined){this.body.setStyle("padding",this.body.addUnits(this.padding))}if(this.border===false){this.el.addClass(this.baseCls+"-noborder");this.body.addClass(this.bodyCls+"-noborder");if(this.header){this.header.addClass(this.headerCls+"-noborder")}if(this.footer){this.footer.addClass(this.footerCls+"-noborder")}if(this.tbar){this.tbar.addClass(this.tbarCls+"-noborder")}if(this.bbar){this.bbar.addClass(this.bbarCls+"-noborder")}}if(this.bodyBorder===false){this.body.addClass(this.bodyCls+"-noborder")}this.bwrap.enableDisplayMode("block");if(this.header){this.header.unselectable();if(this.headerAsText){this.header.dom.innerHTML='<span class="'+this.headerTextCls+'">'+this.header.dom.innerHTML+"</span>";if(this.iconCls){this.setIconClass(this.iconCls)}}}if(this.floating){this.makeFloating(this.floating)}if(this.collapsible){this.tools=this.tools?this.tools.slice(0):[];if(!this.hideCollapseTool){this.tools[this.collapseFirst?"unshift":"push"]({id:"toggle",handler:this.toggleCollapse,scope:this})}if(this.titleCollapse&&this.header){this.mon(this.header,"click",this.toggleCollapse,this);this.header.setStyle("cursor","pointer")}}if(this.tools){var F=this.tools;this.tools={};this.addTool.apply(this,F)}else{this.tools={}}if(this.buttons&&this.buttons.length>0){this.fbar=new Ext.Toolbar({items:this.buttons,toolbarCls:"x-panel-fbar"})}this.toolbars=[];if(this.fbar){this.fbar=Ext.create(this.fbar,"toolbar");this.fbar.enableOverflow=false;if(this.fbar.items){this.fbar.items.each(function(L){L.minWidth=L.minWidth||this.minButtonWidth},this)}this.fbar.toolbarCls="x-panel-fbar";var K=this.footer.createChild({cls:"x-panel-btns x-panel-btns-"+this.buttonAlign});this.fbar.ownerCt=this;this.fbar.render(K);K.createChild({cls:"x-clear"});this.toolbars.push(this.fbar)}if(this.tbar&&this.topToolbar){if(Ext.isArray(this.topToolbar)){this.topToolbar=new Ext.Toolbar(this.topToolbar)}else{if(!this.topToolbar.events){this.topToolbar=Ext.create(this.topToolbar,"toolbar")}}this.topToolbar.ownerCt=this;this.topToolbar.render(this.tbar);this.toolbars.push(this.topToolbar)}if(this.bbar&&this.bottomToolbar){if(Ext.isArray(this.bottomToolbar)){this.bottomToolbar=new Ext.Toolbar(this.bottomToolbar)}else{if(!this.bottomToolbar.events){this.bottomToolbar=Ext.create(this.bottomToolbar,"toolbar")}}this.bottomToolbar.ownerCt=this;this.bottomToolbar.render(this.bbar);this.toolbars.push(this.bottomToolbar)}Ext.each(this.toolbars,function(L){L.on({scope:this,afterlayout:this.syncHeight,remove:this.syncHeight})},this)},setIconClass:function(B){var A=this.iconCls;this.iconCls=B;if(this.rendered&&this.header){if(this.frame){this.header.addClass("x-panel-icon");this.header.replaceClass(A,this.iconCls)}else{var D=this.header.dom;var C=D.firstChild&&String(D.firstChild.tagName).toLowerCase()=="img"?D.firstChild:null;if(C){Ext.fly(C).replaceClass(A,this.iconCls)}else{Ext.DomHelper.insertBefore(D.firstChild,{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-panel-inline-icon "+this.iconCls})}}}this.fireEvent("iconchange",this,B,A)},makeFloating:function(A){this.floating=true;this.el=new Ext.Layer(Ext.isObject(A)?A:{shadow:this.shadow!==undefined?this.shadow:"sides",shadowOffset:this.shadowOffset,constrain:false,shim:this.shim===false?false:undefined},this.el)},getTopToolbar:function(){return this.topToolbar},getBottomToolbar:function(){return this.bottomToolbar},addButton:function(A,D,C){var E={handler:D,scope:C,minWidth:this.minButtonWidth,hideParent:true};if(typeof A=="string"){E.text=A}else{Ext.apply(E,A)}var B=new Ext.Button(E);if(!this.buttons){this.buttons=[]}this.buttons.push(B);return B},addTool:function(){if(!this[this.toolTarget]){return }if(!this.toolTemplate){var F=new Ext.Template('<div class="x-tool x-tool-{id}">&#160;</div>');F.disableFormats=true;F.compile();Ext.Panel.prototype.toolTemplate=F}for(var E=0,C=arguments,B=C.length;E<B;E++){var A=C[E];if(!this.tools[A.id]){var G="x-tool-"+A.id+"-over";var D=this.toolTemplate.insertFirst((A.align!=="left")?this[this.toolTarget]:this[this.toolTarget].child("span"),A,true);this.tools[A.id]=D;D.enableDisplayMode("block");this.mon(D,"click",this.createToolHandler(D,A,G,this));if(A.on){this.mon(D,A.on)}if(A.hidden){D.hide()}if(A.qtip){if(Ext.isObject(A.qtip)){Ext.QuickTips.register(Ext.apply({target:D.id},A.qtip))}else{D.dom.qtip=A.qtip}}D.addClassOnOver(G)}}},onLayout:function(){if(this.toolbars.length>0){this.duringLayout=true;Ext.each(this.toolbars,function(A){A.doLayout()});delete this.duringLayout;this.syncHeight()}},syncHeight:function(){if(!(this.autoHeight||this.duringLayout)){var D=this.lastSize;if(D&&!Ext.isEmpty(D.height)){var B=D.height,C=this.el.getHeight();if(B!="auto"&&B!=C){var E=this.body,A=E.getHeight();C=Math.max(A+B-C,0);if(A>0&&A!=C){E.setHeight(C);if(Ext.isIE&&C<=0){return }var F=E.getSize();this.fireEvent("bodyresize",F.width,F.height)}}}}},onShow:function(){if(this.floating){return this.el.show()}Ext.Panel.superclass.onShow.call(this)},onHide:function(){if(this.floating){return this.el.hide()}Ext.Panel.superclass.onHide.call(this)},createToolHandler:function(C,A,D,B){return function(E){C.removeClass(D);if(A.stopEvent!==false){E.stopEvent()}if(A.handler){A.handler.call(A.scope||C,E,C,B,A)}}},afterRender:function(){if(this.floating&&!this.hidden){this.el.show()}if(this.title){this.setTitle(this.title)}this.setAutoScroll();if(this.html){this.body.update(Ext.isObject(this.html)?Ext.DomHelper.markup(this.html):this.html);delete this.html}if(this.contentEl){var A=Ext.getDom(this.contentEl);Ext.fly(A).removeClass(["x-hidden","x-hide-display"]);this.body.dom.appendChild(A)}if(this.collapsed){this.collapsed=false;this.collapse(false)}Ext.Panel.superclass.afterRender.call(this);this.initEvents()},setAutoScroll:function(){if(this.rendered&&this.autoScroll){var A=this.body||this.el;if(A){A.setOverflow("auto")}}},getKeyMap:function(){if(!this.keyMap){this.keyMap=new Ext.KeyMap(this.el,this.keys)}return this.keyMap},initEvents:function(){if(this.keys){this.getKeyMap()}if(this.draggable){this.initDraggable()}},initDraggable:function(){this.dd=new Ext.Panel.DD(this,typeof this.draggable=="boolean"?null:this.draggable)},beforeEffect:function(){if(this.floating){this.el.beforeAction()}this.el.addClass("x-panel-animated")},afterEffect:function(){this.syncShadow();this.el.removeClass("x-panel-animated")},createEffect:function(B,A,C){var D={scope:C,block:true};if(B===true){D.callback=A;return D}else{if(!B.callback){D.callback=A}else{D.callback=function(){A.call(C);Ext.callback(B.callback,B.scope)}}}return Ext.applyIf(D,B)},collapse:function(B){if(this.collapsed||this.el.hasFxBlock()||this.fireEvent("beforecollapse",this,B)===false){return }var A=B===true||(B!==false&&this.animCollapse);this.beforeEffect();this.onCollapse(A,B);return this},onCollapse:function(A,B){if(A){this[this.collapseEl].slideOut(this.slideAnchor,Ext.apply(this.createEffect(B||true,this.afterCollapse,this),this.collapseDefaults))}else{this[this.collapseEl].hide();this.afterCollapse()}},afterCollapse:function(){this.collapsed=true;this.el.addClass(this.collapsedCls);this.afterEffect();this.fireEvent("collapse",this)},expand:function(B){if(!this.collapsed||this.el.hasFxBlock()||this.fireEvent("beforeexpand",this,B)===false){return }var A=B===true||(B!==false&&this.animCollapse);this.el.removeClass(this.collapsedCls);this.beforeEffect();this.onExpand(A,B);return this},onExpand:function(A,B){if(A){this[this.collapseEl].slideIn(this.slideAnchor,Ext.apply(this.createEffect(B||true,this.afterExpand,this),this.expandDefaults))}else{this[this.collapseEl].show();this.afterExpand()}},afterExpand:function(){this.collapsed=false;this.afterEffect();if(this.deferLayout!==undefined){this.doLayout(true)}this.fireEvent("expand",this)},toggleCollapse:function(A){this[this.collapsed?"expand":"collapse"](A);return this},onDisable:function(){if(this.rendered&&this.maskDisabled){this.el.mask()}Ext.Panel.superclass.onDisable.call(this)},onEnable:function(){if(this.rendered&&this.maskDisabled){this.el.unmask()}Ext.Panel.superclass.onEnable.call(this)},onResize:function(B,C){if(B!==undefined||C!==undefined){if(!this.collapsed){if(typeof B=="number"){B=this.adjustBodyWidth(B-this.getFrameWidth());if(this.tbar){this.tbar.setWidth(B);if(this.topToolbar){this.topToolbar.setSize(B)}}if(this.bbar){this.bbar.setWidth(B);if(this.bottomToolbar){this.bottomToolbar.setSize(B)}}if(this.fbar){var D=this.fbar,E=1,A=Ext.isStrict;if(this.buttonAlign=="left"){E=B-D.container.getFrameWidth("lr")}else{if(Ext.isIE||Ext.isWebKit){if(!(this.buttonAlign=="center"&&Ext.isWebKit)&&(!A||(!Ext.isIE8&&A))){(function(){D.setWidth(D.getEl().child(".x-toolbar-ct").getWidth())}).defer(1)}else{E="auto"}}else{E="auto"}}D.setWidth(E)}this.body.setWidth(B)}else{if(B=="auto"){this.body.setWidth(B)}}if(typeof C=="number"){C=Math.max(0,this.adjustBodyHeight(C-this.getFrameHeight()));this.body.setHeight(C)}else{if(C=="auto"){this.body.setHeight(C)}}if(this.disabled&&this.el._mask){this.el._mask.setSize(this.el.dom.clientWidth,this.el.getHeight())}}else{this.queuedBodySize={width:B,height:C};if(!this.queuedExpand&&this.allowQueuedExpand!==false){this.queuedExpand=true;this.on("expand",function(){delete this.queuedExpand;this.onResize(this.queuedBodySize.width,this.queuedBodySize.height);this.doLayout()},this,{single:true})}}this.fireEvent("bodyresize",this,B,C)}this.syncShadow()},adjustBodyHeight:function(A){return A},adjustBodyWidth:function(A){return A},onPosition:function(){this.syncShadow()},getFrameWidth:function(){var B=this.el.getFrameWidth("lr")+this.bwrap.getFrameWidth("lr");if(this.frame){var A=this.bwrap.dom.firstChild;B+=(Ext.fly(A).getFrameWidth("l")+Ext.fly(A.firstChild).getFrameWidth("r"));var C=this.bwrap.dom.firstChild.firstChild.firstChild;B+=Ext.fly(C).getFrameWidth("lr")}return B},getFrameHeight:function(){var A=this.el.getFrameWidth("tb")+this.bwrap.getFrameWidth("tb");A+=(this.tbar?this.tbar.getHeight():0)+(this.bbar?this.bbar.getHeight():0);if(this.frame){var C=this.el.dom.firstChild;var D=this.bwrap.dom.lastChild;A+=(C.offsetHeight+D.offsetHeight);var B=this.bwrap.dom.firstChild.firstChild.firstChild;A+=Ext.fly(B).getFrameWidth("tb")}else{A+=(this.header?this.header.getHeight():0)+(this.footer?this.footer.getHeight():0)}return A},getInnerWidth:function(){return this.getSize().width-this.getFrameWidth()},getInnerHeight:function(){return this.getSize().height-this.getFrameHeight()},syncShadow:function(){if(this.floating){this.el.sync(true)}},getLayoutTarget:function(){return this.body},setTitle:function(B,A){this.title=B;if(this.header&&this.headerAsText){this.header.child("span").update(B)}if(A){this.setIconClass(A)}this.fireEvent("titlechange",this,B);return this},getUpdater:function(){return this.body.getUpdater()},load:function(){var A=this.body.getUpdater();A.update.apply(A,arguments);return this},beforeDestroy:function(){if(this.header){this.header.removeAllListeners();if(this.headerAsText){Ext.Element.uncache(this.header.child("span"))}}Ext.Element.uncache(this.header,this.tbar,this.bbar,this.footer,this.body,this.bwrap);if(this.tools){for(var B in this.tools){Ext.destroy(this.tools[B])}}if(this.buttons){for(var A in this.buttons){Ext.destroy(this.buttons[A])}}Ext.destroy(this.toolbars);Ext.Panel.superclass.beforeDestroy.call(this)},createClasses:function(){this.headerCls=this.baseCls+"-header";this.headerTextCls=this.baseCls+"-header-text";this.bwrapCls=this.baseCls+"-bwrap";this.tbarCls=this.baseCls+"-tbar";this.bodyCls=this.baseCls+"-body";this.bbarCls=this.baseCls+"-bbar";this.footerCls=this.baseCls+"-footer"},createGhost:function(A,E,B){var D=document.createElement("div");D.className="x-panel-ghost "+(A?A:"");if(this.header){D.appendChild(this.el.dom.firstChild.cloneNode(true))}Ext.fly(D.appendChild(document.createElement("ul"))).setHeight(this.bwrap.getHeight());D.style.width=this.el.dom.offsetWidth+"px";if(!B){this.container.dom.appendChild(D)}else{Ext.getDom(B).appendChild(D)}if(E!==false&&this.el.useShim!==false){var C=new Ext.Layer({shadow:false,useDisplay:true,constrain:false},D);C.show();return C}else{return new Ext.Element(D)}},doAutoLoad:function(){var A=this.body.getUpdater();if(this.renderer){A.setRenderer(this.renderer)}A.update(Ext.isObject(this.autoLoad)?this.autoLoad:{url:this.autoLoad})},getTool:function(A){return this.tools[A]}});Ext.reg("panel",Ext.Panel);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Editor=function(B,A){if(B.field){this.field=Ext.create(B.field,"textfield");A=Ext.apply({},B);delete A.field}else{this.field=B}Ext.Editor.superclass.constructor.call(this,A)};Ext.extend(Ext.Editor,Ext.Component,{value:"",alignment:"c-c?",shadow:"frame",constrain:false,swallowKeys:true,completeOnEnter:false,cancelOnEsc:false,updateEl:false,initComponent:function(){Ext.Editor.superclass.initComponent.call(this);this.addEvents("beforestartedit","startedit","beforecomplete","complete","canceledit","specialkey")},onRender:function(B,A){this.el=new Ext.Layer({shadow:this.shadow,cls:"x-editor",parentEl:B,shim:this.shim,shadowOffset:this.shadowOffset||4,id:this.id,constrain:this.constrain});if(this.zIndex){this.el.setZIndex(this.zIndex)}this.el.setStyle("overflow",Ext.isGecko?"auto":"hidden");if(this.field.msgTarget!="title"){this.field.msgTarget="qtip"}this.field.inEditor=true;this.field.render(this.el);if(Ext.isGecko){this.field.el.dom.setAttribute("autocomplete","off")}this.mon(this.field,"specialkey",this.onSpecialKey,this);if(this.swallowKeys){this.field.el.swallowEvent(["keydown","keypress"])}this.field.show();this.mon(this.field,"blur",this.onBlur,this);if(this.field.grow){this.mon(this.field,"autosize",this.el.sync,this.el,{delay:1})}},onSpecialKey:function(C,B){var A=B.getKey();if(this.completeOnEnter&&A==B.ENTER){B.stopEvent();this.completeEdit()}else{if(this.cancelOnEsc&&A==B.ESC){this.cancelEdit()}else{this.fireEvent("specialkey",C,B)}}if(this.field.triggerBlur&&(A==B.ENTER||A==B.ESC||A==B.TAB)){this.field.triggerBlur()}},startEdit:function(B,C){if(this.editing){this.completeEdit()}this.boundEl=Ext.get(B);var A=C!==undefined?C:this.boundEl.dom.innerHTML;if(!this.rendered){this.render(this.parentEl||document.body)}if(this.fireEvent("beforestartedit",this,this.boundEl,A)===false){return }this.startValue=A;this.field.setValue(A);this.doAutoSize();this.el.alignTo(this.boundEl,this.alignment);this.editing=true;this.show()},doAutoSize:function(){if(this.autoSize){var A=this.boundEl.getSize();switch(this.autoSize){case"width":this.setSize(A.width,"");break;case"height":this.setSize("",A.height);break;default:this.setSize(A.width,A.height)}}},setSize:function(A,B){delete this.field.lastSize;this.field.setSize(A,B);if(this.el){if(Ext.isGecko2||Ext.isOpera){this.el.setSize(A,B)}this.el.sync()}},realign:function(){this.el.alignTo(this.boundEl,this.alignment)},completeEdit:function(A){if(!this.editing){return }var B=this.getValue();if(!this.field.isValid()){if(this.revertInvalid!==false){this.cancelEdit(A)}return }if(String(B)===String(this.startValue)&&this.ignoreNoChange){this.hideEdit(A);return }if(this.fireEvent("beforecomplete",this,B,this.startValue)!==false){B=this.getValue();if(this.updateEl&&this.boundEl){this.boundEl.update(B)}this.hideEdit(A);this.fireEvent("complete",this,B,this.startValue)}},onShow:function(){this.el.show();if(this.hideEl!==false){this.boundEl.hide()}this.field.show();if(Ext.isIE&&!this.fixIEFocus){this.fixIEFocus=true;this.deferredFocus.defer(50,this)}else{this.field.focus()}this.fireEvent("startedit",this.boundEl,this.startValue)},deferredFocus:function(){if(this.editing){this.field.focus()}},cancelEdit:function(A){if(this.editing){var B=this.getValue();this.setValue(this.startValue);this.hideEdit(A);this.fireEvent("canceledit",this,B,this.startValue)}},hideEdit:function(A){if(A!==true){this.editing=false;this.hide()}},onBlur:function(){if(this.allowBlur!==true&&this.editing){this.completeEdit()}},onHide:function(){if(this.editing){this.completeEdit();return }this.field.blur();if(this.field.collapse){this.field.collapse()}this.el.hide();if(this.hideEl!==false){this.boundEl.show()}},setValue:function(A){this.field.setValue(A)},getValue:function(){return this.field.getValue()},beforeDestroy:function(){Ext.destroy(this.field);this.field=null}});Ext.reg("editor",Ext.Editor);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ColorPalette=function(A){Ext.ColorPalette.superclass.constructor.call(this,A);this.addEvents("select");if(this.handler){this.on("select",this.handler,this.scope,true)}};Ext.extend(Ext.ColorPalette,Ext.Component,{itemCls:"x-color-palette",value:null,clickEvent:"click",ctype:"Ext.ColorPalette",allowReselect:false,colors:["000000","993300","333300","003300","003366","000080","333399","333333","800000","FF6600","808000","008000","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","969696","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC","FFCC99","FFFF99","CCFFCC","CCFFFF","99CCFF","CC99FF","FFFFFF"],onRender:function(B,A){var C=this.tpl||new Ext.XTemplate('<tpl for="."><a href="#" class="color-{.}" hidefocus="on"><em><span style="background:#{.}" unselectable="on">&#160;</span></em></a></tpl>');var D=document.createElement("div");D.id=this.getId();D.className=this.itemCls;C.overwrite(D,this.colors);B.dom.insertBefore(D,A);this.el=Ext.get(D);this.mon(this.el,this.clickEvent,this.handleClick,this,{delegate:"a"});if(this.clickEvent!="click"){this.mon(this.el,"click",Ext.emptyFn,this,{delegate:"a",preventDefault:true})}},afterRender:function(){Ext.ColorPalette.superclass.afterRender.call(this);if(this.value){var A=this.value;this.value=null;this.select(A)}},handleClick:function(B,A){B.preventDefault();if(!this.disabled){var C=A.className.match(/(?:^|\s)color-(.{6})(?:\s|$)/)[1];this.select(C.toUpperCase())}},select:function(A){A=A.replace("#","");if(A!=this.value||this.allowReselect){var B=this.el;if(this.value){B.child("a.color-"+this.value).removeClass("x-color-palette-sel")}B.child("a.color-"+A).addClass("x-color-palette-sel");this.value=A;this.fireEvent("select",this,A)}}});Ext.reg("colorpalette",Ext.ColorPalette);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.DatePicker=Ext.extend(Ext.BoxComponent,{todayText:"Today",okText:"&#160;OK&#160;",cancelText:"Cancel",todayTip:"{0} (Spacebar)",minText:"This date is before the minimum date",maxText:"This date is after the maximum date",format:"m/d/y",disabledDaysText:"Disabled",disabledDatesText:"Disabled",monthNames:Date.monthNames,dayNames:Date.dayNames,nextText:"Next Month (Control+Right)",prevText:"Previous Month (Control+Left)",monthYearText:"Choose a month (Control+Up/Down to move years)",startDay:0,showToday:true,initComponent:function(){Ext.DatePicker.superclass.initComponent.call(this);this.value=this.value?this.value.clearTime():new Date().clearTime();this.addEvents("select");if(this.handler){this.on("select",this.handler,this.scope||this)}this.initDisabledDays()},initDisabledDays:function(){if(!this.disabledDatesRE&&this.disabledDates){var B=this.disabledDates,A=B.length-1,C="(?:";Ext.each(B,function(E,D){C+=Ext.isDate(E)?"^"+Ext.escapeRe(E.dateFormat(this.format))+"$":B[D];if(D!=A){C+="|"}},this);this.disabledDatesRE=new RegExp(C+")")}},setDisabledDates:function(A){if(Ext.isArray(A)){this.disabledDates=A;this.disabledDatesRE=null}else{this.disabledDatesRE=A}this.initDisabledDays();this.update(this.value,true)},setDisabledDays:function(A){this.disabledDays=A;this.update(this.value,true)},setMinDate:function(A){this.minDate=A;this.update(this.value,true)},setMaxDate:function(A){this.maxDate=A;this.update(this.value,true)},setValue:function(B){var A=this.value;this.value=B.clearTime(true);if(this.el){this.update(this.value)}},getValue:function(){return this.value},focus:function(){if(this.el){this.update(this.activeDate)}},onEnable:function(A){Ext.DatePicker.superclass.onEnable.call(this);this.doDisabled(false);this.update(A?this.value:this.activeDate);if(Ext.isIE){this.el.repaint()}},onDisable:function(){Ext.DatePicker.superclass.onDisable.call(this);this.doDisabled(true);if(Ext.isIE&&!Ext.isIE8){Ext.each([].concat(this.textNodes,this.el.query("th span")),function(A){Ext.fly(A).repaint()})}},doDisabled:function(A){this.keyNav.setDisabled(A);this.prevRepeater.setDisabled(A);this.nextRepeater.setDisabled(A);if(this.showToday){this.todayKeyListener.setDisabled(A);this.todayBtn.setDisabled(A)}},onRender:function(D,B){var A=['<table cellspacing="0">','<tr><td class="x-date-left"><a href="#" title="',this.prevText,'">&#160;</a></td><td class="x-date-middle" align="center"></td><td class="x-date-right"><a href="#" title="',this.nextText,'">&#160;</a></td></tr>','<tr><td colspan="3"><table class="x-date-inner" cellspacing="0"><thead><tr>'],C=this.dayNames,F;for(F=0;F<7;F++){var H=this.startDay+F;if(H>6){H=H-7}A.push("<th><span>",C[H].substr(0,1),"</span></th>")}A[A.length]="</tr></thead><tbody><tr>";for(F=0;F<42;F++){if(F%7===0&&F!==0){A[A.length]="</tr><tr>"}A[A.length]='<td><a href="#" hidefocus="on" class="x-date-date" tabIndex="1"><em><span></span></em></a></td>'}A.push("</tr></tbody></table></td></tr>",this.showToday?'<tr><td colspan="3" class="x-date-bottom" align="center"></td></tr>':"",'</table><div class="x-date-mp"></div>');var G=document.createElement("div");G.className="x-date-picker";G.innerHTML=A.join("");D.dom.insertBefore(G,B);this.el=Ext.get(G);this.eventEl=Ext.get(G.firstChild);this.prevRepeater=new Ext.util.ClickRepeater(this.el.child("td.x-date-left a"),{handler:this.showPrevMonth,scope:this,preventDefault:true,stopDefault:true});this.nextRepeater=new Ext.util.ClickRepeater(this.el.child("td.x-date-right a"),{handler:this.showNextMonth,scope:this,preventDefault:true,stopDefault:true});this.monthPicker=this.el.down("div.x-date-mp");this.monthPicker.enableDisplayMode("block");this.keyNav=new Ext.KeyNav(this.eventEl,{left:function(I){if(I.ctrlKey){this.showPrevMonth()}else{this.update(this.activeDate.add("d",-1))}},right:function(I){if(I.ctrlKey){this.showNextMonth()}else{this.update(this.activeDate.add("d",1))}},up:function(I){if(I.ctrlKey){this.showNextYear()}else{this.update(this.activeDate.add("d",-7))}},down:function(I){if(I.ctrlKey){this.showPrevYear()}else{this.update(this.activeDate.add("d",7))}},pageUp:function(I){this.showNextMonth()},pageDown:function(I){this.showPrevMonth()},enter:function(I){I.stopPropagation();return true},scope:this});this.el.unselectable();this.cells=this.el.select("table.x-date-inner tbody td");this.textNodes=this.el.query("table.x-date-inner tbody span");this.mbtn=new Ext.Button({text:"&#160;",tooltip:this.monthYearText,renderTo:this.el.child("td.x-date-middle",true)});this.mbtn.el.child("em").addClass("x-btn-arrow");if(this.showToday){this.todayKeyListener=this.eventEl.addKeyListener(Ext.EventObject.SPACE,this.selectToday,this);var E=(new Date()).dateFormat(this.format);this.todayBtn=new Ext.Button({renderTo:this.el.child("td.x-date-bottom",true),text:String.format(this.todayText,E),tooltip:String.format(this.todayTip,E),handler:this.selectToday,scope:this})}this.mon(this.eventEl,"mousewheel",this.handleMouseWheel,this);this.mon(this.eventEl,"click",this.handleDateClick,this,{delegate:"a.x-date-date"});this.mon(this.mbtn,"click",this.showMonthPicker,this);this.onEnable(true)},createMonthPicker:function(){if(!this.monthPicker.dom.firstChild){var A=['<table border="0" cellspacing="0">'];for(var B=0;B<6;B++){A.push('<tr><td class="x-date-mp-month"><a href="#">',Date.getShortMonthName(B),"</a></td>",'<td class="x-date-mp-month x-date-mp-sep"><a href="#">',Date.getShortMonthName(B+6),"</a></td>",B===0?'<td class="x-date-mp-ybtn" align="center"><a class="x-date-mp-prev"></a></td><td class="x-date-mp-ybtn" align="center"><a class="x-date-mp-next"></a></td></tr>':'<td class="x-date-mp-year"><a href="#"></a></td><td class="x-date-mp-year"><a href="#"></a></td></tr>')}A.push('<tr class="x-date-mp-btns"><td colspan="4"><button type="button" class="x-date-mp-ok">',this.okText,'</button><button type="button" class="x-date-mp-cancel">',this.cancelText,"</button></td></tr>","</table>");this.monthPicker.update(A.join(""));this.mon(this.monthPicker,"click",this.onMonthClick,this);this.mon(this.monthPicker,"dblclick",this.onMonthDblClick,this);this.mpMonths=this.monthPicker.select("td.x-date-mp-month");this.mpYears=this.monthPicker.select("td.x-date-mp-year");this.mpMonths.each(function(C,D,E){E+=1;if((E%2)===0){C.dom.xmonth=5+Math.round(E*0.5)}else{C.dom.xmonth=Math.round((E-1)*0.5)}})}},showMonthPicker:function(){if(!this.disabled){this.createMonthPicker();var A=this.el.getSize();this.monthPicker.setSize(A);this.monthPicker.child("table").setSize(A);this.mpSelMonth=(this.activeDate||this.value).getMonth();this.updateMPMonth(this.mpSelMonth);this.mpSelYear=(this.activeDate||this.value).getFullYear();this.updateMPYear(this.mpSelYear);this.monthPicker.slideIn("t",{duration:0.2})}},updateMPYear:function(E){this.mpyear=E;var C=this.mpYears.elements;for(var B=1;B<=10;B++){var D=C[B-1],A;if((B%2)===0){A=E+Math.round(B*0.5);D.firstChild.innerHTML=A;D.xyear=A}else{A=E-(5-Math.round(B*0.5));D.firstChild.innerHTML=A;D.xyear=A}this.mpYears.item(B-1)[A==this.mpSelYear?"addClass":"removeClass"]("x-date-mp-sel")}},updateMPMonth:function(A){this.mpMonths.each(function(B,C,D){B[B.dom.xmonth==A?"addClass":"removeClass"]("x-date-mp-sel")})},selectMPMonth:function(A){},onMonthClick:function(D,B){D.stopEvent();var C=new Ext.Element(B),A;if(C.is("button.x-date-mp-cancel")){this.hideMonthPicker()}else{if(C.is("button.x-date-mp-ok")){var E=new Date(this.mpSelYear,this.mpSelMonth,(this.activeDate||this.value).getDate());if(E.getMonth()!=this.mpSelMonth){E=new Date(this.mpSelYear,this.mpSelMonth,1).getLastDateOfMonth()}this.update(E);this.hideMonthPicker()}else{if((A=C.up("td.x-date-mp-month",2))){this.mpMonths.removeClass("x-date-mp-sel");A.addClass("x-date-mp-sel");this.mpSelMonth=A.dom.xmonth}else{if((A=C.up("td.x-date-mp-year",2))){this.mpYears.removeClass("x-date-mp-sel");A.addClass("x-date-mp-sel");this.mpSelYear=A.dom.xyear}else{if(C.is("a.x-date-mp-prev")){this.updateMPYear(this.mpyear-10)}else{if(C.is("a.x-date-mp-next")){this.updateMPYear(this.mpyear+10)}}}}}}},onMonthDblClick:function(D,B){D.stopEvent();var C=new Ext.Element(B),A;if((A=C.up("td.x-date-mp-month",2))){this.update(new Date(this.mpSelYear,A.dom.xmonth,(this.activeDate||this.value).getDate()));this.hideMonthPicker()}else{if((A=C.up("td.x-date-mp-year",2))){this.update(new Date(A.dom.xyear,this.mpSelMonth,(this.activeDate||this.value).getDate()));this.hideMonthPicker()}}},hideMonthPicker:function(A){if(this.monthPicker){if(A===true){this.monthPicker.hide()}else{this.monthPicker.slideOut("t",{duration:0.2})}}},showPrevMonth:function(A){this.update(this.activeDate.add("mo",-1))},showNextMonth:function(A){this.update(this.activeDate.add("mo",1))},showPrevYear:function(){this.update(this.activeDate.add("y",-1))},showNextYear:function(){this.update(this.activeDate.add("y",1))},handleMouseWheel:function(A){A.stopEvent();if(!this.disabled){var B=A.getWheelDelta();if(B>0){this.showPrevMonth()}else{if(B<0){this.showNextMonth()}}}},handleDateClick:function(B,A){B.stopEvent();if(!this.disabled&&A.dateValue&&!Ext.fly(A.parentNode).hasClass("x-date-disabled")){this.setValue(new Date(A.dateValue));this.fireEvent("select",this,this.value)}},selectToday:function(){if(this.todayBtn&&!this.todayBtn.disabled){this.setValue(new Date().clearTime());this.fireEvent("select",this,this.value)}},update:function(e,W){var A=this.activeDate,M=this.isVisible();this.activeDate=e;if(!W&&A&&this.el){var L=e.getTime();if(A.getMonth()==e.getMonth()&&A.getFullYear()==e.getFullYear()){this.cells.removeClass("x-date-selected");this.cells.each(function(d){if(d.dom.firstChild.dateValue==L){d.addClass("x-date-selected");if(M){Ext.fly(d.dom.firstChild).focus(50)}return false}});return }}var H=e.getDaysInMonth();var N=e.getFirstDateOfMonth();var E=N.getDay()-this.startDay;if(E<=this.startDay){E+=7}var X=e.add("mo",-1);var F=X.getDaysInMonth()-E;var D=this.cells.elements;var O=this.textNodes;H+=E;var U=86400000;var Z=(new Date(X.getFullYear(),X.getMonth(),F)).clearTime();var Y=new Date().clearTime().getTime();var R=e.clearTime().getTime();var Q=this.minDate?this.minDate.clearTime():Number.NEGATIVE_INFINITY;var T=this.maxDate?this.maxDate.clearTime():Number.POSITIVE_INFINITY;var b=this.disabledDatesRE;var P=this.disabledDatesText;var h=this.disabledDays?this.disabledDays.join(""):false;var a=this.disabledDaysText;var V=this.format;if(this.showToday){var J=new Date().clearTime();var C=(J<Q||J>T||(b&&V&&b.test(J.dateFormat(V)))||(h&&h.indexOf(J.getDay())!=-1));if(!this.disabled){this.todayBtn.setDisabled(C);this.todayKeyListener[C?"disable":"enable"]()}}var I=function(k,d){d.title="";var i=Z.getTime();d.firstChild.dateValue=i;if(i==Y){d.className+=" x-date-today";d.title=k.todayText}if(i==R){d.className+=" x-date-selected";if(M){Ext.fly(d.firstChild).focus(50)}}if(i<Q){d.className=" x-date-disabled";d.title=k.minText;return }if(i>T){d.className=" x-date-disabled";d.title=k.maxText;return }if(h){if(h.indexOf(Z.getDay())!=-1){d.title=a;d.className=" x-date-disabled"}}if(b&&V){var j=Z.dateFormat(V);if(b.test(j)){d.title=P.replace("%0",j);d.className=" x-date-disabled"}}};var S=0;for(;S<E;S++){O[S].innerHTML=(++F);Z.setDate(Z.getDate()+1);D[S].className="x-date-prevday";I(this,D[S])}for(;S<H;S++){var B=S-E+1;O[S].innerHTML=(B);Z.setDate(Z.getDate()+1);D[S].className="x-date-active";I(this,D[S])}var g=0;for(;S<42;S++){O[S].innerHTML=(++g);Z.setDate(Z.getDate()+1);D[S].className="x-date-nextday";I(this,D[S])}this.mbtn.setText(this.monthNames[e.getMonth()]+" "+e.getFullYear());if(!this.internalRender){var G=this.el.dom.firstChild;var K=G.offsetWidth;this.el.setWidth(K+this.el.getBorderWidth("lr"));Ext.fly(G).setWidth(K);this.internalRender=true;if(Ext.isOpera&&!this.secondPass){G.rows[0].cells[1].style.width=(K-(G.rows[0].cells[0].offsetWidth+G.rows[0].cells[2].offsetWidth))+"px";this.secondPass=true;this.update.defer(10,this,[e])}}},beforeDestroy:function(){if(this.rendered){this.keyNav.disable();this.keyNav=null;Ext.destroy(this.leftClickRpt,this.rightClickRpt,this.monthPicker,this.eventEl,this.mbtn,this.todayBtn)}}});Ext.reg("datepicker",Ext.DatePicker);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.LoadMask=function(C,B){this.el=Ext.get(C);Ext.apply(this,B);if(this.store){this.store.on("beforeload",this.onBeforeLoad,this);this.store.on("load",this.onLoad,this);this.store.on("exception",this.onLoad,this);this.removeMask=Ext.value(this.removeMask,false)}else{var A=this.el.getUpdater();A.showLoadIndicator=false;A.on("beforeupdate",this.onBeforeLoad,this);A.on("update",this.onLoad,this);A.on("failure",this.onLoad,this);this.removeMask=Ext.value(this.removeMask,true)}};Ext.LoadMask.prototype={msg:"Loading...",msgCls:"x-mask-loading",disabled:false,disable:function(){this.disabled=true},enable:function(){this.disabled=false},onLoad:function(){this.el.unmask(this.removeMask)},onBeforeLoad:function(){if(!this.disabled){this.el.mask(this.msg,this.msgCls)}},show:function(){this.onBeforeLoad()},hide:function(){this.onLoad()},destroy:function(){if(this.store){this.store.un("beforeload",this.onBeforeLoad,this);this.store.un("load",this.onLoad,this);this.store.un("exception",this.onLoad,this)}else{var A=this.el.getUpdater();A.un("beforeupdate",this.onBeforeLoad,this);A.un("update",this.onLoad,this);A.un("failure",this.onLoad,this)}}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Slider=Ext.extend(Ext.BoxComponent,{vertical:false,minValue:0,maxValue:100,decimalPrecision:0,keyIncrement:1,increment:0,clickRange:[5,15],clickToChange:true,animate:true,dragging:false,initComponent:function(){if(!Ext.isDefined(this.value)){this.value=this.minValue}Ext.Slider.superclass.initComponent.call(this);this.keyIncrement=Math.max(this.increment,this.keyIncrement);this.addEvents("beforechange","change","changecomplete","dragstart","drag","dragend");if(this.vertical){Ext.apply(this,Ext.Slider.Vertical)}},onRender:function(){this.autoEl={cls:"x-slider "+(this.vertical?"x-slider-vert":"x-slider-horz"),cn:{cls:"x-slider-end",cn:{cls:"x-slider-inner",cn:[{cls:"x-slider-thumb"},{tag:"a",cls:"x-slider-focus",href:"#",tabIndex:"-1",hidefocus:"on"}]}}};Ext.Slider.superclass.onRender.apply(this,arguments);this.endEl=this.el.first();this.innerEl=this.endEl.first();this.thumb=this.innerEl.first();this.halfThumb=(this.vertical?this.thumb.getHeight():this.thumb.getWidth())/2;this.focusEl=this.thumb.next();this.initEvents()},initEvents:function(){this.thumb.addClassOnOver("x-slider-thumb-over");this.mon(this.el,{scope:this,mousedown:this.onMouseDown,keydown:this.onKeyDown});this.focusEl.swallowEvent("click",true);this.tracker=new Ext.dd.DragTracker({onBeforeStart:this.onBeforeDragStart.createDelegate(this),onStart:this.onDragStart.createDelegate(this),onDrag:this.onDrag.createDelegate(this),onEnd:this.onDragEnd.createDelegate(this),tolerance:3,autoStart:300});this.tracker.initEl(this.thumb);this.on("beforedestroy",this.tracker.destroy,this.tracker)},onMouseDown:function(B){if(this.disabled){return }if(this.clickToChange&&B.target!=this.thumb.dom){var A=this.innerEl.translatePoints(B.getXY());this.onClickChange(A)}this.focus()},onClickChange:function(A){if(A.top>this.clickRange[0]&&A.top<this.clickRange[1]){this.setValue(Ext.util.Format.round(this.reverseValue(A.left),this.decimalPrecision),undefined,true)}},onKeyDown:function(B){if(this.disabled){B.preventDefault();return }var A=B.getKey();switch(A){case B.UP:case B.RIGHT:B.stopEvent();if(B.ctrlKey){this.setValue(this.maxValue,undefined,true)}else{this.setValue(this.value+this.keyIncrement,undefined,true)}break;case B.DOWN:case B.LEFT:B.stopEvent();if(B.ctrlKey){this.setValue(this.minValue,undefined,true)}else{this.setValue(this.value-this.keyIncrement,undefined,true)}break;default:B.preventDefault()}},doSnap:function(B){if(!this.increment||this.increment==1||!B){return B}var D=B,C=this.increment;var A=B%C;if(A!=0){D-=A;if(A*2>C){D+=C}else{if(A*2<-C){D-=C}}}return D.constrain(this.minValue,this.maxValue)},afterRender:function(){Ext.Slider.superclass.afterRender.apply(this,arguments);if(this.value!==undefined){var A=this.normalizeValue(this.value);if(A!==this.value){delete this.value;this.setValue(A,false)}else{this.moveThumb(this.translateValue(A),false)}}},getRatio:function(){var A=this.innerEl.getWidth();var B=this.maxValue-this.minValue;return B==0?A:(A/B)},normalizeValue:function(A){A=this.doSnap(A);A=Ext.util.Format.round(A,this.decimalPrecision);A=A.constrain(this.minValue,this.maxValue);return A},setValue:function(B,A,C){B=this.normalizeValue(B);if(B!==this.value&&this.fireEvent("beforechange",this,B,this.value)!==false){this.value=B;this.moveThumb(this.translateValue(B),A!==false);this.fireEvent("change",this,B);if(C){this.fireEvent("changecomplete",this,B)}}},translateValue:function(A){var B=this.getRatio();return(A*B)-(this.minValue*B)-this.halfThumb},reverseValue:function(B){var A=this.getRatio();return(B+this.halfThumb+(this.minValue*A))/A},moveThumb:function(B,A){if(!A||this.animate===false){this.thumb.setLeft(B)}else{this.thumb.shift({left:B,stopFx:true,duration:0.35})}},focus:function(){this.focusEl.focus(10)},onBeforeDragStart:function(A){return !this.disabled},onDragStart:function(A){this.thumb.addClass("x-slider-thumb-drag");this.dragging=true;this.dragStartValue=this.value;this.fireEvent("dragstart",this,A)},onDrag:function(A){var B=this.innerEl.translatePoints(this.tracker.getXY());this.setValue(Ext.util.Format.round(this.reverseValue(B.left),this.decimalPrecision),false);this.fireEvent("drag",this,A)},onDragEnd:function(A){this.thumb.removeClass("x-slider-thumb-drag");this.dragging=false;this.fireEvent("dragend",this,A);if(this.dragStartValue!=this.value){this.fireEvent("changecomplete",this,this.value)}},onResize:function(A,B){this.innerEl.setWidth(A-(this.el.getPadding("l")+this.endEl.getPadding("r")));this.syncThumb()},onDisable:function(){Ext.Slider.superclass.onDisable.call(this);this.thumb.addClass(this.disabledClass);if(Ext.isIE){var A=this.thumb.getXY();this.thumb.hide();this.innerEl.addClass(this.disabledClass).dom.disabled=true;if(!this.thumbHolder){this.thumbHolder=this.endEl.createChild({cls:"x-slider-thumb "+this.disabledClass})}this.thumbHolder.show().setXY(A)}},onEnable:function(){Ext.Slider.superclass.onEnable.call(this);this.thumb.removeClass(this.disabledClass);if(Ext.isIE){this.innerEl.removeClass(this.disabledClass).dom.disabled=false;if(this.thumbHolder){this.thumbHolder.hide()}this.thumb.show();this.syncThumb()}},syncThumb:function(){if(this.rendered){this.moveThumb(this.translateValue(this.value))}},getValue:function(){return this.value}});Ext.reg("slider",Ext.Slider);Ext.Slider.Vertical={onResize:function(A,B){this.innerEl.setHeight(B-(this.el.getPadding("t")+this.endEl.getPadding("b")));this.syncThumb()},getRatio:function(){var B=this.innerEl.getHeight();var A=this.maxValue-this.minValue;return B/A},moveThumb:function(B,A){if(!A||this.animate===false){this.thumb.setBottom(B)}else{this.thumb.shift({bottom:B,stopFx:true,duration:0.35})}},onDrag:function(B){var C=this.innerEl.translatePoints(this.tracker.getXY());var A=this.innerEl.getHeight()-C.top;this.setValue(this.minValue+Ext.util.Format.round(A/this.getRatio(),this.decimalPrecision),false);this.fireEvent("drag",this,B)},onClickChange:function(B){if(B.left>this.clickRange[0]&&B.left<this.clickRange[1]){var A=this.innerEl.getHeight()-B.top;this.setValue(this.minValue+Ext.util.Format.round(A/this.getRatio(),this.decimalPrecision),undefined,true)}}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ProgressBar=Ext.extend(Ext.BoxComponent,{baseCls:"x-progress",animate:false,waitTimer:null,initComponent:function(){Ext.ProgressBar.superclass.initComponent.call(this);this.addEvents("update")},onRender:function(D,A){var C=new Ext.Template('<div class="{cls}-wrap">','<div class="{cls}-inner">','<div class="{cls}-bar">','<div class="{cls}-text">',"<div>&#160;</div>","</div>","</div>",'<div class="{cls}-text {cls}-text-back">',"<div>&#160;</div>","</div>","</div>","</div>");this.el=A?C.insertBefore(A,{cls:this.baseCls},true):C.append(D,{cls:this.baseCls},true);if(this.id){this.el.dom.id=this.id}var B=this.el.dom.firstChild;this.progressBar=Ext.get(B.firstChild);if(this.textEl){this.textEl=Ext.get(this.textEl);delete this.textTopEl}else{this.textTopEl=Ext.get(this.progressBar.dom.firstChild);var E=Ext.get(B.childNodes[1]);this.textTopEl.setStyle("z-index",99).addClass("x-hidden");this.textEl=new Ext.CompositeElement([this.textTopEl.dom.firstChild,E.dom.firstChild]);this.textEl.setWidth(B.offsetWidth)}this.progressBar.setHeight(B.offsetHeight)},afterRender:function(){Ext.ProgressBar.superclass.afterRender.call(this);if(this.value){this.updateProgress(this.value,this.text)}else{this.updateText(this.text)}},updateProgress:function(C,D,B){this.value=C||0;if(D){this.updateText(D)}if(this.rendered){var A=Math.floor(C*this.el.dom.firstChild.offsetWidth);this.progressBar.setWidth(A,B===true||(B!==false&&this.animate));if(this.textTopEl){this.textTopEl.removeClass("x-hidden").setWidth(A)}}this.fireEvent("update",this,C,D);return this},wait:function(B){if(!this.waitTimer){var A=this;B=B||{};this.updateText(B.text);this.waitTimer=Ext.TaskMgr.start({run:function(C){var D=B.increment||10;this.updateProgress(((((C+D)%D)+1)*(100/D))*0.01,null,B.animate)},interval:B.interval||1000,duration:B.duration,onStop:function(){if(B.fn){B.fn.apply(B.scope||this)}this.reset()},scope:A})}return this},isWaiting:function(){return this.waitTimer!==null},updateText:function(A){this.text=A||"&#160;";if(this.rendered){this.textEl.update(this.text)}return this},syncProgressBar:function(){if(this.value){this.updateProgress(this.value,this.text)}return this},setSize:function(A,C){Ext.ProgressBar.superclass.setSize.call(this,A,C);if(this.textTopEl){var B=this.el.dom.firstChild;this.textEl.setSize(B.offsetWidth,B.offsetHeight)}this.syncProgressBar();return this},reset:function(A){this.updateProgress(0);if(this.textTopEl){this.textTopEl.addClass("x-hidden")}if(this.waitTimer){this.waitTimer.onStop=null;Ext.TaskMgr.stop(this.waitTimer);this.waitTimer=null}if(A===true){this.hide()}return this}});Ext.reg("progress",Ext.ProgressBar);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var A=Ext.EventManager;var B=Ext.lib.Dom;Ext.dd.DragDrop=function(E,C,D){if(E){this.init(E,C,D)}};Ext.dd.DragDrop.prototype={id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:false,lock:function(){this.locked=true},moveOnly:false,unlock:function(){this.locked=false},isTarget:true,padding:null,_domRef:null,__ygDragDrop:true,constrainX:false,constrainY:false,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:false,xTicks:null,yTicks:null,primaryButtonOnly:true,available:false,hasOuterHandles:false,b4StartDrag:function(C,D){},startDrag:function(C,D){},b4Drag:function(C){},onDrag:function(C){},onDragEnter:function(C,D){},b4DragOver:function(C){},onDragOver:function(C,D){},b4DragOut:function(C){},onDragOut:function(C,D){},b4DragDrop:function(C){},onDragDrop:function(C,D){},onInvalidDrop:function(C){},b4EndDrag:function(C){},endDrag:function(C){},b4MouseDown:function(C){},onMouseDown:function(C){},onMouseUp:function(C){},onAvailable:function(){},defaultPadding:{left:0,right:0,top:0,bottom:0},constrainTo:function(H,F,M){if(typeof F=="number"){F={left:F,right:F,top:F,bottom:F}}F=F||this.defaultPadding;var J=Ext.get(this.getEl()).getBox();var C=Ext.get(H);var L=C.getScroll();var I,D=C.dom;if(D==document.body){I={x:L.left,y:L.top,width:Ext.lib.Dom.getViewWidth(),height:Ext.lib.Dom.getViewHeight()}}else{var K=C.getXY();I={x:K[0]+L.left,y:K[1]+L.top,width:D.clientWidth,height:D.clientHeight}}var G=J.y-I.y;var E=J.x-I.x;this.resetConstraints();this.setXConstraint(E-(F.left||0),I.width-E-J.width-(F.right||0),this.xTickSize);this.setYConstraint(G-(F.top||0),I.height-G-J.height-(F.bottom||0),this.yTickSize)},getEl:function(){if(!this._domRef){this._domRef=Ext.getDom(this.id)}return this._domRef},getDragEl:function(){return Ext.getDom(this.dragElId)},init:function(E,C,D){this.initTarget(E,C,D);A.on(this.id,"mousedown",this.handleMouseDown,this)},initTarget:function(E,C,D){this.config=D||{};this.DDM=Ext.dd.DDM;this.groups={};if(typeof E!=="string"){E=Ext.id(E)}this.id=E;this.addToGroup((C)?C:"default");this.handleElId=E;this.setDragElId(E);this.invalidHandleTypes={A:"A"};this.invalidHandleIds={};this.invalidHandleClasses=[];this.applyConfig();this.handleOnAvailable()},applyConfig:function(){this.padding=this.config.padding||[0,0,0,0];this.isTarget=(this.config.isTarget!==false);this.maintainOffset=(this.config.maintainOffset);this.primaryButtonOnly=(this.config.primaryButtonOnly!==false)},handleOnAvailable:function(){this.available=true;this.resetConstraints();this.onAvailable()},setPadding:function(E,C,F,D){if(!C&&0!==C){this.padding=[E,E,E,E]}else{if(!F&&0!==F){this.padding=[E,C,E,C]}else{this.padding=[E,C,F,D]}}},setInitPosition:function(F,E){var G=this.getEl();if(!this.DDM.verifyEl(G)){return }var D=F||0;var C=E||0;var H=B.getXY(G);this.initPageX=H[0]-D;this.initPageY=H[1]-C;this.lastPageX=H[0];this.lastPageY=H[1];this.setStartPosition(H)},setStartPosition:function(D){var C=D||B.getXY(this.getEl());this.deltaSetXY=null;this.startPageX=C[0];this.startPageY=C[1]},addToGroup:function(C){this.groups[C]=true;this.DDM.regDragDrop(this,C)},removeFromGroup:function(C){if(this.groups[C]){delete this.groups[C]}this.DDM.removeDDFromGroup(this,C)},setDragElId:function(C){this.dragElId=C},setHandleElId:function(C){if(typeof C!=="string"){C=Ext.id(C)}this.handleElId=C;this.DDM.regHandle(this.id,C)},setOuterHandleElId:function(C){if(typeof C!=="string"){C=Ext.id(C)}A.on(C,"mousedown",this.handleMouseDown,this);this.setHandleElId(C);this.hasOuterHandles=true},unreg:function(){A.un(this.id,"mousedown",this.handleMouseDown);this._domRef=null;this.DDM._remove(this)},destroy:function(){this.unreg()},isLocked:function(){return(this.DDM.isLocked()||this.locked)},handleMouseDown:function(E,D){if(this.primaryButtonOnly&&E.button!=0){return }if(this.isLocked()){return }this.DDM.refreshCache(this.groups);var C=new Ext.lib.Point(Ext.lib.Event.getPageX(E),Ext.lib.Event.getPageY(E));if(!this.hasOuterHandles&&!this.DDM.isOverTarget(C,this)){}else{if(this.clickValidator(E)){this.setStartPosition();this.b4MouseDown(E);this.onMouseDown(E);this.DDM.handleMouseDown(E,this);this.DDM.stopEvent(E)}else{}}},clickValidator:function(D){var C=D.getTarget();return(this.isValidHandleChild(C)&&(this.id==this.handleElId||this.DDM.handleWasClicked(C,this.id)))},addInvalidHandleType:function(C){var D=C.toUpperCase();this.invalidHandleTypes[D]=D},addInvalidHandleId:function(C){if(typeof C!=="string"){C=Ext.id(C)}this.invalidHandleIds[C]=C},addInvalidHandleClass:function(C){this.invalidHandleClasses.push(C)},removeInvalidHandleType:function(C){var D=C.toUpperCase();delete this.invalidHandleTypes[D]},removeInvalidHandleId:function(C){if(typeof C!=="string"){C=Ext.id(C)}delete this.invalidHandleIds[C]},removeInvalidHandleClass:function(D){for(var E=0,C=this.invalidHandleClasses.length;E<C;++E){if(this.invalidHandleClasses[E]==D){delete this.invalidHandleClasses[E]}}},isValidHandleChild:function(F){var E=true;var H;try{H=F.nodeName.toUpperCase()}catch(G){H=F.nodeName}E=E&&!this.invalidHandleTypes[H];E=E&&!this.invalidHandleIds[F.id];for(var D=0,C=this.invalidHandleClasses.length;E&&D<C;++D){E=!Ext.fly(F).hasClass(this.invalidHandleClasses[D])}return E},setXTicks:function(F,C){this.xTicks=[];this.xTickSize=C;var E={};for(var D=this.initPageX;D>=this.minX;D=D-C){if(!E[D]){this.xTicks[this.xTicks.length]=D;E[D]=true}}for(D=this.initPageX;D<=this.maxX;D=D+C){if(!E[D]){this.xTicks[this.xTicks.length]=D;E[D]=true}}this.xTicks.sort(this.DDM.numericSort)},setYTicks:function(F,C){this.yTicks=[];this.yTickSize=C;var E={};for(var D=this.initPageY;D>=this.minY;D=D-C){if(!E[D]){this.yTicks[this.yTicks.length]=D;E[D]=true}}for(D=this.initPageY;D<=this.maxY;D=D+C){if(!E[D]){this.yTicks[this.yTicks.length]=D;E[D]=true}}this.yTicks.sort(this.DDM.numericSort)},setXConstraint:function(E,D,C){this.leftConstraint=E;this.rightConstraint=D;this.minX=this.initPageX-E;this.maxX=this.initPageX+D;if(C){this.setXTicks(this.initPageX,C)}this.constrainX=true},clearConstraints:function(){this.constrainX=false;this.constrainY=false;this.clearTicks()},clearTicks:function(){this.xTicks=null;this.yTicks=null;this.xTickSize=0;this.yTickSize=0},setYConstraint:function(C,E,D){this.topConstraint=C;this.bottomConstraint=E;this.minY=this.initPageY-C;this.maxY=this.initPageY+E;if(D){this.setYTicks(this.initPageY,D)}this.constrainY=true},resetConstraints:function(){if(this.initPageX||this.initPageX===0){var D=(this.maintainOffset)?this.lastPageX-this.initPageX:0;var C=(this.maintainOffset)?this.lastPageY-this.initPageY:0;this.setInitPosition(D,C)}else{this.setInitPosition()}if(this.constrainX){this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize)}if(this.constrainY){this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize)}},getTick:function(I,F){if(!F){return I}else{if(F[0]>=I){return F[0]}else{for(var D=0,C=F.length;D<C;++D){var E=D+1;if(F[E]&&F[E]>=I){var H=I-F[D];var G=F[E]-I;return(G>H)?F[D]:F[E]}}return F[F.length-1]}}},toString:function(){return("DragDrop "+this.id)}}})();if(!Ext.dd.DragDropMgr){Ext.dd.DragDropMgr=function(){var A=Ext.EventManager;return{ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:true,stopPropagation:true,initialized:false,locked:false,init:function(){this.initialized=true},POINT:0,INTERSECT:1,mode:0,_execOnAll:function(D,C){for(var E in this.ids){for(var B in this.ids[E]){var F=this.ids[E][B];if(!this.isTypeOfDD(F)){continue}F[D].apply(F,C)}}},_onLoad:function(){this.init();A.on(document,"mouseup",this.handleMouseUp,this,true);A.on(document,"mousemove",this.handleMouseMove,this,true);A.on(window,"unload",this._onUnload,this,true);A.on(window,"resize",this._onResize,this,true)},_onResize:function(B){this._execOnAll("resetConstraints",[])},lock:function(){this.locked=true},unlock:function(){this.locked=false},isLocked:function(){return this.locked},locationCache:{},useCache:true,clickPixelThresh:3,clickTimeThresh:350,dragThreshMet:false,clickTimeout:null,startX:0,startY:0,regDragDrop:function(C,B){if(!this.initialized){this.init()}if(!this.ids[B]){this.ids[B]={}}this.ids[B][C.id]=C},removeDDFromGroup:function(D,B){if(!this.ids[B]){this.ids[B]={}}var C=this.ids[B];if(C&&C[D.id]){delete C[D.id]}},_remove:function(C){for(var B in C.groups){if(B&&this.ids[B]&&this.ids[B][C.id]){delete this.ids[B][C.id]}}delete this.handleIds[C.id]},regHandle:function(C,B){if(!this.handleIds[C]){this.handleIds[C]={}}this.handleIds[C][B]=B},isDragDrop:function(B){return(this.getDDById(B))?true:false},getRelated:function(G,C){var F=[];for(var E in G.groups){for(var D in this.ids[E]){var B=this.ids[E][D];if(!this.isTypeOfDD(B)){continue}if(!C||B.isTarget){F[F.length]=B}}}return F},isLegalTarget:function(F,E){var C=this.getRelated(F,true);for(var D=0,B=C.length;D<B;++D){if(C[D].id==E.id){return true}}return false},isTypeOfDD:function(B){return(B&&B.__ygDragDrop)},isHandle:function(C,B){return(this.handleIds[C]&&this.handleIds[C][B])},getDDById:function(C){for(var B in this.ids){if(this.ids[B][C]){return this.ids[B][C]}}return null},handleMouseDown:function(D,C){if(Ext.QuickTips){Ext.QuickTips.disable()}if(this.dragCurrent){this.handleMouseUp(D)}this.currentTarget=D.getTarget();this.dragCurrent=C;var B=C.getEl();this.startX=D.getPageX();this.startY=D.getPageY();this.deltaX=this.startX-B.offsetLeft;this.deltaY=this.startY-B.offsetTop;this.dragThreshMet=false;this.clickTimeout=setTimeout(function(){var E=Ext.dd.DDM;E.startDrag(E.startX,E.startY)},this.clickTimeThresh)},startDrag:function(B,C){clearTimeout(this.clickTimeout);if(this.dragCurrent){this.dragCurrent.b4StartDrag(B,C);this.dragCurrent.startDrag(B,C)}this.dragThreshMet=true},handleMouseUp:function(B){if(Ext.QuickTips){Ext.QuickTips.enable()}if(!this.dragCurrent){return }clearTimeout(this.clickTimeout);if(this.dragThreshMet){this.fireEvents(B,true)}else{}this.stopDrag(B);this.stopEvent(B)},stopEvent:function(B){if(this.stopPropagation){B.stopPropagation()}if(this.preventDefault){B.preventDefault()}},stopDrag:function(B){if(this.dragCurrent){if(this.dragThreshMet){this.dragCurrent.b4EndDrag(B);this.dragCurrent.endDrag(B)}this.dragCurrent.onMouseUp(B)}this.dragCurrent=null;this.dragOvers={}},handleMouseMove:function(D){if(!this.dragCurrent){return true}if(Ext.isIE&&(D.button!==0&&D.button!==1&&D.button!==2)){this.stopEvent(D);return this.handleMouseUp(D)}if(!this.dragThreshMet){var C=Math.abs(this.startX-D.getPageX());var B=Math.abs(this.startY-D.getPageY());if(C>this.clickPixelThresh||B>this.clickPixelThresh){this.startDrag(this.startX,this.startY)}}if(this.dragThreshMet){this.dragCurrent.b4Drag(D);this.dragCurrent.onDrag(D);if(!this.dragCurrent.moveOnly){this.fireEvents(D,false)}}this.stopEvent(D);return true},fireEvents:function(K,L){var N=this.dragCurrent;if(!N||N.isLocked()){return }var O=K.getPoint();var B=[];var E=[];var I=[];var G=[];var D=[];for(var F in this.dragOvers){var C=this.dragOvers[F];if(!this.isTypeOfDD(C)){continue}if(!this.isOverTarget(O,C,this.mode)){E.push(C)}B[F]=true;delete this.dragOvers[F]}for(var M in N.groups){if("string"!=typeof M){continue}for(F in this.ids[M]){var H=this.ids[M][F];if(!this.isTypeOfDD(H)){continue}if(H.isTarget&&!H.isLocked()&&((H!=N)||(N.ignoreSelf===false))){if(this.isOverTarget(O,H,this.mode)){if(L){G.push(H)}else{if(!B[H.id]){D.push(H)}else{I.push(H)}this.dragOvers[H.id]=H}}}}}if(this.mode){if(E.length){N.b4DragOut(K,E);N.onDragOut(K,E)}if(D.length){N.onDragEnter(K,D)}if(I.length){N.b4DragOver(K,I);N.onDragOver(K,I)}if(G.length){N.b4DragDrop(K,G);N.onDragDrop(K,G)}}else{var J=0;for(F=0,J=E.length;F<J;++F){N.b4DragOut(K,E[F].id);N.onDragOut(K,E[F].id)}for(F=0,J=D.length;F<J;++F){N.onDragEnter(K,D[F].id)}for(F=0,J=I.length;F<J;++F){N.b4DragOver(K,I[F].id);N.onDragOver(K,I[F].id)}for(F=0,J=G.length;F<J;++F){N.b4DragDrop(K,G[F].id);N.onDragDrop(K,G[F].id)}}if(L&&!G.length){N.onInvalidDrop(K)}},getBestMatch:function(D){var F=null;var C=D.length;if(C==1){F=D[0]}else{for(var E=0;E<C;++E){var B=D[E];if(B.cursorIsOver){F=B;break}else{if(!F||F.overlap.getArea()<B.overlap.getArea()){F=B}}}}return F},refreshCache:function(C){for(var B in C){if("string"!=typeof B){continue}for(var D in this.ids[B]){var E=this.ids[B][D];if(this.isTypeOfDD(E)){var F=this.getLocation(E);if(F){this.locationCache[E.id]=F}else{delete this.locationCache[E.id]}}}}},verifyEl:function(C){if(C){var B;if(Ext.isIE){try{B=C.offsetParent}catch(D){}}else{B=C.offsetParent}if(B){return true}}return false},getLocation:function(G){if(!this.isTypeOfDD(G)){return null}var E=G.getEl(),J,D,C,L,K,M,B,I,F;try{J=Ext.lib.Dom.getXY(E)}catch(H){}if(!J){return null}D=J[0];C=D+E.offsetWidth;L=J[1];K=L+E.offsetHeight;M=L-G.padding[0];B=C+G.padding[1];I=K+G.padding[2];F=D-G.padding[3];return new Ext.lib.Region(M,B,I,F)},isOverTarget:function(J,B,D){var F=this.locationCache[B.id];if(!F||!this.useCache){F=this.getLocation(B);this.locationCache[B.id]=F}if(!F){return false}B.cursorIsOver=F.contains(J);var I=this.dragCurrent;if(!I||!I.getTargetCoord||(!D&&!I.constrainX&&!I.constrainY)){return B.cursorIsOver}B.overlap=null;var G=I.getTargetCoord(J.x,J.y);var C=I.getDragEl();var E=new Ext.lib.Region(G.y,G.x+C.offsetWidth,G.y+C.offsetHeight,G.x);var H=E.intersect(F);if(H){B.overlap=H;return(D)?true:B.cursorIsOver}else{return false}},_onUnload:function(C,B){Ext.dd.DragDropMgr.unregAll()},unregAll:function(){if(this.dragCurrent){this.stopDrag();this.dragCurrent=null}this._execOnAll("unreg",[]);for(var B in this.elementCache){delete this.elementCache[B]}this.elementCache={};this.ids={}},elementCache:{},getElWrapper:function(C){var B=this.elementCache[C];if(!B||!B.el){B=this.elementCache[C]=new this.ElementWrapper(Ext.getDom(C))}return B},getElement:function(B){return Ext.getDom(B)},getCss:function(C){var B=Ext.getDom(C);return(B)?B.style:null},ElementWrapper:function(B){this.el=B||null;this.id=this.el&&B.id;this.css=this.el&&B.style},getPosX:function(B){return Ext.lib.Dom.getX(B)},getPosY:function(B){return Ext.lib.Dom.getY(B)},swapNode:function(D,B){if(D.swapNode){D.swapNode(B)}else{var E=B.parentNode;var C=B.nextSibling;if(C==D){E.insertBefore(D,B)}else{if(B==D.nextSibling){E.insertBefore(B,D)}else{D.parentNode.replaceChild(B,D);E.insertBefore(D,C)}}}},getScroll:function(){var D,B,E=document.documentElement,C=document.body;if(E&&(E.scrollTop||E.scrollLeft)){D=E.scrollTop;B=E.scrollLeft}else{if(C){D=C.scrollTop;B=C.scrollLeft}else{}}return{top:D,left:B}},getStyle:function(C,B){return Ext.fly(C).getStyle(B)},getScrollTop:function(){return this.getScroll().top},getScrollLeft:function(){return this.getScroll().left},moveToEl:function(B,D){var C=Ext.lib.Dom.getXY(D);Ext.lib.Dom.setXY(B,C)},numericSort:function(C,B){return(C-B)},_timeoutCount:0,_addListeners:function(){var B=Ext.dd.DDM;if(Ext.lib.Event&&document){B._onLoad()}else{if(B._timeoutCount>2000){}else{setTimeout(B._addListeners,10);if(document&&document.body){B._timeoutCount+=1}}}},handleWasClicked:function(B,D){if(this.isHandle(D,B.id)){return true}else{var C=B.parentNode;while(C){if(this.isHandle(D,C.id)){return true}else{C=C.parentNode}}}return false}}}();Ext.dd.DDM=Ext.dd.DragDropMgr;Ext.dd.DDM._addListeners()}Ext.dd.DD=function(C,A,B){if(C){this.init(C,A,B)}};Ext.extend(Ext.dd.DD,Ext.dd.DragDrop,{scroll:true,autoOffset:function(C,B){var A=C-this.startPageX;var D=B-this.startPageY;this.setDelta(A,D)},setDelta:function(B,A){this.deltaX=B;this.deltaY=A},setDragElPos:function(C,B){var A=this.getDragEl();this.alignElWithMouse(A,C,B)},alignElWithMouse:function(C,G,F){var E=this.getTargetCoord(G,F);var B=C.dom?C:Ext.fly(C,"_dd");if(!this.deltaSetXY){var H=[E.x,E.y];B.setXY(H);var D=B.getLeft(true);var A=B.getTop(true);this.deltaSetXY=[D-E.x,A-E.y]}else{B.setLeftTop(E.x+this.deltaSetXY[0],E.y+this.deltaSetXY[1])}this.cachePosition(E.x,E.y);this.autoScroll(E.x,E.y,C.offsetHeight,C.offsetWidth);return E},cachePosition:function(B,A){if(B){this.lastPageX=B;this.lastPageY=A}else{var C=Ext.lib.Dom.getXY(this.getEl());this.lastPageX=C[0];this.lastPageY=C[1]}},autoScroll:function(J,I,E,K){if(this.scroll){var L=Ext.lib.Dom.getViewHeight();var B=Ext.lib.Dom.getViewWidth();var N=this.DDM.getScrollTop();var D=this.DDM.getScrollLeft();var H=E+I;var M=K+J;var G=(L+N-I-this.deltaY);var F=(B+D-J-this.deltaX);var C=40;var A=(document.all)?80:30;if(H>L&&G<C){window.scrollTo(D,N+A)}if(I<N&&N>0&&I-N<C){window.scrollTo(D,N-A)}if(M>B&&F<C){window.scrollTo(D+A,N)}if(J<D&&D>0&&J-D<C){window.scrollTo(D-A,N)}}},getTargetCoord:function(C,B){var A=C-this.deltaX;var D=B-this.deltaY;if(this.constrainX){if(A<this.minX){A=this.minX}if(A>this.maxX){A=this.maxX}}if(this.constrainY){if(D<this.minY){D=this.minY}if(D>this.maxY){D=this.maxY}}A=this.getTick(A,this.xTicks);D=this.getTick(D,this.yTicks);return{x:A,y:D}},applyConfig:function(){Ext.dd.DD.superclass.applyConfig.call(this);this.scroll=(this.config.scroll!==false)},b4MouseDown:function(A){this.autoOffset(A.getPageX(),A.getPageY())},b4Drag:function(A){this.setDragElPos(A.getPageX(),A.getPageY())},toString:function(){return("DD "+this.id)}});Ext.dd.DDProxy=function(C,A,B){if(C){this.init(C,A,B);this.initFrame()}};Ext.dd.DDProxy.dragElId="ygddfdiv";Ext.extend(Ext.dd.DDProxy,Ext.dd.DD,{resizeFrame:true,centerFrame:false,createFrame:function(){var B=this;var A=document.body;if(!A||!A.firstChild){setTimeout(function(){B.createFrame()},50);return }var D=this.getDragEl();if(!D){D=document.createElement("div");D.id=this.dragElId;var C=D.style;C.position="absolute";C.visibility="hidden";C.cursor="move";C.border="2px solid #aaa";C.zIndex=999;A.insertBefore(D,A.firstChild)}},initFrame:function(){this.createFrame()},applyConfig:function(){Ext.dd.DDProxy.superclass.applyConfig.call(this);this.resizeFrame=(this.config.resizeFrame!==false);this.centerFrame=(this.config.centerFrame);this.setDragElId(this.config.dragElId||Ext.dd.DDProxy.dragElId)},showFrame:function(E,D){var C=this.getEl();var A=this.getDragEl();var B=A.style;this._resizeProxy();if(this.centerFrame){this.setDelta(Math.round(parseInt(B.width,10)/2),Math.round(parseInt(B.height,10)/2))}this.setDragElPos(E,D);Ext.fly(A).show()},_resizeProxy:function(){if(this.resizeFrame){var A=this.getEl();Ext.fly(this.getDragEl()).setSize(A.offsetWidth,A.offsetHeight)}},b4MouseDown:function(B){var A=B.getPageX();var C=B.getPageY();this.autoOffset(A,C);this.setDragElPos(A,C)},b4StartDrag:function(A,B){this.showFrame(A,B)},b4EndDrag:function(A){Ext.fly(this.getDragEl()).hide()},endDrag:function(C){var B=this.getEl();var A=this.getDragEl();A.style.visibility="";this.beforeMove();B.style.visibility="hidden";Ext.dd.DDM.moveToEl(B,A);A.style.visibility="hidden";B.style.visibility="";this.afterDrag()},beforeMove:function(){},afterDrag:function(){},toString:function(){return("DDProxy "+this.id)}});Ext.dd.DDTarget=function(C,A,B){if(C){this.initTarget(C,A,B)}};Ext.extend(Ext.dd.DDTarget,Ext.dd.DragDrop,{toString:function(){return("DDTarget "+this.id)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.dd.DragTracker=function(A){Ext.apply(this,A);this.addEvents("mousedown","mouseup","mousemove","dragstart","dragend","drag");this.dragRegion=new Ext.lib.Region(0,0,0,0);if(this.el){this.initEl(this.el)}};Ext.extend(Ext.dd.DragTracker,Ext.util.Observable,{active:false,tolerance:5,autoStart:false,initEl:function(A){this.el=Ext.get(A);A.on("mousedown",this.onMouseDown,this,this.delegate?{delegate:this.delegate}:undefined)},destroy:function(){this.el.un("mousedown",this.onMouseDown,this)},onMouseDown:function(C,B){if(this.fireEvent("mousedown",this,C)!==false&&this.onBeforeStart(C)!==false){this.startXY=this.lastXY=C.getXY();this.dragTarget=this.delegate?B:this.el.dom;if(this.preventDefault!==false){C.preventDefault()}var A=Ext.getDoc();A.on("mouseup",this.onMouseUp,this);A.on("mousemove",this.onMouseMove,this);A.on("selectstart",this.stopSelect,this);if(this.autoStart){this.timer=this.triggerStart.defer(this.autoStart===true?1000:this.autoStart,this)}}},onMouseMove:function(D,C){if(this.active&&Ext.isIE&&!D.browserEvent.button){D.preventDefault();this.onMouseUp(D);return }D.preventDefault();var B=D.getXY(),A=this.startXY;this.lastXY=B;if(!this.active){if(Math.abs(A[0]-B[0])>this.tolerance||Math.abs(A[1]-B[1])>this.tolerance){this.triggerStart()}else{return }}this.fireEvent("mousemove",this,D);this.onDrag(D);this.fireEvent("drag",this,D)},onMouseUp:function(C){var B=Ext.getDoc();B.un("mousemove",this.onMouseMove,this);B.un("mouseup",this.onMouseUp,this);B.un("selectstart",this.stopSelect,this);C.preventDefault();this.clearStart();var A=this.active;this.active=false;delete this.elRegion;this.fireEvent("mouseup",this,C);if(A){this.onEnd(C);this.fireEvent("dragend",this,C)}},triggerStart:function(A){this.clearStart();this.active=true;this.onStart(this.startXY);this.fireEvent("dragstart",this,this.startXY)},clearStart:function(){if(this.timer){clearTimeout(this.timer);delete this.timer}},stopSelect:function(A){A.stopEvent();return false},onBeforeStart:function(A){},onStart:function(A){},onDrag:function(A){},onEnd:function(A){},getDragTarget:function(){return this.dragTarget},getDragCt:function(){return this.el},getXY:function(A){return A?this.constrainModes[A].call(this,this.lastXY):this.lastXY},getOffset:function(C){var B=this.getXY(C);var A=this.startXY;return[A[0]-B[0],A[1]-B[1]]},constrainModes:{point:function(B){if(!this.elRegion){this.elRegion=this.getDragCt().getRegion()}var A=this.dragRegion;A.left=B[0];A.top=B[1];A.right=B[0];A.bottom=B[1];A.constrainTo(this.elRegion);return[A.left,A.top]}}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.dd.ScrollManager=function(){var C=Ext.dd.DragDropMgr;var E={};var B=null;var H={};var G=function(K){B=null;A()};var I=function(){if(C.dragCurrent){C.refreshCache(C.dragCurrent.groups)}};var D=function(){if(C.dragCurrent){var K=Ext.dd.ScrollManager;var L=H.el.ddScrollConfig?H.el.ddScrollConfig.increment:K.increment;if(!K.animate){if(H.el.scroll(H.dir,L)){I()}}else{H.el.scroll(H.dir,L,true,K.animDuration,I)}}};var A=function(){if(H.id){clearInterval(H.id)}H.id=0;H.el=null;H.dir=""};var F=function(L,K){A();H.el=L;H.dir=K;var M=(L.ddScrollConfig&&L.ddScrollConfig.frequency)?L.ddScrollConfig.frequency:Ext.dd.ScrollManager.frequency;H.id=setInterval(D,M)};var J=function(N,P){if(P||!C.dragCurrent){return }var Q=Ext.dd.ScrollManager;if(!B||B!=C.dragCurrent){B=C.dragCurrent;Q.refreshCache()}var R=Ext.lib.Event.getXY(N);var S=new Ext.lib.Point(R[0],R[1]);for(var L in E){var M=E[L],K=M._region;var O=M.ddScrollConfig?M.ddScrollConfig:Q;if(K&&K.contains(S)&&M.isScrollable()){if(K.bottom-S.y<=O.vthresh){if(H.el!=M){F(M,"down")}return }else{if(K.right-S.x<=O.hthresh){if(H.el!=M){F(M,"left")}return }else{if(S.y-K.top<=O.vthresh){if(H.el!=M){F(M,"up")}return }else{if(S.x-K.left<=O.hthresh){if(H.el!=M){F(M,"right")}return }}}}}}A()};C.fireEvents=C.fireEvents.createSequence(J,C);C.stopDrag=C.stopDrag.createSequence(G,C);return{register:function(M){if(Ext.isArray(M)){for(var L=0,K=M.length;L<K;L++){this.register(M[L])}}else{M=Ext.get(M);E[M.id]=M}},unregister:function(M){if(Ext.isArray(M)){for(var L=0,K=M.length;L<K;L++){this.unregister(M[L])}}else{M=Ext.get(M);delete E[M.id]}},vthresh:25,hthresh:25,increment:100,frequency:500,animate:true,animDuration:0.4,refreshCache:function(){for(var K in E){if(typeof E[K]=="object"){E[K]._region=E[K].getRegion()}}}}}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.dd.Registry=function(){var D={};var B={};var A=0;var C=function(F,E){if(typeof F=="string"){return F}var G=F.id;if(!G&&E!==false){G="extdd-"+(++A);F.id=G}return G};return{register:function(H,I){I=I||{};if(typeof H=="string"){H=document.getElementById(H)}I.ddel=H;D[C(H)]=I;if(I.isHandle!==false){B[I.ddel.id]=I}if(I.handles){var G=I.handles;for(var F=0,E=G.length;F<E;F++){B[C(G[F])]=I}}},unregister:function(H){var J=C(H,false);var I=D[J];if(I){delete D[J];if(I.handles){var G=I.handles;for(var F=0,E=G.length;F<E;F++){delete B[C(G[F],false)]}}}},getHandle:function(E){if(typeof E!="string"){E=E.id}return B[E]},getHandleFromEvent:function(F){var E=Ext.lib.Event.getTarget(F);return E?B[E.id]:null},getTarget:function(E){if(typeof E!="string"){E=E.id}return D[E]},getTargetFromEvent:function(F){var E=Ext.lib.Event.getTarget(F);return E?D[E.id]||B[E.id]:null}}}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.dd.StatusProxy=function(A){Ext.apply(this,A);this.id=this.id||Ext.id();this.el=new Ext.Layer({dh:{id:this.id,tag:"div",cls:"x-dd-drag-proxy "+this.dropNotAllowed,children:[{tag:"div",cls:"x-dd-drop-icon"},{tag:"div",cls:"x-dd-drag-ghost"}]},shadow:!A||A.shadow!==false});this.ghost=Ext.get(this.el.dom.childNodes[1]);this.dropStatus=this.dropNotAllowed};Ext.dd.StatusProxy.prototype={dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",setStatus:function(A){A=A||this.dropNotAllowed;if(this.dropStatus!=A){this.el.replaceClass(this.dropStatus,A);this.dropStatus=A}},reset:function(A){this.el.dom.className="x-dd-drag-proxy "+this.dropNotAllowed;this.dropStatus=this.dropNotAllowed;if(A){this.ghost.update("")}},update:function(A){if(typeof A=="string"){this.ghost.update(A)}else{this.ghost.update("");A.style.margin="0";this.ghost.dom.appendChild(A)}var B=this.ghost.dom.firstChild;if(B){Ext.fly(B).setStyle("float","none")}},getEl:function(){return this.el},getGhost:function(){return this.ghost},hide:function(A){this.el.hide();if(A){this.reset(true)}},stop:function(){if(this.anim&&this.anim.isAnimated&&this.anim.isAnimated()){this.anim.stop()}},show:function(){this.el.show()},sync:function(){this.el.sync()},repair:function(B,C,A){this.callback=C;this.scope=A;if(B&&this.animRepair!==false){this.el.addClass("x-dd-drag-repair");this.el.hideUnders(true);this.anim=this.el.shift({duration:this.repairDuration||0.5,easing:"easeOut",xy:B,stopFx:true,callback:this.afterRepair,scope:this})}else{this.afterRepair()}},afterRepair:function(){this.hide(true);if(typeof this.callback=="function"){this.callback.call(this.scope||this)}this.callback=null;this.scope=null}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.dd.DragSource=function(B,A){this.el=Ext.get(B);if(!this.dragData){this.dragData={}}Ext.apply(this,A);if(!this.proxy){this.proxy=new Ext.dd.StatusProxy()}Ext.dd.DragSource.superclass.constructor.call(this,this.el.dom,this.ddGroup||this.group,{dragElId:this.proxy.id,resizeFrame:false,isTarget:false,scroll:this.scroll===true});this.dragging=false};Ext.extend(Ext.dd.DragSource,Ext.dd.DDProxy,{dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",getDragData:function(A){return this.dragData},onDragEnter:function(C,D){var B=Ext.dd.DragDropMgr.getDDById(D);this.cachedTarget=B;if(this.beforeDragEnter(B,C,D)!==false){if(B.isNotifyTarget){var A=B.notifyEnter(this,C,this.dragData);this.proxy.setStatus(A)}else{this.proxy.setStatus(this.dropAllowed)}if(this.afterDragEnter){this.afterDragEnter(B,C,D)}}},beforeDragEnter:function(B,A,C){return true},alignElWithMouse:function(){Ext.dd.DragSource.superclass.alignElWithMouse.apply(this,arguments);this.proxy.sync()},onDragOver:function(C,D){var B=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(D);if(this.beforeDragOver(B,C,D)!==false){if(B.isNotifyTarget){var A=B.notifyOver(this,C,this.dragData);this.proxy.setStatus(A)}if(this.afterDragOver){this.afterDragOver(B,C,D)}}},beforeDragOver:function(B,A,C){return true},onDragOut:function(B,C){var A=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(C);if(this.beforeDragOut(A,B,C)!==false){if(A.isNotifyTarget){A.notifyOut(this,B,this.dragData)}this.proxy.reset();if(this.afterDragOut){this.afterDragOut(A,B,C)}}this.cachedTarget=null},beforeDragOut:function(B,A,C){return true},onDragDrop:function(B,C){var A=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(C);if(this.beforeDragDrop(A,B,C)!==false){if(A.isNotifyTarget){if(A.notifyDrop(this,B,this.dragData)){this.onValidDrop(A,B,C)}else{this.onInvalidDrop(A,B,C)}}else{this.onValidDrop(A,B,C)}if(this.afterDragDrop){this.afterDragDrop(A,B,C)}}delete this.cachedTarget},beforeDragDrop:function(B,A,C){return true},onValidDrop:function(B,A,C){this.hideProxy();if(this.afterValidDrop){this.afterValidDrop(B,A,C)}},getRepairXY:function(B,A){return this.el.getXY()},onInvalidDrop:function(B,A,C){this.beforeInvalidDrop(B,A,C);if(this.cachedTarget){if(this.cachedTarget.isNotifyTarget){this.cachedTarget.notifyOut(this,A,this.dragData)}this.cacheTarget=null}this.proxy.repair(this.getRepairXY(A,this.dragData),this.afterRepair,this);if(this.afterInvalidDrop){this.afterInvalidDrop(A,C)}},afterRepair:function(){if(Ext.enableFx){this.el.highlight(this.hlColor||"c3daf9")}this.dragging=false},beforeInvalidDrop:function(B,A,C){return true},handleMouseDown:function(B){if(this.dragging){return }var A=this.getDragData(B);if(A&&this.onBeforeDrag(A,B)!==false){this.dragData=A;this.proxy.stop();Ext.dd.DragSource.superclass.handleMouseDown.apply(this,arguments)}},onBeforeDrag:function(A,B){return true},onStartDrag:Ext.emptyFn,startDrag:function(A,B){this.proxy.reset();this.dragging=true;this.proxy.update("");this.onInitDrag(A,B);this.proxy.show()},onInitDrag:function(A,C){var B=this.el.dom.cloneNode(true);B.id=Ext.id();this.proxy.update(B);this.onStartDrag(A,C);return true},getProxy:function(){return this.proxy},hideProxy:function(){this.proxy.hide();this.proxy.reset(true);this.dragging=false},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)},b4EndDrag:function(A){},endDrag:function(A){this.onEndDrag(this.dragData,A)},onEndDrag:function(A,B){},autoOffset:function(A,B){this.setDelta(-12,-20)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.dd.DropTarget=function(B,A){this.el=Ext.get(B);Ext.apply(this,A);if(this.containerScroll){Ext.dd.ScrollManager.register(this.el)}Ext.dd.DropTarget.superclass.constructor.call(this,this.el.dom,this.ddGroup||this.group,{isTarget:true})};Ext.extend(Ext.dd.DropTarget,Ext.dd.DDTarget,{dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",isTarget:true,isNotifyTarget:true,notifyEnter:function(A,C,B){if(this.overClass){this.el.addClass(this.overClass)}return this.dropAllowed},notifyOver:function(A,C,B){return this.dropAllowed},notifyOut:function(A,C,B){if(this.overClass){this.el.removeClass(this.overClass)}},notifyDrop:function(A,C,B){return false}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.dd.DragZone=function(B,A){Ext.dd.DragZone.superclass.constructor.call(this,B,A);if(this.containerScroll){Ext.dd.ScrollManager.register(this.el)}};Ext.extend(Ext.dd.DragZone,Ext.dd.DragSource,{getDragData:function(A){return Ext.dd.Registry.getHandleFromEvent(A)},onInitDrag:function(A,B){this.proxy.update(this.dragData.ddel.cloneNode(true));this.onStartDrag(A,B);return true},afterRepair:function(){if(Ext.enableFx){Ext.Element.fly(this.dragData.ddel).highlight(this.hlColor||"c3daf9")}this.dragging=false},getRepairXY:function(A){return Ext.Element.fly(this.dragData.ddel).getXY()}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.dd.DropZone=function(B,A){Ext.dd.DropZone.superclass.constructor.call(this,B,A)};Ext.extend(Ext.dd.DropZone,Ext.dd.DropTarget,{getTargetFromEvent:function(A){return Ext.dd.Registry.getTargetFromEvent(A)},onNodeEnter:function(D,A,C,B){},onNodeOver:function(D,A,C,B){return this.dropAllowed},onNodeOut:function(D,A,C,B){},onNodeDrop:function(D,A,C,B){return false},onContainerOver:function(A,C,B){return this.dropNotAllowed},onContainerDrop:function(A,C,B){return false},notifyEnter:function(A,C,B){return this.dropNotAllowed},notifyOver:function(A,C,B){var D=this.getTargetFromEvent(C);if(!D){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,A,C,B);this.lastOverNode=null}return this.onContainerOver(A,C,B)}if(this.lastOverNode!=D){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,A,C,B)}this.onNodeEnter(D,A,C,B);this.lastOverNode=D}return this.onNodeOver(D,A,C,B)},notifyOut:function(A,C,B){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,A,C,B);this.lastOverNode=null}},notifyDrop:function(A,C,B){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,A,C,B);this.lastOverNode=null}var D=this.getTargetFromEvent(C);return D?this.onNodeDrop(D,A,C,B):this.onContainerDrop(A,C,B)},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Element.addMethods({initDD:function(C,B,D){var A=new Ext.dd.DD(Ext.id(this.dom),C,B);return Ext.apply(A,D)},initDDProxy:function(C,B,D){var A=new Ext.dd.DDProxy(Ext.id(this.dom),C,B);return Ext.apply(A,D)},initDDTarget:function(C,B,D){var A=new Ext.dd.DDTarget(Ext.id(this.dom),C,B);return Ext.apply(A,D)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.Api=(function(){var A={};return{actions:{create:"create",read:"read",update:"update",destroy:"destroy"},restActions:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},isAction:function(B){return(Ext.data.Api.actions[B])?true:false},getVerb:function(B){if(A[B]){return A[B]}for(var C in this.actions){if(this.actions[C]===B){A[B]=C;break}}return(A[B]!==undefined)?A[B]:null},isValid:function(B){var E=[];var D=this.actions;for(var C in B){if(!(C in D)){E.push(C)}}return(!E.length)?true:E},hasUniqueUrl:function(C,F){var B=(C.api[F])?C.api[F].url:null;var E=true;for(var D in C.api){if((E=(D===F)?true:(C.api[D].url!=B)?true:false)===false){break}}return E},prepare:function(B){if(!B.api){B.api={}}for(var D in this.actions){var C=this.actions[D];B.api[C]=B.api[C]||B.url||B.directFn;if(typeof (B.api[C])=="string"){B.api[C]={url:B.api[C]}}}},restify:function(B){B.restful=true;for(var C in this.restActions){B.api[this.actions[C]].method=this.restActions[C]}}}})();Ext.data.Api.Error=Ext.extend(Ext.Error,{constructor:function(B,A){this.arg=A;Ext.Error.call(this,B)},name:"Ext.data.Api"});Ext.apply(Ext.data.Api.Error.prototype,{lang:{"action-url-undefined":"No fallback url defined for this action.  When defining a DataProxy api, please be sure to define an url for each CRUD action in Ext.data.Api.actions or define a default url in addition to your api-configuration.",invalid:"received an invalid API-configuration.  Please ensure your proxy API-configuration contains only the actions defined in Ext.data.Api.actions","invalid-url":"Invalid url.  Please review your proxy configuration.",execute:'Attempted to execute an unknown action.  Valid API actions are defined in Ext.data.Api.actions"'}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.SortTypes={none:function(A){return A},stripTagsRE:/<\/?[^>]+>/gi,asText:function(A){return String(A).replace(this.stripTagsRE,"")},asUCText:function(A){return String(A).toUpperCase().replace(this.stripTagsRE,"")},asUCString:function(A){return String(A).toUpperCase()},asDate:function(A){if(!A){return 0}if(Ext.isDate(A)){return A.getTime()}return Date.parse(String(A))},asFloat:function(A){var B=parseFloat(String(A).replace(/,/g,""));return isNaN(B)?0:B},asInt:function(A){var B=parseInt(String(A).replace(/,/g,""),10);return isNaN(B)?0:B}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.Record=function(A,B){this.id=(B||B===0)?B:Ext.data.Record.id(this);this.data=A||{}};Ext.data.Record.create=function(E){var C=Ext.extend(Ext.data.Record,{});var D=C.prototype;D.fields=new Ext.util.MixedCollection(false,function(F){return F.name});for(var B=0,A=E.length;B<A;B++){D.fields.add(new Ext.data.Field(E[B]))}C.getField=function(F){return D.fields.get(F)};return C};Ext.data.Record.PREFIX="ext-record";Ext.data.Record.AUTO_ID=1;Ext.data.Record.EDIT="edit";Ext.data.Record.REJECT="reject";Ext.data.Record.COMMIT="commit";Ext.data.Record.id=function(A){A.phantom=true;return[Ext.data.Record.PREFIX,"-",Ext.data.Record.AUTO_ID++].join("")};Ext.data.Record.prototype={dirty:false,editing:false,error:null,modified:null,phantom:false,join:function(A){this.store=A},set:function(B,C){var A=(typeof C==="object");if(!A&&String(this.data[B])===String(C)){return }else{if(A&&Ext.encode(this.data[B])===Ext.encode(C)){return }}this.dirty=true;if(!this.modified){this.modified={}}if(typeof this.modified[B]=="undefined"){this.modified[B]=this.data[B]}this.data[B]=C;if(!this.editing){this.afterEdit()}},afterEdit:function(){if(this.store){this.store.afterEdit(this)}},afterReject:function(){if(this.store){this.store.afterReject(this)}},afterCommit:function(){if(this.store){this.store.afterCommit(this)}},get:function(A){return this.data[A]},beginEdit:function(){this.editing=true;this.modified=this.modified||{}},cancelEdit:function(){this.editing=false;delete this.modified},endEdit:function(){this.editing=false;if(this.dirty){this.afterEdit()}},reject:function(B){var A=this.modified;for(var C in A){if(typeof A[C]!="function"){this.data[C]=A[C]}}this.dirty=false;delete this.modified;this.editing=false;if(B!==true){this.afterReject()}},commit:function(A){this.dirty=false;delete this.modified;this.editing=false;if(A!==true){this.afterCommit()}},getChanges:function(){var A=this.modified,B={};for(var C in A){if(A.hasOwnProperty(C)){B[C]=this.data[C]}}return B},hasError:function(){return this.error!==null},clearError:function(){this.error=null},copy:function(A){return new this.constructor(Ext.apply({},this.data),A||this.id)},isModified:function(A){return !!(this.modified&&this.modified.hasOwnProperty(A))},isValid:function(){return this.fields.find(function(A){return(A.allowBlank===false&&Ext.isEmpty(this.data[A.name]))?true:false},this)?false:true},markDirty:function(){this.dirty=true;if(!this.modified){this.modified={}}this.fields.each(function(A){this.modified[A.name]=this.data[A.name]},this)}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.StoreMgr=Ext.apply(new Ext.util.MixedCollection(),{register:function(){for(var A=0,B;(B=arguments[A]);A++){this.add(B)}},unregister:function(){for(var A=0,B;(B=arguments[A]);A++){this.remove(this.lookup(B))}},lookup:function(E){if(Ext.isArray(E)){var B=["field1"],D=!Ext.isArray(E[0]);if(!D){for(var C=2,A=E[0].length;C<=A;++C){B.push("field"+C)}}return new Ext.data.ArrayStore({fields:B,data:E,expandData:D,autoDestroy:true,autoCreated:true})}return Ext.isObject(E)?(E.events?E:Ext.create(E,"store")):this.get(E)},getKey:function(A){return A.storeId}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.Store=function(A){this.data=new Ext.util.MixedCollection(false);this.data.getKey=function(B){return B.id};this.baseParams={};this.removed=[];if(A&&A.data){this.inlineData=A.data;delete A.data}Ext.apply(this,A);this.paramNames=Ext.applyIf(this.paramNames||{},this.defaultParamNames);if(this.url&&!this.proxy){this.proxy=new Ext.data.HttpProxy({url:this.url})}if(this.restful===true&&this.proxy){this.batch=false;Ext.data.Api.restify(this.proxy)}if(this.reader){if(!this.recordType){this.recordType=this.reader.recordType}if(this.reader.onMetaChange){this.reader.onMetaChange=this.onMetaChange.createDelegate(this)}if(this.writer){this.writer.meta=this.reader.meta;this.pruneModifiedRecords=true}}if(this.recordType){this.fields=this.recordType.prototype.fields}this.modified=[];this.addEvents("datachanged","metachange","add","remove","update","clear","exception","beforeload","load","loadexception","beforewrite","write");if(this.proxy){this.relayEvents(this.proxy,["loadexception","exception"])}if(this.writer){this.on({scope:this,add:this.createRecords,remove:this.destroyRecord,update:this.updateRecord})}this.sortToggle={};if(this.sortField){this.setDefaultSort(this.sortField,this.sortDir)}else{if(this.sortInfo){this.setDefaultSort(this.sortInfo.field,this.sortInfo.direction)}}Ext.data.Store.superclass.constructor.call(this);if(this.id){this.storeId=this.id;delete this.id}if(this.storeId){Ext.StoreMgr.register(this)}if(this.inlineData){this.loadData(this.inlineData);delete this.inlineData}else{if(this.autoLoad){this.load.defer(10,this,[typeof this.autoLoad=="object"?this.autoLoad:undefined])}}};Ext.extend(Ext.data.Store,Ext.util.Observable,{writer:undefined,remoteSort:false,autoDestroy:false,pruneModifiedRecords:false,lastOptions:null,autoSave:true,batch:true,restful:false,paramNames:undefined,defaultParamNames:{start:"start",limit:"limit",sort:"sort",dir:"dir"},destroy:function(){if(this.storeId){Ext.StoreMgr.unregister(this)}this.data=null;Ext.destroy(this.proxy);this.reader=this.writer=null;this.purgeListeners()},add:function(B){B=[].concat(B);if(B.length<1){return }for(var D=0,A=B.length;D<A;D++){B[D].join(this)}var C=this.data.length;this.data.addAll(B);if(this.snapshot){this.snapshot.addAll(B)}this.fireEvent("add",this,B,C)},addSorted:function(A){var B=this.findInsertIndex(A);this.insert(B,A)},remove:function(A){var B=this.data.indexOf(A);if(B>-1){this.data.removeAt(B);if(this.pruneModifiedRecords){this.modified.remove(A)}if(this.snapshot){this.snapshot.remove(A)}this.fireEvent("remove",this,A,B)}},removeAt:function(A){this.remove(this.getAt(A))},removeAll:function(){this.data.clear();if(this.snapshot){this.snapshot.clear()}if(this.pruneModifiedRecords){this.modified=[]}this.fireEvent("clear",this)},insert:function(C,B){B=[].concat(B);for(var D=0,A=B.length;D<A;D++){this.data.insert(C,B[D]);B[D].join(this)}this.fireEvent("add",this,B,C)},indexOf:function(A){return this.data.indexOf(A)},indexOfId:function(A){return this.data.indexOfKey(A)},getById:function(A){return this.data.key(A)},getAt:function(A){return this.data.itemAt(A)},getRange:function(B,A){return this.data.getRange(B,A)},storeOptions:function(A){A=Ext.apply({},A);delete A.callback;delete A.scope;this.lastOptions=A},load:function(B){B=B||{};this.storeOptions(B);if(this.sortInfo&&this.remoteSort){var A=this.paramNames;B.params=B.params||{};B.params[A.sort]=this.sortInfo.field;B.params[A.dir]=this.sortInfo.direction}try{return this.execute("read",null,B)}catch(C){this.handleException(C);return false}},updateRecord:function(B,A,C){if(C==Ext.data.Record.EDIT&&this.autoSave===true&&(!A.phantom||(A.phantom&&A.isValid))){this.save()}},createRecords:function(C,B,D){for(var E=0,A=B.length;E<A;E++){if(B[E].phantom&&B[E].isValid()){B[E].markDirty();this.modified.push(B[E])}}if(this.autoSave===true){this.save()}},destroyRecord:function(B,A,C){if(this.modified.indexOf(A)!=-1){this.modified.remove(A)}if(!A.phantom){this.removed.push(A);A.lastIndex=C;if(this.autoSave===true){this.save()}}},execute:function(D,A,B){if(!Ext.data.Api.isAction(D)){throw new Ext.data.Api.Error("execute",D)}B=Ext.applyIf(B||{},{params:{}});var C=true;if(D==="read"){C=this.fireEvent("beforeload",this,B)}else{if(this.writer.listful===true&&this.restful!==true){A=(Ext.isArray(A))?A:[A]}else{if(Ext.isArray(A)&&A.length==1){A=A.shift()}}if((C=this.fireEvent("beforewrite",this,D,A,B))!==false){this.writer.write(D,B.params,A)}}if(C!==false){var E=Ext.apply({},B.params,this.baseParams);if(this.writer&&this.proxy.url&&!this.proxy.restful&&!Ext.data.Api.hasUniqueUrl(this.proxy,D)){E.xaction=D}this.proxy.request(Ext.data.Api.actions[D],A,E,this.reader,this.createCallback(D,A),this,B)}return C},save:function(){if(!this.writer){throw new Ext.data.Store.Error("writer-undefined")}if(this.removed.length){this.doTransaction("destroy",this.removed)}var A=[].concat(this.getModifiedRecords());if(!A.length){return true}var C=[];for(var B=A.length-1;B>=0;B--){if(A[B].phantom===true){var D=A.splice(B,1).shift();if(D.isValid()){C.push(D)}}else{if(!A[B].isValid()){A.splice(B,1)}}}if(C.length){this.doTransaction("create",C)}if(A.length){this.doTransaction("update",A)}return true},doTransaction:function(D,B){function E(F){try{this.execute(D,F)}catch(G){this.handleException(G)}}if(this.batch===false){for(var C=0,A=B.length;C<A;C++){E.call(this,B[C])}}else{E.call(this,B)}},createCallback:function(B,A){var C=Ext.data.Api.actions;return(B=="read")?this.loadRecords:function(E,D,F){this["on"+Ext.util.Format.capitalize(B)+"Records"](F,A,E);if(F===true){this.fireEvent("write",this,B,E,D,A)}}},clearModified:function(A){if(Ext.isArray(A)){for(var B=A.length-1;B>=0;B--){this.modified.splice(this.modified.indexOf(A[B]),1)}}else{this.modified.splice(this.modified.indexOf(A),1)}},reMap:function(B){if(Ext.isArray(B)){for(var D=0,A=B.length;D<A;D++){this.reMap(B[D])}}else{delete this.data.map[B._phid];this.data.map[B.id]=B;var C=this.data.keys.indexOf(B._phid);this.data.keys.splice(C,1,B.id);delete B._phid}},onCreateRecords:function(D,A,B){if(D===true){try{this.reader.realize(A,B);this.reMap(A)}catch(C){this.handleException(C);if(Ext.isArray(A)){this.onCreateRecords(D,A,B)}}}},onUpdateRecords:function(D,A,B){if(D===true){try{this.reader.update(A,B)}catch(C){this.handleException(C);if(Ext.isArray(A)){this.onUpdateRecords(D,A,B)}}}},onDestroyRecords:function(E,B,D){B=(B instanceof Ext.data.Record)?[B]:B;for(var C=0,A=B.length;C<A;C++){this.removed.splice(this.removed.indexOf(B[C]),1)}if(E===false){for(C=B.length-1;C>=0;C--){this.insert(B[C].lastIndex,B[C])}}},handleException:function(A){Ext.handleError(A)},reload:function(A){this.load(Ext.applyIf(A||{},this.lastOptions))},loadRecords:function(G,B,F){if(!G||F===false){if(F!==false){this.fireEvent("load",this,[],B)}if(B.callback){B.callback.call(B.scope||this,[],B,false,G)}return }var E=G.records,D=G.totalRecords||E.length;if(!B||B.add!==true){if(this.pruneModifiedRecords){this.modified=[]}for(var C=0,A=E.length;C<A;C++){E[C].join(this)}if(this.snapshot){this.data=this.snapshot;delete this.snapshot}this.data.clear();this.data.addAll(E);this.totalLength=D;this.applySort();this.fireEvent("datachanged",this)}else{this.totalLength=Math.max(D,this.data.length+E.length);this.add(E)}this.fireEvent("load",this,E,B);if(B.callback){B.callback.call(B.scope||this,E,B,true)}},loadData:function(C,A){var B=this.reader.readRecords(C);this.loadRecords(B,{add:A},true)},getCount:function(){return this.data.length||0},getTotalCount:function(){return this.totalLength||0},getSortState:function(){return this.sortInfo},applySort:function(){if(this.sortInfo&&!this.remoteSort){var A=this.sortInfo,B=A.field;this.sortData(B,A.direction)}},sortData:function(C,D){D=D||"ASC";var A=this.fields.get(C).sortType;var B=function(F,E){var H=A(F.data[C]),G=A(E.data[C]);return H>G?1:(H<G?-1:0)};this.data.sort(D,B);if(this.snapshot&&this.snapshot!=this.data){this.snapshot.sort(D,B)}},setDefaultSort:function(B,A){A=A?A.toUpperCase():"ASC";this.sortInfo={field:B,direction:A};this.sortToggle[B]=A},sort:function(E,C){var D=this.fields.get(E);if(!D){return false}if(!C){if(this.sortInfo&&this.sortInfo.field==D.name){C=(this.sortToggle[D.name]||"ASC").toggle("ASC","DESC")}else{C=D.sortDir}}var B=(this.sortToggle)?this.sortToggle[D.name]:null;var A=(this.sortInfo)?this.sortInfo:null;this.sortToggle[D.name]=C;this.sortInfo={field:D.name,direction:C};if(!this.remoteSort){this.applySort();this.fireEvent("datachanged",this)}else{if(!this.load(this.lastOptions)){if(B){this.sortToggle[D.name]=B}if(A){this.sortInfo=A}}}},each:function(B,A){this.data.each(B,A)},getModifiedRecords:function(){return this.modified},createFilterFn:function(C,B,D,A){if(Ext.isEmpty(B,false)){return false}B=this.data.createValueMatcher(B,D,A);return function(E){return B.test(E.data[C])}},sum:function(E,F,A){var C=this.data.items,B=0;F=F||0;A=(A||A===0)?A:C.length-1;for(var D=F;D<=A;D++){B+=(C[D].data[E]||0)}return B},filter:function(D,C,E,A){var B=this.createFilterFn(D,C,E,A);return B?this.filterBy(B):this.clearFilter()},filterBy:function(B,A){this.snapshot=this.snapshot||this.data;this.data=this.queryBy(B,A||this);this.fireEvent("datachanged",this)},query:function(D,C,E,A){var B=this.createFilterFn(D,C,E,A);return B?this.queryBy(B):this.data.clone()},queryBy:function(B,A){var C=this.snapshot||this.data;return C.filterBy(B,A||this)},find:function(D,C,F,E,A){var B=this.createFilterFn(D,C,E,A);return B?this.data.findIndexBy(B,null,F):-1},findExact:function(B,A,C){return this.data.findIndexBy(function(D){return D.get(B)===A},this,C)},findBy:function(B,A,C){return this.data.findIndexBy(B,A,C)},collect:function(G,H,B){var F=(B===true&&this.snapshot)?this.snapshot.items:this.data.items;var I,J,A=[],C={};for(var D=0,E=F.length;D<E;D++){I=F[D].data[G];J=String(I);if((H||!Ext.isEmpty(I))&&!C[J]){C[J]=true;A[A.length]=I}}return A},clearFilter:function(A){if(this.isFiltered()){this.data=this.snapshot;delete this.snapshot;if(A!==true){this.fireEvent("datachanged",this)}}},isFiltered:function(){return this.snapshot&&this.snapshot!=this.data},afterEdit:function(A){if(this.modified.indexOf(A)==-1){this.modified.push(A)}this.fireEvent("update",this,A,Ext.data.Record.EDIT)},afterReject:function(A){this.modified.remove(A);this.fireEvent("update",this,A,Ext.data.Record.REJECT)},afterCommit:function(A){this.modified.remove(A);this.fireEvent("update",this,A,Ext.data.Record.COMMIT)},commitChanges:function(){var B=this.modified.slice(0);this.modified=[];for(var C=0,A=B.length;C<A;C++){B[C].commit()}},rejectChanges:function(){var B=this.modified.slice(0);this.modified=[];for(var C=0,A=B.length;C<A;C++){B[C].reject()}},onMetaChange:function(B,A,C){this.recordType=A;this.fields=A.prototype.fields;delete this.snapshot;if(B.sortInfo){this.sortInfo=B.sortInfo}else{if(this.sortInfo&&!this.fields.get(this.sortInfo.field)){delete this.sortInfo}}this.modified=[];this.fireEvent("metachange",this,this.reader.meta)},findInsertIndex:function(A){this.suspendEvents();var C=this.data.clone();this.data.add(A);this.applySort();var B=this.data.indexOf(A);this.data=C;this.resumeEvents();return B},setBaseParam:function(A,B){this.baseParams=this.baseParams||{};this.baseParams[A]=B}});Ext.reg("store",Ext.data.Store);Ext.data.Store.Error=Ext.extend(Ext.Error,{name:"Ext.data.Store"});Ext.apply(Ext.data.Store.Error.prototype,{lang:{"writer-undefined":"Attempted to execute a write-action without a DataWriter installed."}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.Field=function(D){if(typeof D=="string"){D={name:D}}Ext.apply(this,D);if(!this.type){this.type="auto"}var C=Ext.data.SortTypes;if(typeof this.sortType=="string"){this.sortType=C[this.sortType]}if(!this.sortType){switch(this.type){case"string":this.sortType=C.asUCString;break;case"date":this.sortType=C.asDate;break;default:this.sortType=C.none}}var E=/[\$,%]/g;if(!this.convert){var B,A=this.dateFormat;switch(this.type){case"":case"auto":case undefined:B=function(F){return F};break;case"string":B=function(F){return(F===undefined||F===null)?"":String(F)};break;case"int":B=function(F){return F!==undefined&&F!==null&&F!==""?parseInt(String(F).replace(E,""),10):""};break;case"float":B=function(F){return F!==undefined&&F!==null&&F!==""?parseFloat(String(F).replace(E,""),10):""};break;case"bool":case"boolean":B=function(F){return F===true||F==="true"||F==1};break;case"date":B=function(G){if(!G){return""}if(Ext.isDate(G)){return G}if(A){if(A=="timestamp"){return new Date(G*1000)}if(A=="time"){return new Date(parseInt(G,10))}return Date.parseDate(G,A)}var F=Date.parse(G);return F?new Date(F):null};break}this.convert=B}};Ext.data.Field.prototype={dateFormat:null,defaultValue:"",mapping:null,sortType:null,sortDir:"ASC",allowBlank:true};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.DataReader=function(A,B){this.meta=A;this.recordType=Ext.isArray(B)?Ext.data.Record.create(B):B};Ext.data.DataReader.prototype={buildExtractors:Ext.emptyFn,realize:function(B,D){if(Ext.isArray(B)){for(var C=B.length-1;C>=0;C--){if(Ext.isArray(D)){this.realize(B.splice(C,1).shift(),D.splice(C,1).shift())}else{this.realize(B.splice(C,1).shift(),D)}}}else{if(Ext.isArray(D)&&D.length==1){D=D.shift()}if(!this.isData(D)){throw new Ext.data.DataReader.Error("realize",B)}this.buildExtractors();var A=this.extractValues(D,B.fields.items,B.fields.items.length);B.phantom=false;B._phid=B.id;B.id=D[this.meta.idProperty];B.data=A;B.commit()}},update:function(A,C){if(Ext.isArray(A)){for(var B=A.length-1;B>=0;B--){if(Ext.isArray(C)){this.update(A.splice(B,1).shift(),C.splice(B,1).shift())}else{this.update(A.splice(B,1).shift(),C)}}}else{if(Ext.isArray(C)&&C.length==1){C=C.shift()}if(!this.isData(C)){A.commit();throw new Ext.data.DataReader.Error("update",A)}this.buildExtractors();A.data=this.extractValues(Ext.apply(A.data,C),A.fields.items,A.fields.items.length);A.commit()}},isData:function(A){return(A&&Ext.isObject(A)&&!Ext.isEmpty(A[this.meta.idProperty]))?true:false}};Ext.data.DataReader.Error=Ext.extend(Ext.Error,{constructor:function(B,A){this.arg=A;Ext.Error.call(this,B)},name:"Ext.data.DataReader"});Ext.apply(Ext.data.DataReader.Error.prototype,{lang:{update:"#update received invalid data from server.  Please see docs for DataReader#update and review your DataReader configuration.",realize:"#realize was called with invalid remote-data.  Please see the docs for DataReader#realize and review your DataReader configuration.","invalid-response":"#readResponse received an invalid response from the server."}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.DataWriter=function(A){Ext.apply(this,A)};Ext.data.DataWriter.prototype={writeAllFields:false,listful:false,write:function(B,C,A){this.render(B,A,C,this[B](A))},render:Ext.emptyFn,update:function(A){var D={};if(Ext.isArray(A)){var C=[],B=[];Ext.each(A,function(E){B.push(E.id);C.push(this.updateRecord(E))},this);D[this.meta.idProperty]=B;D[this.meta.root]=C}else{if(A instanceof Ext.data.Record){D[this.meta.idProperty]=A.id;D[this.meta.root]=this.updateRecord(A)}}return D},updateRecord:Ext.emptyFn,create:function(A){var C={};if(Ext.isArray(A)){var B=[];Ext.each(A,function(D){B.push(this.createRecord(D))},this);C[this.meta.root]=B}else{if(A instanceof Ext.data.Record){C[this.meta.root]=this.createRecord(A)}}return C},createRecord:Ext.emptyFn,destroy:function(A){var D={};if(Ext.isArray(A)){var C=[],B=[];Ext.each(A,function(E){C.push(this.destroyRecord(E))},this);D[this.meta.root]=C}else{if(A instanceof Ext.data.Record){D[this.meta.root]=this.destroyRecord(A)}}return D},destroyRecord:Ext.emptyFn,toHash:function(E){var D=E.fields.map,C={},B=(this.writeAllFields===false&&E.phantom===false)?E.getChanges():E.data,A;Ext.iterate(B,function(G,F){if((A=D[G])){C[A.mapping?A.mapping:A.name]=F}});C[this.meta.idProperty]=E.id;return C}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.DataProxy=function(A){A=A||{};this.api=A.api;this.url=A.url;this.restful=A.restful;this.listeners=A.listeners;this.prettyUrls=A.prettyUrls;try{Ext.data.Api.prepare(this)}catch(B){if(B instanceof Ext.data.Api.Error){B.toConsole()}}this.addEvents("exception","beforeload","load","loadexception","beforewrite","write");Ext.data.DataProxy.superclass.constructor.call(this)};Ext.extend(Ext.data.DataProxy,Ext.util.Observable,{restful:false,setApi:function(){if(arguments.length==1){var A=Ext.data.Api.isValid(arguments[0]);if(A===true){this.api=arguments[0]}else{throw new Ext.data.Api.Error("invalid",A)}}else{if(arguments.length==2){if(!Ext.data.Api.isAction(arguments[0])){throw new Ext.data.Api.Error("invalid",arguments[0])}this.api[arguments[0]]=arguments[1]}}Ext.data.Api.prepare(this)},isApiAction:function(A){return(this.api[A])?true:false},request:function(E,B,F,A,G,D,C){if(!this.api[E]&&!this.load){throw new Ext.data.DataProxy.Error("action-undefined",E)}F=F||{};if((E===Ext.data.Api.actions.read)?this.fireEvent("beforeload",this,F):this.fireEvent("beforewrite",this,E,B,F)!==false){this.doRequest.apply(this,arguments)}else{G.call(D||this,null,C,false)}},load:null,doRequest:function(E,B,F,A,G,D,C){this.load(F,A,G,D,C)},buildUrl:function(D,B){B=B||null;var C=(this.api[D])?this.api[D].url:this.url;if(!C){throw new Ext.data.Api.Error("invalid-url",D)}var E=null;var A=C.match(/(.*)(\.\w+)$/);if(A){E=A[2];C=A[1]}if((this.prettyUrls===true||this.restful===true)&&B instanceof Ext.data.Record&&!B.phantom){C+="/"+B.id}if(E){C+=E}return C},destroy:function(){this.purgeListeners()}});Ext.data.DataProxy.Error=Ext.extend(Ext.Error,{constructor:function(B,A){this.arg=A;Ext.Error.call(this,B)},name:"Ext.data.DataProxy"});Ext.apply(Ext.data.DataProxy.Error.prototype,{lang:{"action-undefined":"DataProxy attempted to execute an API-action but found an undefined url / function.  Please review your Proxy url/api-configuration.","api-invalid":"Recieved an invalid API-configuration.  Please ensure your proxy API-configuration contains only the actions from Ext.data.Api.actions."}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.ScriptTagProxy=function(A){Ext.apply(this,A);Ext.data.ScriptTagProxy.superclass.constructor.call(this,A);this.head=document.getElementsByTagName("head")[0]};Ext.data.ScriptTagProxy.TRANS_ID=1000;Ext.extend(Ext.data.ScriptTagProxy,Ext.data.DataProxy,{timeout:30000,callbackParam:"callback",nocache:true,doRequest:function(E,F,D,G,I,J,K){var C=Ext.urlEncode(Ext.apply(D,this.extraParams));var B=this.buildUrl(E,F);if(!B){throw new Ext.data.Api.Error("invalid-url",B)}B=Ext.urlAppend(B,C);if(this.nocache){B=Ext.urlAppend(B,"_dc="+(new Date().getTime()))}var A=++Ext.data.ScriptTagProxy.TRANS_ID;var L={id:A,action:E,cb:"stcCallback"+A,scriptId:"stcScript"+A,params:D,arg:K,url:B,callback:I,scope:J,reader:G};window[L.cb]=this.createCallback(E,F,L);B+=String.format("&{0}={1}",this.callbackParam,L.cb);if(this.autoAbort!==false){this.abort()}L.timeoutId=this.handleFailure.defer(this.timeout,this,[L]);var H=document.createElement("script");H.setAttribute("src",B);H.setAttribute("type","text/javascript");H.setAttribute("id",L.scriptId);this.head.appendChild(H);this.trans=L},createCallback:function(D,B,C){var A=this;return function(E){A.trans=false;A.destroyTrans(C,true);if(D===Ext.data.Api.actions.read){A.onRead.call(A,D,C,E)}else{A.onWrite.call(A,D,C,E,B)}}},onRead:function(D,C,B){var A;try{A=C.reader.readRecords(B)}catch(E){this.fireEvent("loadexception",this,C,B,E);this.fireEvent("exception",this,"response",D,C,B,E);C.callback.call(C.scope||window,null,C.arg,false);return }if(A.success===false){this.fireEvent("loadexception",this,C,B);this.fireEvent("exception",this,"remote",D,C,B,null)}else{this.fireEvent("load",this,B,C.arg)}C.callback.call(C.scope||window,A,C.arg,A.success)},onWrite:function(E,D,C,B){var A=D.reader;try{A.readResponse(E,C)}catch(F){this.fireEvent("exception",this,"response",E,D,C,F);D.callback.call(D.scope||window,null,C,false);return }if(!C[A.meta.successProperty]===true){this.fireEvent("exception",this,"remote",E,D,C,B);D.callback.call(D.scope||window,null,C,false);return }this.fireEvent("write",this,E,C[A.meta.root],C,B,D.arg);D.callback.call(D.scope||window,C[A.meta.root],C,true)},isLoading:function(){return this.trans?true:false},abort:function(){if(this.isLoading()){this.destroyTrans(this.trans)}},destroyTrans:function(B,A){this.head.removeChild(document.getElementById(B.scriptId));clearTimeout(B.timeoutId);if(A){window[B.cb]=undefined;try{delete window[B.cb]}catch(C){}}else{window[B.cb]=function(){window[B.cb]=undefined;try{delete window[B.cb]}catch(D){}}}},handleFailure:function(A){this.trans=false;this.destroyTrans(A,false);if(A.action===Ext.data.Api.actions.read){this.fireEvent("loadexception",this,null,A.arg)}this.fireEvent("exception",this,"response",A.action,{response:null,options:A.arg});A.callback.call(A.scope||window,null,A.arg,false)},destroy:function(){this.abort();Ext.data.ScriptTagProxy.superclass.destroy.call(this)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.HttpProxy=function(A){Ext.data.HttpProxy.superclass.constructor.call(this,A);this.conn=A;this.conn.url=null;this.useAjax=!A||!A.events;var C=Ext.data.Api.actions;this.activeRequest={};for(var B in C){this.activeRequest[C[B]]=undefined}};Ext.extend(Ext.data.HttpProxy,Ext.data.DataProxy,{getConnection:function(){return this.useAjax?Ext.Ajax:this.conn},setUrl:function(A,B){this.conn.url=A;if(B===true){this.url=A;Ext.data.Api.prepare(this)}},doRequest:function(F,D,H,C,B,E,A){var G={method:(this.api[F])?this.api[F]["method"]:undefined,request:{callback:B,scope:E,arg:A},reader:C,callback:this.createCallback(F,D),scope:this};if(typeof (H[C.meta.root])==="object"){G.jsonData=H}else{G.params=H||{}}if(this.conn.url===null){this.conn.url=this.buildUrl(F,D)}else{if(this.restful===true&&D instanceof Ext.data.Record&&!D.phantom){this.conn.url+="/"+D.id}}if(this.useAjax){Ext.applyIf(G,this.conn);if(this.activeRequest[F]){}this.activeRequest[F]=Ext.Ajax.request(G)}else{this.conn.request(G)}this.conn.url=null},createCallback:function(B,A){return function(E,D,C){this.activeRequest[B]=undefined;if(!D){if(B===Ext.data.Api.actions.read){this.fireEvent("loadexception",this,E,C)}this.fireEvent("exception",this,"response",B,E,C);E.request.callback.call(E.request.scope,null,E.request.arg,false);return }if(B===Ext.data.Api.actions.read){this.onRead(B,E,C)}else{this.onWrite(B,E,C,A)}}},onRead:function(D,F,B){var A;try{A=F.reader.read(B)}catch(E){this.fireEvent("loadexception",this,F,B,E);this.fireEvent("exception",this,"response",D,F,B,E);F.request.callback.call(F.request.scope,null,F.request.arg,false);return }if(A.success===false){this.fireEvent("loadexception",this,F,B);var C=F.reader.readResponse(D,B);this.fireEvent("exception",this,"remote",D,F,C,null)}else{this.fireEvent("load",this,F,F.request.arg)}F.request.callback.call(F.request.scope,A,F.request.arg,A.success)},onWrite:function(E,G,C,B){var A=G.reader;var D;try{D=A.readResponse(E,C)}catch(F){this.fireEvent("exception",this,"response",E,G,C,F);G.request.callback.call(G.request.scope,null,G.request.arg,false);return }if(D[A.meta.successProperty]===false){this.fireEvent("exception",this,"remote",E,G,D,B)}else{this.fireEvent("write",this,E,D[A.meta.root],D,B,G.request.arg)}G.request.callback.call(G.request.scope,D[A.meta.root],D,D[A.meta.successProperty])},destroy:function(){if(!this.useAjax){this.conn.abort()}else{if(this.activeRequest){var B=Ext.data.Api.actions;for(var A in B){if(this.activeRequest[B[A]]){Ext.Ajax.abort(this.activeRequest[B[A]])}}}}Ext.data.HttpProxy.superclass.destroy.call(this)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.MemoryProxy=function(B){var A={};A[Ext.data.Api.actions.read]=true;Ext.data.MemoryProxy.superclass.constructor.call(this,{api:A});this.data=B};Ext.extend(Ext.data.MemoryProxy,Ext.data.DataProxy,{doRequest:function(B,C,A,D,F,G,H){A=A||{};var I;try{I=D.readRecords(this.data)}catch(E){this.fireEvent("loadexception",this,null,H,E);this.fireEvent("exception",this,"response",B,H,null,E);F.call(G,null,H,false);return }F.call(G,I,H,true)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.JsonWriter=function(A){Ext.data.JsonWriter.superclass.constructor.call(this,A);if(this.returnJson!=undefined){this.encode=this.returnJson}};Ext.extend(Ext.data.JsonWriter,Ext.data.DataWriter,{returnJson:undefined,encode:true,render:function(C,A,D,B){Ext.apply(D,B);if(this.encode===true){if(Ext.isArray(A)&&B[this.meta.idProperty]){D[this.meta.idProperty]=Ext.encode(D[this.meta.idProperty])}D[this.meta.root]=Ext.encode(D[this.meta.root])}},createRecord:function(A){return this.toHash(A)},updateRecord:function(A){return this.toHash(A)},destroyRecord:function(A){return A.id}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.JsonReader=function(A,B){A=A||{};Ext.applyIf(A,{idProperty:"id",successProperty:"success",totalProperty:"total"});Ext.data.JsonReader.superclass.constructor.call(this,A,B||A.fields)};Ext.extend(Ext.data.JsonReader,Ext.data.DataReader,{read:function(A){var B=A.responseText;var C=Ext.decode(B);if(!C){throw {message:"JsonReader.read: Json object not found"}}return this.readRecords(C)},onMetaChange:function(A,C,B){},simpleAccess:function(B,A){return B[A]},getJsonAccessor:function(){var A=/[\[\.]/;return function(C){try{return(A.test(C))?new Function("obj","return obj."+C):function(D){return D[C]}}catch(B){}return Ext.emptyFn}}(),readRecords:function(A){this.jsonData=A;if(A.metaData){delete this.ef;this.meta=A.metaData;this.recordType=Ext.data.Record.create(A.metaData.fields);this.onMetaChange(this.meta,this.recordType,A)}var O=this.meta,J=this.recordType,F=J.prototype.fields,N=F.items,K=F.length,L;this.buildExtractors();var I=this.getRoot(A),H=I.length,G=H,M=true;if(O.totalProperty){L=parseInt(this.getTotal(A),10);if(!isNaN(L)){G=L}}if(O.successProperty){L=this.getSuccess(A);if(L===false||L==="false"){M=false}}var C=[];for(var D=0;D<H;D++){var B=I[D];var E=new J(this.extractValues(B,N,K),this.getId(B));E.json=B;C[D]=E}return{success:M,records:C,totalRecords:G}},buildExtractors:function(){if(this.ef){return }var I=this.meta,F=this.recordType,E=F.prototype.fields,H=E.items,G=E.length;if(I.totalProperty){this.getTotal=this.getJsonAccessor(I.totalProperty)}if(I.successProperty){this.getSuccess=this.getJsonAccessor(I.successProperty)}this.getRoot=I.root?this.getJsonAccessor(I.root):function(J){return J};if(I.id||I.idProperty){var D=this.getJsonAccessor(I.id||I.idProperty);this.getId=function(K){var J=D(K);return(J===undefined||J==="")?null:J}}else{this.getId=function(){return null}}var C=[];for(var B=0;B<G;B++){E=H[B];var A=(E.mapping!==undefined&&E.mapping!==null)?E.mapping:E.name;C.push(this.getJsonAccessor(A))}this.ef=C},extractValues:function(G,D,A){var F,C={};for(var E=0;E<A;E++){F=D[E];var B=this.ef[E](G);C[F.name]=F.convert((B!==undefined)?B:F.defaultValue,G)}return C},readResponse:function(B,A){var C=(A.responseText!==undefined)?Ext.decode(A.responseText):A;if(!C){throw new Ext.data.JsonReader.Error("response")}if(Ext.isEmpty(C[this.meta.successProperty])){throw new Ext.data.JsonReader.Error("successProperty-response",this.meta.successProperty)}if((B===Ext.data.Api.actions.create||B===Ext.data.Api.actions.update)){if(Ext.isEmpty(C[this.meta.root])){throw new Ext.data.JsonReader.Error("root-emtpy",this.meta.root)}else{if(C[this.meta.root]===undefined){throw new Ext.data.JsonReader.Error("root-undefined-response",this.meta.root)}}}this.ef=this.buildExtractors();return C}});Ext.data.JsonReader.Error=Ext.extend(Ext.Error,{constructor:function(B,A){this.arg=A;Ext.Error.call(this,B)},name:"Ext.data.JsonReader"});Ext.apply(Ext.data.JsonReader.Error.prototype,{lang:{response:"An error occurred while json-decoding your server response","successProperty-response":'Could not locate your "successProperty" in your server response.  Please review your JsonReader config to ensure the config-property "successProperty" matches the property in your server-response.  See the JsonReader docs.',"root-undefined-response":'Could not locate your "root" property in your server response.  Please review your JsonReader config to ensure the config-property "root" matches the property your server-response.  See the JsonReader docs.',"root-undefined-config":'Your JsonReader was configured without a "root" property.  Please review your JsonReader config and make sure to define the root property.  See the JsonReader docs.',"idProperty-undefined":'Your JsonReader was configured without an "idProperty"  Please review your JsonReader configuration and ensure the "idProperty" is set (e.g.: "id").  See the JsonReader docs.',"root-emtpy":'Data was expected to be returned by the server in the "root" property of the response.  Please review your JsonReader configuration to ensure the "root" property matches that returned in the server-response.  See JsonReader docs.'}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.ArrayReader=Ext.extend(Ext.data.JsonReader,{readRecords:function(K){this.arrayData=K;var G=this.meta,D=G?Ext.num(G.idIndex,G.id):null,B=this.recordType,J=B.prototype.fields,Q=[],E;if(!this.getRoot){this.getRoot=G.root?this.getJsonAccessor(G.root):function(S){return S};if(G.totalProperty){this.getTotal=this.getJsonAccessor(G.totalProperty)}}var M=this.getRoot(K);for(var P=0;P<M.length;P++){var L=M[P];var A={};var I=((D||D===0)&&L[D]!==undefined&&L[D]!==""?L[D]:null);for(var O=0,H=J.length;O<H;O++){var R=J.items[O];var N=R.mapping!==undefined&&R.mapping!==null?R.mapping:O;E=L[N]!==undefined?L[N]:R.defaultValue;E=R.convert(E,L);A[R.name]=E}var C=new B(A,I);C.json=L;Q[Q.length]=C}var F=Q.length;if(G.totalProperty){E=parseInt(this.getTotal(K),10);if(!isNaN(E)){F=E}}return{records:Q,totalRecords:F}}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.ArrayStore=Ext.extend(Ext.data.Store,{constructor:function(A){Ext.data.ArrayStore.superclass.constructor.call(this,Ext.apply(A,{reader:new Ext.data.ArrayReader(A)}))},loadData:function(E,B){if(this.expandData===true){var D=[];for(var C=0,A=E.length;C<A;C++){D[D.length]=[E[C]]}E=D}Ext.data.ArrayStore.superclass.loadData.call(this,E,B)}});Ext.reg("arraystore",Ext.data.ArrayStore);Ext.data.SimpleStore=Ext.data.ArrayStore;Ext.reg("simplestore",Ext.data.SimpleStore);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.JsonStore=Ext.extend(Ext.data.Store,{constructor:function(A){Ext.data.JsonStore.superclass.constructor.call(this,Ext.apply(A,{reader:new Ext.data.JsonReader(A)}))}});Ext.reg("jsonstore",Ext.data.JsonStore);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.XmlWriter=Ext.extend(Ext.data.DataWriter,{render:function(C,A,D,B){},createRecord:function(A){},updateRecord:function(A){},destroyRecord:function(A){}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.XmlReader=function(A,B){A=A||{};Ext.data.XmlReader.superclass.constructor.call(this,A,B||A.fields)};Ext.extend(Ext.data.XmlReader,Ext.data.DataReader,{read:function(A){var B=A.responseXML;if(!B){throw {message:"XmlReader.read: XML Document not available"}}return this.readRecords(B)},readRecords:function(T){this.xmlData=T;var N=T.documentElement||T;var I=Ext.DomQuery;var B=this.recordType,L=B.prototype.fields;var D=this.meta.idPath||this.meta.id;var G=0,E=true;if(this.meta.totalRecords){G=I.selectNumber(this.meta.totalRecords,N,0)}if(this.meta.success){var K=I.selectValue(this.meta.success,N,true);E=K!==false&&K!=="false"}var Q=[];var U=I.select(this.meta.record,N);for(var P=0,R=U.length;P<R;P++){var M=U[P];var A={};var J=D?I.selectValue(D,M):undefined;for(var O=0,H=L.length;O<H;O++){var S=L.items[O];var F=I.selectValue(Ext.value(S.mapping,S.name,true),M,S.defaultValue);F=S.convert(F,M);A[S.name]=F}var C=new B(A,J);C.node=M;Q[Q.length]=C}return{success:E,records:Q,totalRecords:G||Q.length}},readResponse:Ext.emptyFn});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.XmlStore=Ext.extend(Ext.data.Store,{constructor:function(A){Ext.data.XmlStore.superclass.constructor.call(this,Ext.apply(A,{reader:new Ext.data.XmlReader(A)}))}});Ext.reg("xmlstore",Ext.data.XmlStore);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.GroupingStore=Ext.extend(Ext.data.Store,{constructor:function(A){Ext.data.GroupingStore.superclass.constructor.call(this,A);this.applyGroupField()},remoteGroup:false,groupOnSort:false,groupDir:"ASC",clearGrouping:function(){this.groupField=false;if(this.remoteGroup){if(this.baseParams){delete this.baseParams.groupBy}var A=this.lastOptions;if(A&&A.params){delete A.params.groupBy}this.reload()}else{this.applySort();this.fireEvent("datachanged",this)}},groupBy:function(D,B,C){C=C?(String(C).toUpperCase()=="DESC"?"DESC":"ASC"):this.groupDir;if(this.groupField==D&&this.groupDir==C&&!B){return }this.groupField=D;this.groupDir=C;this.applyGroupField();if(this.groupOnSort){this.sort(D,C);return }if(this.remoteGroup){this.reload()}else{var A=this.sortInfo||{};if(A.field!=D||A.direction!=C){this.applySort()}else{this.sortData(D,C)}this.fireEvent("datachanged",this)}},applyGroupField:function(){if(this.remoteGroup){if(!this.baseParams){this.baseParams={}}this.baseParams.groupBy=this.groupField;this.baseParams.groupDir=this.groupDir}},applySort:function(){Ext.data.GroupingStore.superclass.applySort.call(this);if(!this.groupOnSort&&!this.remoteGroup){var A=this.getGroupState();if(A&&(A!=this.sortInfo.field||this.groupDir!=this.sortInfo.direction)){this.sortData(this.groupField,this.groupDir)}}},applyGrouping:function(A){if(this.groupField!==false){this.groupBy(this.groupField,true,this.groupDir);return true}else{if(A===true){this.fireEvent("datachanged",this)}return false}},getGroupState:function(){return this.groupOnSort&&this.groupField!==false?(this.sortInfo?this.sortInfo.field:undefined):this.groupField}});Ext.reg("groupingstore",Ext.data.GroupingStore);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.DirectProxy=function(A){Ext.apply(this,A);if(typeof this.paramOrder=="string"){this.paramOrder=this.paramOrder.split(/[\s,|]/)}Ext.data.DirectProxy.superclass.constructor.call(this,A)};Ext.extend(Ext.data.DirectProxy,Ext.data.DataProxy,{paramOrder:undefined,paramsAsHash:true,directFn:undefined,doRequest:function(B,C,A,E,I,J,L){var H=[];var G=this.api[B]||this.directFn;switch(B){case Ext.data.Api.actions.create:H.push(A[E.meta.root]);break;case Ext.data.Api.actions.read:if(this.paramOrder){for(var D=0,F=this.paramOrder.length;D<F;D++){H.push(A[this.paramOrder[D]])}}else{if(this.paramsAsHash){H.push(A)}}break;case Ext.data.Api.actions.update:H.push(A[E.meta.idProperty]);H.push(A[E.meta.root]);break;case Ext.data.Api.actions.destroy:H.push(A[E.meta.root]);break}var K={params:A||{},callback:I,scope:J,arg:L,reader:E};H.push(this.createCallback(B,C,K),this);G.apply(window,H)},createCallback:function(C,A,B){return function(D,E){if(!E.status){if(C===Ext.data.Api.actions.read){this.fireEvent("loadexception",this,B,E,null)}this.fireEvent("exception",this,"remote",C,B,E,null);B.callback.call(B.scope,null,B.arg,false);return }if(C===Ext.data.Api.actions.read){this.onRead(C,B,D,E)}else{this.onWrite(C,B,D,E,A)}}},onRead:function(F,E,A,D){var B;try{B=E.reader.readRecords(A)}catch(C){this.fireEvent("loadexception",this,E,D,C);this.fireEvent("exception",this,"response",F,E,D,C);E.callback.call(E.scope,null,E.arg,false);return }this.fireEvent("load",this,D,E.arg);E.callback.call(E.scope,B,E.arg,true)},onWrite:function(E,D,A,C,B){this.fireEvent("write",this,E,A,C,B,D.arg);D.callback.call(D.scope,A,C,true)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.DirectStore=function(A){A.batchTransactions=false;Ext.data.DirectStore.superclass.constructor.call(this,Ext.apply(A,{proxy:(typeof (A.proxy)=="undefined")?new Ext.data.DirectProxy(Ext.copyTo({},A,"paramOrder,paramsAsHash,directFn,api")):A.proxy,reader:(typeof (A.reader)=="undefined"&&typeof (A.fields)=="object")?new Ext.data.JsonReader(Ext.copyTo({},A,"totalProperty,root,idProperty"),A.fields):A.reader}))};Ext.extend(Ext.data.DirectStore,Ext.data.Store,{});Ext.reg("directstore",Ext.data.DirectStore);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Direct=Ext.extend(Ext.util.Observable,{exceptions:{TRANSPORT:"xhr",PARSE:"parse",LOGIN:"login",SERVER:"exception"},constructor:function(){this.addEvents("event","exception");this.transactions={};this.providers={}},addProvider:function(D){var B=arguments;if(B.length>1){for(var C=0,A=B.length;C<A;C++){this.addProvider(B[C])}return }if(!D.events){D=new Ext.Direct.PROVIDERS[D.type](D)}D.id=D.id||Ext.id();this.providers[D.id]=D;D.on("data",this.onProviderData,this);D.on("exception",this.onProviderException,this);if(!D.isConnected()){D.connect()}return D},getProvider:function(A){return this.providers[A]},removeProvider:function(B){var A=B.id?B:this.providers[B.id];A.un("data",this.onProviderData,this);A.un("exception",this.onProviderException,this);delete this.providers[A.id];return A},addTransaction:function(A){this.transactions[A.tid]=A;return A},removeTransaction:function(A){delete this.transactions[A.tid||A];return A},getTransaction:function(A){return this.transactions[A.tid||A]},onProviderData:function(D,C){if(Ext.isArray(C)){for(var B=0,A=C.length;B<A;B++){this.onProviderData(D,C[B])}return }if(C.name&&C.name!="event"&&C.name!="exception"){this.fireEvent(C.name,C)}else{if(C.type=="exception"){this.fireEvent("exception",C)}}this.fireEvent("event",C,D)},createEvent:function(A,B){return new Ext.Direct.eventTypes[A.type](Ext.apply(A,B))}});Ext.Direct=new Ext.Direct();Ext.Direct.TID=1;Ext.Direct.PROVIDERS={};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Direct.Transaction=function(A){Ext.apply(this,A);this.tid=++Ext.Direct.TID;this.retryCount=0};Ext.Direct.Transaction.prototype={send:function(){this.provider.queueTransaction(this)},retry:function(){this.retryCount++;this.send()},getProvider:function(){return this.provider}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Direct.Event=function(A){Ext.apply(this,A)};Ext.Direct.Event.prototype={status:true,getData:function(){return this.data}};Ext.Direct.RemotingEvent=Ext.extend(Ext.Direct.Event,{type:"rpc",getTransaction:function(){return this.transaction||Ext.Direct.getTransaction(this.tid)}});Ext.Direct.ExceptionEvent=Ext.extend(Ext.Direct.RemotingEvent,{status:false,type:"exception"});Ext.Direct.eventTypes={rpc:Ext.Direct.RemotingEvent,event:Ext.Direct.Event,exception:Ext.Direct.ExceptionEvent};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.direct.Provider=Ext.extend(Ext.util.Observable,{priority:1,constructor:function(A){Ext.apply(this,A);this.addEvents("connect","disconnect","data","exception");Ext.direct.Provider.superclass.constructor.call(this,A)},isConnected:function(){return false},connect:Ext.emptyFn,disconnect:Ext.emptyFn});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.direct.JsonProvider=Ext.extend(Ext.direct.Provider,{parseResponse:function(A){if(!Ext.isEmpty(A.responseText)){if(typeof A.responseText=="object"){return A.responseText}return Ext.decode(A.responseText)}return null},getEvents:function(G){var E=null;try{E=this.parseResponse(G)}catch(F){var D=new Ext.Direct.ExceptionEvent({data:F,xhr:G,code:Ext.Direct.exceptions.PARSE,message:"Error parsing json response: \n\n "+E});return[D]}var C=[];if(Ext.isArray(E)){for(var B=0,A=E.length;B<A;B++){C.push(Ext.Direct.createEvent(E[B]))}}else{C.push(Ext.Direct.createEvent(E))}return C}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.direct.PollingProvider=Ext.extend(Ext.direct.JsonProvider,{priority:3,interval:3000,constructor:function(A){Ext.direct.PollingProvider.superclass.constructor.call(this,A);this.addEvents("beforepoll","poll")},isConnected:function(){return !!this.pollTask},connect:function(){if(this.url&&!this.pollTask){this.pollTask=Ext.TaskMgr.start({run:function(){if(this.fireEvent("beforepoll",this)!==false){if(typeof this.url=="function"){this.url(this.baseParams)}else{Ext.Ajax.request({url:this.url,callback:this.onData,scope:this,params:this.baseParams})}}},interval:this.interval,scope:this});this.fireEvent("connect",this)}else{if(!this.url){throw"Error initializing PollingProvider, no url configured."}}},disconnect:function(){if(this.pollTask){Ext.TaskMgr.stop(this.pollTask);delete this.pollTask;this.fireEvent("disconnect",this)}},onData:function(D,G,F){if(G){var C=this.getEvents(F);for(var B=0,A=C.length;B<A;B++){var E=C[B];this.fireEvent("data",this,E)}}else{var E=new Ext.Direct.ExceptionEvent({data:E,code:Ext.Direct.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:F});this.fireEvent("data",this,E)}}});Ext.Direct.PROVIDERS.polling=Ext.direct.PollingProvider;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.direct.RemotingProvider=Ext.extend(Ext.direct.JsonProvider,{enableBuffer:10,maxRetries:1,constructor:function(A){Ext.direct.RemotingProvider.superclass.constructor.call(this,A);this.addEvents("beforecall","call");this.namespace=(typeof this.namespace==="string")?Ext.ns(this.namespace):this.namespace||window;this.transactions={};this.callBuffer=[]},initAPI:function(){var F=this.actions;for(var G in F){var C=this.namespace[G]||(this.namespace[G]={});var D=F[G];for(var E=0,B=D.length;E<B;E++){var A=D[E];C[A.name]=this.createMethod(G,A)}}},isConnected:function(){return !!this.connected},connect:function(){if(this.url){this.initAPI();this.connected=true;this.fireEvent("connect",this)}else{if(!this.url){throw"Error initializing RemotingProvider, no url configured."}}},disconnect:function(){if(this.connected){this.connected=false;this.fireEvent("disconnect",this)}},onData:function(A,F,G){if(F){var H=this.getEvents(G);for(var B=0,C=H.length;B<C;B++){var D=H[B];var I=this.getTransaction(D);this.fireEvent("data",this,D);if(I){this.doCallback(I,D,true);Ext.Direct.removeTransaction(I)}}}else{var E=[].concat(A.ts);for(var B=0,C=E.length;B<C;B++){var I=this.getTransaction(E[B]);if(I&&I.retryCount<this.maxRetries){I.retry()}else{var D=new Ext.Direct.ExceptionEvent({data:D,transaction:I,code:Ext.Direct.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:G});this.fireEvent("data",this,D);if(I){this.doCallback(I,D,false);Ext.Direct.removeTransaction(I)}}}}},getCallData:function(A){return{action:A.action,method:A.method,data:A.data,type:"rpc",tid:A.tid}},doSend:function(D){var F={url:this.url,callback:this.onData,scope:this,ts:D};var B;if(Ext.isArray(D)){B=[];for(var C=0,A=D.length;C<A;C++){B.push(this.getCallData(D[C]))}}else{B=this.getCallData(D)}if(this.enableUrlEncode){var E={};E[typeof this.enableUrlEncode=="string"?this.enableUrlEncode:"data"]=Ext.encode(B);F.params=E}else{F.jsonData=B}Ext.Ajax.request(F)},combineAndSend:function(){var A=this.callBuffer.length;if(A>0){this.doSend(A==1?this.callBuffer[0]:this.callBuffer);this.callBuffer=[]}},queueTransaction:function(A){if(A.form){this.processForm(A);return }this.callBuffer.push(A);if(this.enableBuffer){if(!this.callTask){this.callTask=new Ext.util.DelayedTask(this.combineAndSend,this)}this.callTask.delay(typeof this.enableBuffer=="number"?this.enableBuffer:10)}else{this.combineAndSend()}},doCall:function(G,A,B){var F=null,D=B[A.len],E=B[A.len+1];if(A.len!==0){F=B.slice(0,A.len)}var C=new Ext.Direct.Transaction({provider:this,args:B,action:G,method:A.name,data:F,cb:E&&Ext.isFunction(D)?D.createDelegate(E):D});if(this.fireEvent("beforecall",this,C)!==false){Ext.Direct.addTransaction(C);this.queueTransaction(C);this.fireEvent("call",this,C)}},doForm:function(H,B,E,G,D){var C=new Ext.Direct.Transaction({provider:this,action:H,method:B.name,args:[E,G,D],cb:D&&Ext.isFunction(G)?G.createDelegate(D):G,isForm:true});if(this.fireEvent("beforecall",this,C)!==false){Ext.Direct.addTransaction(C);var A=String(E.getAttribute("enctype")).toLowerCase()=="multipart/form-data",F={extTID:C.tid,extAction:H,extMethod:B.name,extType:"rpc",extUpload:String(A)};Ext.apply(C,{form:Ext.getDom(E),isUpload:A,params:G&&Ext.isObject(G.params)?Ext.apply(F,G.params):F});this.fireEvent("call",this,C);this.processForm(C)}},processForm:function(A){Ext.Ajax.request({url:this.url,params:A.params,callback:this.onData,scope:this,form:A.form,isUpload:A.isUpload,ts:A})},createMethod:function(C,A){var B;if(!A.formHandler){B=function(){this.doCall(C,A,Array.prototype.slice.call(arguments,0))}.createDelegate(this)}else{B=function(E,F,D){this.doForm(C,A,E,F,D)}.createDelegate(this)}B.directCfg={action:C,method:A};return B},getTransaction:function(A){return A&&A.tid?Ext.Direct.getTransaction(A.tid):null},doCallback:function(C,E){var D=E.status?"success":"failure";if(C&&C.cb){var B=C.cb;var A=E.result||E.data;if(Ext.isFunction(B)){B(A,E)}else{Ext.callback(B[D],B.scope,[A,E]);Ext.callback(B.callback,B.scope,[A,E])}}}});Ext.Direct.PROVIDERS.remoting=Ext.direct.RemotingProvider;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Resizable=function(D,E){this.el=Ext.get(D);if(E&&E.wrap){E.resizeChild=this.el;this.el=this.el.wrap(typeof E.wrap=="object"?E.wrap:{cls:"xresizable-wrap"});this.el.id=this.el.dom.id=E.resizeChild.id+"-rzwrap";this.el.setStyle("overflow","hidden");this.el.setPositioning(E.resizeChild.getPositioning());E.resizeChild.clearPositioning();if(!E.width||!E.height){var F=E.resizeChild.getSize();this.el.setSize(F.width,F.height)}if(E.pinned&&!E.adjustments){E.adjustments="auto"}}this.proxy=this.el.createProxy({tag:"div",cls:"x-resizable-proxy",id:this.el.id+"-rzproxy"},Ext.getBody());this.proxy.unselectable();this.proxy.enableDisplayMode("block");Ext.apply(this,E);if(this.pinned){this.disableTrackOver=true;this.el.addClass("x-resizable-pinned")}var I=this.el.getStyle("position");if(I!="absolute"&&I!="fixed"){this.el.setStyle("position","relative")}if(!this.handles){this.handles="s,e,se";if(this.multiDirectional){this.handles+=",n,w"}}if(this.handles=="all"){this.handles="n s e w ne nw se sw"}var M=this.handles.split(/\s*?[,;]\s*?| /);var C=Ext.Resizable.positions;for(var H=0,J=M.length;H<J;H++){if(M[H]&&C[M[H]]){var L=C[M[H]];this[L]=new Ext.Resizable.Handle(this,L,this.disableTrackOver,this.transparent)}}this.corner=this.southeast;if(this.handles.indexOf("n")!=-1||this.handles.indexOf("w")!=-1){this.updateBox=true}this.activeHandle=null;if(this.resizeChild){if(typeof this.resizeChild=="boolean"){this.resizeChild=Ext.get(this.el.dom.firstChild,true)}else{this.resizeChild=Ext.get(this.resizeChild,true)}}if(this.adjustments=="auto"){var B=this.resizeChild;var K=this.west,G=this.east,A=this.north,M=this.south;if(B&&(K||A)){B.position("relative");B.setLeft(K?K.el.getWidth():0);B.setTop(A?A.el.getHeight():0)}this.adjustments=[(G?-G.el.getWidth():0)+(K?-K.el.getWidth():0),(A?-A.el.getHeight():0)+(M?-M.el.getHeight():0)-1]}if(this.draggable){this.dd=this.dynamic?this.el.initDD(null):this.el.initDDProxy(null,{dragElId:this.proxy.id});this.dd.setHandleElId(this.resizeChild?this.resizeChild.id:this.el.id)}this.addEvents("beforeresize","resize");if(this.width!==null&&this.height!==null){this.resizeTo(this.width,this.height)}else{this.updateChildSize()}if(Ext.isIE){this.el.dom.style.zoom=1}Ext.Resizable.superclass.constructor.call(this)};Ext.extend(Ext.Resizable,Ext.util.Observable,{adjustments:[0,0],animate:false,disableTrackOver:false,draggable:false,duration:0.35,dynamic:false,easing:"easeOutStrong",enabled:true,handles:false,multiDirectional:false,height:null,width:null,heightIncrement:0,widthIncrement:0,minHeight:5,minWidth:5,maxHeight:10000,maxWidth:10000,minX:0,minY:0,pinned:false,preserveRatio:false,resizeChild:false,transparent:false,resizeTo:function(B,A){this.el.setSize(B,A);this.updateChildSize();this.fireEvent("resize",this,B,A,null)},startSizing:function(C,B){this.fireEvent("beforeresize",this,C);if(this.enabled){if(!this.overlay){this.overlay=this.el.createProxy({tag:"div",cls:"x-resizable-overlay",html:"&#160;"},Ext.getBody());this.overlay.unselectable();this.overlay.enableDisplayMode("block");this.overlay.on({scope:this,mousemove:this.onMouseMove,mouseup:this.onMouseUp})}this.overlay.setStyle("cursor",B.el.getStyle("cursor"));this.resizing=true;this.startBox=this.el.getBox();this.startPoint=C.getXY();this.offsets=[(this.startBox.x+this.startBox.width)-this.startPoint[0],(this.startBox.y+this.startBox.height)-this.startPoint[1]];this.overlay.setSize(Ext.lib.Dom.getViewWidth(true),Ext.lib.Dom.getViewHeight(true));this.overlay.show();if(this.constrainTo){var A=Ext.get(this.constrainTo);this.resizeRegion=A.getRegion().adjust(A.getFrameWidth("t"),A.getFrameWidth("l"),-A.getFrameWidth("b"),-A.getFrameWidth("r"))}this.proxy.setStyle("visibility","hidden");this.proxy.show();this.proxy.setBox(this.startBox);if(!this.dynamic){this.proxy.setStyle("visibility","visible")}}},onMouseDown:function(A,B){if(this.enabled){B.stopEvent();this.activeHandle=A;this.startSizing(B,A)}},onMouseUp:function(B){this.activeHandle=null;var A=this.resizeElement();this.resizing=false;this.handleOut();this.overlay.hide();this.proxy.hide();this.fireEvent("resize",this,A.width,A.height,B)},updateChildSize:function(){if(this.resizeChild){var C=this.el;var D=this.resizeChild;var B=this.adjustments;if(C.dom.offsetWidth){var A=C.getSize(true);D.setSize(A.width+B[0],A.height+B[1])}if(Ext.isIE){setTimeout(function(){if(C.dom.offsetWidth){var E=C.getSize(true);D.setSize(E.width+B[0],E.height+B[1])}},10)}}},snap:function(C,E,B){if(!E||!C){return C}var D=C;var A=C%E;if(A>0){if(A>(E/2)){D=C+(E-A)}else{D=C-A}}return Math.max(B,D)},resizeElement:function(){var A=this.proxy.getBox();if(this.updateBox){this.el.setBox(A,false,this.animate,this.duration,null,this.easing)}else{this.el.setSize(A.width,A.height,this.animate,this.duration,null,this.easing)}this.updateChildSize();if(!this.dynamic){this.proxy.hide()}return A},constrain:function(B,C,A,D){if(B-C<A){C=B-A}else{if(B-C>D){C=B-D}}return C},onMouseMove:function(T){if(this.enabled&&this.activeHandle){try{if(this.resizeRegion&&!this.resizeRegion.contains(T.getPoint())){return }var Q=this.curSize||this.startBox,I=this.startBox.x,H=this.startBox.y,C=I,B=H,J=Q.width,R=Q.height,D=J,L=R,K=this.minWidth,U=this.minHeight,P=this.maxWidth,X=this.maxHeight,F=this.widthIncrement,A=this.heightIncrement,V=T.getXY(),O=-(this.startPoint[0]-Math.max(this.minX,V[0])),M=-(this.startPoint[1]-Math.max(this.minY,V[1])),G=this.activeHandle.position,Y,E;switch(G){case"east":J+=O;J=Math.min(Math.max(K,J),P);break;case"south":R+=M;R=Math.min(Math.max(U,R),X);break;case"southeast":J+=O;R+=M;J=Math.min(Math.max(K,J),P);R=Math.min(Math.max(U,R),X);break;case"north":M=this.constrain(R,M,U,X);H+=M;R-=M;break;case"west":O=this.constrain(J,O,K,P);I+=O;J-=O;break;case"northeast":J+=O;J=Math.min(Math.max(K,J),P);M=this.constrain(R,M,U,X);H+=M;R-=M;break;case"northwest":O=this.constrain(J,O,K,P);M=this.constrain(R,M,U,X);H+=M;R-=M;I+=O;J-=O;break;case"southwest":O=this.constrain(J,O,K,P);R+=M;R=Math.min(Math.max(U,R),X);I+=O;J-=O;break}var N=this.snap(J,F,K);var W=this.snap(R,A,U);if(N!=J||W!=R){switch(G){case"northeast":H-=W-R;break;case"north":H-=W-R;break;case"southwest":I-=N-J;break;case"west":I-=N-J;break;case"northwest":I-=N-J;H-=W-R;break}J=N;R=W}if(this.preserveRatio){switch(G){case"southeast":case"east":R=L*(J/D);R=Math.min(Math.max(U,R),X);J=D*(R/L);break;case"south":J=D*(R/L);J=Math.min(Math.max(K,J),P);R=L*(J/D);break;case"northeast":J=D*(R/L);J=Math.min(Math.max(K,J),P);R=L*(J/D);break;case"north":Y=J;J=D*(R/L);J=Math.min(Math.max(K,J),P);R=L*(J/D);I+=(Y-J)/2;break;case"southwest":R=L*(J/D);R=Math.min(Math.max(U,R),X);Y=J;J=D*(R/L);I+=Y-J;break;case"west":E=R;R=L*(J/D);R=Math.min(Math.max(U,R),X);H+=(E-R)/2;Y=J;J=D*(R/L);I+=Y-J;break;case"northwest":Y=J;E=R;R=L*(J/D);R=Math.min(Math.max(U,R),X);J=D*(R/L);H+=E-R;I+=Y-J;break}}this.proxy.setBounds(I,H,J,R);if(this.dynamic){this.resizeElement()}}catch(S){}}},handleOver:function(){if(this.enabled){this.el.addClass("x-resizable-over")}},handleOut:function(){if(!this.resizing){this.el.removeClass("x-resizable-over")}},getEl:function(){return this.el},getResizeChild:function(){return this.resizeChild},destroy:function(B){Ext.destroy(this.dd,this.overlay,this.proxy);this.overlay=null;this.proxy=null;var C=Ext.Resizable.positions;for(var A in C){if(typeof C[A]!="function"&&this[C[A]]){this[C[A]].destroy()}}if(B){this.el.update("");Ext.destroy(this.el);this.el=null}this.purgeListeners()},syncHandleHeight:function(){var A=this.el.getHeight(true);if(this.west){this.west.el.setHeight(A)}if(this.east){this.east.el.setHeight(A)}}});Ext.Resizable.positions={n:"north",s:"south",e:"east",w:"west",se:"southeast",sw:"southwest",nw:"northwest",ne:"northeast"};Ext.Resizable.Handle=function(C,E,B,D){if(!this.tpl){var A=Ext.DomHelper.createTemplate({tag:"div",cls:"x-resizable-handle x-resizable-handle-{0}"});A.compile();Ext.Resizable.Handle.prototype.tpl=A}this.position=E;this.rz=C;this.el=this.tpl.append(C.el.dom,[this.position],true);this.el.unselectable();if(D){this.el.setOpacity(0)}this.el.on("mousedown",this.onMouseDown,this);if(!B){this.el.on({scope:this,mouseover:this.onMouseOver,mouseout:this.onMouseOut})}};Ext.Resizable.Handle.prototype={afterResize:function(A){},onMouseDown:function(A){this.rz.onMouseDown(this,A)},onMouseOver:function(A){this.rz.handleOver(this,A)},onMouseOut:function(A){this.rz.handleOut(this,A)},destroy:function(){Ext.destroy(this.el);this.el=null}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Window=Ext.extend(Ext.Panel,{baseCls:"x-window",resizable:true,draggable:true,closable:true,closeAction:"close",constrain:false,constrainHeader:false,plain:false,minimizable:false,maximizable:false,minHeight:100,minWidth:200,expandOnShow:true,collapsible:false,initHidden:true,monitorResize:true,elements:"header,body",frame:true,floating:true,initComponent:function(){Ext.Window.superclass.initComponent.call(this);this.addEvents("resize","maximize","minimize","restore");if(this.initHidden===false){this.show()}else{this.hidden=true}},getState:function(){return Ext.apply(Ext.Window.superclass.getState.call(this)||{},this.getBox(true))},onRender:function(B,A){Ext.Window.superclass.onRender.call(this,B,A);if(this.plain){this.el.addClass("x-window-plain")}this.focusEl=this.el.createChild({tag:"a",href:"#",cls:"x-dlg-focus",tabIndex:"-1",html:"&#160;"});this.focusEl.swallowEvent("click",true);this.proxy=this.el.createProxy("x-window-proxy");this.proxy.enableDisplayMode("block");if(this.modal){this.mask=this.container.createChild({cls:"ext-el-mask"},this.el.dom);this.mask.enableDisplayMode("block");this.mask.hide();this.mon(this.mask,"click",this.focus,this)}this.initTools()},initEvents:function(){Ext.Window.superclass.initEvents.call(this);if(this.animateTarget){this.setAnimateTarget(this.animateTarget)}if(this.resizable){this.resizer=new Ext.Resizable(this.el,{minWidth:this.minWidth,minHeight:this.minHeight,handles:this.resizeHandles||"all",pinned:true,resizeElement:this.resizerAction});this.resizer.window=this;this.mon(this.resizer,"beforeresize",this.beforeResize,this)}if(this.draggable){this.header.addClass("x-window-draggable")}this.mon(this.el,"mousedown",this.toFront,this);this.manager=this.manager||Ext.WindowMgr;this.manager.register(this);if(this.maximized){this.maximized=false;this.maximize()}if(this.closable){var A=this.getKeyMap();A.on(27,this.onEsc,this);A.disable()}},initDraggable:function(){this.dd=new Ext.Window.DD(this)},onEsc:function(){this[this.closeAction]()},beforeDestroy:function(){if(this.rendered){this.hide();if(this.doAnchor){Ext.EventManager.removeResizeListener(this.doAnchor,this);Ext.EventManager.un(window,"scroll",this.doAnchor,this)}Ext.destroy(this.focusEl,this.resizer,this.dd,this.proxy,this.mask)}Ext.Window.superclass.beforeDestroy.call(this)},onDestroy:function(){if(this.manager){this.manager.unregister(this)}Ext.Window.superclass.onDestroy.call(this)},initTools:function(){if(this.minimizable){this.addTool({id:"minimize",handler:this.minimize.createDelegate(this,[])})}if(this.maximizable){this.addTool({id:"maximize",handler:this.maximize.createDelegate(this,[])});this.addTool({id:"restore",handler:this.restore.createDelegate(this,[]),hidden:true});this.mon(this.header,"dblclick",this.toggleMaximize,this)}if(this.closable){this.addTool({id:"close",handler:this[this.closeAction].createDelegate(this,[])})}},resizerAction:function(){var A=this.proxy.getBox();this.proxy.hide();this.window.handleResize(A);return A},beforeResize:function(){this.resizer.minHeight=Math.max(this.minHeight,this.getFrameHeight()+40);this.resizer.minWidth=Math.max(this.minWidth,this.getFrameWidth()+40);this.resizeBox=this.el.getBox()},updateHandles:function(){if(Ext.isIE&&this.resizer){this.resizer.syncHandleHeight();this.el.repaint()}},handleResize:function(B){var A=this.resizeBox;if(A.x!=B.x||A.y!=B.y){this.updateBox(B)}else{this.setSize(B)}this.focus();this.updateHandles();this.saveState();this.doLayout();this.fireEvent("resize",this,B.width,B.height)},focus:function(){var C=this.focusEl,A=this.defaultButton,B=typeof A;if(B!="undefined"){if(B=="number"&&this.fbar){C=this.fbar.items.get(A)}else{if(B=="string"){C=Ext.getCmp(A)}else{C=A}}}C=C||this.focusEl;C.focus.defer(10,C)},setAnimateTarget:function(A){A=Ext.get(A);this.animateTarget=A},beforeShow:function(){delete this.el.lastXY;delete this.el.lastLT;if(this.x===undefined||this.y===undefined){var A=this.el.getAlignToXY(this.container,"c-c");var B=this.el.translatePoints(A[0],A[1]);this.x=this.x===undefined?B.left:this.x;this.y=this.y===undefined?B.top:this.y}this.el.setLeftTop(this.x,this.y);if(this.expandOnShow){this.expand(false)}if(this.modal){Ext.getBody().addClass("x-body-masked");this.mask.setSize(Ext.lib.Dom.getViewWidth(true),Ext.lib.Dom.getViewHeight(true));this.mask.show()}},show:function(C,A,B){if(!this.rendered){this.render(Ext.getBody())}if(this.hidden===false){this.toFront();return this}if(this.fireEvent("beforeshow",this)===false){return this}if(A){this.on("show",A,B,{single:true})}this.hidden=false;if(C!==undefined){this.setAnimateTarget(C)}this.beforeShow();if(this.animateTarget){this.animShow()}else{this.afterShow()}return this},afterShow:function(B){this.proxy.hide();this.el.setStyle("display","block");this.el.show();if(this.maximized){this.fitContainer()}if(Ext.isMac&&Ext.isGecko){this.cascade(this.setAutoScroll)}if(this.monitorResize||this.modal||this.constrain||this.constrainHeader){Ext.EventManager.onWindowResize(this.onWindowResize,this)}this.doConstrain();this.doLayout();if(this.keyMap){this.keyMap.enable()}this.toFront();this.updateHandles();if(B&&(Ext.isIE||Ext.isWebKit)){var A=this.getSize();this.onResize(A.width,A.height)}this.fireEvent("show",this)},animShow:function(){this.proxy.show();this.proxy.setBox(this.animateTarget.getBox());this.proxy.setOpacity(0);var A=this.getBox(false);A.callback=this.afterShow.createDelegate(this,[true],false);A.scope=this;A.duration=0.25;A.easing="easeNone";A.opacity=0.5;A.block=true;this.el.setStyle("display","none");this.proxy.shift(A)},hide:function(C,A,B){if(this.hidden||this.fireEvent("beforehide",this)===false){return this}if(A){this.on("hide",A,B,{single:true})}this.hidden=true;if(C!==undefined){this.setAnimateTarget(C)}if(this.modal){this.mask.hide();Ext.getBody().removeClass("x-body-masked")}if(this.animateTarget){this.animHide()}else{this.el.hide();this.afterHide()}return this},afterHide:function(){this.proxy.hide();if(this.monitorResize||this.modal||this.constrain||this.constrainHeader){Ext.EventManager.removeResizeListener(this.onWindowResize,this)}if(this.keyMap){this.keyMap.disable()}this.fireEvent("hide",this)},animHide:function(){this.proxy.setOpacity(0.5);this.proxy.show();var B=this.getBox(false);this.proxy.setBox(B);this.el.hide();var A=this.animateTarget.getBox();A.callback=this.afterHide;A.scope=this;A.duration=0.25;A.easing="easeNone";A.block=true;A.opacity=0;this.proxy.shift(A)},onWindowResize:function(){if(this.maximized){this.fitContainer()}if(this.modal){this.mask.setSize("100%","100%");var A=this.mask.dom.offsetHeight;this.mask.setSize(Ext.lib.Dom.getViewWidth(true),Ext.lib.Dom.getViewHeight(true))}this.doConstrain()},doConstrain:function(){if(this.constrain||this.constrainHeader){var B;if(this.constrain){B={right:this.el.shadowOffset,left:this.el.shadowOffset,bottom:this.el.shadowOffset}}else{var A=this.getSize();B={right:-(A.width-100),bottom:-(A.height-25)}}var C=this.el.getConstrainToXY(this.container,true,B);if(C){this.setPosition(C[0],C[1])}}},ghost:function(A){var C=this.createGhost(A);var B=this.getBox(true);C.setLeftTop(B.x,B.y);C.setWidth(B.width);this.el.hide();this.activeGhost=C;return C},unghost:function(B,A){if(!this.activeGhost){return }if(B!==false){this.el.show();this.focus();if(Ext.isMac&&Ext.isGecko){this.cascade(this.setAutoScroll)}}if(A!==false){this.setPosition(this.activeGhost.getLeft(true),this.activeGhost.getTop(true))}this.activeGhost.hide();this.activeGhost.remove();delete this.activeGhost},minimize:function(){this.fireEvent("minimize",this);return this},close:function(){if(this.fireEvent("beforeclose",this)!==false){this.hide(null,function(){this.fireEvent("close",this);this.destroy()},this)}},maximize:function(){if(!this.maximized){this.expand(false);this.restoreSize=this.getSize();this.restorePos=this.getPosition(true);if(this.maximizable){this.tools.maximize.hide();this.tools.restore.show()}this.maximized=true;this.el.disableShadow();if(this.dd){this.dd.lock()}if(this.collapsible){this.tools.toggle.hide()}this.el.addClass("x-window-maximized");this.container.addClass("x-window-maximized-ct");this.setPosition(0,0);this.fitContainer();this.fireEvent("maximize",this)}return this},restore:function(){if(this.maximized){this.el.removeClass("x-window-maximized");this.tools.restore.hide();this.tools.maximize.show();this.setPosition(this.restorePos[0],this.restorePos[1]);this.setSize(this.restoreSize.width,this.restoreSize.height);delete this.restorePos;delete this.restoreSize;this.maximized=false;this.el.enableShadow(true);if(this.dd){this.dd.unlock()}if(this.collapsible){this.tools.toggle.show()}this.container.removeClass("x-window-maximized-ct");this.doConstrain();this.fireEvent("restore",this)}return this},toggleMaximize:function(){return this[this.maximized?"restore":"maximize"]()},fitContainer:function(){var A=this.container.getViewSize();this.setSize(A.width,A.height)},setZIndex:function(A){if(this.modal){this.mask.setStyle("z-index",A)}this.el.setZIndex(++A);A+=5;if(this.resizer){this.resizer.proxy.setStyle("z-index",++A)}this.lastZIndex=A},alignTo:function(B,A,C){var D=this.el.getAlignToXY(B,A,C);this.setPagePosition(D[0],D[1]);return this},anchorTo:function(C,E,D,B){if(this.doAnchor){Ext.EventManager.removeResizeListener(this.doAnchor,this);Ext.EventManager.un(window,"scroll",this.doAnchor,this)}this.doAnchor=function(){this.alignTo(C,E,D)};Ext.EventManager.onWindowResize(this.doAnchor,this);var A=typeof B;if(A!="undefined"){Ext.EventManager.on(window,"scroll",this.doAnchor,this,{buffer:A=="number"?B:50})}this.doAnchor();return this},toFront:function(A){if(this.manager.bringToFront(this)){if(!A||!A.getTarget().focus){this.focus()}}return this},setActive:function(A){if(A){if(!this.maximized){this.el.enableShadow(true)}this.fireEvent("activate",this)}else{this.el.disableShadow();this.fireEvent("deactivate",this)}},toBack:function(){this.manager.sendToBack(this);return this},center:function(){var A=this.el.getAlignToXY(this.container,"c-c");this.setPagePosition(A[0],A[1]);return this}});Ext.reg("window",Ext.Window);Ext.Window.DD=function(A){this.win=A;Ext.Window.DD.superclass.constructor.call(this,A.el.id,"WindowDD-"+A.id);this.setHandleElId(A.header.id);this.scroll=false};Ext.extend(Ext.Window.DD,Ext.dd.DD,{moveOnly:true,headerOffsets:[100,25],startDrag:function(){var A=this.win;this.proxy=A.ghost();if(A.constrain!==false){var C=A.el.shadowOffset;this.constrainTo(A.container,{right:C,left:C,bottom:C})}else{if(A.constrainHeader!==false){var B=this.proxy.getSize();this.constrainTo(A.container,{right:-(B.width-this.headerOffsets[0]),bottom:-(B.height-this.headerOffsets[1])})}}},b4Drag:Ext.emptyFn,onDrag:function(A){this.alignElWithMouse(this.proxy,A.getPageX(),A.getPageY())},endDrag:function(A){this.win.unghost();this.win.saveState()}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.WindowGroup=function(){var F={};var D=[];var E=null;var C=function(I,H){return(!I._lastAccess||I._lastAccess<H._lastAccess)?-1:1};var G=function(){var J=D,H=J.length;if(H>0){J.sort(C);var I=J[0].manager.zseed;for(var K=0;K<H;K++){var L=J[K];if(L&&!L.hidden){L.setZIndex(I+(K*10))}}}A()};var B=function(H){if(H!=E){if(E){E.setActive(false)}E=H;if(H){H.setActive(true)}}};var A=function(){for(var H=D.length-1;H>=0;--H){if(!D[H].hidden){B(D[H]);return }}B(null)};return{zseed:9000,register:function(H){F[H.id]=H;D.push(H);H.on("hide",A)},unregister:function(H){delete F[H.id];H.un("hide",A);D.remove(H)},get:function(H){return typeof H=="object"?H:F[H]},bringToFront:function(H){H=this.get(H);if(H!=E){H._lastAccess=new Date().getTime();G();return true}return false},sendToBack:function(H){H=this.get(H);H._lastAccess=-(new Date().getTime());G();return H},hideAll:function(){for(var H in F){if(F[H]&&typeof F[H]!="function"&&F[H].isVisible()){F[H].hide()}}},getActive:function(){return E},getBy:function(J,I){var K=[];for(var H=D.length-1;H>=0;--H){var L=D[H];if(J.call(I||L,L)!==false){K.push(L)}}return K},each:function(I,H){for(var J in F){if(F[J]&&typeof F[J]!="function"){if(I.call(H||F[J],F[J])===false){return }}}}}};Ext.WindowMgr=new Ext.WindowGroup();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.MessageBox=function(){var R,B,N,Q;var G,J,P,A,K,M,H,F;var O,S,L,C="";var D=function(U){if(R.isVisible()){R.hide();T();Ext.callback(B.fn,B.scope||window,[U,S.dom.value,B],1)}};var T=function(){if(B&&B.cls){R.el.removeClass(B.cls)}K.reset()};var E=function(W,U,V){if(B&&B.closable!==false){R.hide();T()}if(V){V.stopEvent()}};var I=function(U){var W=0;if(!U){O.ok.hide();O.cancel.hide();O.yes.hide();O.no.hide();return W}R.footer.dom.style.display="";for(var V in O){if(typeof O[V]!="function"){if(U[V]){O[V].show();O[V].setText(typeof U[V]=="string"?U[V]:Ext.MessageBox.buttonText[V]);W+=O[V].el.getWidth()+15}else{O[V].hide()}}}return W};return{getDialog:function(U){if(!R){R=new Ext.Window({autoCreate:true,title:U,resizable:false,constrain:true,constrainHeader:true,minimizable:false,maximizable:false,stateful:false,modal:true,shim:true,buttonAlign:"center",width:400,height:100,minHeight:80,plain:true,footer:true,closable:true,close:function(){if(B&&B.buttons&&B.buttons.no&&!B.buttons.cancel){D("no")}else{D("cancel")}}});O={};var V=this.buttonText;O.ok=R.addButton(V.ok,D.createCallback("ok"));O.yes=R.addButton(V.yes,D.createCallback("yes"));O.no=R.addButton(V.no,D.createCallback("no"));O.cancel=R.addButton(V.cancel,D.createCallback("cancel"));O.ok.hideMode=O.yes.hideMode=O.no.hideMode=O.cancel.hideMode="offsets";R.render(document.body);R.getEl().addClass("x-window-dlg");N=R.mask;G=R.body.createChild({html:'<div class="ext-mb-icon"></div><div class="ext-mb-content"><span class="ext-mb-text"></span><br /><div class="ext-mb-fix-cursor"><input type="text" class="ext-mb-input" /><textarea class="ext-mb-textarea"></textarea></div></div>'});H=Ext.get(G.dom.firstChild);var W=G.dom.childNodes[1];J=Ext.get(W.firstChild);P=Ext.get(W.childNodes[2].firstChild);P.enableDisplayMode();P.addKeyListener([10,13],function(){if(R.isVisible()&&B&&B.buttons){if(B.buttons.ok){D("ok")}else{if(B.buttons.yes){D("yes")}}}});A=Ext.get(W.childNodes[2].childNodes[1]);A.enableDisplayMode();K=new Ext.ProgressBar({renderTo:G});G.createChild({cls:"x-clear"})}return R},updateText:function(X){if(!R.isVisible()&&!B.width){R.setSize(this.maxWidth,100)}J.update(X||"&#160;");var V=C!=""?(H.getWidth()+H.getMargins("lr")):0;var Z=J.getWidth()+J.getMargins("lr");var W=R.getFrameWidth("lr");var Y=R.body.getFrameWidth("lr");if(Ext.isIE&&V>0){V+=3}var U=Math.max(Math.min(B.width||V+Z+W+Y,this.maxWidth),Math.max(B.minWidth||this.minWidth,L||0));if(B.prompt===true){S.setWidth(U-V-W-Y)}if(B.progress===true||B.wait===true){K.setSize(U-V-W-Y)}if(Ext.isIE&&U==L){U+=6}R.setSize(U,"auto").center();return this},updateProgress:function(V,U,W){K.updateProgress(V,U);if(W){this.updateText(W)}return this},isVisible:function(){return R&&R.isVisible()},hide:function(){var U=R?R.activeGhost:null;if(this.isVisible()||U){R.hide();T();if(U){R.unghost(false,false)}}return this},show:function(X){if(this.isVisible()){this.hide()}B=X;var Y=this.getDialog(B.title||"&#160;");Y.setTitle(B.title||"&#160;");var U=(B.closable!==false&&B.progress!==true&&B.wait!==true);Y.tools.close.setDisplayed(U);S=P;B.prompt=B.prompt||(B.multiline?true:false);if(B.prompt){if(B.multiline){P.hide();A.show();A.setHeight(typeof B.multiline=="number"?B.multiline:this.defaultTextHeight);S=A}else{P.show();A.hide()}}else{P.hide();A.hide()}S.dom.value=B.value||"";if(B.prompt){Y.focusEl=S}else{var W=B.buttons;var V=null;if(W&&W.ok){V=O.ok}else{if(W&&W.yes){V=O.yes}}if(V){Y.focusEl=V}}if(B.iconCls){Y.setIconClass(B.iconCls)}this.setIcon(B.icon);if(B.cls){Y.el.addClass(B.cls)}Y.proxyDrag=B.proxyDrag===true;Y.modal=B.modal!==false;Y.mask=B.modal!==false?N:false;Y.on("show",function(){Y.keyMap.setDisabled(U!==true);Y.doLayout();this.setIcon(B.icon);L=I(B.buttons);K.setVisible(B.progress===true||B.wait===true);this.updateProgress(0,B.progressText);this.updateText(B.msg);if(B.wait===true){K.wait(B.waitConfig)}},this,{single:true});if(!Y.isVisible()){document.body.appendChild(R.el.dom);Y.setAnimateTarget(B.animEl);Y.show(B.animEl)}return this},setIcon:function(U){if(U&&U!=""){H.removeClass("x-hidden");H.replaceClass(C,U);G.addClass("x-dlg-icon");C=U}else{H.replaceClass(C,"x-hidden");G.removeClass("x-dlg-icon");C=""}return this},progress:function(W,V,U){this.show({title:W,msg:V,buttons:false,progress:true,closable:false,minWidth:this.minProgressWidth,progressText:U});return this},wait:function(W,V,U){this.show({title:V,msg:W,buttons:false,closable:false,wait:true,modal:true,minWidth:this.minProgressWidth,waitConfig:U});return this},alert:function(X,W,V,U){this.show({title:X,msg:W,buttons:this.OK,fn:V,scope:U});return this},confirm:function(X,W,V,U){this.show({title:X,msg:W,buttons:this.YESNO,fn:V,scope:U,icon:this.QUESTION});return this},prompt:function(Z,Y,W,V,U,X){this.show({title:Z,msg:Y,buttons:this.OKCANCEL,fn:W,minWidth:250,scope:V,prompt:true,multiline:U,value:X});return this},OK:{ok:true},CANCEL:{cancel:true},OKCANCEL:{ok:true,cancel:true},YESNO:{yes:true,no:true},YESNOCANCEL:{yes:true,no:true,cancel:true},INFO:"ext-mb-info",WARNING:"ext-mb-warning",QUESTION:"ext-mb-question",ERROR:"ext-mb-error",defaultTextHeight:75,maxWidth:600,minWidth:110,minProgressWidth:250,buttonText:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No"}}}();Ext.Msg=Ext.MessageBox;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.dd.PanelProxy=function(A,B){this.panel=A;this.id=this.panel.id+"-ddproxy";Ext.apply(this,B)};Ext.dd.PanelProxy.prototype={insertProxy:true,setStatus:Ext.emptyFn,reset:Ext.emptyFn,update:Ext.emptyFn,stop:Ext.emptyFn,sync:Ext.emptyFn,getEl:function(){return this.ghost},getGhost:function(){return this.ghost},getProxy:function(){return this.proxy},hide:function(){if(this.ghost){if(this.proxy){this.proxy.remove();delete this.proxy}this.panel.el.dom.style.display="";this.ghost.remove();delete this.ghost}},show:function(){if(!this.ghost){this.ghost=this.panel.createGhost(undefined,undefined,Ext.getBody());this.ghost.setXY(this.panel.el.getXY());if(this.insertProxy){this.proxy=this.panel.el.insertSibling({cls:"x-panel-dd-spacer"});this.proxy.setSize(this.panel.getSize())}this.panel.el.dom.style.display="none"}},repair:function(B,C,A){this.hide();if(typeof C=="function"){C.call(A||this)}},moveProxy:function(A,B){if(this.proxy){A.insertBefore(this.proxy.dom,B)}}};Ext.Panel.DD=function(B,A){this.panel=B;this.dragData={panel:B};this.proxy=new Ext.dd.PanelProxy(B,A);Ext.Panel.DD.superclass.constructor.call(this,B.el,A);var C=B.header;if(C){this.setHandleElId(C.id)}(C?C:this.panel.body).setStyle("cursor","move");this.scroll=false};Ext.extend(Ext.Panel.DD,Ext.dd.DragSource,{showFrame:Ext.emptyFn,startDrag:Ext.emptyFn,b4StartDrag:function(A,B){this.proxy.show()},b4MouseDown:function(B){var A=B.getPageX();var C=B.getPageY();this.autoOffset(A,C)},onInitDrag:function(A,B){this.onStartDrag(A,B);return true},createFrame:Ext.emptyFn,getDragEl:function(A){return this.proxy.ghost.dom},endDrag:function(A){this.proxy.hide();this.panel.saveState()},autoOffset:function(A,B){A-=this.startPageX;B-=this.startPageY;this.setDelta(A,B)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.state.Provider=function(){this.addEvents("statechange");this.state={};Ext.state.Provider.superclass.constructor.call(this)};Ext.extend(Ext.state.Provider,Ext.util.Observable,{get:function(B,A){return typeof this.state[B]=="undefined"?A:this.state[B]},clear:function(A){delete this.state[A];this.fireEvent("statechange",this,A,null)},set:function(A,B){this.state[A]=B;this.fireEvent("statechange",this,A,B)},decodeValue:function(A){var J=/^(a|n|d|b|s|o)\:(.*)$/;var C=J.exec(unescape(A));if(!C||!C[1]){return }var F=C[1];var H=C[2];switch(F){case"n":return parseFloat(H);case"d":return new Date(Date.parse(H));case"b":return(H=="1");case"a":var G=[];var I=H.split("^");for(var B=0,D=I.length;B<D;B++){G.push(this.decodeValue(I[B]))}return G;case"o":var G={};var I=H.split("^");for(var B=0,D=I.length;B<D;B++){var E=I[B].split("=");G[E[0]]=this.decodeValue(E[1])}return G;default:return H}},encodeValue:function(C){var B;if(typeof C=="number"){B="n:"+C}else{if(typeof C=="boolean"){B="b:"+(C?"1":"0")}else{if(Ext.isDate(C)){B="d:"+C.toGMTString()}else{if(Ext.isArray(C)){var F="";for(var E=0,A=C.length;E<A;E++){F+=this.encodeValue(C[E]);if(E!=A-1){F+="^"}}B="a:"+F}else{if(typeof C=="object"){var F="";for(var D in C){if(typeof C[D]!="function"&&C[D]!==undefined){F+=D+"="+this.encodeValue(C[D])+"^"}}B="o:"+F.substring(0,F.length-1)}else{B="s:"+C}}}}}return escape(B)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.state.Manager=function(){var A=new Ext.state.Provider();return{setProvider:function(B){A=B},get:function(C,B){return A.get(C,B)},set:function(B,C){A.set(B,C)},clear:function(B){A.clear(B)},getProvider:function(){return A}}}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.state.CookieProvider=function(A){Ext.state.CookieProvider.superclass.constructor.call(this);this.path="/";this.expires=new Date(new Date().getTime()+(1000*60*60*24*7));this.domain=null;this.secure=false;Ext.apply(this,A);this.state=this.readCookies()};Ext.extend(Ext.state.CookieProvider,Ext.state.Provider,{set:function(A,B){if(typeof B=="undefined"||B===null){this.clear(A);return }this.setCookie(A,B);Ext.state.CookieProvider.superclass.set.call(this,A,B)},clear:function(A){this.clearCookie(A);Ext.state.CookieProvider.superclass.clear.call(this,A)},readCookies:function(){var C={};var F=document.cookie+";";var B=/\s?(.*?)=(.*?);/g;var E;while((E=B.exec(F))!=null){var A=E[1];var D=E[2];if(A&&A.substring(0,3)=="ys-"){C[A.substr(3)]=this.decodeValue(D)}}return C},setCookie:function(A,B){document.cookie="ys-"+A+"="+this.encodeValue(B)+((this.expires==null)?"":("; expires="+this.expires.toGMTString()))+((this.path==null)?"":("; path="+this.path))+((this.domain==null)?"":("; domain="+this.domain))+((this.secure==true)?"; secure":"")},clearCookie:function(A){document.cookie="ys-"+A+"=null; expires=Thu, 01-Jan-70 00:00:01 GMT"+((this.path==null)?"":("; path="+this.path))+((this.domain==null)?"":("; domain="+this.domain))+((this.secure==true)?"; secure":"")}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.DataView=Ext.extend(Ext.BoxComponent,{selectedClass:"x-view-selected",emptyText:"",deferEmptyText:true,trackOver:false,last:false,initComponent:function(){Ext.DataView.superclass.initComponent.call(this);if(Ext.isString(this.tpl)||Ext.isArray(this.tpl)){this.tpl=new Ext.XTemplate(this.tpl)}this.addEvents("beforeclick","click","mouseenter","mouseleave","containerclick","dblclick","contextmenu","containercontextmenu","selectionchange","beforeselect");this.store=Ext.StoreMgr.lookup(this.store);this.all=new Ext.CompositeElementLite();this.selected=new Ext.CompositeElementLite()},afterRender:function(){Ext.DataView.superclass.afterRender.call(this);this.mon(this.getTemplateTarget(),{click:this.onClick,dblclick:this.onDblClick,contextmenu:this.onContextMenu,scope:this});if(this.overClass||this.trackOver){this.mon(this.getTemplateTarget(),{mouseover:this.onMouseOver,mouseout:this.onMouseOut,scope:this})}if(this.store){this.bindStore(this.store,true)}},refresh:function(){this.clearSelections(false,true);var B=this.getTemplateTarget();B.update("");var A=this.store.getRange();if(A.length<1){if(!this.deferEmptyText||this.hasSkippedEmptyText){B.update(this.emptyText)}this.all.clear()}else{this.tpl.overwrite(B,this.collectData(A,0));this.all.fill(Ext.query(this.itemSelector,B.dom));this.updateIndexes(0)}this.hasSkippedEmptyText=true},getTemplateTarget:function(){return this.el},prepareData:function(A){return A},collectData:function(B,E){var D=[];for(var C=0,A=B.length;C<A;C++){D[D.length]=this.prepareData(B[C].data,E+C,B[C])}return D},bufferRender:function(A){var B=document.createElement("div");this.tpl.overwrite(B,this.collectData(A));return Ext.query(this.itemSelector,B)},onUpdate:function(F,A){var B=this.store.indexOf(A);var E=this.isSelected(B);var C=this.all.elements[B];var D=this.bufferRender([A],B)[0];this.all.replaceElement(B,D,true);if(E){this.selected.replaceElement(C,D);this.all.item(B).addClass(this.selectedClass)}this.updateIndexes(B,B)},onAdd:function(E,C,D){if(this.all.getCount()===0){this.refresh();return }var B=this.bufferRender(C,D),F,A=this.all.elements;if(D<this.all.getCount()){F=this.all.item(D).insertSibling(B,"before",true);A.splice.apply(A,[D,0].concat(B))}else{F=this.all.last().insertSibling(B,"after",true);A.push.apply(A,B)}this.updateIndexes(D)},onRemove:function(C,A,B){this.deselect(B);this.all.removeElement(B,true);this.updateIndexes(B);if(this.store.getCount()===0){this.refresh()}},refreshNode:function(A){this.onUpdate(this.store,this.store.getAt(A))},updateIndexes:function(D,C){var B=this.all.elements;D=D||0;C=C||((C===0)?0:(B.length-1));for(var A=D;A<=C;A++){B[A].viewIndex=A}},getStore:function(){return this.store},bindStore:function(A,B){if(!B&&this.store){this.store.un("beforeload",this.onBeforeLoad,this);this.store.un("datachanged",this.refresh,this);this.store.un("add",this.onAdd,this);this.store.un("remove",this.onRemove,this);this.store.un("update",this.onUpdate,this);this.store.un("clear",this.refresh,this);if(A!==this.store&&this.store.autoDestroy){this.store.destroy()}}if(A){A=Ext.StoreMgr.lookup(A);A.on({scope:this,beforeload:this.onBeforeLoad,datachanged:this.refresh,add:this.onAdd,remove:this.onRemove,update:this.onUpdate,clear:this.refresh})}this.store=A;if(A){this.refresh()}},findItemFromChild:function(A){return Ext.fly(A).findParent(this.itemSelector,this.getTemplateTarget())},onClick:function(C){var B=C.getTarget(this.itemSelector,this.getTemplateTarget());if(B){var A=this.indexOf(B);if(this.onItemClick(B,A,C)!==false){this.fireEvent("click",this,A,B,C)}}else{if(this.fireEvent("containerclick",this,C)!==false){this.onContainerClick(C)}}},onContainerClick:function(A){this.clearSelections()},onContextMenu:function(B){var A=B.getTarget(this.itemSelector,this.getTemplateTarget());if(A){this.fireEvent("contextmenu",this,this.indexOf(A),A,B)}else{this.fireEvent("containercontextmenu",this,B)}},onDblClick:function(B){var A=B.getTarget(this.itemSelector,this.getTemplateTarget());if(A){this.fireEvent("dblclick",this,this.indexOf(A),A,B)}},onMouseOver:function(B){var A=B.getTarget(this.itemSelector,this.getTemplateTarget());if(A&&A!==this.lastItem){this.lastItem=A;Ext.fly(A).addClass(this.overClass);this.fireEvent("mouseenter",this,this.indexOf(A),A,B)}},onMouseOut:function(A){if(this.lastItem){if(!A.within(this.lastItem,true,true)){Ext.fly(this.lastItem).removeClass(this.overClass);this.fireEvent("mouseleave",this,this.indexOf(this.lastItem),this.lastItem,A);delete this.lastItem}}},onItemClick:function(B,A,C){if(this.fireEvent("beforeclick",this,A,B,C)===false){return false}if(this.multiSelect){this.doMultiSelection(B,A,C);C.preventDefault()}else{if(this.singleSelect){this.doSingleSelection(B,A,C);C.preventDefault()}}return true},doSingleSelection:function(B,A,C){if(C.ctrlKey&&this.isSelected(A)){this.deselect(A)}else{this.select(A,false)}},doMultiSelection:function(C,A,D){if(D.shiftKey&&this.last!==false){var B=this.last;this.selectRange(B,A,D.ctrlKey);this.last=B}else{if((D.ctrlKey||this.simpleSelect)&&this.isSelected(A)){this.deselect(A)}else{this.select(A,D.ctrlKey||D.shiftKey||this.simpleSelect)}}},getSelectionCount:function(){return this.selected.getCount()},getSelectedNodes:function(){return this.selected.elements},getSelectedIndexes:function(){var B=[],D=this.selected.elements;for(var C=0,A=D.length;C<A;C++){B.push(D[C].viewIndex)}return B},getSelectedRecords:function(){var D=[],C=this.selected.elements;for(var B=0,A=C.length;B<A;B++){D[D.length]=this.store.getAt(C[B].viewIndex)}return D},getRecords:function(B){var E=[],D=B;for(var C=0,A=D.length;C<A;C++){E[E.length]=this.store.getAt(D[C].viewIndex)}return E},getRecord:function(A){return this.store.getAt(A.viewIndex)},clearSelections:function(A,B){if((this.multiSelect||this.singleSelect)&&this.selected.getCount()>0){if(!B){this.selected.removeClass(this.selectedClass)}this.selected.clear();this.last=false;if(!A){this.fireEvent("selectionchange",this,this.selected.elements)}}},isSelected:function(A){return this.selected.contains(this.getNode(A))},deselect:function(A){if(this.isSelected(A)){A=this.getNode(A);this.selected.removeElement(A);if(this.last==A.viewIndex){this.last=false}Ext.fly(A).removeClass(this.selectedClass);this.fireEvent("selectionchange",this,this.selected.elements)}},select:function(D,F,B){if(Ext.isArray(D)){if(!F){this.clearSelections(true)}for(var C=0,A=D.length;C<A;C++){this.select(D[C],true,true)}if(!B){this.fireEvent("selectionchange",this,this.selected.elements)}}else{var E=this.getNode(D);if(!F){this.clearSelections(true)}if(E&&!this.isSelected(E)){if(this.fireEvent("beforeselect",this,E,this.selected.elements)!==false){Ext.fly(E).addClass(this.selectedClass);this.selected.add(E);this.last=E.viewIndex;if(!B){this.fireEvent("selectionchange",this,this.selected.elements)}}}}},selectRange:function(C,A,B){if(!B){this.clearSelections(true)}this.select(this.getNodes(C,A),true)},getNode:function(A){if(Ext.isString(A)){return document.getElementById(A)}else{if(Ext.isNumber(A)){return this.all.elements[A]}}return A},getNodes:function(E,A){var D=this.all.elements;E=E||0;A=!Ext.isDefined(A)?Math.max(D.length-1,0):A;var B=[],C;if(E<=A){for(C=E;C<=A&&D[C];C++){B.push(D[C])}}else{for(C=E;C>=A&&D[C];C--){B.push(D[C])}}return B},indexOf:function(A){A=this.getNode(A);if(Ext.isNumber(A.viewIndex)){return A.viewIndex}return this.all.indexOf(A)},onBeforeLoad:function(){if(this.loadingText){this.clearSelections(false,true);this.getTemplateTarget().update('<div class="loading-indicator">'+this.loadingText+"</div>");this.all.clear()}},onDestroy:function(){Ext.DataView.superclass.onDestroy.call(this);this.bindStore(null)}});Ext.DataView.prototype.setStore=Ext.DataView.prototype.bindStore;Ext.reg("dataview",Ext.DataView);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ListView=Ext.extend(Ext.DataView,{itemSelector:"dl",selectedClass:"x-list-selected",overClass:"x-list-over",scrollOffset:19,columnResize:true,columnSort:true,initComponent:function(){if(this.columnResize){this.colResizer=new Ext.ListView.ColumnResizer(this.colResizer);this.colResizer.init(this)}if(this.columnSort){this.colSorter=new Ext.ListView.Sorter(this.columnSort);this.colSorter.init(this)}if(!this.internalTpl){this.internalTpl=new Ext.XTemplate('<div class="x-list-header"><div class="x-list-header-inner">','<tpl for="columns">','<div style="width:{width}%;text-align:{align};"><em unselectable="on" id="',this.id,'-xlhd-{#}">',"{header}","</em></div>","</tpl>",'<div class="x-clear"></div>',"</div></div>",'<div class="x-list-body"><div class="x-list-body-inner">',"</div></div>")}if(!this.tpl){this.tpl=new Ext.XTemplate('<tpl for="rows">',"<dl>",'<tpl for="parent.columns">','<dt style="width:{width}%;text-align:{align};"><em unselectable="on">',"{[values.tpl.apply(parent)]}","</em></dt>","</tpl>",'<div class="x-clear"></div>',"</dl>","</tpl>")}var G=this.columns,E=0,F=0,H=G.length;for(var D=0;D<H;D++){var I=G[D];if(!I.tpl){I.tpl=new Ext.XTemplate("{"+I.dataIndex+"}")}else{if(Ext.isString(I.tpl)){I.tpl=new Ext.XTemplate(I.tpl)}}I.align=I.align||"left";if(Ext.isNumber(I.width)){I.width*=100;E+=I.width;F++}}if(F<H){var B=H-F;if(E<100){var A=((100-E)/B);for(var C=0;C<H;C++){var I=G[C];if(!Ext.isNumber(I.width)){I.width=A}}}}Ext.ListView.superclass.initComponent.call(this)},onRender:function(){Ext.ListView.superclass.onRender.apply(this,arguments);this.internalTpl.overwrite(this.el,{columns:this.columns});this.innerBody=Ext.get(this.el.dom.childNodes[1].firstChild);this.innerHd=Ext.get(this.el.dom.firstChild.firstChild);if(this.hideHeaders){this.el.dom.firstChild.style.display="none"}},getTemplateTarget:function(){return this.innerBody},collectData:function(){var A=Ext.ListView.superclass.collectData.apply(this,arguments);return{columns:this.columns,rows:A}},verifyInternalSize:function(){if(this.lastSize){this.onResize(this.lastSize.width,this.lastSize.height)}},onResize:function(B,D){var E=this.innerBody.dom;var F=this.innerHd.dom;if(!E){return }var C=E.parentNode;if(Ext.isNumber(B)){var A=B-this.scrollOffset;if(this.reserveScrollOffset||((C.offsetWidth-C.clientWidth)>10)){E.style.width=A+"px";F.style.width=A+"px"}else{E.style.width=B+"px";F.style.width=B+"px";setTimeout(function(){if((C.offsetWidth-C.clientWidth)>10){E.style.width=A+"px";F.style.width=A+"px"}},10)}}if(Ext.isNumber(D=="number")){C.style.height=(D-F.parentNode.offsetHeight)+"px"}},updateIndexes:function(){Ext.ListView.superclass.updateIndexes.apply(this,arguments);this.verifyInternalSize()},findHeaderIndex:function(D){D=D.dom||D;var A=D.parentNode,C=A.parentNode.childNodes;for(var B=0,E;E=C[B];B++){if(E==A){return B}}return -1},setHdWidths:function(){var C=this.innerHd.dom.getElementsByTagName("div");for(var B=0,D=this.columns,A=D.length;B<A;B++){C[B].style.width=D[B].width+"%"}}});Ext.reg("listview",Ext.ListView);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ListView.ColumnResizer=Ext.extend(Ext.util.Observable,{minPct:0.05,constructor:function(A){Ext.apply(this,A);Ext.ListView.ColumnResizer.superclass.constructor.call(this)},init:function(A){this.view=A;A.on("render",this.initEvents,this)},initEvents:function(A){A.mon(A.innerHd,"mousemove",this.handleHdMove,this);this.tracker=new Ext.dd.DragTracker({onBeforeStart:this.onBeforeStart.createDelegate(this),onStart:this.onStart.createDelegate(this),onDrag:this.onDrag.createDelegate(this),onEnd:this.onEnd.createDelegate(this),tolerance:3,autoStart:300});this.tracker.initEl(A.innerHd);A.on("beforedestroy",this.tracker.destroy,this.tracker)},handleHdMove:function(H,E){var B=5;var A=H.getPageX();var G=H.getTarget("em",3,true);if(G){var F=G.getRegion();var D=G.dom.style;var C=G.dom.parentNode;if(A-F.left<=B&&C!=C.parentNode.firstChild){this.activeHd=Ext.get(C.previousSibling.firstChild);D.cursor=Ext.isWebKit?"e-resize":"col-resize"}else{if(F.right-A<=B&&C!=C.parentNode.lastChild.previousSibling){this.activeHd=G;D.cursor=Ext.isWebKit?"w-resize":"col-resize"}else{delete this.activeHd;D.cursor=""}}}},onBeforeStart:function(A){this.dragHd=this.activeHd;return !!this.dragHd},onStart:function(C){this.view.disableHeaders=true;this.proxy=this.view.el.createChild({cls:"x-list-resizer"});this.proxy.setHeight(this.view.el.getHeight());var A=this.tracker.getXY()[0];var B=this.view.innerHd.getWidth();this.hdX=this.dragHd.getX();this.hdIndex=this.view.findHeaderIndex(this.dragHd);this.proxy.setX(this.hdX);this.proxy.setWidth(A-this.hdX);this.minWidth=B*this.minPct;this.maxWidth=B-(this.minWidth*(this.view.columns.length-1-this.hdIndex))},onDrag:function(B){var A=this.tracker.getXY()[0];this.proxy.setWidth((A-this.hdX).constrain(this.minWidth,this.maxWidth))},onEnd:function(I){var G=this.proxy.getWidth();this.proxy.remove();var F=this.hdIndex;var L=this.view,E=L.columns,H=E.length;var N=this.view.innerHd.getWidth(),D=this.minPct*100;var O=Math.ceil((G*100)/N);var M=E[F].width-O;var K=Math.floor(M/(H-1-F));var J=M-(K*(H-1-F));for(var C=F+1;C<H;C++){var B=E[C].width+K;var A=Math.max(D,B);if(B!=A){J+=B-A}E[C].width=A}E[F].width=O;E[F+1].width+=J;delete this.dragHd;this.view.setHdWidths();this.view.refresh();setTimeout(function(){L.disableHeaders=false},100)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ListView.Sorter=Ext.extend(Ext.util.Observable,{sortClasses:["sort-asc","sort-desc"],constructor:function(A){Ext.apply(this,A);Ext.ListView.Sorter.superclass.constructor.call(this)},init:function(A){this.view=A;A.on("render",this.initEvents,this)},initEvents:function(A){A.mon(A.innerHd,"click",this.onHdClick,this);A.innerHd.setStyle("cursor","pointer");A.mon(A.store,"datachanged",this.updateSortState,this);this.updateSortState.defer(10,this,[A.store])},updateSortState:function(C){var F=C.getSortState();if(!F){return }this.sortState=F;var E=this.view.columns,G=-1;for(var D=0,A=E.length;D<A;D++){if(E[D].dataIndex==F.field){G=D;break}}if(G!=-1){var B=F.direction;this.updateSortIcon(G,B)}},updateSortIcon:function(B,A){var D=this.sortClasses;var C=this.view.innerHd.select("em").removeClass(D);C.item(B).addClass(D[A=="DESC"?1:0])},onHdClick:function(C){var B=C.getTarget("em",3);if(B&&!this.view.disableHeaders){var A=this.view.findHeaderIndex(B);this.view.store.sort(this.view.columns[A].dataIndex)}}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.TabPanel=Ext.extend(Ext.Panel,{monitorResize:true,deferredRender:true,tabWidth:120,minTabWidth:30,resizeTabs:false,enableTabScroll:false,scrollIncrement:0,scrollRepeatInterval:400,scrollDuration:0.35,animScroll:true,tabPosition:"top",baseCls:"x-tab-panel",autoTabs:false,autoTabSelector:"div.x-tab",activeTab:null,tabMargin:2,plain:false,wheelIncrement:20,idDelimiter:"__",itemCls:"x-tab-item",elements:"body",headerAsText:false,frame:false,hideBorders:true,initComponent:function(){this.frame=false;Ext.TabPanel.superclass.initComponent.call(this);this.addEvents("beforetabchange","tabchange","contextmenu");this.setLayout(new Ext.layout.CardLayout(Ext.apply({layoutOnCardChange:this.layoutOnTabChange,deferredRender:this.deferredRender},this.layoutConfig)));if(this.tabPosition=="top"){this.elements+=",header";this.stripTarget="header"}else{this.elements+=",footer";this.stripTarget="footer"}if(!this.stack){this.stack=Ext.TabPanel.AccessStack()}this.initItems()},onRender:function(C,A){Ext.TabPanel.superclass.onRender.call(this,C,A);if(this.plain){var F=this.tabPosition=="top"?"header":"footer";this[F].addClass("x-tab-panel-"+F+"-plain")}var B=this[this.stripTarget];this.stripWrap=B.createChild({cls:"x-tab-strip-wrap",cn:{tag:"ul",cls:"x-tab-strip x-tab-strip-"+this.tabPosition}});var E=(this.tabPosition=="bottom"?this.stripWrap:null);this.stripSpacer=B.createChild({cls:"x-tab-strip-spacer"},E);this.strip=new Ext.Element(this.stripWrap.dom.firstChild);this.edge=this.strip.createChild({tag:"li",cls:"x-tab-edge"});this.strip.createChild({cls:"x-clear"});this.body.addClass("x-tab-panel-body-"+this.tabPosition);if(!this.itemTpl){var D=new Ext.Template('<li class="{cls}" id="{id}"><a class="x-tab-strip-close" onclick="return false;"></a>','<a class="x-tab-right" href="#" onclick="return false;"><em class="x-tab-left">','<span class="x-tab-strip-inner"><span class="x-tab-strip-text {iconCls}">{text}</span></span>',"</em></a></li>");D.disableFormats=true;D.compile();Ext.TabPanel.prototype.itemTpl=D}this.items.each(this.initTab,this)},afterRender:function(){Ext.TabPanel.superclass.afterRender.call(this);if(this.autoTabs){this.readTabs(false)}if(this.activeTab!==undefined){var A=Ext.isObject(this.activeTab)?this.activeTab:this.items.get(this.activeTab);delete this.activeTab;this.setActiveTab(A)}},initEvents:function(){Ext.TabPanel.superclass.initEvents.call(this);this.on("add",this.onAdd,this,{target:this});this.on("remove",this.onRemove,this,{target:this});this.mon(this.strip,"mousedown",this.onStripMouseDown,this);this.mon(this.strip,"contextmenu",this.onStripContextMenu,this);if(this.enableTabScroll){this.mon(this.strip,"mousewheel",this.onWheel,this)}},findTargets:function(C){var B=null;var A=C.getTarget("li",this.strip);if(A){B=this.getComponent(A.id.split(this.idDelimiter)[1]);if(B.disabled){return{close:null,item:null,el:null}}}return{close:C.getTarget(".x-tab-strip-close",this.strip),item:B,el:A}},onStripMouseDown:function(B){if(B.button!==0){return }B.preventDefault();var A=this.findTargets(B);if(A.close){if(A.item.fireEvent("beforeclose",A.item)!==false){A.item.fireEvent("close",A.item);this.remove(A.item)}return }if(A.item&&A.item!=this.activeTab){this.setActiveTab(A.item)}},onStripContextMenu:function(B){B.preventDefault();var A=this.findTargets(B);if(A.item){this.fireEvent("contextmenu",this,A.item,B)}},readTabs:function(D){if(D===true){this.items.each(function(G){this.remove(G)},this)}var C=this.el.query(this.autoTabSelector);for(var B=0,A=C.length;B<A;B++){var E=C[B];var F=E.getAttribute("title");E.removeAttribute("title");this.add({title:F,contentEl:E})}},initTab:function(C,A){var D=this.strip.dom.childNodes[A];var E=this.getTemplateArgs(C);var B=D?this.itemTpl.insertBefore(D,E):this.itemTpl.append(this.strip,E);Ext.fly(B).addClassOnOver("x-tab-strip-over");if(C.tabTip){Ext.fly(B).child("span.x-tab-strip-text",true).qtip=C.tabTip}C.tabEl=B;C.on("disable",this.onItemDisabled,this);C.on("enable",this.onItemEnabled,this);C.on("titlechange",this.onItemTitleChanged,this);C.on("iconchange",this.onItemIconChanged,this);C.on("beforeshow",this.onBeforeShowItem,this)},getTemplateArgs:function(B){var A=B.closable?"x-tab-strip-closable":"";if(B.disabled){A+=" x-item-disabled"}if(B.iconCls){A+=" x-tab-with-icon"}if(B.tabCls){A+=" "+B.tabCls}return{id:this.id+this.idDelimiter+B.getItemId(),text:B.title,cls:A,iconCls:B.iconCls||""}},onAdd:function(C,B,A){this.initTab(B,A);if(this.items.getCount()==1){this.syncSize()}this.delegateUpdates()},onBeforeAdd:function(B){var A=B.events?(this.items.containsKey(B.getItemId())?B:null):this.items.get(B);if(A){this.setActiveTab(B);return false}Ext.TabPanel.superclass.onBeforeAdd.apply(this,arguments);var C=B.elements;B.elements=C?C.replace(",header",""):C;B.border=(B.border===true)},onRemove:function(C,B){Ext.destroy(Ext.get(this.getTabEl(B)));this.stack.remove(B);B.un("disable",this.onItemDisabled,this);B.un("enable",this.onItemEnabled,this);B.un("titlechange",this.onItemTitleChanged,this);B.un("iconchange",this.onItemIconChanged,this);B.un("beforeshow",this.onBeforeShowItem,this);if(B==this.activeTab){var A=this.stack.next();if(A){this.setActiveTab(A)}else{if(this.items.getCount()>0){this.setActiveTab(0)}else{this.activeTab=null}}}this.delegateUpdates()},onBeforeShowItem:function(A){if(A!=this.activeTab){this.setActiveTab(A);return false}},onItemDisabled:function(B){var A=this.getTabEl(B);if(A){Ext.fly(A).addClass("x-item-disabled")}this.stack.remove(B)},onItemEnabled:function(B){var A=this.getTabEl(B);if(A){Ext.fly(A).removeClass("x-item-disabled")}},onItemTitleChanged:function(B){var A=this.getTabEl(B);if(A){Ext.fly(A).child("span.x-tab-strip-text",true).innerHTML=B.title}},onItemIconChanged:function(D,A,C){var B=this.getTabEl(D);if(B){Ext.fly(B).child("span.x-tab-strip-text").replaceClass(C,A)}},getTabEl:function(A){return document.getElementById(this.id+this.idDelimiter+this.getComponent(A).getItemId())},onResize:function(){Ext.TabPanel.superclass.onResize.apply(this,arguments);this.delegateUpdates()},beginUpdate:function(){this.suspendUpdates=true},endUpdate:function(){this.suspendUpdates=false;this.delegateUpdates()},hideTabStripItem:function(B){B=this.getComponent(B);var A=this.getTabEl(B);if(A){A.style.display="none";this.delegateUpdates()}this.stack.remove(B)},unhideTabStripItem:function(B){B=this.getComponent(B);var A=this.getTabEl(B);if(A){A.style.display="";this.delegateUpdates()}},delegateUpdates:function(){if(this.suspendUpdates){return }if(this.resizeTabs&&this.rendered){this.autoSizeTabs()}if(this.enableTabScroll&&this.rendered){this.autoScrollTabs()}},autoSizeTabs:function(){var G=this.items.length;var B=this.tabPosition!="bottom"?"header":"footer";var C=this[B].dom.offsetWidth;var A=this[B].dom.clientWidth;if(!this.resizeTabs||G<1||!A){return }var I=Math.max(Math.min(Math.floor((A-4)/G)-this.tabMargin,this.tabWidth),this.minTabWidth);this.lastTabWidth=I;var K=this.strip.query("li:not([className^=x-tab-edge])");for(var E=0,H=K.length;E<H;E++){var J=K[E];var L=Ext.fly(J).child(".x-tab-strip-inner",true);var F=J.offsetWidth;var D=L.offsetWidth;L.style.width=(I-(F-D))+"px"}},adjustBodyWidth:function(A){if(this.header){this.header.setWidth(A)}if(this.footer){this.footer.setWidth(A)}return A},setActiveTab:function(C){C=this.getComponent(C);if(!C||this.fireEvent("beforetabchange",this,C,this.activeTab)===false){return }if(!this.rendered){this.activeTab=C;return }if(this.activeTab!=C){if(this.activeTab){var A=this.getTabEl(this.activeTab);if(A){Ext.fly(A).removeClass("x-tab-strip-active")}this.activeTab.fireEvent("deactivate",this.activeTab)}var B=this.getTabEl(C);Ext.fly(B).addClass("x-tab-strip-active");this.activeTab=C;this.stack.add(C);this.layout.setActiveItem(C);if(this.scrolling){this.scrollToTab(C,this.animScroll)}C.fireEvent("activate",C);this.fireEvent("tabchange",this,C)}},getActiveTab:function(){return this.activeTab||null},getItem:function(A){return this.getComponent(A)},autoScrollTabs:function(){this.pos=this.tabPosition=="bottom"?this.footer:this.header;var G=this.items.length;var D=this.pos.dom.offsetWidth;var C=this.pos.dom.clientWidth;var F=this.stripWrap;var E=F.dom;var B=E.offsetWidth;var H=this.getScrollPos();var A=this.edge.getOffsetsTo(this.stripWrap)[0]+H;if(!this.enableTabScroll||G<1||B<20){return }if(A<=C){E.scrollLeft=0;F.setWidth(C);if(this.scrolling){this.scrolling=false;this.pos.removeClass("x-tab-scrolling");this.scrollLeft.hide();this.scrollRight.hide();if(Ext.isAir||Ext.isWebKit){E.style.marginLeft="";E.style.marginRight=""}}}else{if(!this.scrolling){this.pos.addClass("x-tab-scrolling");if(Ext.isAir||Ext.isWebKit){E.style.marginLeft="18px";E.style.marginRight="18px"}}C-=F.getMargins("lr");F.setWidth(C>20?C:20);if(!this.scrolling){if(!this.scrollLeft){this.createScrollers()}else{this.scrollLeft.show();this.scrollRight.show()}}this.scrolling=true;if(H>(A-C)){E.scrollLeft=A-C}else{this.scrollToTab(this.activeTab,false)}this.updateScrollButtons()}},createScrollers:function(){this.pos.addClass("x-tab-scrolling-"+this.tabPosition);var C=this.stripWrap.dom.offsetHeight;var A=this.pos.insertFirst({cls:"x-tab-scroller-left"});A.setHeight(C);A.addClassOnOver("x-tab-scroller-left-over");this.leftRepeater=new Ext.util.ClickRepeater(A,{interval:this.scrollRepeatInterval,handler:this.onScrollLeft,scope:this});this.scrollLeft=A;var B=this.pos.insertFirst({cls:"x-tab-scroller-right"});B.setHeight(C);B.addClassOnOver("x-tab-scroller-right-over");this.rightRepeater=new Ext.util.ClickRepeater(B,{interval:this.scrollRepeatInterval,handler:this.onScrollRight,scope:this});this.scrollRight=B},getScrollWidth:function(){return this.edge.getOffsetsTo(this.stripWrap)[0]+this.getScrollPos()},getScrollPos:function(){return parseInt(this.stripWrap.dom.scrollLeft,10)||0},getScrollArea:function(){return parseInt(this.stripWrap.dom.clientWidth,10)||0},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},getScrollIncrement:function(){return this.scrollIncrement||(this.resizeTabs?this.lastTabWidth+2:100)},scrollToTab:function(E,A){if(!E){return }var C=this.getTabEl(E);var G=this.getScrollPos(),D=this.getScrollArea();var F=Ext.fly(C).getOffsetsTo(this.stripWrap)[0]+G;var B=F+C.offsetWidth;if(F<G){this.scrollTo(F,A)}else{if(B>(G+D)){this.scrollTo(B-D,A)}}},scrollTo:function(B,A){this.stripWrap.scrollTo("left",B,A?this.getScrollAnim():false);if(!A){this.updateScrollButtons()}},onWheel:function(D){var E=D.getWheelDelta()*this.wheelIncrement*-1;D.stopEvent();var F=this.getScrollPos();var C=F+E;var A=this.getScrollWidth()-this.getScrollArea();var B=Math.max(0,Math.min(A,C));if(B!=F){this.scrollTo(B,false)}},onScrollRight:function(){var A=this.getScrollWidth()-this.getScrollArea();var C=this.getScrollPos();var B=Math.min(A,C+this.getScrollIncrement());if(B!=C){this.scrollTo(B,this.animScroll)}},onScrollLeft:function(){var B=this.getScrollPos();var A=Math.max(0,B-this.getScrollIncrement());if(A!=B){this.scrollTo(A,this.animScroll)}},updateScrollButtons:function(){var A=this.getScrollPos();this.scrollLeft[A===0?"addClass":"removeClass"]("x-tab-scroller-left-disabled");this.scrollRight[A>=(this.getScrollWidth()-this.getScrollArea())?"addClass":"removeClass"]("x-tab-scroller-right-disabled")},beforeDestroy:function(){if(this.items){this.items.each(function(A){if(A&&A.tabEl){Ext.get(A.tabEl).removeAllListeners();A.tabEl=null}},this)}if(this.strip){this.strip.removeAllListeners()}Ext.TabPanel.superclass.beforeDestroy.apply(this)}});Ext.reg("tabpanel",Ext.TabPanel);Ext.TabPanel.prototype.activate=Ext.TabPanel.prototype.setActiveTab;Ext.TabPanel.AccessStack=function(){var A=[];return{add:function(B){A.push(B);if(A.length>10){A.shift()}},remove:function(E){var D=[];for(var C=0,B=A.length;C<B;C++){if(A[C]!=E){D.push(A[C])}}A=D},next:function(){return A.pop()}}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Button=Ext.extend(Ext.BoxComponent,{hidden:false,disabled:false,pressed:false,enableToggle:false,menuAlign:"tl-bl?",type:"button",menuClassTarget:"tr:nth(2)",clickEvent:"click",handleMouseEvents:true,tooltipType:"qtip",buttonSelector:"button:first-child",scale:"small",iconAlign:"left",arrowAlign:"right",initComponent:function(){Ext.Button.superclass.initComponent.call(this);this.addEvents("click","toggle","mouseover","mouseout","menushow","menuhide","menutriggerover","menutriggerout");if(this.menu){this.menu=Ext.menu.MenuMgr.get(this.menu)}if(Ext.isString(this.toggleGroup)){this.enableToggle=true}},getTemplateArgs:function(){var A=(this.cls||"");A+=(this.iconCls||this.icon)?(this.text?" x-btn-text-icon":" x-btn-icon"):" x-btn-noicon";if(this.pressed){A+=" x-btn-pressed"}return[this.text||"&#160;",this.type,this.iconCls||"",A,"x-btn-"+this.scale+" x-btn-icon-"+this.scale+"-"+this.iconAlign,this.getMenuClass()]},getMenuClass:function(){return this.menu?(this.arrowAlign!="bottom"?"x-btn-arrow":"x-btn-arrow-bottom"):""},onRender:function(C,A){if(!this.template){if(!Ext.Button.buttonTemplate){Ext.Button.buttonTemplate=new Ext.Template('<table cellspacing="0" class="x-btn {3}"><tbody class="{4}">','<tr><td class="x-btn-tl"><i>&#160;</i></td><td class="x-btn-tc"></td><td class="x-btn-tr"><i>&#160;</i></td></tr>','<tr><td class="x-btn-ml"><i>&#160;</i></td><td class="x-btn-mc"><em class="{5}" unselectable="on"><button class="x-btn-text {2}" type="{1}">{0}</button></em></td><td class="x-btn-mr"><i>&#160;</i></td></tr>','<tr><td class="x-btn-bl"><i>&#160;</i></td><td class="x-btn-bc"></td><td class="x-btn-br"><i>&#160;</i></td></tr>',"</tbody></table>");Ext.Button.buttonTemplate.compile()}this.template=Ext.Button.buttonTemplate}var B,D=this.getTemplateArgs();if(A){B=this.template.insertBefore(A,D,true)}else{B=this.template.append(C,D,true)}this.btnEl=B.child(this.buttonSelector);this.mon(this.btnEl,{scope:this,focus:this.onFocus,blur:this.onBlur});this.initButtonEl(B,this.btnEl);Ext.ButtonToggleMgr.register(this)},initButtonEl:function(B,C){this.el=B;if(this.id){this.el.dom.id=this.el.id=this.id}if(this.icon){C.setStyle("background-image","url("+this.icon+")")}if(this.tabIndex!==undefined){C.dom.tabIndex=this.tabIndex}if(this.tooltip){this.setTooltip(this.tooltip,true)}if(this.handleMouseEvents){this.mon(B,{scope:this,mouseover:this.onMouseOver,mousedown:this.onMouseDown})}if(this.menu){this.mon(this.menu,{scope:this,show:this.onMenuShow,hide:this.onMenuHide})}if(this.repeat){var A=new Ext.util.ClickRepeater(B,Ext.isObject(this.repeat)?this.repeat:{});this.mon(A,"click",this.onClick,this)}this.mon(B,this.clickEvent,this.onClick,this)},afterRender:function(){Ext.Button.superclass.afterRender.call(this);this.doAutoWidth()},setIconClass:function(A){if(this.el){this.btnEl.replaceClass(this.iconCls,A)}this.iconCls=A;return this},setTooltip:function(B,A){if(this.rendered){if(!A){this.clearTip()}if(Ext.isObject(B)){Ext.QuickTips.register(Ext.apply({target:this.btnEl.id},B));this.tooltip=B}else{this.btnEl.dom[this.tooltipType]=B}}else{this.tooltip=B}return this},clearTip:function(){if(Ext.isObject(this.tooltip)){Ext.QuickTips.unregister(this.btnEl)}},beforeDestroy:function(){if(this.rendered){this.clearTip()}Ext.destroy(this.menu,this.repeater)},onDestroy:function(){var A=Ext.getDoc();A.un("mouseover",this.monitorMouseOver,this);A.un("mouseup",this.onMouseUp,this);if(this.rendered){Ext.ButtonToggleMgr.unregister(this)}},doAutoWidth:function(){if(this.el&&this.text&&this.width===undefined){this.el.setWidth("auto");if(Ext.isIE7&&Ext.isStrict){var A=this.btnEl;if(A&&A.getWidth()>20){A.clip();A.setWidth(Ext.util.TextMetrics.measure(A,this.text).width+A.getFrameWidth("lr"))}}if(this.minWidth){if(this.el.getWidth()<this.minWidth){this.el.setWidth(this.minWidth)}}}},setHandler:function(B,A){this.handler=B;this.scope=A;return this},setText:function(A){this.text=A;if(this.el){this.el.child("td.x-btn-mc "+this.buttonSelector).update(A)}this.doAutoWidth();return this},getText:function(){return this.text},toggle:function(B,A){B=B===undefined?!this.pressed:!!B;if(B!=this.pressed){this.el[B?"addClass":"removeClass"]("x-btn-pressed");this.pressed=B;if(!A){this.fireEvent("toggle",this,B);if(this.toggleHandler){this.toggleHandler.call(this.scope||this,this,B)}}}return this},focus:function(){this.btnEl.focus()},onDisable:function(){this.onDisableChange(true)},onEnable:function(){this.onDisableChange(false)},onDisableChange:function(A){if(this.el){if(!Ext.isIE6||!this.text){this.el[A?"addClass":"removeClass"](this.disabledClass)}this.el.dom.disabled=A}this.disabled=A},showMenu:function(){if(this.rendered&&this.menu){if(this.tooltip){Ext.QuickTips.getQuickTip().cancelShow(this.btnEl)}this.menu.show(this.el,this.menuAlign)}return this},hideMenu:function(){if(this.menu){this.menu.hide()}return this},hasVisibleMenu:function(){return this.menu&&this.menu.isVisible()},onClick:function(A){if(A){A.preventDefault()}if(A.button!==0){return }if(!this.disabled){if(this.enableToggle&&(this.allowDepress!==false||!this.pressed)){this.toggle()}if(this.menu&&!this.menu.isVisible()&&!this.ignoreNextClick){this.showMenu()}this.fireEvent("click",this,A);if(this.handler){this.handler.call(this.scope||this,this,A)}}},isMenuTriggerOver:function(B,A){return this.menu&&!A},isMenuTriggerOut:function(B,A){return this.menu&&!A},onMouseOver:function(B){if(!this.disabled){var A=B.within(this.el,true);if(!A){this.el.addClass("x-btn-over");if(!this.monitoringMouseOver){Ext.getDoc().on("mouseover",this.monitorMouseOver,this);this.monitoringMouseOver=true}this.fireEvent("mouseover",this,B)}if(this.isMenuTriggerOver(B,A)){this.fireEvent("menutriggerover",this,this.menu,B)}}},monitorMouseOver:function(A){if(A.target!=this.el.dom&&!A.within(this.el)){if(this.monitoringMouseOver){Ext.getDoc().un("mouseover",this.monitorMouseOver,this);this.monitoringMouseOver=false}this.onMouseOut(A)}},onMouseOut:function(B){var A=B.within(this.el)&&B.target!=this.el.dom;this.el.removeClass("x-btn-over");this.fireEvent("mouseout",this,B);if(this.isMenuTriggerOut(B,A)){this.fireEvent("menutriggerout",this,this.menu,B)}},onFocus:function(A){if(!this.disabled){this.el.addClass("x-btn-focus")}},onBlur:function(A){this.el.removeClass("x-btn-focus")},getClickEl:function(B,A){return this.el},onMouseDown:function(A){if(!this.disabled&&A.button===0){this.getClickEl(A).addClass("x-btn-click");Ext.getDoc().on("mouseup",this.onMouseUp,this)}},onMouseUp:function(A){if(A.button===0){this.getClickEl(A,true).removeClass("x-btn-click");Ext.getDoc().un("mouseup",this.onMouseUp,this)}},onMenuShow:function(A){this.ignoreNextClick=0;this.el.addClass("x-btn-menu-active");this.fireEvent("menushow",this,this.menu)},onMenuHide:function(A){this.el.removeClass("x-btn-menu-active");this.ignoreNextClick=this.restoreClick.defer(250,this);this.fireEvent("menuhide",this,this.menu)},restoreClick:function(){this.ignoreNextClick=0}});Ext.reg("button",Ext.Button);Ext.ButtonToggleMgr=function(){var A={};function B(E,G){if(G){var F=A[E.toggleGroup];for(var D=0,C=F.length;D<C;D++){if(F[D]!=E){F[D].toggle(false)}}}}return{register:function(C){if(!C.toggleGroup){return }var D=A[C.toggleGroup];if(!D){D=A[C.toggleGroup]=[]}D.push(C);C.on("toggle",B)},unregister:function(C){if(!C.toggleGroup){return }var D=A[C.toggleGroup];if(D){D.remove(C);C.un("toggle",B)}},getPressed:function(F){var E=A[F];if(E){for(var D=0,C=E.length;D<C;D++){if(E[D].pressed===true){return E[D]}}}return null}}}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.SplitButton=Ext.extend(Ext.Button,{arrowSelector:"em",split:true,initComponent:function(){Ext.SplitButton.superclass.initComponent.call(this);this.addEvents("arrowclick")},onRender:function(){Ext.SplitButton.superclass.onRender.apply(this,arguments);if(this.arrowTooltip){this.el.child(this.arrowSelector).dom[this.tooltipType]=this.arrowTooltip}},setArrowHandler:function(B,A){this.arrowHandler=B;this.scope=A},getMenuClass:function(){return"x-btn-split"+(this.arrowAlign=="bottom"?"-bottom":"")},isClickOnArrow:function(A){return this.arrowAlign!="bottom"?A.getPageX()>this.el.child(this.buttonSelector).getRegion().right:A.getPageY()>this.el.child(this.buttonSelector).getRegion().bottom},onClick:function(B,A){B.preventDefault();if(!this.disabled){if(this.isClickOnArrow(B)){if(this.menu&&!this.menu.isVisible()&&!this.ignoreNextClick){this.showMenu()}this.fireEvent("arrowclick",this,B);if(this.arrowHandler){this.arrowHandler.call(this.scope||this,this,B)}}else{if(this.enableToggle){this.toggle()}this.fireEvent("click",this,B);if(this.handler){this.handler.call(this.scope||this,this,B)}}}},isMenuTriggerOver:function(A){return this.menu&&A.target.tagName=="em"},isMenuTriggerOut:function(B,A){return this.menu&&B.target.tagName!="em"}});Ext.reg("splitbutton",Ext.SplitButton);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.CycleButton=Ext.extend(Ext.SplitButton,{getItemText:function(A){if(A&&this.showText===true){var B="";if(this.prependText){B+=this.prependText}B+=A.text;return B}return undefined},setActiveItem:function(C,A){if(typeof C!="object"){C=this.menu.items.get(C)}if(C){if(!this.rendered){this.text=this.getItemText(C);this.iconCls=C.iconCls}else{var B=this.getItemText(C);if(B){this.setText(B)}this.setIconClass(C.iconCls)}this.activeItem=C;if(!C.checked){C.setChecked(true,true)}if(this.forceIcon){this.setIconClass(this.forceIcon)}if(!A){this.fireEvent("change",this,C)}}},getActiveItem:function(){return this.activeItem},initComponent:function(){this.addEvents("change");if(this.changeHandler){this.on("change",this.changeHandler,this.scope||this);delete this.changeHandler}this.itemCount=this.items.length;this.menu={cls:"x-cycle-menu",items:[]};var D;for(var B=0,A=this.itemCount;B<A;B++){var C=this.items[B];C.group=C.group||this.id;C.itemIndex=B;C.checkHandler=this.checkHandler;C.scope=this;C.checked=C.checked||false;this.menu.items.push(C);if(C.checked){D=C}}this.setActiveItem(D,true);Ext.CycleButton.superclass.initComponent.call(this);this.on("click",this.toggleSelected,this)},checkHandler:function(A,B){if(B){this.setActiveItem(A)}},toggleSelected:function(){this.menu.render();var C,A;for(var B=1;B<this.itemCount;B++){C=(this.activeItem.itemIndex+B)%this.itemCount;A=this.menu.items.itemAt(C);if(!A.disabled){A.setChecked(true);break}}}});Ext.reg("cycle",Ext.CycleButton);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.ToolbarLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,triggerWidth:18,lastOverflow:false,noItemsMenuText:'<div class="x-toolbar-no-items">(None)</div>',onLayout:function(C,E){if(!this.leftTr){E.addClass("x-toolbar-layout-ct");E.insertHtml("beforeEnd",'<table cellspacing="0" class="x-toolbar-ct"><tbody><tr><td class="x-toolbar-left" align="left"><table cellspacing="0"><tbody><tr class="x-toolbar-left-row"></tr></tbody></table></td><td class="x-toolbar-right" align="right"><table cellspacing="0" class="x-toolbar-right-ct"><tbody><tr><td><table cellspacing="0"><tbody><tr class="x-toolbar-right-row"></tr></tbody></table></td><td><table cellspacing="0"><tbody><tr class="x-toolbar-extras-row"></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>');this.leftTr=E.child("tr.x-toolbar-left-row",true);this.rightTr=E.child("tr.x-toolbar-right-row",true);this.extrasTr=E.child("tr.x-toolbar-extras-row",true)}var F=this.leftTr;var I=0;var G=C.items.items;for(var B=0,D=G.length,H;B<D;B++,I++){H=G[B];if(H.isFill){F=this.rightTr;I=-1}else{if(!H.rendered){H.render(this.insertCell(H,F,I))}else{if(!H.xtbHidden&&!this.isValidParent(H,F.childNodes[I])){var A=this.insertCell(H,F,I);A.appendChild(H.getDomPositionEl().dom);H.container=Ext.get(A)}}}}this.cleanup(this.leftTr);this.cleanup(this.rightTr);this.cleanup(this.extrasTr);this.fitToSize(E)},cleanup:function(B){var D=B.childNodes;for(var A=D.length-1,C;A>=0&&(C=D[A]);A--){if(!C.firstChild){B.removeChild(C)}}},insertCell:function(D,A,C){var B=document.createElement("td");B.className="x-toolbar-cell";A.insertBefore(B,A.childNodes[C]||null);return B},hideItem:function(B){var A=(this.hiddens=this.hiddens||[]);A.push(B);B.xtbHidden=true;B.xtbWidth=B.getDomPositionEl().dom.parentNode.offsetWidth;B.hide()},unhideItem:function(A){A.show();A.xtbHidden=false;this.hiddens.remove(A);if(this.hiddens.length<1){delete this.hiddens}},getItemWidth:function(A){return A.hidden?(A.xtbWidth||0):A.getDomPositionEl().dom.parentNode.offsetWidth},fitToSize:function(K){if(this.container.enableOverflow===false){return }var J=K.dom.clientWidth;var B=this.lastWidth||0;this.lastWidth=J;var C=K.dom.firstChild.offsetWidth;var I=J-this.triggerWidth;var H=-1;if(C>J||(this.hiddens&&J>=B)){var D,F=this.container.items.items,E=F.length,G;var A=0;for(D=0;D<E;D++){G=F[D];if(!G.isFill){A+=this.getItemWidth(G);if(A>I){if(!G.xtbHidden){this.hideItem(G)}}else{if(G.xtbHidden){this.unhideItem(G)}}}}}if(this.hiddens){this.initMore();if(!this.lastOverflow){this.container.fireEvent("overflowchange",this.container,true);this.lastOverflow=true}}else{if(this.more){this.clearMenu();this.more.destroy();delete this.more;if(this.lastOverflow){this.container.fireEvent("overflowchange",this.container,false);this.lastOverflow=false}}}},createMenuConfig:function(D,B){var A=Ext.apply({},D.initialConfig),C=D.toggleGroup;Ext.apply(A,{text:D.overflowText||D.text,iconCls:D.iconCls,icon:D.icon,itemId:D.itemId,disabled:D.disabled,handler:D.handler,scope:D.scope,menu:D.menu,hideOnClick:B});if(C||D.enableToggle){Ext.apply(A,{group:C,checked:D.pressed,listeners:{checkchange:function(F,E){D.toggle(E)}}})}delete A.xtype;delete A.id;return A},addComponentToMenu:function(A,B){if(B instanceof Ext.Toolbar.Separator){A.add("-")}else{if(Ext.isFunction(B.isXType)){if(B.isXType("splitbutton")){A.add(this.createMenuConfig(B,true))}else{if(B.isXType("button")){A.add(this.createMenuConfig(B,!B.menu))}else{if(B.isXType("buttongroup")){B.items.each(function(C){this.addComponentToMenu(A,C)},this)}}}}}},clearMenu:function(){var A=this.moreMenu;if(A&&A.items){this.moreMenu.items.each(function(B){delete B.menu})}},beforeMoreShow:function(B){var E=this.container.items.items,A=E.length,G,F,C=function(I,H){return I.isXType("buttongroup")&&!(H instanceof Ext.Toolbar.Separator)};this.clearMenu();B.removeAll();for(var D=0;D<A;D++){G=E[D];if(G.xtbHidden){if(F&&(C(G,F)||C(F,G))){B.add("-")}this.addComponentToMenu(B,G);F=G}}if(B.items.length<1){B.add(this.noItemsMenuText)}},initMore:function(){if(!this.more){this.moreMenu=new Ext.menu.Menu({listeners:{beforeshow:this.beforeMoreShow,scope:this}});this.more=new Ext.Button({iconCls:"x-toolbar-more-icon",cls:"x-toolbar-more",menu:this.moreMenu});var A=this.insertCell(this.more,this.extrasTr,100);this.more.render(A)}},destroy:function(){Ext.destroy(this.more,this.moreMenu);Ext.layout.ToolbarLayout.superclass.destroy.call(this)}});Ext.Container.LAYOUTS.toolbar=Ext.layout.ToolbarLayout;Ext.Toolbar=function(A){if(Ext.isArray(A)){A={items:A,layout:"toolbar"}}else{A=Ext.apply({layout:"toolbar"},A);if(A.buttons){A.items=A.buttons}}Ext.Toolbar.superclass.constructor.call(this,A)};(function(){var A=Ext.Toolbar;Ext.extend(A,Ext.Container,{defaultType:"button",trackMenus:true,internalDefaults:{removeMode:"container",hideParent:true},toolbarCls:"x-toolbar",initComponent:function(){A.superclass.initComponent.call(this);this.addEvents("overflowchange")},onRender:function(C,B){if(!this.el){if(!this.autoCreate){this.autoCreate={cls:this.toolbarCls+" x-small-editor"}}this.el=C.createChild(Ext.apply({id:this.id},this.autoCreate),B)}},lookupComponent:function(B){if(Ext.isString(B)){if(B=="-"){B=new A.Separator()}else{if(B==" "){B=new A.Spacer()}else{if(B=="->"){B=new A.Fill()}else{B=new A.TextItem(B)}}}this.applyDefaults(B)}else{if(B.isFormField||B.render){B=this.constructItem(B)}else{if(B.tag){B=new A.Item({autoEl:B})}else{if(B.tagName){B=new A.Item({el:B})}else{if(Ext.isObject(B)){B=B.xtype?this.constructItem(B):this.constructButton(B)}}}}}return B},applyDefaults:function(C){if(!Ext.isString(C)){C=Ext.Toolbar.superclass.applyDefaults.call(this,C);var B=this.internalDefaults;if(C.events){Ext.applyIf(C.initialConfig,B);Ext.apply(C,B)}else{Ext.applyIf(C,B)}}return C},constructItem:function(C,B){return Ext.create(C,B||this.defaultType)},addSeparator:function(){return this.add(new A.Separator())},addSpacer:function(){return this.add(new A.Spacer())},addFill:function(){this.add(new A.Fill())},addElement:function(B){return this.addItem(new A.Item({el:B}))},addItem:function(B){return Ext.Toolbar.superclass.add.apply(this,arguments)},addButton:function(C){if(Ext.isArray(C)){var E=[];for(var D=0,B=C.length;D<B;D++){E.push(this.addButton(C[D]))}return E}return this.add(this.constructButton(C))},addText:function(B){return this.addItem(new A.TextItem(B))},addDom:function(B){return this.add(new A.Item({autoEl:B}))},addField:function(B){return this.add(B)},insertButton:function(C,F){if(Ext.isArray(F)){var E=[];for(var D=0,B=F.length;D<B;D++){E.push(this.insertButton(C+D,F[D]))}return E}return Ext.Toolbar.superclass.insert.call(this,C,F)},initMenuTracking:function(B){if(this.trackMenus&&B.menu){this.mon(B,{menutriggerover:this.onButtonTriggerOver,menushow:this.onButtonMenuShow,menuhide:this.onButtonMenuHide,scope:this})}},constructButton:function(C){var B=C.events?C:this.constructItem(C,C.split?"splitbutton":this.defaultType);this.initMenuTracking(B);return B},onDisable:function(){this.items.each(function(B){if(B.disable){B.disable()}})},onEnable:function(){this.items.each(function(B){if(B.enable){B.enable()}})},onButtonTriggerOver:function(B){if(this.activeMenuBtn&&this.activeMenuBtn!=B){this.activeMenuBtn.hideMenu();B.showMenu();this.activeMenuBtn=B}},onButtonMenuShow:function(B){this.activeMenuBtn=B},onButtonMenuHide:function(B){delete this.activeMenuBtn}});Ext.reg("toolbar",Ext.Toolbar);A.Item=Ext.extend(Ext.BoxComponent,{hideParent:true,enable:Ext.emptyFn,disable:Ext.emptyFn,focus:Ext.emptyFn});Ext.reg("tbitem",A.Item);A.Separator=Ext.extend(A.Item,{onRender:function(C,B){this.el=C.createChild({tag:"span",cls:"xtb-sep"},B)}});Ext.reg("tbseparator",A.Separator);A.Spacer=Ext.extend(A.Item,{onRender:function(C,B){this.el=C.createChild({tag:"div",cls:"xtb-spacer",style:this.width?"width:"+this.width+"px":""},B)}});Ext.reg("tbspacer",A.Spacer);A.Fill=Ext.extend(A.Item,{render:Ext.emptyFn,isFill:true});Ext.reg("tbfill",A.Fill);A.TextItem=Ext.extend(A.Item,{constructor:function(B){if(Ext.isString(B)){B={autoEl:{cls:"xtb-text",html:B}}}else{B.autoEl={cls:"xtb-text",html:B.text||""}}A.TextItem.superclass.constructor.call(this,B)},setText:function(B){if(this.rendered){this.el.dom.innerHTML=B}else{this.autoEl.html=B}}});Ext.reg("tbtext",A.TextItem);A.Button=Ext.extend(Ext.Button,{});A.SplitButton=Ext.extend(Ext.SplitButton,{});Ext.reg("tbbutton",A.Button);Ext.reg("tbsplit",A.SplitButton)})();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ButtonGroup=Ext.extend(Ext.Panel,{baseCls:"x-btn-group",layout:"table",defaultType:"button",frame:true,internalDefaults:{removeMode:"container",hideParent:true},initComponent:function(){this.layoutConfig=this.layoutConfig||{};Ext.applyIf(this.layoutConfig,{columns:this.columns});if(!this.title){this.addClass("x-btn-group-notitle")}this.on("afterlayout",this.onAfterLayout,this);Ext.ButtonGroup.superclass.initComponent.call(this)},applyDefaults:function(B){B=Ext.ButtonGroup.superclass.applyDefaults.call(this,B);var A=this.internalDefaults;if(B.events){Ext.applyIf(B.initialConfig,A);Ext.apply(B,A)}else{Ext.applyIf(B,A)}return B},onAfterLayout:function(){var A=this.body.getFrameWidth("lr")+this.body.dom.firstChild.offsetWidth;this.body.setWidth(A);this.el.setWidth(A+this.getFrameWidth())}});Ext.reg("buttongroup",Ext.ButtonGroup);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
(function(){var A=Ext.Toolbar;Ext.PagingToolbar=Ext.extend(Ext.Toolbar,{pageSize:20,displayMsg:"Displaying {0} - {1} of {2}",emptyMsg:"No data to display",beforePageText:"Page",afterPageText:"of {0}",firstText:"First Page",prevText:"Previous Page",nextText:"Next Page",lastText:"Last Page",refreshText:"Refresh",initComponent:function(){var C=[this.first=new A.Button({tooltip:this.firstText,overflowText:this.firstText,iconCls:"x-tbar-page-first",disabled:true,handler:this.moveFirst,scope:this}),this.prev=new A.Button({tooltip:this.prevText,overflowText:this.prevText,iconCls:"x-tbar-page-prev",disabled:true,handler:this.movePrevious,scope:this}),"-",this.beforePageText,this.inputItem=new Ext.form.NumberField({cls:"x-tbar-page-number",allowDecimals:false,allowNegative:false,enableKeyEvents:true,selectOnFocus:true,listeners:{scope:this,keydown:this.onPagingKeyDown,blur:this.onPagingBlur}}),this.afterTextItem=new A.TextItem({text:String.format(this.afterPageText,1)}),"-",this.next=new A.Button({tooltip:this.nextText,overflowText:this.nextText,iconCls:"x-tbar-page-next",disabled:true,handler:this.moveNext,scope:this}),this.last=new A.Button({tooltip:this.lastText,overflowText:this.lastText,iconCls:"x-tbar-page-last",disabled:true,handler:this.moveLast,scope:this}),"-",this.refresh=new A.Button({tooltip:this.refreshText,overflowText:this.refreshText,iconCls:"x-tbar-loading",handler:this.refresh,scope:this})];var B=this.items||this.buttons||[];if(this.prependButtons){this.items=B.concat(C)}else{this.items=C.concat(B)}delete this.buttons;if(this.displayInfo){this.items.push("->");this.items.push(this.displayItem=new A.TextItem({}))}Ext.PagingToolbar.superclass.initComponent.call(this);this.addEvents("change","beforechange");this.on("afterlayout",this.onFirstLayout,this,{single:true});this.cursor=0;this.bindStore(this.store)},onFirstLayout:function(){if(this.dsLoaded){this.onLoad.apply(this,this.dsLoaded)}},updateInfo:function(){if(this.displayItem){var B=this.store.getCount();var C=B==0?this.emptyMsg:String.format(this.displayMsg,this.cursor+1,this.cursor+B,this.store.getTotalCount());this.displayItem.setText(C)}},onLoad:function(B,D,H){if(!this.rendered){this.dsLoaded=[B,D,H];return }var E=this.getParams();this.cursor=(H.params&&H.params[E.start])?H.params[E.start]:0;var G=this.getPageData(),C=G.activePage,F=G.pages;this.afterTextItem.setText(String.format(this.afterPageText,G.pages));this.inputItem.setValue(C);this.first.setDisabled(C==1);this.prev.setDisabled(C==1);this.next.setDisabled(C==F);this.last.setDisabled(C==F);this.refresh.enable();this.updateInfo();this.fireEvent("change",this,G)},getPageData:function(){var B=this.store.getTotalCount();return{total:B,activePage:Math.ceil((this.cursor+this.pageSize)/this.pageSize),pages:B<this.pageSize?1:Math.ceil(B/this.pageSize)}},changePage:function(B){this.doLoad(((B-1)*this.pageSize).constrain(0,this.store.getTotalCount()))},onLoadError:function(){if(!this.rendered){return }this.refresh.enable()},readPage:function(D){var B=this.inputItem.getValue(),C;if(!B||isNaN(C=parseInt(B,10))){this.inputItem.setValue(D.activePage);return false}return C},onPagingFocus:function(){this.inputItem.select()},onPagingBlur:function(B){this.inputItem.setValue(this.getPageData().activePage)},onPagingKeyDown:function(F,E){var C=E.getKey(),G=this.getPageData(),D;if(C==E.RETURN){E.stopEvent();D=this.readPage(G);if(D!==false){D=Math.min(Math.max(1,D),G.pages)-1;this.doLoad(D*this.pageSize)}}else{if(C==E.HOME||C==E.END){E.stopEvent();D=C==E.HOME?1:G.pages;F.setValue(D)}else{if(C==E.UP||C==E.PAGEUP||C==E.DOWN||C==E.PAGEDOWN){E.stopEvent();if((D=this.readPage(G))){var B=E.shiftKey?10:1;if(C==E.DOWN||C==E.PAGEDOWN){B*=-1}D+=B;if(D>=1&D<=G.pages){F.setValue(D)}}}}}},getParams:function(){return this.paramNames||this.store.paramNames},beforeLoad:function(){if(this.rendered&&this.refresh){this.refresh.disable()}},doLoad:function(D){var C={},B=this.getParams();C[B.start]=D;C[B.limit]=this.pageSize;if(this.fireEvent("beforechange",this,C)!==false){this.store.load({params:C})}},moveFirst:function(){this.doLoad(0)},movePrevious:function(){this.doLoad(Math.max(0,this.cursor-this.pageSize))},moveNext:function(){this.doLoad(this.cursor+this.pageSize)},moveLast:function(){var C=this.store.getTotalCount(),B=C%this.pageSize;this.doLoad(B?(C-B):C-this.pageSize)},refresh:function(){this.doLoad(this.cursor)},bindStore:function(C,D){var B;if(!D&&this.store){this.store.un("beforeload",this.beforeLoad,this);this.store.un("load",this.onLoad,this);this.store.un("exception",this.onLoadError,this);if(C!==this.store&&this.store.autoDestroy){this.store.destroy()}}if(C){C=Ext.StoreMgr.lookup(C);C.on({scope:this,beforeload:this.beforeLoad,load:this.onLoad,exception:this.onLoadError});B=C.getCount()>0}this.store=C;if(B){this.onLoad(C,null,{})}},unbind:function(B){this.bindStore(null)},bind:function(B){this.bindStore(B)},onDestroy:function(){this.bindStore(null);Ext.PagingToolbar.superclass.onDestroy.call(this)}})})();Ext.reg("paging",Ext.PagingToolbar);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.History=(function(){var E,C;var J=false;var D;function F(){var K=top.location.href,L=K.indexOf("#");return L>=0?K.substr(L+1):null}function A(){C.value=D}function G(K){D=K;Ext.History.fireEvent("change",K)}function H(L){var K=['<html><body><div id="state">',L,"</div></body></html>"].join("");try{var N=E.contentWindow.document;N.open();N.write(K);N.close();return true}catch(M){return false}}function B(){if(!E.contentWindow||!E.contentWindow.document){setTimeout(B,10);return }var N=E.contentWindow.document;var L=N.getElementById("state");var K=L?L.innerText:null;var M=F();setInterval(function(){N=E.contentWindow.document;L=N.getElementById("state");var P=L?L.innerText:null;var O=F();if(P!==K){K=P;G(K);top.location.hash=K;M=K;A()}else{if(O!==M){M=O;H(O)}}},50);J=true;Ext.History.fireEvent("ready",Ext.History)}function I(){D=C.value?C.value:F();if(Ext.isIE){B()}else{var K=F();setInterval(function(){var L=F();if(L!==K){K=L;G(K);A()}},50);J=true;Ext.History.fireEvent("ready",Ext.History)}}return{fieldId:"x-history-field",iframeId:"x-history-frame",events:{},init:function(L,K){if(J){Ext.callback(L,K,[this]);return }if(!Ext.isReady){Ext.onReady(function(){Ext.History.init(L,K)});return }C=Ext.getDom(Ext.History.fieldId);if(Ext.isIE){E=Ext.getDom(Ext.History.iframeId)}this.addEvents("ready","change");if(L){this.on("ready",L,K,{single:true})}I()},add:function(K,L){if(L!==false){if(this.getToken()==K){return true}}if(Ext.isIE){return H(K)}else{top.location.hash=K;return true}},back:function(){history.go(-1)},forward:function(){history.go(1)},getToken:function(){return J?D:F()}}})();Ext.apply(Ext.History,new Ext.util.Observable());
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.Tip=Ext.extend(Ext.Panel,{minWidth:40,maxWidth:300,shadow:"sides",defaultAlign:"tl-bl?",autoRender:true,quickShowInterval:250,frame:true,hidden:true,baseCls:"x-tip",floating:{shadow:true,shim:true,useDisplay:true,constrain:false},autoHeight:true,closeAction:"hide",initComponent:function(){Ext.Tip.superclass.initComponent.call(this);if(this.closable&&!this.title){this.elements+=",header"}},afterRender:function(){Ext.Tip.superclass.afterRender.call(this);if(this.closable){this.addTool({id:"close",handler:this[this.closeAction],scope:this})}},showAt:function(A){Ext.Tip.superclass.show.call(this);if(this.measureWidth!==false&&(!this.initialConfig||typeof this.initialConfig.width!="number")){this.doAutoWidth()}if(this.constrainPosition){A=this.el.adjustForConstraints(A)}this.setPagePosition(A[0],A[1])},doAutoWidth:function(){var A=this.body.getTextWidth();if(this.title){A=Math.max(A,this.header.child("span").getTextWidth(this.title))}A+=this.getFrameWidth()+(this.closable?20:0)+this.body.getPadding("lr");this.setWidth(A.constrain(this.minWidth,this.maxWidth));if(Ext.isIE7&&!this.repainted){this.el.repaint();this.repainted=true}},showBy:function(A,B){if(!this.rendered){this.render(Ext.getBody())}this.showAt(this.el.getAlignToXY(A,B||this.defaultAlign))},initDraggable:function(){this.dd=new Ext.Tip.DD(this,typeof this.draggable=="boolean"?null:this.draggable);this.header.addClass("x-tip-draggable")}});Ext.Tip.DD=function(B,A){Ext.apply(this,A);this.tip=B;Ext.Tip.DD.superclass.constructor.call(this,B.el.id,"WindowDD-"+B.id);this.setHandleElId(B.header.id);this.scroll=false};Ext.extend(Ext.Tip.DD,Ext.dd.DD,{moveOnly:true,scroll:false,headerOffsets:[100,25],startDrag:function(){this.tip.el.disableShadow()},endDrag:function(A){this.tip.el.enableShadow(true)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ToolTip=Ext.extend(Ext.Tip,{showDelay:500,hideDelay:200,dismissDelay:5000,trackMouse:false,anchorToTarget:true,anchorOffset:0,targetCounter:0,constrainPosition:false,initComponent:function(){Ext.ToolTip.superclass.initComponent.call(this);this.lastActive=new Date();this.initTarget(this.target);this.origAnchor=this.anchor},onRender:function(B,A){Ext.ToolTip.superclass.onRender.call(this,B,A);this.anchorCls="x-tip-anchor-"+this.getAnchorPosition();this.anchorEl=this.el.createChild({cls:"x-tip-anchor "+this.anchorCls})},afterRender:function(){Ext.ToolTip.superclass.afterRender.call(this);this.anchorEl.setStyle("z-index",this.el.getZIndex()+1)},initTarget:function(B){var A;if((A=Ext.get(B))){if(this.target){this.target=Ext.get(this.target);this.target.un("mouseover",this.onTargetOver,this);this.target.un("mouseout",this.onTargetOut,this);this.target.un("mousemove",this.onMouseMove,this)}this.mon(A,{mouseover:this.onTargetOver,mouseout:this.onTargetOut,mousemove:this.onMouseMove,scope:this});this.target=A}if(this.anchor){this.anchorTarget=this.target}},onMouseMove:function(B){var A=this.delegate?B.getTarget(this.delegate):this.triggerElement=true;if(A){this.targetXY=B.getXY();if(A===this.triggerElement){if(!this.hidden&&this.trackMouse){this.setPagePosition(this.getTargetXY())}}else{this.hide();this.lastActive=new Date(0);this.onTargetOver(B)}}else{if(!this.closable&&this.isVisible()){this.hide()}}},getTargetXY:function(){if(this.anchor){this.targetCounter++;var C=this.getOffsets();var I=(this.anchorToTarget&&!this.trackMouse)?this.el.getAlignToXY(this.anchorTarget,this.getAnchorAlign()):this.targetXY;var A=Ext.lib.Dom.getViewWidth()-5;var F=Ext.lib.Dom.getViewHeight()-5;var H=(document.documentElement.scrollLeft||document.body.scrollLeft||0)+5;var G=(document.documentElement.scrollTop||document.body.scrollTop||0)+5;var B=[I[0]+C[0],I[1]+C[1]];var E=this.getSize();this.anchorEl.removeClass(this.anchorCls);if(this.targetCounter<2){if(B[0]<H){if(this.anchorToTarget){this.defaultAlign="l-r";if(this.mouseOffset){this.mouseOffset[0]*=-1}}this.anchor="left";return this.getTargetXY()}if(B[0]+E.width>A){if(this.anchorToTarget){this.defaultAlign="r-l";if(this.mouseOffset){this.mouseOffset[0]*=-1}}this.anchor="right";return this.getTargetXY()}if(B[1]<G){if(this.anchorToTarget){this.defaultAlign="t-b";if(this.mouseOffset){this.mouseOffset[1]*=-1}}this.anchor="top";return this.getTargetXY()}if(B[1]+E.height>F){if(this.anchorToTarget){this.defaultAlign="b-t";if(this.mouseOffset){this.mouseOffset[1]*=-1}}this.anchor="bottom";return this.getTargetXY()}}this.anchorCls="x-tip-anchor-"+this.getAnchorPosition();this.anchorEl.addClass(this.anchorCls);this.targetCounter=0;return B}else{var D=this.getMouseOffset();return[this.targetXY[0]+D[0],this.targetXY[1]+D[1]]}},getMouseOffset:function(){var A=this.anchor?[0,0]:[15,18];if(this.mouseOffset){A[0]+=this.mouseOffset[0];A[1]+=this.mouseOffset[1]}return A},getAnchorPosition:function(){if(this.anchor){this.tipAnchor=this.anchor.charAt(0)}else{var A=this.defaultAlign.match(/^([a-z]+)-([a-z]+)(\?)?$/);if(!A){throw"AnchorTip.defaultAlign is invalid"}this.tipAnchor=A[1].charAt(0)}switch(this.tipAnchor){case"t":return"top";case"b":return"bottom";case"r":return"right"}return"left"},getAnchorAlign:function(){switch(this.anchor){case"top":return"tl-bl";case"left":return"tl-tr";case"right":return"tr-tl";default:return"bl-tl"}},getOffsets:function(){var B,A=this.getAnchorPosition().charAt(0);if(this.anchorToTarget&&!this.trackMouse){switch(A){case"t":B=[0,9];break;case"b":B=[0,-13];break;case"r":B=[-13,0];break;default:B=[9,0];break}}else{switch(A){case"t":B=[-15-this.anchorOffset,30];break;case"b":B=[-19-this.anchorOffset,-13-this.el.dom.offsetHeight];break;case"r":B=[-15-this.el.dom.offsetWidth,-13-this.anchorOffset];break;default:B=[25,-13-this.anchorOffset];break}}var C=this.getMouseOffset();B[0]+=C[0];B[1]+=C[1];return B},onTargetOver:function(B){if(this.disabled||B.within(this.target.dom,true)){return }var A=B.getTarget(this.delegate);if(A){this.triggerElement=A;this.clearTimer("hide");this.targetXY=B.getXY();this.delayShow()}},delayShow:function(){if(this.hidden&&!this.showTimer){if(this.lastActive.getElapsed()<this.quickShowInterval){this.show()}else{this.showTimer=this.show.defer(this.showDelay,this)}}else{if(!this.hidden&&this.autoHide!==false){this.show()}}},onTargetOut:function(A){if(this.disabled||A.within(this.target.dom,true)){return }this.clearTimer("show");if(this.autoHide!==false){this.delayHide()}},delayHide:function(){if(!this.hidden&&!this.hideTimer){this.hideTimer=this.hide.defer(this.hideDelay,this)}},hide:function(){this.clearTimer("dismiss");this.lastActive=new Date();if(this.anchorEl){this.anchorEl.hide()}Ext.ToolTip.superclass.hide.call(this);delete this.triggerElement},show:function(){if(this.anchor){this.showAt([-1000,-1000]);this.origConstrainPosition=this.constrainPosition;this.constrainPosition=false;this.anchor=this.origAnchor}this.showAt(this.getTargetXY());if(this.anchor){this.syncAnchor();this.anchorEl.show();this.constrainPosition=this.origConstrainPosition}else{this.anchorEl.hide()}},showAt:function(A){this.lastActive=new Date();this.clearTimers();Ext.ToolTip.superclass.showAt.call(this,A);if(this.dismissDelay&&this.autoHide!==false){this.dismissTimer=this.hide.defer(this.dismissDelay,this)}},syncAnchor:function(){var A,B,C;switch(this.tipAnchor.charAt(0)){case"t":A="b";B="tl";C=[20+this.anchorOffset,2];break;case"r":A="l";B="tr";C=[-2,11+this.anchorOffset];break;case"b":A="t";B="bl";C=[20+this.anchorOffset,-2];break;default:A="r";B="tl";C=[2,11+this.anchorOffset];break}this.anchorEl.alignTo(this.el,A+"-"+B,C)},setPagePosition:function(A,B){Ext.ToolTip.superclass.setPagePosition.call(this,A,B);if(this.anchor){this.syncAnchor()}},clearTimer:function(A){A=A+"Timer";clearTimeout(this[A]);delete this[A]},clearTimers:function(){this.clearTimer("show");this.clearTimer("dismiss");this.clearTimer("hide")},onShow:function(){Ext.ToolTip.superclass.onShow.call(this);Ext.getDoc().on("mousedown",this.onDocMouseDown,this)},onHide:function(){Ext.ToolTip.superclass.onHide.call(this);Ext.getDoc().un("mousedown",this.onDocMouseDown,this)},onDocMouseDown:function(A){if(this.autoHide!==true&&!this.closable&&!A.within(this.el.dom)){this.disable();this.enable.defer(100,this)}},onDisable:function(){this.clearTimers();this.hide()},adjustPosition:function(A,D){if(this.contstrainPosition){var C=this.targetXY[1],B=this.getSize().height;if(D<=C&&(D+B)>=C){D=C-B-5}}return{x:A,y:D}},onDestroy:function(){Ext.getDoc().un("mousedown",this.onDocMouseDown,this);Ext.ToolTip.superclass.onDestroy.call(this)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.QuickTip=Ext.extend(Ext.ToolTip,{interceptTitles:false,tagConfig:{namespace:"ext",attribute:"qtip",width:"qwidth",target:"target",title:"qtitle",hide:"hide",cls:"qclass",align:"qalign",anchor:"anchor"},initComponent:function(){this.target=this.target||Ext.getDoc();this.targets=this.targets||{};Ext.QuickTip.superclass.initComponent.call(this)},register:function(D){var F=Ext.isArray(D)?D:arguments;for(var E=0,A=F.length;E<A;E++){var H=F[E];var G=H.target;if(G){if(Ext.isArray(G)){for(var C=0,B=G.length;C<B;C++){this.targets[Ext.id(G[C])]=H}}else{this.targets[Ext.id(G)]=H}}}},unregister:function(A){delete this.targets[Ext.id(A)]},cancelShow:function(B){var A=this.activeTarget;B=Ext.get(B).dom;if(this.isVisible()){if(A&&A.el==B){this.hide()}}else{if(A&&A.el==B){this.clearTimer("show")}}},onTargetOver:function(G){if(this.disabled){return }this.targetXY=G.getXY();var C=G.getTarget();if(!C||C.nodeType!==1||C==document||C==document.body){return }if(this.activeTarget&&C==this.activeTarget.el){this.clearTimer("hide");this.show();return }if(C&&this.targets[C.id]){this.activeTarget=this.targets[C.id];this.activeTarget.el=C;this.anchor=this.activeTarget.anchor;if(this.anchor){this.anchorTarget=C}this.delayShow();return }var E,F=Ext.fly(C),B=this.tagConfig;var D=B.namespace;if(this.interceptTitles&&C.title){E=C.title;C.qtip=E;C.removeAttribute("title");G.preventDefault()}else{E=C.qtip||F.getAttribute(B.attribute,D)}if(E){var A=F.getAttribute(B.hide,D);this.activeTarget={el:C,text:E,width:F.getAttribute(B.width,D),autoHide:A!="user"&&A!=="false",title:F.getAttribute(B.title,D),cls:F.getAttribute(B.cls,D),align:F.getAttribute(B.align,D)};this.anchor=F.getAttribute(B.anchor,D);if(this.anchor){this.anchorTarget=C}this.delayShow()}},onTargetOut:function(A){this.clearTimer("show");if(this.autoHide!==false){this.delayHide()}},showAt:function(B){var A=this.activeTarget;if(A){if(!this.rendered){this.render(Ext.getBody());this.activeTarget=A}if(A.width){this.setWidth(A.width);this.body.setWidth(this.adjustBodyWidth(A.width-this.getFrameWidth()));this.measureWidth=false}else{this.measureWidth=true}this.setTitle(A.title||"");this.body.update(A.text);this.autoHide=A.autoHide;this.dismissDelay=A.dismissDelay||this.dismissDelay;if(this.lastCls){this.el.removeClass(this.lastCls);delete this.lastCls}if(A.cls){this.el.addClass(A.cls);this.lastCls=A.cls}if(this.anchor){this.constrainPosition=false}else{if(A.align){B=this.el.getAlignToXY(A.el,A.align);this.constrainPosition=false}else{this.constrainPosition=true}}}Ext.QuickTip.superclass.showAt.call(this,B)},hide:function(){delete this.activeTarget;Ext.QuickTip.superclass.hide.call(this)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.QuickTips=function(){var B,A=[];return{init:function(C){if(!B){if(!Ext.isReady){Ext.onReady(function(){Ext.QuickTips.init(C)});return }B=new Ext.QuickTip({elements:"header,body"});if(C!==false){B.render(Ext.getBody())}}},enable:function(){if(B){A.pop();if(A.length<1){B.enable()}}},disable:function(){if(B){B.disable()}A.push(1)},isEnabled:function(){return B!==undefined&&!B.disabled},getQuickTip:function(){return B},register:function(){B.register.apply(B,arguments)},unregister:function(){B.unregister.apply(B,arguments)},tips:function(){B.register.apply(B,arguments)}}}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.tree.TreePanel=Ext.extend(Ext.Panel,{rootVisible:true,animate:Ext.enableFx,lines:true,enableDD:false,hlDrop:Ext.enableFx,pathSeparator:"/",initComponent:function(){Ext.tree.TreePanel.superclass.initComponent.call(this);if(!this.eventModel){this.eventModel=new Ext.tree.TreeEventModel(this)}var A=this.loader;if(!A){A=new Ext.tree.TreeLoader({dataUrl:this.dataUrl,requestMethod:this.requestMethod})}else{if(typeof A=="object"&&!A.load){A=new Ext.tree.TreeLoader(A)}}this.loader=A;this.nodeHash={};if(this.root){var B=this.root;delete this.root;this.setRootNode(B)}this.addEvents("append","remove","movenode","insert","beforeappend","beforeremove","beforemovenode","beforeinsert","beforeload","load","textchange","beforeexpandnode","beforecollapsenode","expandnode","disabledchange","collapsenode","beforeclick","click","checkchange","dblclick","contextmenu","beforechildrenrendered","startdrag","enddrag","dragdrop","beforenodedrop","nodedrop","nodedragover");if(this.singleExpand){this.on("beforeexpandnode",this.restrictExpand,this)}},proxyNodeEvent:function(C,B,A,G,F,E,D){if(C=="collapse"||C=="expand"||C=="beforecollapse"||C=="beforeexpand"||C=="move"||C=="beforemove"){C=C+"node"}return this.fireEvent(C,B,A,G,F,E,D)},getRootNode:function(){return this.root},setRootNode:function(B){Ext.destroy(this.root);if(!B.render){B=this.loader.createNode(B)}this.root=B;B.ownerTree=this;B.isRoot=true;this.registerNode(B);if(!this.rootVisible){var A=B.attributes.uiProvider;B.ui=A?new A(B):new Ext.tree.RootTreeNodeUI(B)}if(this.innerCt){this.innerCt.update("");this.afterRender()}return B},getNodeById:function(A){return this.nodeHash[A]},registerNode:function(A){this.nodeHash[A.id]=A},unregisterNode:function(A){delete this.nodeHash[A.id]},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"},restrictExpand:function(A){var B=A.parentNode;if(B){if(B.expandedChild&&B.expandedChild.parentNode==B){B.expandedChild.collapse()}B.expandedChild=A}},getChecked:function(A,B){B=B||this.root;var C=[];var D=function(){if(this.attributes.checked){C.push(!A?this:(A=="id"?this.id:this.attributes[A]))}};B.cascade(D);return C},getEl:function(){return this.el},getLoader:function(){return this.loader},expandAll:function(){this.root.expand(true)},collapseAll:function(){this.root.collapse(true)},getSelectionModel:function(){if(!this.selModel){this.selModel=new Ext.tree.DefaultSelectionModel()}return this.selModel},expandPath:function(F,A,G){A=A||"id";var D=F.split(this.pathSeparator);var C=this.root;if(C.attributes[A]!=D[1]){if(G){G(false,null)}return }var B=1;var E=function(){if(++B==D.length){if(G){G(true,C)}return }var H=C.findChild(A,D[B]);if(!H){if(G){G(false,C)}return }C=H;H.expand(false,false,E)};C.expand(false,false,E)},selectPath:function(E,A,F){A=A||"id";var C=E.split(this.pathSeparator);var B=C.pop();if(C.length>0){var D=function(H,G){if(H&&G){var I=G.findChild(A,B);if(I){I.select();if(F){F(true,I)}}else{if(F){F(false,I)}}}else{if(F){F(false,I)}}};this.expandPath(C.join(this.pathSeparator),A,D)}else{this.root.select();if(F){F(true,this.root)}}},getTreeEl:function(){return this.body},onRender:function(B,A){Ext.tree.TreePanel.superclass.onRender.call(this,B,A);this.el.addClass("x-tree");this.innerCt=this.body.createChild({tag:"ul",cls:"x-tree-root-ct "+(this.useArrows?"x-tree-arrows":this.lines?"x-tree-lines":"x-tree-no-lines")})},initEvents:function(){Ext.tree.TreePanel.superclass.initEvents.call(this);if(this.containerScroll){Ext.dd.ScrollManager.register(this.body)}if((this.enableDD||this.enableDrop)&&!this.dropZone){this.dropZone=new Ext.tree.TreeDropZone(this,this.dropConfig||{ddGroup:this.ddGroup||"TreeDD",appendOnly:this.ddAppendOnly===true})}if((this.enableDD||this.enableDrag)&&!this.dragZone){this.dragZone=new Ext.tree.TreeDragZone(this,this.dragConfig||{ddGroup:this.ddGroup||"TreeDD",scroll:this.ddScroll})}this.getSelectionModel().init(this)},afterRender:function(){Ext.tree.TreePanel.superclass.afterRender.call(this);this.root.render();if(!this.rootVisible){this.root.renderChildren()}},onDestroy:function(){if(this.rendered){this.body.removeAllListeners();Ext.dd.ScrollManager.unregister(this.body);if(this.dropZone){this.dropZone.unreg()}if(this.dragZone){this.dragZone.unreg()}}this.root.destroy();this.nodeHash=null;Ext.tree.TreePanel.superclass.onDestroy.call(this)}});Ext.tree.TreePanel.nodeTypes={};Ext.reg("treepanel",Ext.tree.TreePanel);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.tree.TreeEventModel=function(A){this.tree=A;this.tree.on("render",this.initEvents,this)};Ext.tree.TreeEventModel.prototype={initEvents:function(){var A=this.tree.getTreeEl();A.on("click",this.delegateClick,this);if(this.tree.trackMouseOver!==false){this.tree.innerCt.on("mouseover",this.delegateOver,this);this.tree.innerCt.on("mouseout",this.delegateOut,this)}A.on("dblclick",this.delegateDblClick,this);A.on("contextmenu",this.delegateContextMenu,this)},getNode:function(B){var A;if(A=B.getTarget(".x-tree-node-el",10)){var C=Ext.fly(A,"_treeEvents").getAttribute("tree-node-id","ext");if(C){return this.tree.getNodeById(C)}}return null},getNodeTarget:function(B){var A=B.getTarget(".x-tree-node-icon",1);if(!A){A=B.getTarget(".x-tree-node-el",6)}return A},delegateOut:function(B,A){if(!this.beforeEvent(B)){return }if(B.getTarget(".x-tree-ec-icon",1)){var C=this.getNode(B);this.onIconOut(B,C);if(C==this.lastEcOver){delete this.lastEcOver}}if((A=this.getNodeTarget(B))&&!B.within(A,true)){this.onNodeOut(B,this.getNode(B))}},delegateOver:function(B,A){if(!this.beforeEvent(B)){return }if(Ext.isGecko&&!this.trackingDoc){Ext.getBody().on("mouseover",this.trackExit,this);this.trackingDoc=true}if(this.lastEcOver){this.onIconOut(B,this.lastEcOver);delete this.lastEcOver}if(B.getTarget(".x-tree-ec-icon",1)){this.lastEcOver=this.getNode(B);this.onIconOver(B,this.lastEcOver)}if(A=this.getNodeTarget(B)){this.onNodeOver(B,this.getNode(B))}},trackExit:function(A){if(this.lastOverNode&&!A.within(this.lastOverNode.ui.getEl())){this.onNodeOut(A,this.lastOverNode);delete this.lastOverNode;Ext.getBody().un("mouseover",this.trackExit,this);this.trackingDoc=false}},delegateClick:function(B,A){if(!this.beforeEvent(B)){return }if(B.getTarget("input[type=checkbox]",1)){this.onCheckboxClick(B,this.getNode(B))}else{if(B.getTarget(".x-tree-ec-icon",1)){this.onIconClick(B,this.getNode(B))}else{if(this.getNodeTarget(B)){this.onNodeClick(B,this.getNode(B))}}}},delegateDblClick:function(B,A){if(this.beforeEvent(B)&&this.getNodeTarget(B)){this.onNodeDblClick(B,this.getNode(B))}},delegateContextMenu:function(B,A){if(this.beforeEvent(B)&&this.getNodeTarget(B)){this.onNodeContextMenu(B,this.getNode(B))}},onNodeClick:function(B,A){A.ui.onClick(B)},onNodeOver:function(B,A){this.lastOverNode=A;A.ui.onOver(B)},onNodeOut:function(B,A){A.ui.onOut(B)},onIconOver:function(B,A){A.ui.addClass("x-tree-ec-over")},onIconOut:function(B,A){A.ui.removeClass("x-tree-ec-over")},onIconClick:function(B,A){A.ui.ecClick(B)},onCheckboxClick:function(B,A){A.ui.onCheckChange(B)},onNodeDblClick:function(B,A){A.ui.onDblClick(B)},onNodeContextMenu:function(B,A){A.ui.onContextMenu(B)},beforeEvent:function(A){if(this.disabled){A.stopEvent();return false}return true},disable:function(){this.disabled=true},enable:function(){this.disabled=false}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.tree.DefaultSelectionModel=function(A){this.selNode=null;this.addEvents("selectionchange","beforeselect");Ext.apply(this,A);Ext.tree.DefaultSelectionModel.superclass.constructor.call(this)};Ext.extend(Ext.tree.DefaultSelectionModel,Ext.util.Observable,{init:function(A){this.tree=A;A.getTreeEl().on("keydown",this.onKeyDown,this);A.on("click",this.onNodeClick,this)},onNodeClick:function(A,B){this.select(A)},select:function(B){var A=this.selNode;if(B==A){B.ui.onSelectedChange(true)}else{if(this.fireEvent("beforeselect",this,B,A)!==false){if(A){A.ui.onSelectedChange(false)}this.selNode=B;B.ui.onSelectedChange(true);this.fireEvent("selectionchange",this,B,A)}}return B},unselect:function(A){if(this.selNode==A){this.clearSelections()}},clearSelections:function(){var A=this.selNode;if(A){A.ui.onSelectedChange(false);this.selNode=null;this.fireEvent("selectionchange",this,null)}return A},getSelectedNode:function(){return this.selNode},isSelected:function(A){return this.selNode==A},selectPrevious:function(){var A=this.selNode||this.lastSelNode;if(!A){return null}var C=A.previousSibling;if(C){if(!C.isExpanded()||C.childNodes.length<1){return this.select(C)}else{var B=C.lastChild;while(B&&B.isExpanded()&&B.childNodes.length>0){B=B.lastChild}return this.select(B)}}else{if(A.parentNode&&(this.tree.rootVisible||!A.parentNode.isRoot)){return this.select(A.parentNode)}}return null},selectNext:function(){var B=this.selNode||this.lastSelNode;if(!B){return null}if(B.firstChild&&B.isExpanded()){return this.select(B.firstChild)}else{if(B.nextSibling){return this.select(B.nextSibling)}else{if(B.parentNode){var A=null;B.parentNode.bubble(function(){if(this.nextSibling){A=this.getOwnerTree().selModel.select(this.nextSibling);return false}});return A}}}return null},onKeyDown:function(C){var B=this.selNode||this.lastSelNode;var D=this;if(!B){return }var A=C.getKey();switch(A){case C.DOWN:C.stopEvent();this.selectNext();break;case C.UP:C.stopEvent();this.selectPrevious();break;case C.RIGHT:C.preventDefault();if(B.hasChildNodes()){if(!B.isExpanded()){B.expand()}else{if(B.firstChild){this.select(B.firstChild,C)}}}break;case C.LEFT:C.preventDefault();if(B.hasChildNodes()&&B.isExpanded()){B.collapse()}else{if(B.parentNode&&(this.tree.rootVisible||B.parentNode!=this.tree.getRootNode())){this.select(B.parentNode,C)}}break}}});Ext.tree.MultiSelectionModel=function(A){this.selNodes=[];this.selMap={};this.addEvents("selectionchange");Ext.apply(this,A);Ext.tree.MultiSelectionModel.superclass.constructor.call(this)};Ext.extend(Ext.tree.MultiSelectionModel,Ext.util.Observable,{init:function(A){this.tree=A;A.getTreeEl().on("keydown",this.onKeyDown,this);A.on("click",this.onNodeClick,this)},onNodeClick:function(A,B){if(B.ctrlKey&&this.isSelected(A)){this.unselect(A)}else{this.select(A,B,B.ctrlKey)}},select:function(A,C,B){if(B!==true){this.clearSelections(true)}if(this.isSelected(A)){this.lastSelNode=A;return A}this.selNodes.push(A);this.selMap[A.id]=A;this.lastSelNode=A;A.ui.onSelectedChange(true);this.fireEvent("selectionchange",this,this.selNodes);return A},unselect:function(B){if(this.selMap[B.id]){B.ui.onSelectedChange(false);var C=this.selNodes;var A=C.indexOf(B);if(A!=-1){this.selNodes.splice(A,1)}delete this.selMap[B.id];this.fireEvent("selectionchange",this,this.selNodes)}},clearSelections:function(B){var D=this.selNodes;if(D.length>0){for(var C=0,A=D.length;C<A;C++){D[C].ui.onSelectedChange(false)}this.selNodes=[];this.selMap={};if(B!==true){this.fireEvent("selectionchange",this,this.selNodes)}}},isSelected:function(A){return this.selMap[A.id]?true:false},getSelectedNodes:function(){return this.selNodes},onKeyDown:Ext.tree.DefaultSelectionModel.prototype.onKeyDown,selectNext:Ext.tree.DefaultSelectionModel.prototype.selectNext,selectPrevious:Ext.tree.DefaultSelectionModel.prototype.selectPrevious});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.data.Tree=function(A){this.nodeHash={};this.root=null;if(A){this.setRootNode(A)}this.addEvents("append","remove","move","insert","beforeappend","beforeremove","beforemove","beforeinsert");Ext.data.Tree.superclass.constructor.call(this)};Ext.extend(Ext.data.Tree,Ext.util.Observable,{pathSeparator:"/",proxyNodeEvent:function(){return this.fireEvent.apply(this,arguments)},getRootNode:function(){return this.root},setRootNode:function(A){this.root=A;A.ownerTree=this;A.isRoot=true;this.registerNode(A);return A},getNodeById:function(A){return this.nodeHash[A]},registerNode:function(A){this.nodeHash[A.id]=A},unregisterNode:function(A){delete this.nodeHash[A.id]},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"}});Ext.data.Node=function(A){this.attributes=A||{};this.leaf=this.attributes.leaf;this.id=this.attributes.id;if(!this.id){this.id=Ext.id(null,"xnode-");this.attributes.id=this.id}this.childNodes=[];if(!this.childNodes.indexOf){this.childNodes.indexOf=function(D){for(var C=0,B=this.length;C<B;C++){if(this[C]==D){return C}}return -1}}this.parentNode=null;this.firstChild=null;this.lastChild=null;this.previousSibling=null;this.nextSibling=null;this.addEvents({append:true,remove:true,move:true,insert:true,beforeappend:true,beforeremove:true,beforemove:true,beforeinsert:true});this.listeners=this.attributes.listeners;Ext.data.Node.superclass.constructor.call(this)};Ext.extend(Ext.data.Node,Ext.util.Observable,{fireEvent:function(B){if(Ext.data.Node.superclass.fireEvent.apply(this,arguments)===false){return false}var A=this.getOwnerTree();if(A){if(A.proxyNodeEvent.apply(A,arguments)===false){return false}}return true},isLeaf:function(){return this.leaf===true},setFirstChild:function(A){this.firstChild=A},setLastChild:function(A){this.lastChild=A},isLast:function(){return(!this.parentNode?true:this.parentNode.lastChild==this)},isFirst:function(){return(!this.parentNode?true:this.parentNode.firstChild==this)},hasChildNodes:function(){return !this.isLeaf()&&this.childNodes.length>0},isExpandable:function(){return this.attributes.expandable||this.hasChildNodes()},appendChild:function(E){var F=false;if(Ext.isArray(E)){F=E}else{if(arguments.length>1){F=arguments}}if(F){for(var D=0,A=F.length;D<A;D++){this.appendChild(F[D])}}else{if(this.fireEvent("beforeappend",this.ownerTree,this,E)===false){return false}var B=this.childNodes.length;var C=E.parentNode;if(C){if(E.fireEvent("beforemove",E.getOwnerTree(),E,C,this,B)===false){return false}C.removeChild(E)}B=this.childNodes.length;if(B===0){this.setFirstChild(E)}this.childNodes.push(E);E.parentNode=this;var G=this.childNodes[B-1];if(G){E.previousSibling=G;G.nextSibling=E}else{E.previousSibling=null}E.nextSibling=null;this.setLastChild(E);E.setOwnerTree(this.getOwnerTree());this.fireEvent("append",this.ownerTree,this,E,B);if(C){E.fireEvent("move",this.ownerTree,E,C,this,B)}return E}},removeChild:function(B){var A=this.childNodes.indexOf(B);if(A==-1){return false}if(this.fireEvent("beforeremove",this.ownerTree,this,B)===false){return false}this.childNodes.splice(A,1);if(B.previousSibling){B.previousSibling.nextSibling=B.nextSibling}if(B.nextSibling){B.nextSibling.previousSibling=B.previousSibling}if(this.firstChild==B){this.setFirstChild(B.nextSibling)}if(this.lastChild==B){this.setLastChild(B.previousSibling)}B.setOwnerTree(null);B.parentNode=null;B.previousSibling=null;B.nextSibling=null;this.fireEvent("remove",this.ownerTree,this,B);return B},insertBefore:function(D,A){if(!A){return this.appendChild(D)}if(D==A){return false}if(this.fireEvent("beforeinsert",this.ownerTree,this,D,A)===false){return false}var B=this.childNodes.indexOf(A);var C=D.parentNode;var E=B;if(C==this&&this.childNodes.indexOf(D)<B){E--}if(C){if(D.fireEvent("beforemove",D.getOwnerTree(),D,C,this,B,A)===false){return false}C.removeChild(D)}if(E===0){this.setFirstChild(D)}this.childNodes.splice(E,0,D);D.parentNode=this;var F=this.childNodes[E-1];if(F){D.previousSibling=F;F.nextSibling=D}else{D.previousSibling=null}D.nextSibling=A;A.previousSibling=D;D.setOwnerTree(this.getOwnerTree());this.fireEvent("insert",this.ownerTree,this,D,A);if(C){D.fireEvent("move",this.ownerTree,D,C,this,E,A)}return D},remove:function(){this.parentNode.removeChild(this);return this},item:function(A){return this.childNodes[A]},replaceChild:function(A,C){var B=C?C.nextSibling:null;this.removeChild(C);this.insertBefore(A,B);return C},indexOf:function(A){return this.childNodes.indexOf(A)},getOwnerTree:function(){if(!this.ownerTree){var A=this;while(A){if(A.ownerTree){this.ownerTree=A.ownerTree;break}A=A.parentNode}}return this.ownerTree},getDepth:function(){var B=0;var A=this;while(A.parentNode){++B;A=A.parentNode}return B},setOwnerTree:function(B){if(B!=this.ownerTree){if(this.ownerTree){this.ownerTree.unregisterNode(this)}this.ownerTree=B;var D=this.childNodes;for(var C=0,A=D.length;C<A;C++){D[C].setOwnerTree(B)}if(B){B.registerNode(this)}}},setId:function(B){if(B!==this.id){var A=this.ownerTree;if(A){A.unregisterNode(this)}this.id=B;if(A){A.registerNode(this)}this.onIdChange(B)}},onIdChange:Ext.emptyFn,getPath:function(B){B=B||"id";var D=this.parentNode;var A=[this.attributes[B]];while(D){A.unshift(D.attributes[B]);D=D.parentNode}var C=this.getOwnerTree().pathSeparator;return C+A.join(C)},bubble:function(C,B,A){var D=this;while(D){if(C.apply(B||D,A||[D])===false){break}D=D.parentNode}},cascade:function(F,E,B){if(F.apply(E||this,B||[this])!==false){var D=this.childNodes;for(var C=0,A=D.length;C<A;C++){D[C].cascade(F,E,B)}}},eachChild:function(F,E,B){var D=this.childNodes;for(var C=0,A=D.length;C<A;C++){if(F.apply(E||this,B||[D[C]])===false){break}}},findChild:function(D,E){var C=this.childNodes;for(var B=0,A=C.length;B<A;B++){if(C[B].attributes[D]==E){return C[B]}}return null},findChildBy:function(E,D){var C=this.childNodes;for(var B=0,A=C.length;B<A;B++){if(E.call(D||C[B],C[B])===true){return C[B]}}return null},sort:function(E,D){var C=this.childNodes;var A=C.length;if(A>0){var F=D?function(){E.apply(D,arguments)}:E;C.sort(F);for(var B=0;B<A;B++){var G=C[B];G.previousSibling=C[B-1];G.nextSibling=C[B+1];if(B===0){this.setFirstChild(G)}if(B==A-1){this.setLastChild(G)}}}},contains:function(A){return A.isAncestor(this)},isAncestor:function(A){var B=this.parentNode;while(B){if(B==A){return true}B=B.parentNode}return false},toString:function(){return"[Node"+(this.id?" "+this.id:"")+"]"}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.tree.TreeNode=function(A){A=A||{};if(typeof A=="string"){A={text:A}}this.childrenRendered=false;this.rendered=false;Ext.tree.TreeNode.superclass.constructor.call(this,A);this.expanded=A.expanded===true;this.isTarget=A.isTarget!==false;this.draggable=A.draggable!==false&&A.allowDrag!==false;this.allowChildren=A.allowChildren!==false&&A.allowDrop!==false;this.text=A.text;this.disabled=A.disabled===true;this.hidden=A.hidden===true;this.addEvents("textchange","beforeexpand","beforecollapse","expand","disabledchange","collapse","beforeclick","click","checkchange","dblclick","contextmenu","beforechildrenrendered");var B=this.attributes.uiProvider||this.defaultUI||Ext.tree.TreeNodeUI;this.ui=new B(this)};Ext.extend(Ext.tree.TreeNode,Ext.data.Node,{preventHScroll:true,isExpanded:function(){return this.expanded},getUI:function(){return this.ui},getLoader:function(){var A;return this.loader||((A=this.getOwnerTree())&&A.loader?A.loader:new Ext.tree.TreeLoader())},setFirstChild:function(A){var B=this.firstChild;Ext.tree.TreeNode.superclass.setFirstChild.call(this,A);if(this.childrenRendered&&B&&A!=B){B.renderIndent(true,true)}if(this.rendered){this.renderIndent(true,true)}},setLastChild:function(B){var A=this.lastChild;Ext.tree.TreeNode.superclass.setLastChild.call(this,B);if(this.childrenRendered&&A&&B!=A){A.renderIndent(true,true)}if(this.rendered){this.renderIndent(true,true)}},appendChild:function(B){if(!B.render&&!Ext.isArray(B)){B=this.getLoader().createNode(B)}var A=Ext.tree.TreeNode.superclass.appendChild.call(this,B);if(A&&this.childrenRendered){A.render()}this.ui.updateExpandIcon();return A},removeChild:function(A){this.ownerTree.getSelectionModel().unselect(A);Ext.tree.TreeNode.superclass.removeChild.apply(this,arguments);if(this.childrenRendered){A.ui.remove()}if(this.childNodes.length<1){this.collapse(false,false)}else{this.ui.updateExpandIcon()}if(!this.firstChild&&!this.isHiddenRoot()){this.childrenRendered=false}return A},insertBefore:function(C,A){if(!C.render){C=this.getLoader().createNode(C)}var B=Ext.tree.TreeNode.superclass.insertBefore.call(this,C,A);if(B&&A&&this.childrenRendered){C.render()}this.ui.updateExpandIcon();return B},setText:function(B){var A=this.text;this.text=B;this.attributes.text=B;if(this.rendered){this.ui.onTextChange(this,B,A)}this.fireEvent("textchange",this,B,A)},select:function(){this.getOwnerTree().getSelectionModel().select(this)},unselect:function(){this.getOwnerTree().getSelectionModel().unselect(this)},isSelected:function(){return this.getOwnerTree().getSelectionModel().isSelected(this)},expand:function(A,C,D,B){if(!this.expanded){if(this.fireEvent("beforeexpand",this,A,C)===false){return }if(!this.childrenRendered){this.renderChildren()}this.expanded=true;if(!this.isHiddenRoot()&&(this.getOwnerTree().animate&&C!==false)||C){this.ui.animExpand(function(){this.fireEvent("expand",this);this.runCallback(D,B||this,[this]);if(A===true){this.expandChildNodes(true)}}.createDelegate(this));return }else{this.ui.expand();this.fireEvent("expand",this);this.runCallback(D,B||this,[this])}}else{this.runCallback(D,B||this,[this])}if(A===true){this.expandChildNodes(true)}},runCallback:function(A,C,B){if(Ext.isFunction(A)){A.apply(C,B)}},isHiddenRoot:function(){return this.isRoot&&!this.getOwnerTree().rootVisible},collapse:function(B,F,G,E){if(this.expanded&&!this.isHiddenRoot()){if(this.fireEvent("beforecollapse",this,B,F)===false){return }this.expanded=false;if((this.getOwnerTree().animate&&F!==false)||F){this.ui.animCollapse(function(){this.fireEvent("collapse",this);this.runCallback(G,E||this,[this]);if(B===true){this.collapseChildNodes(true)}}.createDelegate(this));return }else{this.ui.collapse();this.fireEvent("collapse",this);this.runCallback(G,E||this,[this])}}else{if(!this.expanded){this.runCallback(G,E||this,[this])}}if(B===true){var D=this.childNodes;for(var C=0,A=D.length;C<A;C++){D[C].collapse(true,false)}}},delayedExpand:function(A){if(!this.expandProcId){this.expandProcId=this.expand.defer(A,this)}},cancelExpand:function(){if(this.expandProcId){clearTimeout(this.expandProcId)}this.expandProcId=false},toggle:function(){if(this.expanded){this.collapse()}else{this.expand()}},ensureVisible:function(C,B){var A=this.getOwnerTree();A.expandPath(this.parentNode?this.parentNode.getPath():this.getPath(),false,function(){var D=A.getNodeById(this.id);A.getTreeEl().scrollChildIntoView(D.ui.anchor);this.runCallback(C,B||this,[this])}.createDelegate(this))},expandChildNodes:function(B){var D=this.childNodes;for(var C=0,A=D.length;C<A;C++){D[C].expand(B)}},collapseChildNodes:function(B){var D=this.childNodes;for(var C=0,A=D.length;C<A;C++){D[C].collapse(B)}},disable:function(){this.disabled=true;this.unselect();if(this.rendered&&this.ui.onDisableChange){this.ui.onDisableChange(this,true)}this.fireEvent("disabledchange",this,true)},enable:function(){this.disabled=false;if(this.rendered&&this.ui.onDisableChange){this.ui.onDisableChange(this,false)}this.fireEvent("disabledchange",this,false)},renderChildren:function(B){if(B!==false){this.fireEvent("beforechildrenrendered",this)}var D=this.childNodes;for(var C=0,A=D.length;C<A;C++){D[C].render(true)}this.childrenRendered=true},sort:function(E,D){Ext.tree.TreeNode.superclass.sort.apply(this,arguments);if(this.childrenRendered){var C=this.childNodes;for(var B=0,A=C.length;B<A;B++){C[B].render(true)}}},render:function(A){this.ui.render(A);if(!this.rendered){this.getOwnerTree().registerNode(this);this.rendered=true;if(this.expanded){this.expanded=false;this.expand(false,false)}}},renderIndent:function(B,E){if(E){this.ui.childIndent=null}this.ui.renderIndent();if(B===true&&this.childrenRendered){var D=this.childNodes;for(var C=0,A=D.length;C<A;C++){D[C].renderIndent(true,E)}}},beginUpdate:function(){this.childrenRendered=false},endUpdate:function(){if(this.expanded&&this.rendered){this.renderChildren()}},destroy:function(){if(this.childNodes){for(var B=0,A=this.childNodes.length;B<A;B++){this.childNodes[B].destroy()}this.childNodes=null}if(this.ui.destroy){this.ui.destroy()}},onIdChange:function(A){this.ui.onIdChange(A)}});Ext.tree.TreePanel.nodeTypes.node=Ext.tree.TreeNode;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.tree.AsyncTreeNode=function(A){this.loaded=A&&A.loaded===true;this.loading=false;Ext.tree.AsyncTreeNode.superclass.constructor.apply(this,arguments);this.addEvents("beforeload","load")};Ext.extend(Ext.tree.AsyncTreeNode,Ext.tree.TreeNode,{expand:function(B,E,G,C){if(this.loading){var F;var D=function(){if(!this.loading){clearInterval(F);this.expand(B,E,G,C)}}.createDelegate(this);F=setInterval(D,200);return }if(!this.loaded){if(this.fireEvent("beforeload",this)===false){return }this.loading=true;this.ui.beforeLoad(this);var A=this.loader||this.attributes.loader||this.getOwnerTree().getLoader();if(A){A.load(this,this.loadComplete.createDelegate(this,[B,E,G,C]),this);return }}Ext.tree.AsyncTreeNode.superclass.expand.call(this,B,E,G,C)},isLoading:function(){return this.loading},loadComplete:function(A,C,D,B){this.loading=false;this.loaded=true;this.ui.afterLoad(this);this.fireEvent("load",this);this.expand(A,C,D,B)},isLoaded:function(){return this.loaded},hasChildNodes:function(){if(!this.isLeaf()&&!this.loaded){return true}else{return Ext.tree.AsyncTreeNode.superclass.hasChildNodes.call(this)}},reload:function(B,A){this.collapse(false,false);while(this.firstChild){this.removeChild(this.firstChild).destroy()}this.childrenRendered=false;this.loaded=false;if(this.isHiddenRoot()){this.expanded=false}this.expand(false,false,B,A)}});Ext.tree.TreePanel.nodeTypes.async=Ext.tree.AsyncTreeNode;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.tree.TreeNodeUI=function(A){this.node=A;this.rendered=false;this.animating=false;this.wasLeaf=true;this.ecc="x-tree-ec-icon x-tree-elbow";this.emptyIcon=Ext.BLANK_IMAGE_URL};Ext.tree.TreeNodeUI.prototype={removeChild:function(A){if(this.rendered){this.ctNode.removeChild(A.ui.getEl())}},beforeLoad:function(){this.addClass("x-tree-node-loading")},afterLoad:function(){this.removeClass("x-tree-node-loading")},onTextChange:function(B,C,A){if(this.rendered){this.textNode.innerHTML=C}},onDisableChange:function(A,B){this.disabled=B;if(this.checkbox){this.checkbox.disabled=B}if(B){this.addClass("x-tree-node-disabled")}else{this.removeClass("x-tree-node-disabled")}},onSelectedChange:function(A){if(A){this.focus();this.addClass("x-tree-selected")}else{this.removeClass("x-tree-selected")}},onMove:function(A,G,E,F,D,B){this.childIndent=null;if(this.rendered){var H=F.ui.getContainer();if(!H){this.holder=document.createElement("div");this.holder.appendChild(this.wrap);return }var C=B?B.ui.getEl():null;if(C){H.insertBefore(this.wrap,C)}else{H.appendChild(this.wrap)}this.node.renderIndent(true,E!=F)}},addClass:function(A){if(this.elNode){Ext.fly(this.elNode).addClass(A)}},removeClass:function(A){if(this.elNode){Ext.fly(this.elNode).removeClass(A)}},remove:function(){if(this.rendered){this.holder=document.createElement("div");this.holder.appendChild(this.wrap)}},fireEvent:function(){return this.node.fireEvent.apply(this.node,arguments)},initEvents:function(){this.node.on("move",this.onMove,this);if(this.node.disabled){this.addClass("x-tree-node-disabled");if(this.checkbox){this.checkbox.disabled=true}}if(this.node.hidden){this.hide()}var B=this.node.getOwnerTree();var A=B.enableDD||B.enableDrag||B.enableDrop;if(A&&(!this.node.isRoot||B.rootVisible)){Ext.dd.Registry.register(this.elNode,{node:this.node,handles:this.getDDHandles(),isHandle:false})}},getDDHandles:function(){return[this.iconNode,this.textNode,this.elNode]},hide:function(){this.node.hidden=true;if(this.wrap){this.wrap.style.display="none"}},show:function(){this.node.hidden=false;if(this.wrap){this.wrap.style.display=""}},onContextMenu:function(A){if(this.node.hasListener("contextmenu")||this.node.getOwnerTree().hasListener("contextmenu")){A.preventDefault();this.focus();this.fireEvent("contextmenu",this.node,A)}},onClick:function(B){if(this.dropping){B.stopEvent();return }if(this.fireEvent("beforeclick",this.node,B)!==false){var A=B.getTarget("a");if(!this.disabled&&this.node.attributes.href&&A){this.fireEvent("click",this.node,B);return }else{if(A&&B.ctrlKey){B.stopEvent()}}B.preventDefault();if(this.disabled){return }if(this.node.attributes.singleClickExpand&&!this.animating&&this.node.isExpandable()){this.node.toggle()}this.fireEvent("click",this.node,B)}else{B.stopEvent()}},onDblClick:function(A){A.preventDefault();if(this.disabled){return }if(this.checkbox){this.toggleCheck()}if(!this.animating&&this.node.isExpandable()){this.node.toggle()}this.fireEvent("dblclick",this.node,A)},onOver:function(A){this.addClass("x-tree-node-over")},onOut:function(A){this.removeClass("x-tree-node-over")},onCheckChange:function(){var A=this.checkbox.checked;this.checkbox.defaultChecked=A;this.node.attributes.checked=A;this.fireEvent("checkchange",this.node,A)},ecClick:function(A){if(!this.animating&&this.node.isExpandable()){this.node.toggle()}},startDrop:function(){this.dropping=true},endDrop:function(){setTimeout(function(){this.dropping=false}.createDelegate(this),50)},expand:function(){this.updateExpandIcon();this.ctNode.style.display=""},focus:function(){if(!this.node.preventHScroll){try{this.anchor.focus()}catch(C){}}else{try{var B=this.node.getOwnerTree().getTreeEl().dom;var A=B.scrollLeft;this.anchor.focus();B.scrollLeft=A}catch(C){}}},toggleCheck:function(B){var A=this.checkbox;if(A){A.checked=(B===undefined?!A.checked:B);this.onCheckChange()}},blur:function(){try{this.anchor.blur()}catch(A){}},animExpand:function(B){var A=Ext.get(this.ctNode);A.stopFx();if(!this.node.isExpandable()){this.updateExpandIcon();this.ctNode.style.display="";Ext.callback(B);return }this.animating=true;this.updateExpandIcon();A.slideIn("t",{callback:function(){this.animating=false;Ext.callback(B)},scope:this,duration:this.node.ownerTree.duration||0.25})},highlight:function(){var A=this.node.getOwnerTree();Ext.fly(this.wrap).highlight(A.hlColor||"C3DAF9",{endColor:A.hlBaseColor})},collapse:function(){this.updateExpandIcon();this.ctNode.style.display="none"},animCollapse:function(B){var A=Ext.get(this.ctNode);A.enableDisplayMode("block");A.stopFx();this.animating=true;this.updateExpandIcon();A.slideOut("t",{callback:function(){this.animating=false;Ext.callback(B)},scope:this,duration:this.node.ownerTree.duration||0.25})},getContainer:function(){return this.ctNode},getEl:function(){return this.wrap},appendDDGhost:function(A){A.appendChild(this.elNode.cloneNode(true))},getDDRepairXY:function(){return Ext.lib.Dom.getXY(this.iconNode)},onRender:function(){this.render()},render:function(B){var D=this.node,A=D.attributes;var C=D.parentNode?D.parentNode.ui.getContainer():D.ownerTree.innerCt.dom;if(!this.rendered){this.rendered=true;this.renderElements(D,A,C,B);if(A.qtip){if(this.textNode.setAttributeNS){this.textNode.setAttributeNS("ext","qtip",A.qtip);if(A.qtipTitle){this.textNode.setAttributeNS("ext","qtitle",A.qtipTitle)}}else{this.textNode.setAttribute("ext:qtip",A.qtip);if(A.qtipTitle){this.textNode.setAttribute("ext:qtitle",A.qtipTitle)}}}else{if(A.qtipCfg){A.qtipCfg.target=Ext.id(this.textNode);Ext.QuickTips.register(A.qtipCfg)}}this.initEvents();if(!this.node.expanded){this.updateExpandIcon(true)}}else{if(B===true){C.appendChild(this.wrap)}}},renderElements:function(D,I,H,J){this.indentMarkup=D.parentNode?D.parentNode.ui.getChildIndent():"";var E=typeof I.checked=="boolean";var B=I.href?I.href:Ext.isGecko?"":"#";var C=['<li class="x-tree-node"><div ext:tree-node-id="',D.id,'" class="x-tree-node-el x-tree-node-leaf x-unselectable ',I.cls,'" unselectable="on">','<span class="x-tree-node-indent">',this.indentMarkup,"</span>",'<img src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />','<img src="',I.icon||this.emptyIcon,'" class="x-tree-node-icon',(I.icon?" x-tree-node-inline-icon":""),(I.iconCls?" "+I.iconCls:""),'" unselectable="on" />',E?('<input class="x-tree-node-cb" type="checkbox" '+(I.checked?'checked="checked" />':"/>")):"",'<a hidefocus="on" class="x-tree-node-anchor" href="',B,'" tabIndex="1" ',I.hrefTarget?' target="'+I.hrefTarget+'"':"",'><span unselectable="on">',D.text,"</span></a></div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join("");var A;if(J!==true&&D.nextSibling&&(A=D.nextSibling.ui.getEl())){this.wrap=Ext.DomHelper.insertHtml("beforeBegin",A,C)}else{this.wrap=Ext.DomHelper.insertHtml("beforeEnd",H,C)}this.elNode=this.wrap.childNodes[0];this.ctNode=this.wrap.childNodes[1];var G=this.elNode.childNodes;this.indentNode=G[0];this.ecNode=G[1];this.iconNode=G[2];var F=3;if(E){this.checkbox=G[3];this.checkbox.defaultChecked=this.checkbox.checked;F++}this.anchor=G[F];this.textNode=G[F].firstChild},getAnchor:function(){return this.anchor},getTextEl:function(){return this.textNode},getIconEl:function(){return this.iconNode},isChecked:function(){return this.checkbox?this.checkbox.checked:false},updateExpandIcon:function(){if(this.rendered){var F=this.node,D,C;var A=F.isLast()?"x-tree-elbow-end":"x-tree-elbow";var E=F.hasChildNodes();if(E||F.attributes.expandable){if(F.expanded){A+="-minus";D="x-tree-node-collapsed";C="x-tree-node-expanded"}else{A+="-plus";D="x-tree-node-expanded";C="x-tree-node-collapsed"}if(this.wasLeaf){this.removeClass("x-tree-node-leaf");this.wasLeaf=false}if(this.c1!=D||this.c2!=C){Ext.fly(this.elNode).replaceClass(D,C);this.c1=D;this.c2=C}}else{if(!this.wasLeaf){Ext.fly(this.elNode).replaceClass("x-tree-node-expanded","x-tree-node-leaf");delete this.c1;delete this.c2;this.wasLeaf=true}}var B="x-tree-ec-icon "+A;if(this.ecc!=B){this.ecNode.className=B;this.ecc=B}}},onIdChange:function(A){if(this.rendered){this.elNode.setAttribute("ext:tree-node-id",A)}},getChildIndent:function(){if(!this.childIndent){var A=[];var B=this.node;while(B){if(!B.isRoot||(B.isRoot&&B.ownerTree.rootVisible)){if(!B.isLast()){A.unshift('<img src="'+this.emptyIcon+'" class="x-tree-elbow-line" />')}else{A.unshift('<img src="'+this.emptyIcon+'" class="x-tree-icon" />')}}B=B.parentNode}this.childIndent=A.join("")}return this.childIndent},renderIndent:function(){if(this.rendered){var A="";var B=this.node.parentNode;if(B){A=B.ui.getChildIndent()}if(this.indentMarkup!=A){this.indentNode.innerHTML=A;this.indentMarkup=A}this.updateExpandIcon()}},destroy:function(){if(this.elNode){Ext.dd.Registry.unregister(this.elNode.id)}delete this.elNode;delete this.ctNode;delete this.indentNode;delete this.ecNode;delete this.iconNode;delete this.checkbox;delete this.anchor;delete this.textNode;if(this.holder){delete this.wrap;Ext.removeNode(this.holder);delete this.holder}else{Ext.removeNode(this.wrap);delete this.wrap}}};Ext.tree.RootTreeNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{render:function(){if(!this.rendered){var A=this.node.ownerTree.innerCt.dom;this.node.expanded=true;A.innerHTML='<div class="x-tree-root-node"></div>';this.wrap=this.ctNode=A.firstChild}},collapse:Ext.emptyFn,expand:Ext.emptyFn});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.tree.TreeLoader=function(A){this.baseParams={};Ext.apply(this,A);this.addEvents("beforeload","load","loadexception");Ext.tree.TreeLoader.superclass.constructor.call(this);if(typeof this.paramOrder=="string"){this.paramOrder=this.paramOrder.split(/[\s,|]/)}};Ext.extend(Ext.tree.TreeLoader,Ext.util.Observable,{uiProviders:{},clearOnLoad:true,paramOrder:undefined,paramsAsHash:false,directFn:undefined,load:function(B,C,A){if(this.clearOnLoad){while(B.firstChild){B.removeChild(B.firstChild)}}if(this.doPreload(B)){this.runCallback(C,A||B,[])}else{if(this.directFn||this.dataUrl||this.url){this.requestData(B,C,A||B)}}},doPreload:function(D){if(D.attributes.children){if(D.childNodes.length<1){var C=D.attributes.children;D.beginUpdate();for(var B=0,A=C.length;B<A;B++){var E=D.appendChild(this.createNode(C[B]));if(this.preloadChildren){this.doPreload(E)}}D.endUpdate()}return true}return false},getParams:function(F){var B=[],E=this.baseParams;if(this.directFn){B.push(F.id);if(E){if(this.paramOrder){for(var D=0,A=this.paramOrder.length;D<A;D++){B.push(E[this.paramOrder[D]])}}else{if(this.paramsAsHash){B.push(E)}}}return B}else{for(var C in E){if(!Ext.isFunction(E[C])){B.push(encodeURIComponent(C),"=",encodeURIComponent(E[C]),"&")}}B.push("node=",encodeURIComponent(F.id));return B.join("")}},requestData:function(C,D,B){if(this.fireEvent("beforeload",this,C,D)!==false){if(this.directFn){var A=this.getParams(C);A.push(this.processDirectResponse.createDelegate(this,[{callback:D,node:C,scope:B}],true));this.directFn.apply(window,A)}else{this.transId=Ext.Ajax.request({method:this.requestMethod,url:this.dataUrl||this.url,success:this.handleResponse,failure:this.handleFailure,scope:this,argument:{callback:D,node:C,scope:B},params:this.getParams(C)})}}else{this.runCallback(D,B||C,[])}},processDirectResponse:function(A,B,C){if(B.status){this.handleResponse({responseData:Ext.isArray(A)?A:null,responseText:A,argument:C})}else{this.handleFailure({argument:C})}},runCallback:function(A,C,B){if(Ext.isFunction(A)){A.apply(C,B)}},isLoading:function(){return !!this.transId},abort:function(){if(this.isLoading()){Ext.Ajax.abort(this.transId)}},createNode:function(attr){if(this.baseAttrs){Ext.applyIf(attr,this.baseAttrs)}if(this.applyLoader!==false){attr.loader=this}if(typeof attr.uiProvider=="string"){attr.uiProvider=this.uiProviders[attr.uiProvider]||eval(attr.uiProvider)}if(attr.nodeType){return new Ext.tree.TreePanel.nodeTypes[attr.nodeType](attr)}else{return attr.leaf?new Ext.tree.TreeNode(attr):new Ext.tree.AsyncTreeNode(attr)}},processResponse:function(D,C,H,I){var J=D.responseText;try{var A=D.responseData||Ext.decode(J);C.beginUpdate();for(var E=0,F=A.length;E<F;E++){var B=this.createNode(A[E]);if(B){C.appendChild(B)}}C.endUpdate();this.runCallback(H,I||C,[C])}catch(G){this.handleFailure(D)}},handleResponse:function(B){this.transId=false;var A=B.argument;this.processResponse(B,A.node,A.callback,A.scope);this.fireEvent("load",this,A.node,B)},handleFailure:function(B){this.transId=false;var A=B.argument;this.fireEvent("loadexception",this,A.node,B);this.runCallback(A.callback,A.scope||A.node,[A.node])}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.tree.TreeFilter=function(A,B){this.tree=A;this.filtered={};Ext.apply(this,B)};Ext.tree.TreeFilter.prototype={clearBlank:false,reverse:false,autoClear:false,remove:false,filter:function(D,A,B){A=A||"text";var C;if(typeof D=="string"){var E=D.length;if(E==0&&this.clearBlank){this.clear();return }D=D.toLowerCase();C=function(F){return F.attributes[A].substr(0,E).toLowerCase()==D}}else{if(D.exec){C=function(F){return D.test(F.attributes[A])}}else{throw"Illegal filter type, must be string or regex"}}this.filterBy(C,null,B)},filterBy:function(D,C,B){B=B||this.tree.root;if(this.autoClear){this.clear()}var A=this.filtered,H=this.reverse;var E=function(J){if(J==B){return true}if(A[J.id]){return false}var I=D.call(C||J,J);if(!I||H){A[J.id]=J;J.ui.hide();return false}return true};B.cascade(E);if(this.remove){for(var G in A){if(typeof G!="function"){var F=A[G];if(F&&F.parentNode){F.parentNode.removeChild(F)}}}}},clear:function(){var B=this.tree;var A=this.filtered;for(var D in A){if(typeof D!="function"){var C=A[D];if(C){C.ui.show()}}}this.filtered={}}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.tree.TreeSorter=function(B,C){Ext.apply(this,C);B.on("beforechildrenrendered",this.doSort,this);B.on("append",this.updateSort,this);B.on("insert",this.updateSort,this);B.on("textchange",this.updateSortParent,this);var E=this.dir&&this.dir.toLowerCase()=="desc";var F=this.property||"text";var G=this.sortType;var A=this.folderSort;var D=this.caseSensitive===true;var H=this.leafAttr||"leaf";this.sortFn=function(J,I){if(A){if(J.attributes[H]&&!I.attributes[H]){return 1}if(!J.attributes[H]&&I.attributes[H]){return -1}}var L=G?G(J):(D?J.attributes[F]:J.attributes[F].toUpperCase());var K=G?G(I):(D?I.attributes[F]:I.attributes[F].toUpperCase());if(L<K){return E?+1:-1}else{if(L>K){return E?-1:+1}else{return 0}}}};Ext.tree.TreeSorter.prototype={doSort:function(A){A.sort(this.sortFn)},compareNodes:function(B,A){return(B.text.toUpperCase()>A.text.toUpperCase()?1:-1)},updateSort:function(A,B){if(B.childrenRendered){this.doSort.defer(1,this,[B])}},updateSortParent:function(A){var B=A.parentNode;if(B&&B.childrenRendered){this.doSort.defer(1,this,[B])}}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
if(Ext.dd.DropZone){Ext.tree.TreeDropZone=function(A,B){this.allowParentInsert=B.allowParentInsert||false;this.allowContainerDrop=B.allowContainerDrop||false;this.appendOnly=B.appendOnly||false;Ext.tree.TreeDropZone.superclass.constructor.call(this,A.getTreeEl(),B);this.tree=A;this.dragOverData={};this.lastInsertClass="x-tree-no-status"};Ext.extend(Ext.tree.TreeDropZone,Ext.dd.DropZone,{ddGroup:"TreeDD",expandDelay:1000,expandNode:function(A){if(A.hasChildNodes()&&!A.isExpanded()){A.expand(false,null,this.triggerCacheRefresh.createDelegate(this))}},queueExpand:function(A){this.expandProcId=this.expandNode.defer(this.expandDelay,this,[A])},cancelExpand:function(){if(this.expandProcId){clearTimeout(this.expandProcId);this.expandProcId=false}},isValidDropPoint:function(A,I,G,D,C){if(!A||!C){return false}var E=A.node;var F=C.node;if(!(E&&E.isTarget&&I)){return false}if(I=="append"&&E.allowChildren===false){return false}if((I=="above"||I=="below")&&(E.parentNode&&E.parentNode.allowChildren===false)){return false}if(F&&(E==F||F.contains(E))){return false}var B=this.dragOverData;B.tree=this.tree;B.target=E;B.data=C;B.point=I;B.source=G;B.rawEvent=D;B.dropNode=F;B.cancel=false;var H=this.tree.fireEvent("nodedragover",B);return B.cancel===false&&H!==false},getDropPoint:function(E,D,I){var J=D.node;if(J.isRoot){return J.allowChildren!==false?"append":false}var B=D.ddel;var K=Ext.lib.Dom.getY(B),G=K+B.offsetHeight;var F=Ext.lib.Event.getPageY(E);var H=J.allowChildren===false||J.isLeaf();if(this.appendOnly||J.parentNode.allowChildren===false){return H?false:"append"}var C=false;if(!this.allowParentInsert){C=J.hasChildNodes()&&J.isExpanded()}var A=(G-K)/(H?2:3);if(F>=K&&F<(K+A)){return"above"}else{if(!C&&(H||F>=G-A&&F<=G)){return"below"}else{return"append"}}},onNodeEnter:function(D,A,C,B){this.cancelExpand()},onContainerOver:function(A,C,B){if(this.allowContainerDrop&&this.isValidDropPoint({ddel:this.tree.getRootNode().ui.elNode,node:this.tree.getRootNode()},"append",A,C,B)){return this.dropAllowed}return this.dropNotAllowed},onNodeOver:function(B,G,F,E){var I=this.getDropPoint(F,B,G);var C=B.node;if(!this.expandProcId&&I=="append"&&C.hasChildNodes()&&!B.node.isExpanded()){this.queueExpand(C)}else{if(I!="append"){this.cancelExpand()}}var D=this.dropNotAllowed;if(this.isValidDropPoint(B,I,G,F,E)){if(I){var A=B.ddel;var H;if(I=="above"){D=B.node.isFirst()?"x-tree-drop-ok-above":"x-tree-drop-ok-between";H="x-tree-drag-insert-above"}else{if(I=="below"){D=B.node.isLast()?"x-tree-drop-ok-below":"x-tree-drop-ok-between";H="x-tree-drag-insert-below"}else{D="x-tree-drop-ok-append";H="x-tree-drag-append"}}if(this.lastInsertClass!=H){Ext.fly(A).replaceClass(this.lastInsertClass,H);this.lastInsertClass=H}}}return D},onNodeOut:function(D,A,C,B){this.cancelExpand();this.removeDropIndicators(D)},onNodeDrop:function(G,B,F,D){var A=this.getDropPoint(F,G,B);var E=G.node;E.ui.startDrop();if(!this.isValidDropPoint(G,A,B,F,D)){E.ui.endDrop();return false}var C=D.node||(B.getTreeNode?B.getTreeNode(D,E,A,F):null);return this.processDrop(E,D,A,B,F,C)},onContainerDrop:function(A,E,C){if(this.allowContainerDrop&&this.isValidDropPoint({ddel:this.tree.getRootNode().ui.elNode,node:this.tree.getRootNode()},"append",A,E,C)){var D=this.tree.getRootNode();D.ui.startDrop();var B=C.node||(A.getTreeNode?A.getTreeNode(C,D,"append",E):null);return this.processDrop(D,C,"append",A,E,B)}return false},processDrop:function(H,F,B,A,G,D){var E={tree:this.tree,target:H,data:F,point:B,source:A,rawEvent:G,dropNode:D,cancel:!D,dropStatus:false};var C=this.tree.fireEvent("beforenodedrop",E);if(C===false||E.cancel===true||!E.dropNode){H.ui.endDrop();return E.dropStatus}H=E.target;if(B=="append"&&!H.isExpanded()){H.expand(false,null,function(){this.completeDrop(E)}.createDelegate(this))}else{this.completeDrop(E)}return true},completeDrop:function(G){var D=G.dropNode,E=G.point,C=G.target;if(!Ext.isArray(D)){D=[D]}var F;for(var B=0,A=D.length;B<A;B++){F=D[B];if(E=="above"){C.parentNode.insertBefore(F,C)}else{if(E=="below"){C.parentNode.insertBefore(F,C.nextSibling)}else{C.appendChild(F)}}}F.ui.focus();if(Ext.enableFx&&this.tree.hlDrop){F.ui.highlight()}C.ui.endDrop();this.tree.fireEvent("nodedrop",G)},afterNodeMoved:function(A,C,E,D,B){if(Ext.enableFx&&this.tree.hlDrop){B.ui.focus();B.ui.highlight()}this.tree.fireEvent("nodedrop",this.tree,D,C,A,E)},getTree:function(){return this.tree},removeDropIndicators:function(B){if(B&&B.ddel){var A=B.ddel;Ext.fly(A).removeClass(["x-tree-drag-insert-above","x-tree-drag-insert-below","x-tree-drag-append"]);this.lastInsertClass="_noclass"}},beforeDragDrop:function(B,A,C){this.cancelExpand();return true},afterRepair:function(A){if(A&&Ext.enableFx){A.node.ui.highlight()}this.hideProxy()}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
}if(Ext.dd.DragZone){Ext.tree.TreeDragZone=function(A,B){Ext.tree.TreeDragZone.superclass.constructor.call(this,A.innerCt,B);this.tree=A};Ext.extend(Ext.tree.TreeDragZone,Ext.dd.DragZone,{ddGroup:"TreeDD",onBeforeDrag:function(A,B){var C=A.node;return C&&C.draggable&&!C.disabled},onInitDrag:function(B){var A=this.dragData;this.tree.getSelectionModel().select(A.node);this.tree.eventModel.disable();this.proxy.update("");A.node.ui.appendDDGhost(this.proxy.ghost.dom);this.tree.fireEvent("startdrag",this.tree,A.node,B)},getRepairXY:function(B,A){return A.node.ui.getDDRepairXY()},onEndDrag:function(A,B){this.tree.eventModel.enable.defer(100,this.tree.eventModel);this.tree.fireEvent("enddrag",this.tree,A.node,B)},onValidDrop:function(A,B,C){this.tree.fireEvent("dragdrop",this.tree,this.dragData.node,A,B);this.hideProxy()},beforeInvalidDrop:function(A,C){var B=this.tree.getSelectionModel();B.clearSelections();B.select(this.dragData.node)},afterRepair:function(){if(Ext.enableFx&&this.tree.hlDrop){Ext.Element.fly(this.dragData.ddel).highlight(this.hlColor||"c3daf9")}this.dragging=false}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
}Ext.tree.TreeEditor=function(A,C,B){C=C||{};var D=C.events?C:new Ext.form.TextField(C);Ext.tree.TreeEditor.superclass.constructor.call(this,D,B);this.tree=A;if(!A.rendered){A.on("render",this.initEditor,this)}else{this.initEditor(A)}};Ext.extend(Ext.tree.TreeEditor,Ext.Editor,{alignment:"l-l",autoSize:false,hideEl:false,cls:"x-small-editor x-tree-editor",shim:false,shadow:"frame",maxWidth:250,editDelay:350,initEditor:function(A){A.on("beforeclick",this.beforeNodeClick,this);A.on("dblclick",this.onNodeDblClick,this);this.on("complete",this.updateNode,this);this.on("beforestartedit",this.fitToTree,this);this.on("startedit",this.bindScroll,this,{delay:10});this.on("specialkey",this.onSpecialKey,this)},fitToTree:function(B,C){var E=this.tree.getTreeEl().dom,D=C.dom;if(E.scrollLeft>D.offsetLeft){E.scrollLeft=D.offsetLeft}var A=Math.min(this.maxWidth,(E.clientWidth>20?E.clientWidth:E.offsetWidth)-Math.max(0,D.offsetLeft-E.scrollLeft)-5);this.setSize(A,"")},triggerEdit:function(A,C){this.completeEdit();if(A.attributes.editable!==false){this.editNode=A;if(this.tree.autoScroll){Ext.fly(A.ui.getEl()).scrollIntoView(this.tree.body)}var B=A.text||"";if(!Ext.isGecko&&Ext.isEmpty(A.text)){A.setText("&#160;")}this.autoEditTimer=this.startEdit.defer(this.editDelay,this,[A.ui.textNode,B]);return false}},bindScroll:function(){this.tree.getTreeEl().on("scroll",this.cancelEdit,this)},beforeNodeClick:function(A,B){clearTimeout(this.autoEditTimer);if(this.tree.getSelectionModel().isSelected(A)){B.stopEvent();return this.triggerEdit(A)}},onNodeDblClick:function(A,B){clearTimeout(this.autoEditTimer)},updateNode:function(A,B){this.tree.getTreeEl().un("scroll",this.cancelEdit,this);this.editNode.setText(B)},onHide:function(){Ext.tree.TreeEditor.superclass.onHide.call(this);if(this.editNode){this.editNode.ui.focus.defer(50,this.editNode.ui)}},onSpecialKey:function(C,B){var A=B.getKey();if(A==B.ESC){B.stopEvent();this.cancelEdit()}else{if(A==B.ENTER&&!B.hasModifier()){B.stopEvent();this.completeEdit()}}}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.layout.MenuLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,setContainer:function(A){this.monitorResize=!A.floating;Ext.layout.MenuLayout.superclass.setContainer.call(this,A)},renderItem:function(D,A,C){if(!this.itemTpl){this.itemTpl=Ext.layout.MenuLayout.prototype.itemTpl=new Ext.XTemplate('<li id="{itemId}" class="{itemCls}">','<tpl if="needsIcon">','<img src="{icon}" class="{iconCls}"/>',"</tpl>","</li>")}if(D&&!D.rendered){if(Ext.isNumber(A)){A=C.dom.childNodes[A]}var B=this.getItemArgs(D);D.render(D.positionEl=A?this.itemTpl.insertBefore(A,B,true):this.itemTpl.append(C,B,true));D.positionEl.menuItemId=D.itemId||D.id;if(!B.isMenuItem&&B.needsIcon){D.positionEl.addClass("x-menu-list-item-indent")}}else{if(D&&!this.isValidParent(D,C)){if(Ext.isNumber(A)){A=C.dom.childNodes[A]}C.dom.insertBefore(D.getActionEl().dom,A||null)}}},getItemArgs:function(B){var A=B instanceof Ext.menu.Item;return{isMenuItem:A,needsIcon:!A&&(B.icon||B.iconCls),icon:B.icon||Ext.BLANK_IMAGE_URL,iconCls:"x-menu-item-icon "+(B.iconCls||""),itemId:"x-menu-el-"+B.id,itemCls:"x-menu-list-item "+(this.extraCls||"")}},isValidParent:function(B,A){return B.el.up("li.x-menu-list-item",5).dom.parentNode===(A.dom||A)},onLayout:function(A,B){this.renderAll(A,B);this.doAutoSize()},doAutoSize:function(){var C=this.container,A=C.width;if(C.floating){if(A){C.setWidth(A)}else{if(Ext.isIE){C.setWidth(Ext.isStrict&&(Ext.isIE7||Ext.isIE8)?"auto":C.minWidth);var D=C.getEl(),B=D.dom.offsetWidth;C.setWidth(C.getLayoutTarget().getWidth()+D.getFrameWidth("lr"))}}}}});Ext.Container.LAYOUTS.menu=Ext.layout.MenuLayout;Ext.menu.Menu=Ext.extend(Ext.Container,{minWidth:120,shadow:"sides",subMenuAlign:"tl-tr?",defaultAlign:"tl-bl?",allowOtherMenus:false,ignoreParentClicks:false,enableScrolling:true,maxHeight:null,scrollIncrement:24,showSeparator:true,defaultOffsets:[0,0],floating:true,hidden:true,layout:"menu",hideMode:"offsets",scrollerHeight:8,autoLayout:true,defaultType:"menuitem",initComponent:function(){if(Ext.isArray(this.initialConfig)){Ext.apply(this,{items:this.initialConfig})}this.addEvents("click","mouseover","mouseout","itemclick");Ext.menu.MenuMgr.register(this);if(this.floating){Ext.EventManager.onWindowResize(this.hide,this)}else{if(this.initialConfig.hidden!==false){this.hidden=false}this.internalDefaults={hideOnClick:false}}Ext.menu.Menu.superclass.initComponent.call(this);if(this.autoLayout){this.on({add:this.doLayout,remove:this.doLayout,scope:this})}},getLayoutTarget:function(){return this.ul},onRender:function(B,A){if(!B){B=Ext.getBody()}var C={id:this.getId(),cls:"x-menu "+((this.floating)?"x-menu-floating x-layer ":"")+(this.cls||"")+(this.plain?" x-menu-plain":"")+(this.showSeparator?"":" x-menu-nosep"),style:this.style,cn:[{tag:"a",cls:"x-menu-focus",href:"#",onclick:"return false;",tabIndex:"-1"},{tag:"ul",cls:"x-menu-list"}]};if(this.floating){this.el=new Ext.Layer({shadow:this.shadow,dh:C,constrain:false,parentEl:B,zindex:15000})}else{this.el=B.createChild(C)}Ext.menu.Menu.superclass.onRender.call(this,B,A);if(!this.keyNav){this.keyNav=new Ext.menu.MenuNav(this)}this.focusEl=this.el.child("a.x-menu-focus");this.ul=this.el.child("ul.x-menu-list");this.mon(this.ul,{scope:this,click:this.onClick,mouseover:this.onMouseOver,mouseout:this.onMouseOut});if(this.enableScrolling){this.mon(this.el,{scope:this,delegate:".x-menu-scroller",click:this.onScroll,mouseover:this.deactivateActive})}},findTargetItem:function(B){var A=B.getTarget(".x-menu-list-item",this.ul,true);if(A&&A.menuItemId){return this.items.get(A.menuItemId)}},onClick:function(B){var A=this.findTargetItem(B);if(A){if(A.isFormField){this.setActiveItem(A)}else{if(A.menu&&this.ignoreParentClicks){A.expandMenu();B.preventDefault()}else{if(A.onClick){A.onClick(B);this.fireEvent("click",this,A,B)}}}}},setActiveItem:function(A,B){if(A!=this.activeItem){this.deactivateActive();if((this.activeItem=A).isFormField){A.focus()}else{A.activate(B)}}else{if(B){A.expandMenu()}}},deactivateActive:function(){var A=this.activeItem;if(A){if(A.isFormField){if(A.collapse){A.collapse()}}else{A.deactivate()}delete this.activeItem}},tryActivate:function(F,E){var B=this.items;for(var C=F,A=B.length;C>=0&&C<A;C+=E){var D=B.get(C);if(!D.disabled&&(D.canActivate||D.isFormField)){this.setActiveItem(D,false);return D}}return false},onMouseOver:function(B){var A=this.findTargetItem(B);if(A){if(A.canActivate&&!A.disabled){this.setActiveItem(A,true)}}this.over=true;this.fireEvent("mouseover",this,B,A)},onMouseOut:function(B){var A=this.findTargetItem(B);if(A){if(A==this.activeItem&&A.shouldDeactivate&&A.shouldDeactivate(B)){this.activeItem.deactivate();delete this.activeItem}}this.over=false;this.fireEvent("mouseout",this,B,A)},onScroll:function(D,B){if(D){D.stopEvent()}var A=this.ul.dom,C=Ext.fly(B).is(".x-menu-scroller-top");A.scrollTop+=this.scrollIncrement*(C?-1:1);if(C?A.scrollTop<=0:A.scrollTop+this.activeMax>=A.scrollHeight){this.onScrollerOut(null,B)}},onScrollerIn:function(D,B){var A=this.ul.dom,C=Ext.fly(B).is(".x-menu-scroller-top");if(C?A.scrollTop>0:A.scrollTop+this.activeMax<A.scrollHeight){Ext.fly(B).addClass(["x-menu-item-active","x-menu-scroller-active"])}},onScrollerOut:function(B,A){Ext.fly(A).removeClass(["x-menu-item-active","x-menu-scroller-active"])},show:function(B,C,A){if(this.floating){this.parentMenu=A;if(!this.el){this.render();this.doLayout(false,true)}if(this.fireEvent("beforeshow",this)!==false){this.showAt(this.el.getAlignToXY(B,C||this.defaultAlign,this.defaultOffsets),A,false)}}else{Ext.menu.Menu.superclass.show.call(this)}},showAt:function(C,B,A){this.parentMenu=B;if(!this.el){this.render()}this.el.setXY(C);if(this.enableScrolling){this.constrainScroll(C[1])}this.el.show();Ext.menu.Menu.superclass.onShow.call(this);if(Ext.isIE){this.layout.doAutoSize();if(!Ext.isIE8){this.el.repaint()}}this.hidden=false;this.focus();this.fireEvent("show",this)},constrainScroll:function(C){var A,B=this.ul.setHeight("auto").getHeight();if(this.floating){A=this.maxHeight?this.maxHeight:Ext.fly(this.el.dom.parentNode).getViewSize().height-C}else{A=this.getHeight()}if(B>A&&A>0){this.activeMax=A-this.scrollerHeight*2-this.el.getFrameWidth("tb")-Ext.num(this.el.shadowOffset,0);this.ul.setHeight(this.activeMax);this.createScrollers();this.el.select(".x-menu-scroller").setDisplayed("")}else{this.ul.setHeight(B);this.el.select(".x-menu-scroller").setDisplayed("none")}this.ul.dom.scrollTop=0},createScrollers:function(){if(!this.scroller){this.scroller={pos:0,top:this.el.insertFirst({tag:"div",cls:"x-menu-scroller x-menu-scroller-top",html:"&#160;"}),bottom:this.el.createChild({tag:"div",cls:"x-menu-scroller x-menu-scroller-bottom",html:"&#160;"})};this.scroller.top.hover(this.onScrollerIn,this.onScrollerOut,this);this.scroller.topRepeater=new Ext.util.ClickRepeater(this.scroller.top,{listeners:{click:this.onScroll.createDelegate(this,[null,this.scroller.top],false)}});this.scroller.bottom.hover(this.onScrollerIn,this.onScrollerOut,this);this.scroller.bottomRepeater=new Ext.util.ClickRepeater(this.scroller.bottom,{listeners:{click:this.onScroll.createDelegate(this,[null,this.scroller.bottom],false)}})}},onLayout:function(){if(this.isVisible()){if(this.enableScrolling){this.constrainScroll(this.el.getTop())}if(this.floating){this.el.sync()}}},focus:function(){if(!this.hidden){this.doFocus.defer(50,this)}},doFocus:function(){if(!this.hidden){this.focusEl.focus()}},hide:function(A){this.deepHide=A;Ext.menu.Menu.superclass.hide.call(this);delete this.deepHide},onHide:function(){Ext.menu.Menu.superclass.onHide.call(this);this.deactivateActive();if(this.el&&this.floating){this.el.hide()}if(this.deepHide===true&&this.parentMenu){this.parentMenu.hide(true)}},lookupComponent:function(A){if(Ext.isString(A)){A=(A=="separator"||A=="-")?new Ext.menu.Separator():new Ext.menu.TextItem(A);this.applyDefaults(A)}else{if(Ext.isObject(A)){A=this.getMenuItem(A)}else{if(A.tagName||A.el){A=new Ext.BoxComponent({el:A})}}}return A},applyDefaults:function(B){if(!Ext.isString(B)){B=Ext.menu.Menu.superclass.applyDefaults.call(this,B);var A=this.internalDefaults;if(A){if(B.events){Ext.applyIf(B.initialConfig,A);Ext.apply(B,A)}else{Ext.applyIf(B,A)}}}return B},getMenuItem:function(A){if(!A.isXType){if(!A.xtype&&Ext.isBoolean(A.checked)){return new Ext.menu.CheckItem(A)}return Ext.create(A,this.defaultType)}return A},addSeparator:function(){return this.add(new Ext.menu.Separator())},addElement:function(A){return this.add(new Ext.menu.BaseItem(A))},addItem:function(A){return this.add(A)},addMenuItem:function(A){return this.add(this.getMenuItem(A))},addText:function(A){return this.add(new Ext.menu.TextItem(A))},onDestroy:function(){Ext.menu.Menu.superclass.onDestroy.call(this);Ext.menu.MenuMgr.unregister(this);Ext.EventManager.removeResizeListener(this.hide,this);if(this.keyNav){this.keyNav.disable()}var A=this.scroller;if(A){Ext.destroy(A.topRepeater,A.bottomRepeater,A.top,A.bottom)}}});Ext.reg("menu",Ext.menu.Menu);Ext.menu.MenuNav=Ext.extend(Ext.KeyNav,function(){function A(D,C){if(!C.tryActivate(C.items.indexOf(C.activeItem)-1,-1)){C.tryActivate(C.items.length-1,-1)}}function B(D,C){if(!C.tryActivate(C.items.indexOf(C.activeItem)+1,1)){C.tryActivate(0,1)}}return{constructor:function(C){Ext.menu.MenuNav.superclass.constructor.call(this,C.el);this.scope=this.menu=C},doRelay:function(E,D){var C=E.getKey();if(this.menu.activeItem&&this.menu.activeItem.isFormField&&C!=E.TAB){return false}if(!this.menu.activeItem&&E.isNavKeyPress()&&C!=E.SPACE&&C!=E.RETURN){this.menu.tryActivate(0,1);return false}return D.call(this.scope||this,E,this.menu)},tab:function(D,C){D.stopEvent();if(D.shiftKey){A(D,C)}else{B(D,C)}},up:A,down:B,right:function(D,C){if(C.activeItem){C.activeItem.expandMenu(true)}},left:function(D,C){C.hide();if(C.parentMenu&&C.parentMenu.activeItem){C.parentMenu.activeItem.activate()}},enter:function(D,C){if(C.activeItem){D.stopPropagation();C.activeItem.onClick(D);C.fireEvent("click",this,C.activeItem);return true}}}}());
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.menu.MenuMgr=function(){var F,D,C={},A=false,K=new Date();function M(){F={};D=new Ext.util.MixedCollection();Ext.getDoc().addKeyListener(27,function(){if(D.length>0){H()}})}function H(){if(D&&D.length>0){var N=D.clone();N.each(function(O){O.hide()})}}function E(N){D.remove(N);if(D.length<1){Ext.getDoc().un("mousedown",L);A=false}}function J(N){var O=D.last();K=new Date();D.add(N);if(!A){Ext.getDoc().on("mousedown",L);A=true}if(N.parentMenu){N.getEl().setZIndex(parseInt(N.parentMenu.getEl().getStyle("z-index"),10)+3);N.parentMenu.activeChild=N}else{if(O&&O.isVisible()){N.getEl().setZIndex(parseInt(O.getEl().getStyle("z-index"),10)+3)}}}function B(N){if(N.activeChild){N.activeChild.hide()}if(N.autoHideTimer){clearTimeout(N.autoHideTimer);delete N.autoHideTimer}}function G(N){var O=N.parentMenu;if(!O&&!N.allowOtherMenus){H()}else{if(O&&O.activeChild){O.activeChild.hide()}}}function L(N){if(K.getElapsed()>50&&D.length>0&&(!N.getTarget(".x-menu")&&!N.getTarget(".x-menu-arteryPopup"))){H()}}function I(O,R){if(R){var Q=C[O.group];for(var P=0,N=Q.length;P<N;P++){if(Q[P]!=O){Q[P].setChecked(false)}}}}return{hideAll:function(){H()},register:function(O){if(!F){M()}F[O.id]=O;O.on("beforehide",B);O.on("hide",E);O.on("beforeshow",G);O.on("show",J);var N=O.group;if(N&&O.events.checkchange){if(!C[N]){C[N]=[]}C[N].push(O);O.on("checkchange",onCheck)}},get:function(N){if(typeof N=="string"){if(!F){return null}return F[N]}else{if(N.events){return N}else{if(typeof N.length=="number"){return new Ext.menu.Menu({items:N})}else{return Ext.create(N,"menu")}}}},unregister:function(O){delete F[O.id];O.un("beforehide",B);O.un("hide",E);O.un("beforeshow",G);O.un("show",J);var N=O.group;if(N&&O.events.checkchange){C[N].remove(O);O.un("checkchange",onCheck)}},registerCheckable:function(N){var O=N.group;if(O){if(!C[O]){C[O]=[]}C[O].push(N);N.on("beforecheckchange",I)}},unregisterCheckable:function(N){var O=N.group;if(O){C[O].remove(N);N.un("beforecheckchange",I)}},getCheckedItem:function(P){var Q=C[P];if(Q){for(var O=0,N=Q.length;O<N;O++){if(Q[O].checked){return Q[O]}}}return null},setCheckedItem:function(P,R){var Q=C[P];if(Q){for(var O=0,N=Q.length;O<N;O++){if(Q[O].id==R){Q[O].setChecked(true)}}}return null}}}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.menu.BaseItem=function(A){Ext.menu.BaseItem.superclass.constructor.call(this,A);this.addEvents("click","activate","deactivate");if(this.handler){this.on("click",this.handler,this.scope)}};Ext.extend(Ext.menu.BaseItem,Ext.Component,{canActivate:false,activeClass:"x-menu-item-active",hideOnClick:true,clickHideDelay:1,ctype:"Ext.menu.BaseItem",actionMode:"container",onRender:function(B,A){Ext.menu.BaseItem.superclass.onRender.apply(this,arguments);if(this.ownerCt&&this.ownerCt instanceof Ext.menu.Menu){this.parentMenu=this.ownerCt}else{this.container.addClass("x-menu-list-item");this.mon(this.el,"click",this.onClick,this);this.mon(this.el,"mouseenter",this.activate,this);this.mon(this.el,"mouseleave",this.deactivate,this)}},setHandler:function(B,A){if(this.handler){this.un("click",this.handler,this.scope)}this.on("click",this.handler=B,this.scope=A)},onClick:function(A){if(!this.disabled&&this.fireEvent("click",this,A)!==false&&(this.parentMenu&&this.parentMenu.fireEvent("itemclick",this,A)!==false)){this.handleClick(A)}else{A.stopEvent()}},activate:function(){if(this.disabled){return false}var A=this.container;A.addClass(this.activeClass);this.region=A.getRegion().adjust(2,2,-2,-2);this.fireEvent("activate",this);return true},deactivate:function(){this.container.removeClass(this.activeClass);this.fireEvent("deactivate",this)},shouldDeactivate:function(A){return !this.region||!this.region.contains(A.getPoint())},handleClick:function(A){if(this.hideOnClick){this.parentMenu.hide.defer(this.clickHideDelay,this.parentMenu,[true])}},expandMenu:Ext.emptyFn,hideMenu:Ext.emptyFn});Ext.reg("menubaseitem",Ext.menu.BaseItem);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.menu.TextItem=function(A){if(typeof A=="string"){A={text:A}}Ext.menu.TextItem.superclass.constructor.call(this,A)};Ext.extend(Ext.menu.TextItem,Ext.menu.BaseItem,{hideOnClick:false,itemCls:"x-menu-text",onRender:function(){var A=document.createElement("span");A.className=this.itemCls;A.innerHTML=this.text;this.el=A;Ext.menu.TextItem.superclass.onRender.apply(this,arguments)}});Ext.reg("menutextitem",Ext.menu.TextItem);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.menu.Separator=function(A){Ext.menu.Separator.superclass.constructor.call(this,A)};Ext.extend(Ext.menu.Separator,Ext.menu.BaseItem,{itemCls:"x-menu-sep",hideOnClick:false,activeClass:"",onRender:function(A){var B=document.createElement("span");B.className=this.itemCls;B.innerHTML="&#160;";this.el=B;A.addClass("x-menu-sep-li");Ext.menu.Separator.superclass.onRender.apply(this,arguments)}});Ext.reg("menuseparator",Ext.menu.Separator);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.menu.Item=function(A){Ext.menu.Item.superclass.constructor.call(this,A);if(this.menu){this.menu=Ext.menu.MenuMgr.get(this.menu)}};Ext.extend(Ext.menu.Item,Ext.menu.BaseItem,{itemCls:"x-menu-item",canActivate:true,showDelay:200,hideDelay:200,ctype:"Ext.menu.Item",onRender:function(C,A){if(!this.itemTpl){this.itemTpl=Ext.menu.Item.prototype.itemTpl=new Ext.XTemplate('<a id="{id}" class="{cls}" hidefocus="true" unselectable="on" href="{href}"','<tpl if="hrefTarget">',' target="{hrefTarget}"',"</tpl>",">",'<img src="{icon}" class="x-menu-item-icon {iconCls}"/>','<span class="x-menu-item-text">{text}</span>',"</a>")}var B=this.getTemplateArgs();this.el=A?this.itemTpl.insertBefore(A,B,true):this.itemTpl.append(C,B,true);this.iconEl=this.el.child("img.x-menu-item-icon");this.textEl=this.el.child(".x-menu-item-text");Ext.menu.Item.superclass.onRender.call(this,C,A)},getTemplateArgs:function(){return{id:this.id,cls:this.itemCls+(this.menu?" x-menu-item-arrow":"")+(this.cls?" "+this.cls:""),href:this.href||"#",hrefTarget:this.hrefTarget,icon:this.icon||Ext.BLANK_IMAGE_URL,iconCls:this.iconCls||"",text:this.itemText||this.text||"&#160;"}},setText:function(A){this.text=A||"&#160;";if(this.rendered){this.textEl.update(this.text);this.parentMenu.layout.doAutoSize()}},setIconClass:function(A){var B=this.iconCls;this.iconCls=A;if(this.rendered){this.iconEl.replaceClass(B,this.iconCls)}},beforeDestroy:function(){if(this.menu){this.menu.destroy()}Ext.menu.Item.superclass.beforeDestroy.call(this)},handleClick:function(A){if(!this.href){A.stopEvent()}Ext.menu.Item.superclass.handleClick.apply(this,arguments)},activate:function(A){if(Ext.menu.Item.superclass.activate.apply(this,arguments)){this.focus();if(A){this.expandMenu()}}return true},shouldDeactivate:function(A){if(Ext.menu.Item.superclass.shouldDeactivate.call(this,A)){if(this.menu&&this.menu.isVisible()){return !this.menu.getEl().getRegion().contains(A.getPoint())}return true}return false},deactivate:function(){Ext.menu.Item.superclass.deactivate.apply(this,arguments);this.hideMenu()},expandMenu:function(A){if(!this.disabled&&this.menu){clearTimeout(this.hideTimer);delete this.hideTimer;if(!this.menu.isVisible()&&!this.showTimer){this.showTimer=this.deferExpand.defer(this.showDelay,this,[A])}else{if(this.menu.isVisible()&&A){this.menu.tryActivate(0,1)}}}},deferExpand:function(A){delete this.showTimer;this.menu.show(this.container,this.parentMenu.subMenuAlign||"tl-tr?",this.parentMenu);if(A){this.menu.tryActivate(0,1)}},hideMenu:function(){clearTimeout(this.showTimer);delete this.showTimer;if(!this.hideTimer&&this.menu&&this.menu.isVisible()){this.hideTimer=this.deferHide.defer(this.hideDelay,this)}},deferHide:function(){delete this.hideTimer;if(this.menu.over){this.parentMenu.setActiveItem(this,false)}else{this.menu.hide()}}});Ext.reg("menuitem",Ext.menu.Item);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.menu.CheckItem=function(A){Ext.menu.CheckItem.superclass.constructor.call(this,A);this.addEvents("beforecheckchange","checkchange");if(this.checkHandler){this.on("checkchange",this.checkHandler,this.scope)}Ext.menu.MenuMgr.registerCheckable(this)};Ext.extend(Ext.menu.CheckItem,Ext.menu.Item,{itemCls:"x-menu-item x-menu-check-item",groupClass:"x-menu-group-item",checked:false,ctype:"Ext.menu.CheckItem",onRender:function(A){Ext.menu.CheckItem.superclass.onRender.apply(this,arguments);if(this.group){this.el.addClass(this.groupClass)}if(this.checked){this.checked=false;this.setChecked(true,true)}},destroy:function(){Ext.menu.MenuMgr.unregisterCheckable(this);Ext.menu.CheckItem.superclass.destroy.apply(this,arguments)},setChecked:function(B,A){if(this.checked!=B&&this.fireEvent("beforecheckchange",this,B)!==false){if(this.container){this.container[B?"addClass":"removeClass"]("x-menu-item-checked")}this.checked=B;if(A!==true){this.fireEvent("checkchange",this,B)}}},handleClick:function(A){if(!this.disabled&&!(this.checked&&this.group)){this.setChecked(!this.checked)}Ext.menu.CheckItem.superclass.handleClick.apply(this,arguments)}});Ext.reg("menucheckitem",Ext.menu.CheckItem);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.menu.DateMenu=Ext.extend(Ext.menu.Menu,{enableScrolling:false,hideOnClick:true,cls:"x-date-menu",initComponent:function(){this.on("beforeshow",this.onBeforeShow,this);if(this.strict=(Ext.isIE7&&Ext.isStrict)){this.on("show",this.onShow,this,{single:true,delay:20})}Ext.apply(this,{plain:true,showSeparator:false,items:this.picker=new Ext.DatePicker(Ext.apply({internalRender:this.strict||!Ext.isIE,ctCls:"x-menu-date-item"},this.initialConfig))});this.picker.purgeListeners();Ext.menu.DateMenu.superclass.initComponent.call(this);this.relayEvents(this.picker,["select"]);this.on("select",this.menuHide,this);if(this.handler){this.on("select",this.handler,this.scope||this)}},menuHide:function(){if(this.hideOnClick){this.hide(true)}},onBeforeShow:function(){if(this.picker){this.picker.hideMonthPicker(true)}},onShow:function(){var A=this.picker.getEl();A.setWidth(A.getWidth())}});Ext.reg("datemenu",Ext.menu.DateMenu);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.menu.ColorMenu=Ext.extend(Ext.menu.Menu,{enableScrolling:false,hideOnClick:true,initComponent:function(){Ext.apply(this,{plain:true,showSeparator:false,items:this.palette=new Ext.ColorPalette(this.initialConfig)});this.palette.purgeListeners();Ext.menu.ColorMenu.superclass.initComponent.call(this);this.relayEvents(this.palette,["select"]);this.on("select",this.menuHide,this);if(this.handler){this.on("select",this.handler,this.scope||this)}},menuHide:function(){if(this.hideOnClick){this.hide(true)}}});Ext.reg("colormenu",Ext.menu.ColorMenu);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.Field=Ext.extend(Ext.BoxComponent,{invalidClass:"x-form-invalid",invalidText:"The value in this field is invalid",focusClass:"x-form-focus",validationEvent:"keyup",validateOnBlur:true,validationDelay:250,defaultAutoCreate:{tag:"input",type:"text",size:"20",autocomplete:"off"},fieldClass:"x-form-field",msgTarget:"qtip",msgFx:"normal",readOnly:false,disabled:false,isFormField:true,hasFocus:false,initComponent:function(){Ext.form.Field.superclass.initComponent.call(this);this.addEvents("focus","blur","specialkey","change","invalid","valid")},getName:function(){return this.rendered&&this.el.dom.name?this.el.dom.name:this.name||this.id||""},onRender:function(C,A){if(!this.el){var B=this.getAutoCreate();if(!B.name){B.name=this.name||this.id}if(this.inputType){B.type=this.inputType}this.autoEl=B}Ext.form.Field.superclass.onRender.call(this,C,A);var D=this.el.dom.type;if(D){if(D=="password"){D="text"}this.el.addClass("x-form-"+D)}if(this.readOnly){this.el.dom.readOnly=true}if(this.tabIndex!==undefined){this.el.dom.setAttribute("tabIndex",this.tabIndex)}this.el.addClass([this.fieldClass,this.cls])},getItemCt:function(){return this.el.up(".x-form-item",4)},initValue:function(){if(this.value!==undefined){this.setValue(this.value)}else{if(!Ext.isEmpty(this.el.dom.value)&&this.el.dom.value!=this.emptyText){this.setValue(this.el.dom.value)}}this.originalValue=this.getValue()},isDirty:function(){if(this.disabled||!this.rendered){return false}return String(this.getValue())!==String(this.originalValue)},afterRender:function(){Ext.form.Field.superclass.afterRender.call(this);this.initEvents();this.initValue()},fireKey:function(A){if(A.isSpecialKey()){this.fireEvent("specialkey",this,A)}},reset:function(){this.setValue(this.originalValue);this.clearInvalid()},initEvents:function(){this.mon(this.el,Ext.EventManager.useKeydown?"keydown":"keypress",this.fireKey,this);this.mon(this.el,"focus",this.onFocus,this);var A=this.inEditor&&Ext.isWindows&&Ext.isGecko?{buffer:10}:null;this.mon(this.el,"blur",this.onBlur,this,A)},onFocus:function(){if(this.focusClass){this.el.addClass(this.focusClass)}if(!this.hasFocus){this.hasFocus=true;this.startValue=this.getValue();this.fireEvent("focus",this)}},beforeBlur:Ext.emptyFn,onBlur:function(){this.beforeBlur();if(this.focusClass){this.el.removeClass(this.focusClass)}this.hasFocus=false;if(this.validationEvent!==false&&this.validateOnBlur&&this.validationEvent!="blur"){this.validate()}var A=this.getValue();if(String(A)!==String(this.startValue)){this.fireEvent("change",this,A,this.startValue)}this.fireEvent("blur",this)},isValid:function(A){if(this.disabled){return true}var C=this.preventMark;this.preventMark=A===true;var B=this.validateValue(this.processValue(this.getRawValue()));this.preventMark=C;return B},validate:function(){if(this.disabled||this.validateValue(this.processValue(this.getRawValue()))){this.clearInvalid();return true}return false},processValue:function(A){return A},validateValue:function(A){return true},markInvalid:function(C){if(!this.rendered||this.preventMark){return }C=C||this.invalidText;var A=this.getMessageHandler();if(A){A.mark(this,C)}else{if(this.msgTarget){this.el.addClass(this.invalidClass);var B=Ext.getDom(this.msgTarget);if(B){B.innerHTML=C;B.style.display=this.msgDisplay}}}this.fireEvent("invalid",this,C)},clearInvalid:function(){if(!this.rendered||this.preventMark){return }this.el.removeClass(this.invalidClass);var A=this.getMessageHandler();if(A){A.clear(this)}else{if(this.msgTarget){this.el.removeClass(this.invalidClass);var B=Ext.getDom(this.msgTarget);if(B){B.innerHTML="";B.style.display="none"}}}this.fireEvent("valid",this)},getMessageHandler:function(){return Ext.form.MessageTargets[this.msgTarget]},getErrorCt:function(){return this.el.findParent(".x-form-element",5,true)||this.el.findParent(".x-form-field-wrap",5,true)},alignErrorIcon:function(){this.errorIcon.alignTo(this.el,"tl-tr",[2,0])},getRawValue:function(){var A=this.rendered?this.el.getValue():Ext.value(this.value,"");if(A===this.emptyText){A=""}return A},getValue:function(){if(!this.rendered){return this.value}var A=this.el.getValue();if(A===this.emptyText||A===undefined){A=""}return A},setRawValue:function(A){return(this.el.dom.value=(Ext.isEmpty(A)?"":A))},setValue:function(A){this.value=A;if(this.rendered){this.el.dom.value=(Ext.isEmpty(A)?"":A);this.validate()}return this},append:function(A){this.setValue([this.getValue(),A].join(""))},adjustSize:function(A,D){var C=Ext.form.Field.superclass.adjustSize.call(this,A,D);C.width=this.adjustWidth(this.el.dom.tagName,C.width);if(this.offsetCt){var B=this.getItemCt();C.width-=B.getFrameWidth("lr");C.height-=B.getFrameWidth("tb")}return C},adjustWidth:function(A,B){if(typeof B=="number"&&(Ext.isIE&&(Ext.isIE6||!Ext.isStrict))&&/input|textarea/i.test(A)&&!this.inEditor){return B-3}return B}});Ext.form.MessageTargets={qtip:{mark:function(A,B){A.el.addClass(A.invalidClass);A.el.dom.qtip=B;A.el.dom.qclass="x-form-invalid-tip";if(Ext.QuickTips){Ext.QuickTips.enable()}},clear:function(A){A.el.removeClass(A.invalidClass);A.el.dom.qtip=""}},title:{mark:function(A,B){A.el.addClass(A.invalidClass);A.el.dom.title=B},clear:function(A){A.el.dom.title=""}},under:{mark:function(B,C){B.el.addClass(B.invalidClass);if(!B.errorEl){var A=B.getErrorCt();if(!A){B.el.dom.title=C;return }B.errorEl=A.createChild({cls:"x-form-invalid-msg"});B.errorEl.setWidth(A.getWidth(true)-20)}B.errorEl.update(C);Ext.form.Field.msgFx[B.msgFx].show(B.errorEl,B)},clear:function(A){A.el.removeClass(A.invalidClass);if(A.errorEl){Ext.form.Field.msgFx[A.msgFx].hide(A.errorEl,A)}else{A.el.dom.title=""}}},side:{mark:function(B,C){B.el.addClass(B.invalidClass);if(!B.errorIcon){var A=B.getErrorCt();if(!A){B.el.dom.title=C;return }B.errorIcon=A.createChild({cls:"x-form-invalid-icon"})}B.alignErrorIcon();B.errorIcon.dom.qtip=C;B.errorIcon.dom.qclass="x-form-invalid-tip";B.errorIcon.show();B.on("resize",B.alignErrorIcon,B)},clear:function(A){A.el.removeClass(A.invalidClass);if(A.errorIcon){A.errorIcon.dom.qtip="";A.errorIcon.hide();A.un("resize",A.alignErrorIcon,A)}else{A.el.dom.title=""}}}};Ext.form.Field.msgFx={normal:{show:function(A,B){A.setDisplayed("block")},hide:function(A,B){A.setDisplayed(false).update("")}},slide:{show:function(A,B){A.slideIn("t",{stopFx:true})},hide:function(A,B){A.slideOut("t",{stopFx:true,useDisplay:true})}},slideRight:{show:function(A,B){A.fixDisplay();A.alignTo(B.el,"tl-tr");A.slideIn("l",{stopFx:true})},hide:function(A,B){A.slideOut("l",{stopFx:true,useDisplay:true})}}};Ext.reg("field",Ext.form.Field);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.TextField=Ext.extend(Ext.form.Field,{grow:false,growMin:30,growMax:800,vtype:null,maskRe:null,disableKeyFilter:false,allowBlank:true,minLength:0,maxLength:Number.MAX_VALUE,minLengthText:"The minimum length for this field is {0}",maxLengthText:"The maximum length for this field is {0}",selectOnFocus:false,blankText:"This field is required",validator:null,regex:null,regexText:"",emptyText:null,emptyClass:"x-form-empty-field",initComponent:function(){Ext.form.TextField.superclass.initComponent.call(this);this.addEvents("autosize","keydown","keyup","keypress")},initEvents:function(){Ext.form.TextField.superclass.initEvents.call(this);if(this.validationEvent=="keyup"){this.validationTask=new Ext.util.DelayedTask(this.validate,this);this.mon(this.el,"keyup",this.filterValidation,this)}else{if(this.validationEvent!==false){this.mon(this.el,this.validationEvent,this.validate,this,{buffer:this.validationDelay})}}if(this.selectOnFocus||this.emptyText){this.on("focus",this.preFocus,this);this.mon(this.el,"mousedown",function(){if(!this.hasFocus){this.el.on("mouseup",function(A){A.preventDefault()},this,{single:true})}},this);if(this.emptyText){this.on("blur",this.postBlur,this);this.applyEmptyText()}}if(this.maskRe||(this.vtype&&this.disableKeyFilter!==true&&(this.maskRe=Ext.form.VTypes[this.vtype+"Mask"]))){this.mon(this.el,"keypress",this.filterKeys,this)}if(this.grow){this.mon(this.el,"keyup",this.onKeyUpBuffered,this,{buffer:50});this.mon(this.el,"click",this.autoSize,this)}if(this.enableKeyEvents){this.mon(this.el,"keyup",this.onKeyUp,this);this.mon(this.el,"keydown",this.onKeyDown,this);this.mon(this.el,"keypress",this.onKeyPress,this)}},processValue:function(A){if(this.stripCharsRe){var B=A.replace(this.stripCharsRe,"");if(B!==A){this.setRawValue(B);return B}}return A},filterValidation:function(A){if(!A.isNavKeyPress()){this.validationTask.delay(this.validationDelay)}},onDisable:function(){Ext.form.TextField.superclass.onDisable.call(this);if(Ext.isIE){this.el.dom.unselectable="on"}},onEnable:function(){Ext.form.TextField.superclass.onEnable.call(this);if(Ext.isIE){this.el.dom.unselectable=""}},onKeyUpBuffered:function(A){if(!A.isNavKeyPress()){this.autoSize()}},onKeyUp:function(A){this.fireEvent("keyup",this,A)},onKeyDown:function(A){this.fireEvent("keydown",this,A)},onKeyPress:function(A){this.fireEvent("keypress",this,A)},reset:function(){Ext.form.TextField.superclass.reset.call(this);this.applyEmptyText()},applyEmptyText:function(){if(this.rendered&&this.emptyText&&this.getRawValue().length<1&&!this.hasFocus){this.setRawValue(this.emptyText);this.el.addClass(this.emptyClass)}},preFocus:function(){var A=this.el;if(this.emptyText){if(A.dom.value==this.emptyText){this.setRawValue("")}A.removeClass(this.emptyClass)}if(this.selectOnFocus){(function(){A.dom.select()}).defer(this.inEditor&&Ext.isIE?50:0)}},postBlur:function(){this.applyEmptyText()},filterKeys:function(A){if(A.ctrlKey||A.isSpecialKey()){return }if(!this.maskRe.test(String.fromCharCode(A.getCharCode()))){A.stopEvent()}},setValue:function(A){if(this.emptyText&&this.el&&!Ext.isEmpty(A)){this.el.removeClass(this.emptyClass)}Ext.form.TextField.superclass.setValue.apply(this,arguments);this.applyEmptyText();this.autoSize();return this},validateValue:function(A){if(Ext.isFunction(this.validator)){var C=this.validator(A);if(C!==true){this.markInvalid(C);return false}}if(A.length<1||A===this.emptyText){if(this.allowBlank){this.clearInvalid();return true}else{this.markInvalid(this.blankText);return false}}if(A.length<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));return false}if(A.length>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));return false}if(this.vtype){var B=Ext.form.VTypes;if(!B[this.vtype](A,this)){this.markInvalid(this.vtypeText||B[this.vtype+"Text"]);return false}}if(this.regex&&!this.regex.test(A)){this.markInvalid(this.regexText);return false}return true},selectText:function(F,A){var C=this.getRawValue();var D=false;if(C.length>0){F=F===undefined?0:F;A=A===undefined?C.length:A;var E=this.el.dom;if(E.setSelectionRange){E.setSelectionRange(F,A)}else{if(E.createTextRange){var B=E.createTextRange();B.moveStart("character",F);B.moveEnd("character",A-C.length);B.select()}}D=Ext.isGecko||Ext.isOpera}else{D=true}if(D){this.focus()}},autoSize:function(){if(!this.grow||!this.rendered){return }if(!this.metrics){this.metrics=Ext.util.TextMetrics.createInstance(this.el)}var C=this.el;var B=C.dom.value;var D=document.createElement("div");D.appendChild(document.createTextNode(B));B=D.innerHTML;D=null;Ext.removeNode(D);B+="&#160;";var A=Math.min(this.growMax,Math.max(this.metrics.getWidth(B)+10,this.growMin));this.el.setWidth(A);this.fireEvent("autosize",this,A)},onDestroy:function(){if(this.validationTask){this.validationTask.cancel();this.validationTask=null}Ext.form.TextField.superclass.onDestroy.call(this)}});Ext.reg("textfield",Ext.form.TextField);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.TriggerField=Ext.extend(Ext.form.TextField,{defaultAutoCreate:{tag:"input",type:"text",size:"16",autocomplete:"off"},hideTrigger:false,editable:true,wrapFocusClass:"x-trigger-wrap-focus",autoSize:Ext.emptyFn,monitorTab:true,deferHeight:true,mimicing:false,actionMode:"wrap",onResize:function(A,B){Ext.form.TriggerField.superclass.onResize.call(this,A,B);if(typeof A=="number"){this.el.setWidth(this.adjustWidth("input",A-this.trigger.getWidth()))}this.wrap.setWidth(this.el.getWidth()+this.trigger.getWidth())},adjustSize:Ext.BoxComponent.prototype.adjustSize,getResizeEl:function(){return this.wrap},getPositionEl:function(){return this.wrap},alignErrorIcon:function(){if(this.wrap){this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])}},onRender:function(B,A){Ext.form.TriggerField.superclass.onRender.call(this,B,A);this.wrap=this.el.wrap({cls:"x-form-field-wrap x-form-field-trigger-wrap"});this.trigger=this.wrap.createChild(this.triggerConfig||{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.triggerClass});if(this.hideTrigger){this.trigger.setDisplayed(false)}this.initTrigger();if(!this.width){this.wrap.setWidth(this.el.getWidth()+this.trigger.getWidth())}if(!this.editable){this.editable=true;this.setEditable(false)}},afterRender:function(){Ext.form.TriggerField.superclass.afterRender.call(this)},initTrigger:function(){this.mon(this.trigger,"click",this.onTriggerClick,this,{preventDefault:true});this.trigger.addClassOnOver("x-form-trigger-over");this.trigger.addClassOnClick("x-form-trigger-click")},onDestroy:function(){Ext.destroy(this.trigger,this.wrap);if(this.mimicing){Ext.get(Ext.isIE?document.body:document).un("mousedown",this.mimicBlur,this)}Ext.form.TriggerField.superclass.onDestroy.call(this)},onFocus:function(){Ext.form.TriggerField.superclass.onFocus.call(this);if(!this.mimicing){this.wrap.addClass(this.wrapFocusClass);this.mimicing=true;Ext.get(Ext.isIE?document.body:document).on("mousedown",this.mimicBlur,this,{delay:10});if(this.monitorTab){this.el.on("keydown",this.checkTab,this)}}},checkTab:function(A){if(A.getKey()==A.TAB){this.triggerBlur()}},onBlur:function(){},mimicBlur:function(A){if(!this.wrap.contains(A.target)&&this.validateBlur(A)){this.triggerBlur()}},triggerBlur:function(){this.mimicing=false;Ext.get(Ext.isIE?document.body:document).un("mousedown",this.mimicBlur,this);if(this.monitorTab&&this.el){this.el.un("keydown",this.checkTab,this)}Ext.form.TriggerField.superclass.onBlur.call(this);if(this.wrap){this.wrap.removeClass(this.wrapFocusClass)}},beforeBlur:Ext.emptyFn,setEditable:function(A){if(A==this.editable){return }this.editable=A;if(!A){this.el.addClass("x-trigger-noedit").on("click",this.onTriggerClick,this).dom.setAttribute("readOnly",true)}else{this.el.removeClass("x-trigger-noedit").un("click",this.onTriggerClick,this).dom.removeAttribute("readOnly")}},validateBlur:function(A){return true},onTriggerClick:Ext.emptyFn});Ext.form.TwinTriggerField=Ext.extend(Ext.form.TriggerField,{initComponent:function(){Ext.form.TwinTriggerField.superclass.initComponent.call(this);this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger2Class}]}},getTrigger:function(A){return this.triggers[A]},initTrigger:function(){var A=this.trigger.select(".x-form-trigger",true);this.wrap.setStyle("overflow","hidden");var B=this;A.each(function(D,F,C){D.hide=function(){var G=B.wrap.getWidth();this.dom.style.display="none";B.el.setWidth(G-B.trigger.getWidth())};D.show=function(){var G=B.wrap.getWidth();this.dom.style.display="";B.el.setWidth(G-B.trigger.getWidth())};var E="Trigger"+(C+1);if(this["hide"+E]){D.dom.style.display="none"}this.mon(D,"click",this["on"+E+"Click"],this,{preventDefault:true});D.addClassOnOver("x-form-trigger-over");D.addClassOnClick("x-form-trigger-click")},this);this.triggers=A.elements},onTrigger1Click:Ext.emptyFn,onTrigger2Click:Ext.emptyFn});Ext.reg("trigger",Ext.form.TriggerField);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.TextArea=Ext.extend(Ext.form.TextField,{growMin:60,growMax:1000,growAppend:"&#160;\n&#160;",growPad:Ext.isWebKit?-6:0,enterIsSpecial:false,preventScrollbars:false,onRender:function(B,A){if(!this.el){this.defaultAutoCreate={tag:"textarea",style:"width:100px;height:60px;",autocomplete:"off"}}Ext.form.TextArea.superclass.onRender.call(this,B,A);if(this.grow){this.textSizeEl=Ext.DomHelper.append(document.body,{tag:"pre",cls:"x-form-grow-sizer"});if(this.preventScrollbars){this.el.setStyle("overflow","hidden")}this.el.setHeight(this.growMin)}},onDestroy:function(){Ext.destroy(this.textSizeEl);Ext.form.TextArea.superclass.onDestroy.call(this)},fireKey:function(A){if(A.isSpecialKey()&&(this.enterIsSpecial||(A.getKey()!=A.ENTER||A.hasModifier()))){this.fireEvent("specialkey",this,A)}},onKeyUp:function(A){if(!A.isNavKeyPress()||A.getKey()==A.ENTER){this.autoSize()}Ext.form.TextArea.superclass.onKeyUp.call(this,A)},autoSize:function(){if(!this.grow||!this.textSizeEl){return }var C=this.el;var A=C.dom.value;var D=this.textSizeEl;D.innerHTML="";D.appendChild(document.createTextNode(A));A=D.innerHTML;Ext.fly(D).setWidth(this.el.getWidth());if(A.length<1){A="&#160;&#160;"}else{A+=this.growAppend;if(Ext.isIE){A=A.replace(/\n/g,"<br />")}}D.innerHTML=A;var B=Math.min(this.growMax,Math.max(D.offsetHeight,this.growMin)+this.growPad);if(B!=this.lastHeight){this.lastHeight=B;this.el.setHeight(B);this.fireEvent("autosize",this,B)}}});Ext.reg("textarea",Ext.form.TextArea);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.NumberField=Ext.extend(Ext.form.TextField,{fieldClass:"x-form-field x-form-num-field",allowDecimals:true,decimalSeparator:".",decimalPrecision:2,allowNegative:true,minValue:Number.NEGATIVE_INFINITY,maxValue:Number.MAX_VALUE,minText:"The minimum value for this field is {0}",maxText:"The maximum value for this field is {0}",nanText:"{0} is not a valid number",baseChars:"0123456789",initEvents:function(){var A=this.baseChars+"";if(this.allowDecimals){A+=this.decimalSeparator}if(this.allowNegative){A+="-"}this.maskRe=new RegExp("["+Ext.escapeRe(A)+"]");Ext.form.NumberField.superclass.initEvents.call(this)},validateValue:function(B){if(!Ext.form.NumberField.superclass.validateValue.call(this,B)){return false}if(B.length<1){return true}B=String(B).replace(this.decimalSeparator,".");if(isNaN(B)){this.markInvalid(String.format(this.nanText,B));return false}var A=this.parseValue(B);if(A<this.minValue){this.markInvalid(String.format(this.minText,this.minValue));return false}if(A>this.maxValue){this.markInvalid(String.format(this.maxText,this.maxValue));return false}return true},getValue:function(){return this.fixPrecision(this.parseValue(Ext.form.NumberField.superclass.getValue.call(this)))},setValue:function(A){A=typeof A=="number"?A:parseFloat(String(A).replace(this.decimalSeparator,"."));A=isNaN(A)?"":String(A).replace(".",this.decimalSeparator);return Ext.form.NumberField.superclass.setValue.call(this,A)},parseValue:function(A){A=parseFloat(String(A).replace(this.decimalSeparator,"."));return isNaN(A)?"":A},fixPrecision:function(B){var A=isNaN(B);if(!this.allowDecimals||this.decimalPrecision==-1||A||!B){return A?"":B}return parseFloat(parseFloat(B).toFixed(this.decimalPrecision))},beforeBlur:function(){var A=this.parseValue(this.getRawValue());if(!Ext.isEmpty(A)){this.setValue(this.fixPrecision(A))}}});Ext.reg("numberfield",Ext.form.NumberField);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.DateField=Ext.extend(Ext.form.TriggerField,{format:"m/d/Y",altFormats:"m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d",disabledDaysText:"Disabled",disabledDatesText:"Disabled",minText:"The date in this field must be equal to or after {0}",maxText:"The date in this field must be equal to or before {0}",invalidText:"{0} is not a valid date - it must be in the format {1}",triggerClass:"x-form-date-trigger",showToday:true,defaultAutoCreate:{tag:"input",type:"text",size:"10",autocomplete:"off"},initComponent:function(){Ext.form.DateField.superclass.initComponent.call(this);this.addEvents("select");if(Ext.isString(this.minValue)){this.minValue=this.parseDate(this.minValue)}if(Ext.isString(this.maxValue)){this.maxValue=this.parseDate(this.maxValue)}this.disabledDatesRE=null;this.initDisabledDays()},initDisabledDays:function(){if(this.disabledDates){var B=this.disabledDates,A=B.length-1,C="(?:";Ext.each(B,function(E,D){C+=Ext.isDate(E)?"^"+Ext.escapeRe(E.dateFormat(this.format))+"$":B[D];if(D!=A){C+="|"}},this);this.disabledDatesRE=new RegExp(C+")")}},setDisabledDates:function(A){this.disabledDates=A;this.initDisabledDays();if(this.menu){this.menu.picker.setDisabledDates(this.disabledDatesRE)}},setDisabledDays:function(A){this.disabledDays=A;if(this.menu){this.menu.picker.setDisabledDays(A)}},setMinValue:function(A){this.minValue=(Ext.isString(A)?this.parseDate(A):A);if(this.menu){this.menu.picker.setMinDate(this.minValue)}},setMaxValue:function(A){this.maxValue=(Ext.isString(A)?this.parseDate(A):A);if(this.menu){this.menu.picker.setMaxDate(this.maxValue)}},validateValue:function(E){E=this.formatDate(E);if(!Ext.form.DateField.superclass.validateValue.call(this,E)){return false}if(E.length<1){return true}var C=E;E=this.parseDate(E);if(!E){this.markInvalid(String.format(this.invalidText,C,this.format));return false}var F=E.getTime();if(this.minValue&&F<this.minValue.getTime()){this.markInvalid(String.format(this.minText,this.formatDate(this.minValue)));return false}if(this.maxValue&&F>this.maxValue.getTime()){this.markInvalid(String.format(this.maxText,this.formatDate(this.maxValue)));return false}if(this.disabledDays){var A=E.getDay();for(var B=0;B<this.disabledDays.length;B++){if(A===this.disabledDays[B]){this.markInvalid(this.disabledDaysText);return false}}}var D=this.formatDate(E);if(this.disabledDatesRE&&this.disabledDatesRE.test(D)){this.markInvalid(String.format(this.disabledDatesText,D));return false}return true},validateBlur:function(){return !this.menu||!this.menu.isVisible()},getValue:function(){return this.parseDate(Ext.form.DateField.superclass.getValue.call(this))||""},setValue:function(A){return Ext.form.DateField.superclass.setValue.call(this,this.formatDate(this.parseDate(A)))},parseDate:function(D){if(!D||Ext.isDate(D)){return D}var B=Date.parseDate(D,this.format);if(!B&&this.altFormats){if(!this.altFormatsArray){this.altFormatsArray=this.altFormats.split("|")}for(var C=0,A=this.altFormatsArray.length;C<A&&!B;C++){B=Date.parseDate(D,this.altFormatsArray[C])}}return B},onDestroy:function(){Ext.destroy(this.menu);Ext.form.DateField.superclass.onDestroy.call(this)},formatDate:function(A){return Ext.isDate(A)?A.dateFormat(this.format):A},onTriggerClick:function(){if(this.disabled){return }if(this.menu==null){this.menu=new Ext.menu.DateMenu({hideOnClick:false})}this.onFocus();Ext.apply(this.menu.picker,{minDate:this.minValue,maxDate:this.maxValue,disabledDatesRE:this.disabledDatesRE,disabledDatesText:this.disabledDatesText,disabledDays:this.disabledDays,disabledDaysText:this.disabledDaysText,format:this.format,showToday:this.showToday,minText:String.format(this.minText,this.formatDate(this.minValue)),maxText:String.format(this.maxText,this.formatDate(this.maxValue))});this.menu.picker.setValue(this.getValue()||new Date());this.menu.show(this.el,"tl-bl?");this.menuEvents("on")},menuEvents:function(A){this.menu[A]("select",this.onSelect,this);this.menu[A]("hide",this.onMenuHide,this);this.menu[A]("show",this.onFocus,this)},onSelect:function(A,B){this.setValue(B);this.fireEvent("select",this,B);this.menu.hide()},onMenuHide:function(){this.focus(false,60);this.menuEvents("un")},beforeBlur:function(){var A=this.parseDate(this.getRawValue());if(A){this.setValue(A)}}});Ext.reg("datefield",Ext.form.DateField);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.DisplayField=Ext.extend(Ext.form.Field,{validationEvent:false,validateOnBlur:false,defaultAutoCreate:{tag:"div"},fieldClass:"x-form-display-field",htmlEncode:false,initEvents:Ext.emptyFn,isValid:function(){return true},validate:function(){return true},getRawValue:function(){var A=this.rendered?this.el.dom.innerHTML:Ext.value(this.value,"");if(A===this.emptyText){A=""}if(this.htmlEncode){A=Ext.util.Format.htmlDecode(A)}return A},getValue:function(){return this.getRawValue()},getName:function(){return this.name},setRawValue:function(A){if(this.htmlEncode){A=Ext.util.Format.htmlEncode(A)}return this.rendered?(this.el.dom.innerHTML=(Ext.isEmpty(A)?"":A)):(this.value=A)},setValue:function(A){this.setRawValue(A);return this}});Ext.reg("displayfield",Ext.form.DisplayField);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.ComboBox=Ext.extend(Ext.form.TriggerField,{defaultAutoCreate:{tag:"input",type:"text",size:"24",autocomplete:"off"},listClass:"",selectedClass:"x-combo-selected",listEmptyText:"",triggerClass:"x-form-arrow-trigger",shadow:"sides",listAlign:"tl-bl?",maxHeight:300,minHeight:90,triggerAction:"query",minChars:4,typeAhead:false,queryDelay:500,pageSize:0,selectOnFocus:false,queryParam:"query",loadingText:"Loading...",resizable:false,handleHeight:8,allQuery:"",mode:"remote",minListWidth:70,forceSelection:false,typeAheadDelay:250,lazyInit:true,initComponent:function(){Ext.form.ComboBox.superclass.initComponent.call(this);this.addEvents("expand","collapse","beforeselect","select","beforequery");if(this.transform){var C=Ext.getDom(this.transform);if(!this.hiddenName){this.hiddenName=C.name}if(!this.store){this.mode="local";var G=[],D=C.options;for(var B=0,A=D.length;B<A;B++){var F=D[B],E=(F.hasAttribute?F.hasAttribute("value"):F.getAttributeNode("value").specified)?F.value:F.text;if(F.selected&&Ext.isEmpty(this.value,true)){this.value=E}G.push([E,F.text])}this.store=new Ext.data.ArrayStore({id:0,fields:["value","text"],data:G,autoDestroy:true});this.valueField="value";this.displayField="text"}C.name=Ext.id();if(!this.lazyRender){this.target=true;this.el=Ext.DomHelper.insertBefore(C,this.autoCreate||this.defaultAutoCreate);this.render(this.el.parentNode,C);Ext.removeNode(C)}else{Ext.removeNode(C)}}else{if(this.store){this.store=Ext.StoreMgr.lookup(this.store);if(this.store.autoCreated){this.displayField=this.valueField="field1";if(!this.store.expandData){this.displayField="field2"}this.mode="local"}}}this.selectedIndex=-1;if(this.mode=="local"){if(!Ext.isDefined(this.initialConfig.queryDelay)){this.queryDelay=10}if(!Ext.isDefined(this.initialConfig.minChars)){this.minChars=0}}},onRender:function(B,A){Ext.form.ComboBox.superclass.onRender.call(this,B,A);if(this.hiddenName){this.hiddenField=this.el.insertSibling({tag:"input",type:"hidden",name:this.hiddenName,id:(this.hiddenId||this.hiddenName)},"before",true);this.el.dom.removeAttribute("name")}if(Ext.isGecko){this.el.dom.setAttribute("autocomplete","off")}if(!this.lazyInit){this.initList()}else{this.on("focus",this.initList,this,{single:true})}},initValue:function(){Ext.form.ComboBox.superclass.initValue.call(this);if(this.hiddenField){this.hiddenField.value=Ext.isDefined(this.hiddenValue)?this.hiddenValue:Ext.isDefined(this.value)?this.value:""}},initList:function(){if(!this.list){var A="x-combo-list";this.list=new Ext.Layer({parentEl:this.getListParent(),shadow:this.shadow,cls:[A,this.listClass].join(" "),constrain:false});var B=this.listWidth||Math.max(this.wrap.getWidth(),this.minListWidth);this.list.setSize(B,0);this.list.swallowEvent("mousewheel");this.assetHeight=0;if(this.syncFont!==false){this.list.setStyle("font-size",this.el.getStyle("font-size"))}if(this.title){this.header=this.list.createChild({cls:A+"-hd",html:this.title});this.assetHeight+=this.header.getHeight()}this.innerList=this.list.createChild({cls:A+"-inner"});this.mon(this.innerList,"mouseover",this.onViewOver,this);this.mon(this.innerList,"mousemove",this.onViewMove,this);this.innerList.setWidth(B-this.list.getFrameWidth("lr"));if(this.pageSize){this.footer=this.list.createChild({cls:A+"-ft"});this.pageTb=new Ext.PagingToolbar({store:this.store,pageSize:this.pageSize,renderTo:this.footer});this.assetHeight+=this.footer.getHeight()}if(!this.tpl){this.tpl='<tpl for="."><div class="'+A+'-item">{'+this.displayField+"}</div></tpl>"}this.view=new Ext.DataView({applyTo:this.innerList,tpl:this.tpl,singleSelect:true,selectedClass:this.selectedClass,itemSelector:this.itemSelector||"."+A+"-item",emptyText:this.listEmptyText});this.mon(this.view,"click",this.onViewClick,this);this.bindStore(this.store,true);if(this.resizable){this.resizer=new Ext.Resizable(this.list,{pinned:true,handles:"se"});this.mon(this.resizer,"resize",function(E,C,D){this.maxHeight=D-this.handleHeight-this.list.getFrameWidth("tb")-this.assetHeight;this.listWidth=C;this.innerList.setWidth(C-this.list.getFrameWidth("lr"));this.restrictHeight()},this);this[this.pageSize?"footer":"innerList"].setStyle("margin-bottom",this.handleHeight+"px")}}},getListParent:function(){return document.body},getStore:function(){return this.store},bindStore:function(A,B){if(this.store&&!B){this.store.un("beforeload",this.onBeforeLoad,this);this.store.un("load",this.onLoad,this);this.store.un("exception",this.collapse,this);if(this.store!==A&&this.store.autoDestroy){this.store.destroy()}if(!A){this.store=null;if(this.view){this.view.bindStore(null)}}}if(A){if(!B){this.lastQuery=null;if(this.pageTb){this.pageTb.bindStore(A)}}this.store=Ext.StoreMgr.lookup(A);this.store.on({scope:this,beforeload:this.onBeforeLoad,load:this.onLoad,exception:this.collapse});if(this.view){this.view.bindStore(A)}}},initEvents:function(){Ext.form.ComboBox.superclass.initEvents.call(this);this.keyNav=new Ext.KeyNav(this.el,{up:function(A){this.inKeyMode=true;this.selectPrev()},down:function(A){if(!this.isExpanded()){this.onTriggerClick()}else{this.inKeyMode=true;this.selectNext()}},enter:function(A){this.onViewClick();this.delayedCheck=true;this.unsetDelayCheck.defer(10,this)},esc:function(A){this.collapse()},tab:function(A){this.onViewClick(false);return true},scope:this,doRelay:function(C,B,A){if(A=="down"||this.scope.isExpanded()){return Ext.KeyNav.prototype.doRelay.apply(this,arguments)}return true},forceKeyDown:true});this.queryDelay=Math.max(this.queryDelay||10,this.mode=="local"?10:250);this.dqTask=new Ext.util.DelayedTask(this.initQuery,this);if(this.typeAhead){this.taTask=new Ext.util.DelayedTask(this.onTypeAhead,this)}if(this.editable!==false&&!this.enableKeyEvents){this.mon(this.el,"keyup",this.onKeyUp,this)}},onDestroy:function(){if(this.dqTask){this.dqTask.cancel();this.dqTask=null}this.bindStore(null);Ext.destroy(this.resizer,this.view,this.pageTb,this.list);Ext.form.ComboBox.superclass.onDestroy.call(this)},unsetDelayCheck:function(){delete this.delayedCheck},fireKey:function(B){var A=function(C){if(C.isNavKeyPress()&&!this.isExpanded()&&!this.delayedCheck){this.fireEvent("specialkey",this,C)}};if(this.inEditor&&Ext.isWebKit&&B.getKey()==B.TAB){A.defer(10,this,[new Ext.EventObjectImpl(B)])}else{A.call(this,B)}},onResize:function(A,B){Ext.form.ComboBox.superclass.onResize.apply(this,arguments);if(this.list&&!Ext.isDefined(this.listWidth)){var C=Math.max(A,this.minListWidth);this.list.setWidth(C);this.innerList.setWidth(C-this.list.getFrameWidth("lr"))}},onEnable:function(){Ext.form.ComboBox.superclass.onEnable.apply(this,arguments);if(this.hiddenField){this.hiddenField.disabled=false}},onDisable:function(){Ext.form.ComboBox.superclass.onDisable.apply(this,arguments);if(this.hiddenField){this.hiddenField.disabled=true}},onBeforeLoad:function(){if(!this.hasFocus){return }this.innerList.update(this.loadingText?'<div class="loading-indicator">'+this.loadingText+"</div>":"");this.restrictHeight();this.selectedIndex=-1},onLoad:function(){if(!this.hasFocus){return }if(this.store.getCount()>0){this.expand();this.restrictHeight();if(this.lastQuery==this.allQuery){if(this.editable){this.el.dom.select()}if(!this.selectByValue(this.value,true)){this.select(0,true)}}else{this.selectNext();if(this.typeAhead&&this.lastKey!=Ext.EventObject.BACKSPACE&&this.lastKey!=Ext.EventObject.DELETE){this.taTask.delay(this.typeAheadDelay)}}}else{this.onEmptyResults()}},onTypeAhead:function(){if(this.store.getCount()>0){var B=this.store.getAt(0);var C=B.data[this.displayField];var A=C.length;var D=this.getRawValue().length;if(D!=A){this.setRawValue(C);this.selectText(D,C.length)}}},onSelect:function(A,B){if(this.fireEvent("beforeselect",this,A,B)!==false){this.setValue(A.data[this.valueField||this.displayField]);this.collapse();this.fireEvent("select",this,A,B)}},getName:function(){var A=this.hiddenField;return A&&A.name?A.name:this.hiddenName||Ext.form.ComboBox.superclass.getName.call(this)},getValue:function(){if(this.valueField){return Ext.isDefined(this.value)?this.value:""}else{return Ext.form.ComboBox.superclass.getValue.call(this)}},clearValue:function(){if(this.hiddenField){this.hiddenField.value=""}this.setRawValue("");this.lastSelectionText="";this.applyEmptyText();this.value=""},setValue:function(A){var C=A;if(this.valueField){var B=this.findRecord(this.valueField,A);if(B){C=B.data[this.displayField]}else{if(Ext.isDefined(this.valueNotFoundText)){C=this.valueNotFoundText}}}this.lastSelectionText=C;if(this.hiddenField){this.hiddenField.value=A}Ext.form.ComboBox.superclass.setValue.call(this,C);this.value=A;return this},findRecord:function(C,B){var A;if(this.store.getCount()>0){this.store.each(function(D){if(D.data[C]==B){A=D;return false}})}return A},onViewMove:function(B,A){this.inKeyMode=false},onViewOver:function(D,B){if(this.inKeyMode){return }var C=this.view.findItemFromChild(B);if(C){var A=this.view.indexOf(C);this.select(A,false)}},onViewClick:function(B){var A=this.view.getSelectedIndexes()[0];var C=this.store.getAt(A);if(C){this.onSelect(C,A)}if(B!==false){this.el.focus()}},restrictHeight:function(){this.innerList.dom.style.height="";var B=this.innerList.dom;var E=this.list.getFrameWidth("tb")+(this.resizable?this.handleHeight:0)+this.assetHeight;var C=Math.max(B.clientHeight,B.offsetHeight,B.scrollHeight);var A=this.getPosition()[1]-Ext.getBody().getScroll().top;var F=Ext.lib.Dom.getViewHeight()-A-this.getSize().height;var D=Math.max(A,F,this.minHeight||0)-this.list.shadowOffset-E-5;C=Math.min(C,D,this.maxHeight);this.innerList.setHeight(C);this.list.beginUpdate();this.list.setHeight(C+E);this.list.alignTo(this.wrap,this.listAlign);this.list.endUpdate()},onEmptyResults:function(){this.collapse()},isExpanded:function(){return this.list&&this.list.isVisible()},selectByValue:function(A,C){if(!Ext.isEmpty(A,true)){var B=this.findRecord(this.valueField||this.displayField,A);if(B){this.select(this.store.indexOf(B),C);return true}}return false},select:function(A,C){this.selectedIndex=A;this.view.select(A);if(C!==false){var B=this.view.getNode(A);if(B){this.innerList.scrollChildIntoView(B,false)}}},selectNext:function(){var A=this.store.getCount();if(A>0){if(this.selectedIndex==-1){this.select(0)}else{if(this.selectedIndex<A-1){this.select(this.selectedIndex+1)}}}},selectPrev:function(){var A=this.store.getCount();if(A>0){if(this.selectedIndex==-1){this.select(0)}else{if(this.selectedIndex!==0){this.select(this.selectedIndex-1)}}}},onKeyUp:function(B){var A=B.getKey();if(this.editable!==false&&(A==B.BACKSPACE||!B.isSpecialKey())){this.lastKey=A;this.dqTask.delay(this.queryDelay)}Ext.form.ComboBox.superclass.onKeyUp.call(this,B)},validateBlur:function(){return !this.list||!this.list.isVisible()},initQuery:function(){this.doQuery(this.getRawValue())},beforeBlur:function(){var B=this.getRawValue();if(this.forceSelection){if(B.length>0&&B!=this.emptyText){this.el.dom.value=Ext.isDefined(this.lastSelectionText)?this.lastSelectionText:"";this.applyEmptyText()}else{this.clearValue()}}else{var A=this.findRecord(this.displayField,B);if(A){B=A.get(this.valueField||this.displayField)}this.setValue(B)}},doQuery:function(C,B){C=Ext.isEmpty(C)?"":C;var A={query:C,forceAll:B,combo:this,cancel:false};if(this.fireEvent("beforequery",A)===false||A.cancel){return false}C=A.query;B=A.forceAll;if(B===true||(C.length>=this.minChars)){if(this.lastQuery!==C){this.lastQuery=C;if(this.mode=="local"){this.selectedIndex=-1;if(B){this.store.clearFilter()}else{this.store.filter(this.displayField,C)}this.onLoad()}else{this.store.baseParams[this.queryParam]=C;this.store.load({params:this.getParams(C)});this.expand()}}else{this.selectedIndex=-1;this.onLoad()}}},getParams:function(A){var B={};if(this.pageSize){B.start=0;B.limit=this.pageSize}return B},collapse:function(){if(!this.isExpanded()){return }this.list.hide();Ext.getDoc().un("mousewheel",this.collapseIf,this);Ext.getDoc().un("mousedown",this.collapseIf,this);this.fireEvent("collapse",this)},collapseIf:function(A){if(!A.within(this.wrap)&&!A.within(this.list)){this.collapse()}},expand:function(){if(this.isExpanded()||!this.hasFocus){return }this.list.alignTo(this.wrap,this.listAlign);this.list.show();if(Ext.isGecko2){this.innerList.setOverflow("auto")}Ext.getDoc().on({scope:this,mousewheel:this.collapseIf,mousedown:this.collapseIf});this.fireEvent("expand",this)},onTriggerClick:function(){if(this.disabled){return }if(this.isExpanded()){this.collapse();this.el.focus()}else{this.onFocus({});if(this.triggerAction=="all"){this.doQuery(this.allQuery,true)}else{this.doQuery(this.getRawValue())}this.el.focus()}}});Ext.reg("combo",Ext.form.ComboBox);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.Checkbox=Ext.extend(Ext.form.Field,{focusClass:undefined,fieldClass:"x-form-field",checked:false,defaultAutoCreate:{tag:"input",type:"checkbox",autocomplete:"off"},actionMode:"wrap",initComponent:function(){Ext.form.Checkbox.superclass.initComponent.call(this);this.addEvents("check")},onResize:function(){Ext.form.Checkbox.superclass.onResize.apply(this,arguments);if(!this.boxLabel&&!this.fieldLabel){this.el.alignTo(this.wrap,"c-c")}},initEvents:function(){Ext.form.Checkbox.superclass.initEvents.call(this);this.mon(this.el,"click",this.onClick,this);this.mon(this.el,"change",this.onClick,this)},getResizeEl:function(){return this.wrap},getPositionEl:function(){return this.wrap},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,onRender:function(B,A){Ext.form.Checkbox.superclass.onRender.call(this,B,A);if(this.inputValue!==undefined){this.el.dom.value=this.inputValue}this.wrap=this.el.wrap({cls:"x-form-check-wrap"});if(this.boxLabel){this.wrap.createChild({tag:"label",htmlFor:this.el.id,cls:"x-form-cb-label",html:this.boxLabel})}if(this.checked){this.setValue(true)}else{this.checked=this.el.dom.checked}},onDestroy:function(){Ext.destroy(this.wrap);Ext.form.Checkbox.superclass.onDestroy.call(this)},initValue:function(){this.originalValue=this.getValue()},getValue:function(){if(this.rendered){return this.el.dom.checked}return false},onClick:function(){if(this.el.dom.checked!=this.checked){this.setValue(this.el.dom.checked)}},setValue:function(A){var B=this.checked;this.checked=(A===true||A==="true"||A=="1"||String(A).toLowerCase()=="on");if(this.rendered){this.el.dom.checked=this.checked;this.el.dom.defaultChecked=this.checked}if(B!=this.checked){this.fireEvent("check",this,this.checked);if(this.handler){this.handler.call(this.scope||this,this,this.checked)}}return this}});Ext.reg("checkbox",Ext.form.Checkbox);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.CheckboxGroup=Ext.extend(Ext.form.Field,{columns:"auto",vertical:false,allowBlank:true,blankText:"You must select at least one item in this group",defaultType:"checkbox",groupCls:"x-form-check-group",initComponent:function(){this.addEvents("change");Ext.form.CheckboxGroup.superclass.initComponent.call(this)},onRender:function(H,F){if(!this.el){var M={cls:this.groupCls,layout:"column",border:false,renderTo:H};var A={defaultType:this.defaultType,layout:"form",border:false,defaults:{hideLabel:true,anchor:"100%"}};if(this.items[0].items){Ext.apply(M,{layoutConfig:{columns:this.items.length},defaults:this.defaults,items:this.items});for(var E=0,J=this.items.length;E<J;E++){Ext.applyIf(this.items[E],A)}}else{var D,K=[];if(typeof this.columns=="string"){this.columns=this.items.length}if(!Ext.isArray(this.columns)){var I=[];for(var E=0;E<this.columns;E++){I.push((100/this.columns)*0.01)}this.columns=I}D=this.columns.length;for(var E=0;E<D;E++){var B=Ext.apply({items:[]},A);B[this.columns[E]<=1?"columnWidth":"width"]=this.columns[E];if(this.defaults){B.defaults=Ext.apply(B.defaults||{},this.defaults)}K.push(B)}if(this.vertical){var O=Math.ceil(this.items.length/D),L=0;for(var E=0,J=this.items.length;E<J;E++){if(E>0&&E%O==0){L++}if(this.items[E].fieldLabel){this.items[E].hideLabel=false}K[L].items.push(this.items[E])}}else{for(var E=0,J=this.items.length;E<J;E++){var N=E%D;if(this.items[E].fieldLabel){this.items[E].hideLabel=false}K[N].items.push(this.items[E])}}Ext.apply(M,{layoutConfig:{columns:D},items:K})}this.panel=new Ext.Panel(M);this.panel.ownerCt=this;this.el=this.panel.getEl();if(this.forId&&this.itemCls){var C=this.el.up(this.itemCls).child("label",true);if(C){C.setAttribute("htmlFor",this.forId)}}var G=this.panel.findBy(function(P){return P.isFormField},this);this.items=new Ext.util.MixedCollection();this.items.addAll(G)}Ext.form.CheckboxGroup.superclass.onRender.call(this,H,F)},afterRender:function(){Ext.form.CheckboxGroup.superclass.afterRender.call(this);if(this.values){this.setValue.apply(this,this.values);delete this.values}this.eachItem(function(A){A.on("check",this.fireChecked,this);A.inGroup=true})},doLayout:function(){if(this.rendered){this.panel.forceLayout=this.ownerCt.forceLayout;this.panel.doLayout()}},fireChecked:function(){var A=[];this.eachItem(function(B){if(B.checked){A.push(B)}});this.fireEvent("change",this,A)},validateValue:function(A){if(!this.allowBlank){var B=true;this.eachItem(function(C){if(C.checked){return(B=false)}});if(B){this.markInvalid(this.blankText);return false}}return true},onDisable:function(){this.eachItem(function(A){A.disable()})},onEnable:function(){this.eachItem(function(A){A.enable()})},doLayout:function(){if(this.rendered){this.panel.forceLayout=this.ownerCt.forceLayout;this.panel.doLayout()}},onResize:function(A,B){this.panel.setSize(A,B);this.panel.doLayout()},reset:function(){Ext.form.CheckboxGroup.superclass.reset.call(this);this.eachItem(function(A){if(A.reset){A.reset()}})},setValue:function(D,C){if(this.rendered){if(arguments.length==1){if(Ext.isArray(D)){Ext.each(D,function(G,E){var F=this.items.itemAt(E);if(F){F.setValue(G)}},this)}else{if(Ext.isObject(D)){for(var A in D){var B=this.getBox(A);if(B){B.setValue(D[A])}}}else{this.setValueForItem(D)}}}else{var B=this.getBox(D);if(B){B.setValue(C)}}}else{this.values=arguments}return this},onDestroy:function(){Ext.destroy(this.panel);Ext.form.CheckboxGroup.superclass.onDestroy.call(this)},setValueForItem:function(A){A=String(A).split(",");this.eachItem(function(B){if(A.indexOf(B.inputValue)>-1){B.setValue(true)}})},getBox:function(B){var A=null;this.eachItem(function(C){if(B==C||C.dataIndex==B||C.id==B||C.getName()==B){A=C;return false}});return A},getValue:function(){var A=[];this.eachItem(function(B){if(B.checked){A.push(B)}});return A},eachItem:function(A){if(this.items&&this.items.each){this.items.each(A,this)}},initValue:Ext.emptyFn,getValue:Ext.emptyFn,getRawValue:Ext.emptyFn,setRawValue:Ext.emptyFn});Ext.reg("checkboxgroup",Ext.form.CheckboxGroup);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.Radio=Ext.extend(Ext.form.Checkbox,{inputType:"radio",markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,getGroupValue:function(){var A=this.el.up("form")||Ext.getBody();var B=A.child("input[name="+this.el.dom.name+"]:checked",true);return B?B.value:null},onClick:function(){if(this.el.dom.checked!=this.checked){var A=this.getCheckEl().select("input[name="+this.el.dom.name+"]");A.each(function(B){if(B.dom.id==this.id){this.setValue(true)}else{Ext.getCmp(B.dom.id).setValue(false)}},this)}},setValue:function(A){if(typeof A=="boolean"){Ext.form.Radio.superclass.setValue.call(this,A)}else{var B=this.getCheckEl().child("input[name="+this.el.dom.name+"][value="+A+"]",true);if(B){Ext.getCmp(B.id).setValue(true)}}return this},getCheckEl:function(){if(this.inGroup){return this.el.up(".x-form-radio-group")}return this.el.up("form")||Ext.getBody()}});Ext.reg("radio",Ext.form.Radio);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.RadioGroup=Ext.extend(Ext.form.CheckboxGroup,{allowBlank:true,blankText:"You must select one item in this group",defaultType:"radio",groupCls:"x-form-radio-group",getValue:function(){var A=null;this.eachItem(function(B){if(B.checked){A=B;return false}});return A},setValue:function(C,B){if(this.rendered){if(arguments.length>1){var A=this.getBox(C);if(A){A.setValue(B);if(A.checked){this.eachItem(function(D){if(D!==A){D.setValue(false)}})}}}else{this.setValueForItem(C)}}else{this.values=arguments}return this},fireChecked:function(){if(!this.checkTask){this.checkTask=new Ext.util.DelayedTask(this.bufferChecked,this)}this.checkTask.delay(10)},bufferChecked:function(){var A=null;this.eachItem(function(B){if(B.checked){A=B;return false}});this.fireEvent("change",this,A)},onDestroy:function(){if(this.checkTask){this.checkTask.cancel();this.checkTask=null}Ext.form.RadioGroup.superclass.onDestroy.call(this)}});Ext.reg("radiogroup",Ext.form.RadioGroup);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.Hidden=Ext.extend(Ext.form.Field,{inputType:"hidden",onRender:function(){Ext.form.Hidden.superclass.onRender.apply(this,arguments)},initEvents:function(){this.originalValue=this.getValue()},setSize:Ext.emptyFn,setWidth:Ext.emptyFn,setHeight:Ext.emptyFn,setPosition:Ext.emptyFn,setPagePosition:Ext.emptyFn,markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn});Ext.reg("hidden",Ext.form.Hidden);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.BasicForm=function(B,A){Ext.apply(this,A);if(Ext.isString(this.paramOrder)){this.paramOrder=this.paramOrder.split(/[\s,|]/)}this.items=new Ext.util.MixedCollection(false,function(C){return C.itemId||C.id||(C.id=Ext.id())});this.addEvents("beforeaction","actionfailed","actioncomplete");if(B){this.initEl(B)}Ext.form.BasicForm.superclass.constructor.call(this)};Ext.extend(Ext.form.BasicForm,Ext.util.Observable,{timeout:30,paramOrder:undefined,paramsAsHash:false,activeAction:null,trackResetOnLoad:false,initEl:function(A){this.el=Ext.get(A);this.id=this.el.id||Ext.id();if(!this.standardSubmit){this.el.on("submit",this.onSubmit,this)}this.el.addClass("x-form")},getEl:function(){return this.el},onSubmit:function(A){A.stopEvent()},destroy:function(){this.items.each(function(A){Ext.destroy(A)});if(this.el){this.el.removeAllListeners();this.el.remove()}this.purgeListeners()},isValid:function(){var A=true;this.items.each(function(B){if(!B.validate()){A=false}});return A},isDirty:function(){var A=false;this.items.each(function(B){if(B.isDirty()){A=true;return false}});return A},doAction:function(B,A){if(Ext.isString(B)){B=new Ext.form.Action.ACTION_TYPES[B](this,A)}if(this.fireEvent("beforeaction",this,B)!==false){this.beforeAction(B);B.run.defer(100,B)}return this},submit:function(B){if(this.standardSubmit){var A=this.isValid();if(A){this.el.dom.submit()}return A}var C=String.format("{0}submit",this.api?"direct":"");this.doAction(C,B);return this},load:function(A){var B=String.format("{0}load",this.api?"direct":"");this.doAction(B,A);return this},updateRecord:function(B){B.beginEdit();var A=B.fields;A.each(function(C){var D=this.findField(C.name);if(D){B.set(C.name,D.getValue())}},this);B.endEdit();return this},loadRecord:function(A){this.setValues(A.data);return this},beforeAction:function(A){var B=A.options;if(B.waitMsg){if(this.waitMsgTarget===true){this.el.mask(B.waitMsg,"x-mask-loading")}else{if(this.waitMsgTarget){this.waitMsgTarget=Ext.get(this.waitMsgTarget);this.waitMsgTarget.mask(B.waitMsg,"x-mask-loading")}else{Ext.MessageBox.wait(B.waitMsg,B.waitTitle||this.waitTitle||"Please Wait...")}}}},afterAction:function(A,C){this.activeAction=null;var B=A.options;if(B.waitMsg){if(this.waitMsgTarget===true){this.el.unmask()}else{if(this.waitMsgTarget){this.waitMsgTarget.unmask()}else{Ext.MessageBox.updateProgress(1);Ext.MessageBox.hide()}}}if(C){if(B.reset){this.reset()}Ext.callback(B.success,B.scope,[this,A]);this.fireEvent("actioncomplete",this,A)}else{Ext.callback(B.failure,B.scope,[this,A]);this.fireEvent("actionfailed",this,A)}},findField:function(B){var A=this.items.get(B);if(!Ext.isObject(A)){this.items.each(function(C){if(C.isFormField&&(C.dataIndex==B||C.id==B||C.getName()==B)){A=C;return false}})}return A||null},markInvalid:function(G){if(Ext.isArray(G)){for(var C=0,A=G.length;C<A;C++){var B=G[C];var D=this.findField(B.id);if(D){D.markInvalid(B.msg)}}}else{var E,F;for(F in G){if(!Ext.isFunction(G[F])&&(E=this.findField(F))){E.markInvalid(G[F])}}}return this},setValues:function(C){if(Ext.isArray(C)){for(var D=0,A=C.length;D<A;D++){var B=C[D];var E=this.findField(B.id);if(E){E.setValue(B.value);if(this.trackResetOnLoad){E.originalValue=E.getValue()}}}}else{var F,G;for(G in C){if(!Ext.isFunction(C[G])&&(F=this.findField(G))){F.setValue(C[G]);if(this.trackResetOnLoad){F.originalValue=F.getValue()}}}}return this},getValues:function(B){var A=Ext.lib.Ajax.serializeForm(this.el.dom);if(B===true){return A}return Ext.urlDecode(A)},getFieldValues:function(){var A={};this.items.each(function(B){A[B.getName()]=B.getValue()});return A},clearInvalid:function(){this.items.each(function(A){A.clearInvalid()});return this},reset:function(){this.items.each(function(A){A.reset()});return this},add:function(){this.items.addAll(Array.prototype.slice.call(arguments,0));return this},remove:function(A){this.items.remove(A);return this},render:function(){this.items.each(function(A){if(A.isFormField&&!A.rendered&&document.getElementById(A.id)){A.applyToMarkup(A.id)}});return this},applyToFields:function(A){this.items.each(function(B){Ext.apply(B,A)});return this},applyIfToFields:function(A){this.items.each(function(B){Ext.applyIf(B,A)});return this},callFieldMethod:function(B,A){A=A||[];this.items.each(function(C){if(Ext.isFunction(C[B])){C[B].apply(C,A)}});return this}});Ext.BasicForm=Ext.form.BasicForm;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.FormPanel=Ext.extend(Ext.Panel,{minButtonWidth:75,labelAlign:"left",monitorValid:false,monitorPoll:200,layout:"form",initComponent:function(){this.form=this.createForm();Ext.FormPanel.superclass.initComponent.call(this);this.bodyCfg={tag:"form",cls:this.baseCls+"-body",method:this.method||"POST",id:this.formId||Ext.id()};if(this.fileUpload){this.bodyCfg.enctype="multipart/form-data"}this.initItems();this.addEvents("clientvalidation");this.relayEvents(this.form,["beforeaction","actionfailed","actioncomplete"])},createForm:function(){var A=Ext.applyIf({listeners:{}},this.initialConfig);return new Ext.form.BasicForm(null,A)},initFields:function(){var C=this.form;var A=this;var B=function(D){if(A.isField(D)){C.add(D)}if(D.isFieldWrap){Ext.applyIf(D,{labelAlign:D.ownerCt.labelAlign,labelWidth:D.ownerCt.labelWidth,itemCls:D.ownerCt.itemCls});C.add(D.field)}else{if(D.doLayout&&D!=A){Ext.applyIf(D,{labelAlign:D.ownerCt.labelAlign,labelWidth:D.ownerCt.labelWidth,itemCls:D.ownerCt.itemCls});if(D.items&&D.items.each){D.items.each(B,this)}}}};this.items.each(B,this)},getLayoutTarget:function(){return this.form.el},getForm:function(){return this.form},onRender:function(B,A){this.initFields();Ext.FormPanel.superclass.onRender.call(this,B,A);this.form.initEl(this.body)},beforeDestroy:function(){this.stopMonitoring();Ext.FormPanel.superclass.beforeDestroy.call(this);this.form.items.clear();Ext.destroy(this.form)},isField:function(A){return !!A.setValue&&!!A.getValue&&!!A.markInvalid&&!!A.clearInvalid},initEvents:function(){Ext.FormPanel.superclass.initEvents.call(this);this.on("remove",this.onRemove,this);this.on("add",this.onAdd,this);if(this.monitorValid){this.startMonitoring()}},onAdd:function(A,B){if(this.isField(B)){this.form.add(B)}else{if(B.findBy){Ext.applyIf(B,{labelAlign:B.ownerCt.labelAlign,labelWidth:B.ownerCt.labelWidth,itemCls:B.ownerCt.itemCls});this.form.add.apply(this.form,B.findBy(this.isField))}}},onRemove:function(A,B){if(this.isField(B)){Ext.destroy(B.container.up(".x-form-item"));this.form.remove(B)}else{if(B.findByType){Ext.each(B.findBy(this.isField),this.form.remove,this.form)}}},startMonitoring:function(){if(!this.validTask){this.validTask=new Ext.util.TaskRunner();this.validTask.start({run:this.bindHandler,interval:this.monitorPoll||200,scope:this})}},stopMonitoring:function(){if(this.validTask){this.validTask.stopAll();this.validTask=null}},load:function(){this.form.load.apply(this.form,arguments)},onDisable:function(){Ext.FormPanel.superclass.onDisable.call(this);if(this.form){this.form.items.each(function(){this.disable()})}},onEnable:function(){Ext.FormPanel.superclass.onEnable.call(this);if(this.form){this.form.items.each(function(){this.enable()})}},bindHandler:function(){var E=true;this.form.items.each(function(F){if(!F.isValid(true)){E=false;return false}});if(this.fbar){var B=this.fbar.items.items;for(var D=0,A=B.length;D<A;D++){var C=B[D];if(C.formBind===true&&C.disabled===E){C.setDisabled(!E)}}}this.fireEvent("clientvalidation",this,E)}});Ext.reg("form",Ext.FormPanel);Ext.form.FormPanel=Ext.FormPanel;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.FieldSet=Ext.extend(Ext.Panel,{baseCls:"x-fieldset",layout:"form",animCollapse:false,onRender:function(B,A){if(!this.el){this.el=document.createElement("fieldset");this.el.id=this.id;if(this.title||this.header||this.checkboxToggle){this.el.appendChild(document.createElement("legend")).className="x-fieldset-header"}}Ext.form.FieldSet.superclass.onRender.call(this,B,A);if(this.checkboxToggle){var C=typeof this.checkboxToggle=="object"?this.checkboxToggle:{tag:"input",type:"checkbox",name:this.checkboxName||this.id+"-checkbox"};this.checkbox=this.header.insertFirst(C);this.checkbox.dom.checked=!this.collapsed;this.mon(this.checkbox,"click",this.onCheckClick,this)}},onCollapse:function(A,B){if(this.checkbox){this.checkbox.dom.checked=false}Ext.form.FieldSet.superclass.onCollapse.call(this,A,B)},onExpand:function(A,B){if(this.checkbox){this.checkbox.dom.checked=true}Ext.form.FieldSet.superclass.onExpand.call(this,A,B)},onCheckClick:function(){this[this.checkbox.dom.checked?"expand":"collapse"]()}});Ext.reg("fieldset",Ext.form.FieldSet);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.HtmlEditor=Ext.extend(Ext.form.Field,{enableFormat:true,enableFontSize:true,enableColors:true,enableAlignments:true,enableLists:true,enableSourceEdit:true,enableLinks:true,enableFont:true,createLinkText:"Please enter the URL for the link:",defaultLinkValue:"http://",fontFamilies:["Arial","Courier New","Tahoma","Times New Roman","Verdana"],defaultFont:"tahoma",defaultValue:(Ext.isOpera||Ext.isIE6)?"&nbsp;":"&#8203;",actionMode:"wrap",validationEvent:false,deferHeight:true,initialized:false,activated:false,sourceEditMode:false,onFocus:Ext.emptyFn,iframePad:3,hideMode:"offsets",defaultAutoCreate:{tag:"textarea",style:"width:500px;height:300px;",autocomplete:"off"},initComponent:function(){this.addEvents("initialize","activate","beforesync","beforepush","sync","push","editmodechange")},createFontOptions:function(){var D=[],B=this.fontFamilies,C,F;for(var E=0,A=B.length;E<A;E++){C=B[E];F=C.toLowerCase();D.push('<option value="',F,'" style="font-family:',C,';"',(this.defaultFont==F?' selected="true">':">"),C,"</option>")}return D.join("")},createToolbar:function(D){var A=Ext.QuickTips&&Ext.QuickTips.isEnabled();function C(G,E,F){return{itemId:G,cls:"x-btn-icon",iconCls:"x-edit-"+G,enableToggle:E!==false,scope:D,handler:F||D.relayBtnCmd,clickEvent:"mousedown",tooltip:A?D.buttonTips[G]||undefined:undefined,overflowText:D.buttonTips[G].title||undefined,tabIndex:-1}}var B=new Ext.Toolbar({renderTo:this.wrap.dom.firstChild});this.mon(B.el,"click",function(E){E.preventDefault()});if(this.enableFont&&!Ext.isSafari2){this.fontSelect=B.el.createChild({tag:"select",cls:"x-font-select",html:this.createFontOptions()});this.mon(this.fontSelect,"change",function(){var E=this.fontSelect.dom.value;this.relayCmd("fontname",E);this.deferFocus()},this);B.add(this.fontSelect.dom,"-")}if(this.enableFormat){B.add(C("bold"),C("italic"),C("underline"))}if(this.enableFontSize){B.add("-",C("increasefontsize",false,this.adjustFont),C("decreasefontsize",false,this.adjustFont))}if(this.enableColors){B.add("-",{itemId:"forecolor",cls:"x-btn-icon",iconCls:"x-edit-forecolor",clickEvent:"mousedown",tooltip:A?D.buttonTips.forecolor||undefined:undefined,tabIndex:-1,menu:new Ext.menu.ColorMenu({allowReselect:true,focus:Ext.emptyFn,value:"000000",plain:true,listeners:{scope:this,select:function(F,E){this.execCmd("forecolor",Ext.isWebKit||Ext.isIE?"#"+E:E);this.deferFocus()}},clickEvent:"mousedown"})},{itemId:"backcolor",cls:"x-btn-icon",iconCls:"x-edit-backcolor",clickEvent:"mousedown",tooltip:A?D.buttonTips.backcolor||undefined:undefined,tabIndex:-1,menu:new Ext.menu.ColorMenu({focus:Ext.emptyFn,value:"FFFFFF",plain:true,allowReselect:true,listeners:{scope:this,select:function(F,E){if(Ext.isGecko){this.execCmd("useCSS",false);this.execCmd("hilitecolor",E);this.execCmd("useCSS",true);this.deferFocus()}else{this.execCmd(Ext.isOpera?"hilitecolor":"backcolor",Ext.isWebKit||Ext.isIE?"#"+E:E);this.deferFocus()}}},clickEvent:"mousedown"})})}if(this.enableAlignments){B.add("-",C("justifyleft"),C("justifycenter"),C("justifyright"))}if(!Ext.isSafari2){if(this.enableLinks){B.add("-",C("createlink",false,this.createLink))}if(this.enableLists){B.add("-",C("insertorderedlist"),C("insertunorderedlist"))}if(this.enableSourceEdit){B.add("-",C("sourceedit",true,function(E){this.toggleSourceEdit(!this.sourceEditMode)}))}}this.tb=B},getDocMarkup:function(){return'<html><head><style type="text/css">body{border:0;margin:0;padding:3px;height:98%;cursor:text;}</style></head><body></body></html>'},getEditorBody:function(){return this.doc.body||this.doc.documentElement},getDoc:function(){return Ext.isIE?this.getWin().document:(this.iframe.contentDocument||this.getWin().document)},getWin:function(){return Ext.isIE?this.iframe.contentWindow:window.frames[this.iframe.name]},onRender:function(B,A){Ext.form.HtmlEditor.superclass.onRender.call(this,B,A);this.el.dom.style.border="0 none";this.el.dom.setAttribute("tabIndex",-1);this.el.addClass("x-hidden");if(Ext.isIE){this.el.applyStyles("margin-top:-1px;margin-bottom:-1px;")}this.wrap=this.el.wrap({cls:"x-html-editor-wrap",cn:{cls:"x-html-editor-tb"}});this.createToolbar(this);this.disableItems(true);this.createIFrame();if(!this.width){var C=this.el.getSize();this.setSize(C.width,this.height||C.height)}},createIFrame:function(){var A=document.createElement("iframe");A.name=Ext.id();A.frameBorder="0";A.src=Ext.isIE?Ext.SSL_SECURE_URL:"javascript:;";this.wrap.dom.appendChild(A);this.iframe=A;this.monitorTask=Ext.TaskMgr.start({run:this.checkDesignMode,scope:this,interval:100})},initFrame:function(){Ext.TaskMgr.stop(this.monitorTask);this.doc=this.getDoc();this.win=this.getWin();this.doc.open();this.doc.write(this.getDocMarkup());this.doc.close();var A={run:function(){if(this.doc.body||this.doc.readyState=="complete"){Ext.TaskMgr.stop(A);this.doc.designMode="on";this.initEditor.defer(10,this)}},interval:10,duration:10000,scope:this};Ext.TaskMgr.start(A)},checkDesignMode:function(){if(this.wrap&&this.wrap.dom.offsetWidth){var A=this.getDoc();if(!A){return }if(!A.editorInitialized||String(A.designMode).toLowerCase()!="on"){this.initFrame()}}},disableItems:function(A){if(this.fontSelect){this.fontSelect.dom.disabled=A}this.tb.items.each(function(B){if(B.itemId!="sourceedit"){B.setDisabled(A)}})},onResize:function(B,C){Ext.form.HtmlEditor.superclass.onResize.apply(this,arguments);if(this.el&&this.iframe){if(typeof B=="number"){var D=B-this.wrap.getFrameWidth("lr");this.el.setWidth(this.adjustWidth("textarea",D));this.tb.setWidth(D);this.iframe.style.width=Math.max(D,0)+"px"}if(typeof C=="number"){var A=C-this.wrap.getFrameWidth("tb")-this.tb.el.getHeight();this.el.setHeight(this.adjustWidth("textarea",A));this.iframe.style.height=Math.max(A,0)+"px";if(this.doc){this.getEditorBody().style.height=Math.max((A-(this.iframePad*2)),0)+"px"}}}},toggleSourceEdit:function(A){if(A===undefined){A=!this.sourceEditMode}this.sourceEditMode=A===true;var C=this.tb.items.get("sourceedit");if(C.pressed!==this.sourceEditMode){C.toggle(this.sourceEditMode);if(!C.xtbHidden){return }}if(this.sourceEditMode){this.disableItems(true);this.syncValue();this.iframe.className="x-hidden";this.el.removeClass("x-hidden");this.el.dom.removeAttribute("tabIndex");this.el.focus()}else{if(this.initialized){this.disableItems(false)}this.pushValue();this.iframe.className="";this.el.addClass("x-hidden");this.el.dom.setAttribute("tabIndex",-1);this.deferFocus()}var B=this.lastSize;if(B){delete this.lastSize;this.setSize(B)}this.fireEvent("editmodechange",this,this.sourceEditMode)},createLink:function(){var A=prompt(this.createLinkText,this.defaultLinkValue);if(A&&A!="http://"){this.relayCmd("createlink",A)}},adjustSize:Ext.BoxComponent.prototype.adjustSize,getResizeEl:function(){return this.wrap},getPositionEl:function(){return this.wrap},initEvents:function(){this.originalValue=this.getValue()},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,setValue:function(A){Ext.form.HtmlEditor.superclass.setValue.call(this,A);this.pushValue();return this},cleanHtml:function(A){A=String(A);if(A.length>5){if(Ext.isWebKit){A=A.replace(/\sclass="(?:Apple-style-span|khtml-block-placeholder)"/gi,"")}}if(A==this.defaultValue){A=""}return A},syncValue:function(){if(this.initialized){var D=this.getEditorBody();var C=D.innerHTML;if(Ext.isWebKit){var B=D.getAttribute("style");var A=B.match(/text-align:(.*?);/i);if(A&&A[1]){C='<div style="'+A[0]+'">'+C+"</div>"}}C=this.cleanHtml(C);if(this.fireEvent("beforesync",this,C)!==false){this.el.dom.value=C;this.fireEvent("sync",this,C)}}},getValue:function(){this[this.sourceEditMode?"pushValue":"syncValue"]();return Ext.form.HtmlEditor.superclass.getValue.call(this)},pushValue:function(){if(this.initialized){var A=this.el.dom.value;if(!this.activated&&A.length<1){A=this.defaultValue}if(this.fireEvent("beforepush",this,A)!==false){this.getEditorBody().innerHTML=A;if(Ext.isGecko){var C=this.doc,B=C.designMode.toLowerCase();C.designMode=B.toggle("on","off");C.designMode=B}this.fireEvent("push",this,A)}}},deferFocus:function(){this.focus.defer(10,this)},focus:function(){if(this.win&&!this.sourceEditMode){this.win.focus()}else{this.el.focus()}},initEditor:function(){try{var B=this.getEditorBody();var A=this.el.getStyles("font-size","font-family","background-image","background-repeat");A["background-attachment"]="fixed";B.bgProperties="fixed";Ext.DomHelper.applyStyles(B,A);if(this.doc){try{Ext.EventManager.removeAll(this.doc)}catch(C){}}this.doc=this.getDoc();Ext.EventManager.on(this.doc,{mousedown:this.onEditorEvent,dblclick:this.onEditorEvent,click:this.onEditorEvent,keyup:this.onEditorEvent,buffer:100,scope:this});if(Ext.isGecko){Ext.EventManager.on(this.doc,"keypress",this.applyCommand,this)}if(Ext.isIE||Ext.isWebKit||Ext.isOpera){Ext.EventManager.on(this.doc,"keydown",this.fixKeys,this)}this.initialized=true;this.fireEvent("initialize",this);this.doc.editorInitialized=true;this.pushValue()}catch(C){}},onDestroy:function(){if(this.monitorTask){Ext.TaskMgr.stop(this.monitorTask)}if(this.rendered){Ext.destroy(this.tb);if(this.wrap){this.wrap.dom.innerHTML="";this.wrap.remove()}}if(this.el){this.el.removeAllListeners();this.el.remove()}if(this.doc){try{Ext.EventManager.removeAll(this.doc);for(var B in this.doc){delete this.doc[B]}}catch(A){}}this.purgeListeners()},onFirstFocus:function(){this.activated=true;this.disableItems(false);if(Ext.isGecko){this.win.focus();var A=this.win.getSelection();if(!A.focusNode||A.focusNode.nodeType!=3){var B=A.getRangeAt(0);B.selectNodeContents(this.getEditorBody());B.collapse(true);this.deferFocus()}try{this.execCmd("useCSS",true);this.execCmd("styleWithCSS",false)}catch(C){}}this.fireEvent("activate",this)},adjustFont:function(B){var C=B.itemId=="increasefontsize"?1:-1;var A=parseInt(this.doc.queryCommandValue("FontSize")||2,10);if((Ext.isSafari&&!Ext.isSafari2)||Ext.isChrome||Ext.isAir){if(A<=10){A=1+C}else{if(A<=13){A=2+C}else{if(A<=16){A=3+C}else{if(A<=18){A=4+C}else{if(A<=24){A=5+C}else{A=6+C}}}}}A=A.constrain(1,6)}else{if(Ext.isSafari){C*=2}A=Math.max(1,A+C)+(Ext.isSafari?"px":0)}this.execCmd("FontSize",A)},onEditorEvent:function(A){this.updateToolbar()},updateToolbar:function(){if(!this.activated){this.onFirstFocus();return }var B=this.tb.items.map,C=this.doc;if(this.enableFont&&!Ext.isSafari2){var A=(this.doc.queryCommandValue("FontName")||this.defaultFont).toLowerCase();if(A!=this.fontSelect.dom.value){this.fontSelect.dom.value=A}}if(this.enableFormat){B.bold.toggle(C.queryCommandState("bold"));B.italic.toggle(C.queryCommandState("italic"));B.underline.toggle(C.queryCommandState("underline"))}if(this.enableAlignments){B.justifyleft.toggle(C.queryCommandState("justifyleft"));B.justifycenter.toggle(C.queryCommandState("justifycenter"));B.justifyright.toggle(C.queryCommandState("justifyright"))}if(!Ext.isSafari2&&this.enableLists){B.insertorderedlist.toggle(C.queryCommandState("insertorderedlist"));B.insertunorderedlist.toggle(C.queryCommandState("insertunorderedlist"))}Ext.menu.MenuMgr.hideAll();this.syncValue()},relayBtnCmd:function(A){this.relayCmd(A.itemId)},relayCmd:function(B,A){(function(){this.focus();this.execCmd(B,A);this.updateToolbar()}).defer(10,this)},execCmd:function(B,A){this.doc.execCommand(B,false,A===undefined?null:A);this.syncValue()},applyCommand:function(B){if(B.ctrlKey){var C=B.getCharCode(),A;if(C>0){C=String.fromCharCode(C);switch(C){case"b":A="bold";break;case"i":A="italic";break;case"u":A="underline";break}if(A){this.win.focus();this.execCmd(A);this.deferFocus();B.preventDefault()}}}},insertAtCursor:function(B){if(!this.activated){return }if(Ext.isIE){this.win.focus();var A=this.doc.selection.createRange();if(A){A.collapse(true);A.pasteHTML(B);this.syncValue();this.deferFocus()}}else{if(Ext.isGecko||Ext.isOpera){this.win.focus();this.execCmd("InsertHTML",B);this.deferFocus()}else{if(Ext.isWebKit){this.execCmd("InsertText",B);this.deferFocus()}}}},fixKeys:function(){if(Ext.isIE){return function(D){var A=D.getKey(),B;if(A==D.TAB){D.stopEvent();B=this.doc.selection.createRange();if(B){B.collapse(true);B.pasteHTML("&nbsp;&nbsp;&nbsp;&nbsp;");this.deferFocus()}}else{if(A==D.ENTER){B=this.doc.selection.createRange();if(B){var C=B.parentElement();if(!C||C.tagName.toLowerCase()!="li"){D.stopEvent();B.pasteHTML("<br />");B.collapse(false);B.select()}}}}}}else{if(Ext.isOpera){return function(B){var A=B.getKey();if(A==B.TAB){B.stopEvent();this.win.focus();this.execCmd("InsertHTML","&nbsp;&nbsp;&nbsp;&nbsp;");this.deferFocus()}}}else{if(Ext.isWebKit){return function(B){var A=B.getKey();if(A==B.TAB){B.stopEvent();this.execCmd("InsertText","\t");this.deferFocus()}}}}}}(),getToolbar:function(){return this.tb},buttonTips:{bold:{title:"Bold (Ctrl+B)",text:"Make the selected text bold.",cls:"x-html-editor-tip"},italic:{title:"Italic (Ctrl+I)",text:"Make the selected text italic.",cls:"x-html-editor-tip"},underline:{title:"Underline (Ctrl+U)",text:"Underline the selected text.",cls:"x-html-editor-tip"},increasefontsize:{title:"Grow Text",text:"Increase the font size.",cls:"x-html-editor-tip"},decreasefontsize:{title:"Shrink Text",text:"Decrease the font size.",cls:"x-html-editor-tip"},backcolor:{title:"Text Highlight Color",text:"Change the background color of the selected text.",cls:"x-html-editor-tip"},forecolor:{title:"Font Color",text:"Change the color of the selected text.",cls:"x-html-editor-tip"},justifyleft:{title:"Align Text Left",text:"Align text to the left.",cls:"x-html-editor-tip"},justifycenter:{title:"Center Text",text:"Center text in the editor.",cls:"x-html-editor-tip"},justifyright:{title:"Align Text Right",text:"Align text to the right.",cls:"x-html-editor-tip"},insertunorderedlist:{title:"Bullet List",text:"Start a bulleted list.",cls:"x-html-editor-tip"},insertorderedlist:{title:"Numbered List",text:"Start a numbered list.",cls:"x-html-editor-tip"},createlink:{title:"Hyperlink",text:"Make the selected text a hyperlink.",cls:"x-html-editor-tip"},sourceedit:{title:"Source Edit",text:"Switch to source editing mode.",cls:"x-html-editor-tip"}}});Ext.reg("htmleditor",Ext.form.HtmlEditor);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.TimeField=Ext.extend(Ext.form.ComboBox,{minValue:null,maxValue:null,minText:"The time in this field must be equal to or after {0}",maxText:"The time in this field must be equal to or before {0}",invalidText:"{0} is not a valid time",format:"g:i A",altFormats:"g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H",increment:15,mode:"local",triggerAction:"all",typeAhead:false,initDate:"1/1/2008",initComponent:function(){if(typeof this.minValue=="string"){this.minValue=this.parseDate(this.minValue)}if(typeof this.maxValue=="string"){this.maxValue=this.parseDate(this.maxValue)}if(!this.store){var B=this.parseDate(this.minValue)||new Date(this.initDate).clearTime();var A=this.parseDate(this.maxValue)||new Date(this.initDate).clearTime().add("mi",(24*60)-1);var C=[];while(B<=A){C.push(B.dateFormat(this.format));B=B.add("mi",this.increment)}this.store=C}Ext.form.TimeField.superclass.initComponent.call(this)},getValue:function(){var A=Ext.form.TimeField.superclass.getValue.call(this);return this.formatDate(this.parseDate(A))||""},setValue:function(A){return Ext.form.TimeField.superclass.setValue.call(this,this.formatDate(this.parseDate(A)))},validateValue:Ext.form.DateField.prototype.validateValue,parseDate:Ext.form.DateField.prototype.parseDate,formatDate:Ext.form.DateField.prototype.formatDate,beforeBlur:function(){var A=this.parseDate(this.getRawValue());if(A){this.setValue(A.dateFormat(this.format))}Ext.form.TimeField.superclass.beforeBlur.call(this)}});Ext.reg("timefield",Ext.form.TimeField);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.Label=Ext.extend(Ext.BoxComponent,{onRender:function(B,A){if(!this.el){this.el=document.createElement("label");this.el.id=this.getId();this.el.innerHTML=this.text?Ext.util.Format.htmlEncode(this.text):(this.html||"");if(this.forId){this.el.setAttribute("for",this.forId)}}Ext.form.Label.superclass.onRender.call(this,B,A)},setText:function(A,B){var C=B===false;this[!C?"text":"html"]=A;delete this[C?"text":"html"];if(this.rendered){this.el.dom.innerHTML=B!==false?Ext.util.Format.htmlEncode(A):A}return this}});Ext.reg("label",Ext.form.Label);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.Action=function(B,A){this.form=B;this.options=A||{}};Ext.form.Action.CLIENT_INVALID="client";Ext.form.Action.SERVER_INVALID="server";Ext.form.Action.CONNECT_FAILURE="connect";Ext.form.Action.LOAD_FAILURE="load";Ext.form.Action.prototype={type:"default",run:function(A){},success:function(A){},handleResponse:function(A){},failure:function(A){this.response=A;this.failureType=Ext.form.Action.CONNECT_FAILURE;this.form.afterAction(this,false)},processResponse:function(A){this.response=A;if(!A.responseText&&!A.responseXML){return true}this.result=this.handleResponse(A);return this.result},getUrl:function(C){var A=this.options.url||this.form.url||this.form.el.dom.action;if(C){var B=this.getParams();if(B){A=Ext.urlAppend(A,B)}}return A},getMethod:function(){return(this.options.method||this.form.method||this.form.el.dom.method||"POST").toUpperCase()},getParams:function(){var A=this.form.baseParams;var B=this.options.params;if(B){if(typeof B=="object"){B=Ext.urlEncode(Ext.applyIf(B,A))}else{if(typeof B=="string"&&A){B+="&"+Ext.urlEncode(A)}}}else{if(A){B=Ext.urlEncode(A)}}return B},createCallback:function(A){var A=A||{};return{success:this.success,failure:this.failure,scope:this,timeout:(A.timeout*1000)||(this.form.timeout*1000),upload:this.form.fileUpload?this.success:undefined}}};Ext.form.Action.Submit=function(B,A){Ext.form.Action.Submit.superclass.constructor.call(this,B,A)};Ext.extend(Ext.form.Action.Submit,Ext.form.Action,{type:"submit",run:function(){var B=this.options;var C=this.getMethod();var A=C=="GET";if(B.clientValidation===false||this.form.isValid()){Ext.Ajax.request(Ext.apply(this.createCallback(B),{form:this.form.el.dom,url:this.getUrl(A),method:C,headers:B.headers,params:!A?this.getParams():null,isUpload:this.form.fileUpload}))}else{if(B.clientValidation!==false){this.failureType=Ext.form.Action.CLIENT_INVALID;this.form.afterAction(this,false)}}},success:function(B){var A=this.processResponse(B);if(A===true||A.success){this.form.afterAction(this,true);return }if(A.errors){this.form.markInvalid(A.errors);this.failureType=Ext.form.Action.SERVER_INVALID}this.form.afterAction(this,false)},handleResponse:function(C){if(this.form.errorReader){var B=this.form.errorReader.read(C);var F=[];if(B.records){for(var D=0,A=B.records.length;D<A;D++){var E=B.records[D];F[D]=E.data}}if(F.length<1){F=null}return{success:B.success,errors:F}}return Ext.decode(C.responseText)}});Ext.form.Action.Load=function(B,A){Ext.form.Action.Load.superclass.constructor.call(this,B,A);this.reader=this.form.reader};Ext.extend(Ext.form.Action.Load,Ext.form.Action,{type:"load",run:function(){Ext.Ajax.request(Ext.apply(this.createCallback(this.options),{method:this.getMethod(),url:this.getUrl(false),headers:this.options.headers,params:this.getParams()}))},success:function(B){var A=this.processResponse(B);if(A===true||!A.success||!A.data){this.failureType=Ext.form.Action.LOAD_FAILURE;this.form.afterAction(this,false);return }this.form.clearInvalid();this.form.setValues(A.data);this.form.afterAction(this,true)},handleResponse:function(B){if(this.form.reader){var A=this.form.reader.read(B);var C=A.records&&A.records[0]?A.records[0].data:null;return{success:A.success,data:C}}return Ext.decode(B.responseText)}});Ext.form.Action.DirectLoad=Ext.extend(Ext.form.Action.Load,{constructor:function(B,A){Ext.form.Action.DirectLoad.superclass.constructor.call(this,B,A)},type:"directload",run:function(){var A=this.getParams();A.push(this.success,this);this.form.api.load.apply(window,A)},getParams:function(){var C=[],G={};var E=this.form.baseParams;var F=this.options.params;Ext.apply(G,F,E);var B=this.form.paramOrder;if(B){for(var D=0,A=B.length;D<A;D++){C.push(G[B[D]])}}else{if(this.form.paramsAsHash){C.push(G)}}return C},processResponse:function(A){this.result=A;return A}});Ext.form.Action.DirectSubmit=Ext.extend(Ext.form.Action.Submit,{constructor:function(B,A){Ext.form.Action.DirectSubmit.superclass.constructor.call(this,B,A)},type:"directsubmit",run:function(){var A=this.options;if(A.clientValidation===false||this.form.isValid()){this.success.params=this.getParams();this.form.api.submit(this.form.el.dom,this.success,this)}else{if(A.clientValidation!==false){this.failureType=Ext.form.Action.CLIENT_INVALID;this.form.afterAction(this,false)}}},getParams:function(){var C={};var A=this.form.baseParams;var B=this.options.params;Ext.apply(C,B,A);return C},processResponse:function(A){this.result=A;return A}});Ext.form.Action.ACTION_TYPES={load:Ext.form.Action.Load,submit:Ext.form.Action.Submit,directload:Ext.form.Action.DirectLoad,directsubmit:Ext.form.Action.DirectSubmit};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.form.VTypes=function(){var C=/^[a-zA-Z_]+$/;var D=/^[a-zA-Z0-9_]+$/;var B=/^(\w+)([-+.][\w]+)*@(\w[-\w]*\.){1,5}([A-Za-z]){2,4}$/;var A=/(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;return{email:function(E){return B.test(E)},emailText:'This field should be an e-mail address in the format "user@example.com"',emailMask:/[a-z0-9_\.\-@]/i,url:function(E){return A.test(E)},urlText:'This field should be a URL in the format "http://www.example.com"',alpha:function(E){return C.test(E)},alphaText:"This field should only contain letters and _",alphaMask:/[a-z_]/i,alphanum:function(E){return D.test(E)},alphanumText:"This field should only contain letters, numbers and _",alphanumMask:/[a-z0-9_]/i}}();
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.GridPanel=Ext.extend(Ext.Panel,{autoExpandColumn:false,autoExpandMax:1000,autoExpandMin:50,columnLines:false,ddText:"{0} selected row{1}",deferRowRender:true,enableColumnHide:true,enableColumnMove:true,enableDragDrop:false,enableHdMenu:true,loadMask:false,minColumnWidth:25,stripeRows:false,trackMouseOver:true,stateEvents:["columnmove","columnresize","sortchange"],view:null,rendered:false,viewReady:false,initComponent:function(){Ext.grid.GridPanel.superclass.initComponent.call(this);if(this.columnLines){this.cls=(this.cls||"")+" x-grid-with-col-lines"}this.autoScroll=false;this.autoWidth=false;if(Ext.isArray(this.columns)){this.colModel=new Ext.grid.ColumnModel(this.columns);delete this.columns}if(this.ds){this.store=this.ds;delete this.ds}if(this.cm){this.colModel=this.cm;delete this.cm}if(this.sm){this.selModel=this.sm;delete this.sm}this.store=Ext.StoreMgr.lookup(this.store);this.addEvents("click","dblclick","contextmenu","mousedown","mouseup","mouseover","mouseout","keypress","keydown","cellmousedown","rowmousedown","headermousedown","cellclick","celldblclick","rowclick","rowdblclick","headerclick","headerdblclick","rowcontextmenu","cellcontextmenu","headercontextmenu","bodyscroll","columnresize","columnmove","sortchange","reconfigure")},onRender:function(C,A){Ext.grid.GridPanel.superclass.onRender.apply(this,arguments);var D=this.body;this.el.addClass("x-grid-panel");var B=this.getView();B.init(this);this.mon(D,{mousedown:this.onMouseDown,click:this.onClick,dblclick:this.onDblClick,contextmenu:this.onContextMenu,keydown:this.onKeyDown,scope:this});this.relayEvents(D,["mousedown","mouseup","mouseover","mouseout","keypress"]);this.getSelectionModel().init(this);this.view.render()},initEvents:function(){Ext.grid.GridPanel.superclass.initEvents.call(this);if(this.loadMask){this.loadMask=new Ext.LoadMask(this.bwrap,Ext.apply({store:this.store},this.loadMask))}},initStateEvents:function(){Ext.grid.GridPanel.superclass.initStateEvents.call(this);this.mon(this.colModel,"hiddenchange",this.saveState,this,{delay:100})},applyState:function(F){var B=this.colModel;var E=F.columns;if(E){for(var C=0,A=E.length;C<A;C++){var D=E[C];var H=B.getColumnById(D.id);if(H){H.hidden=D.hidden;H.width=D.width;var G=B.getIndexById(D.id);if(G!=C){B.moveColumn(G,C)}}}}if(F.sort&&this.store){this.store[this.store.remoteSort?"setDefaultSort":"sort"](F.sort.field,F.sort.direction)}delete F.columns;delete F.sort;Ext.grid.GridPanel.superclass.applyState.call(this,F)},getState:function(){var C={columns:[]};for(var B=0,D;(D=this.colModel.config[B]);B++){C.columns[B]={id:D.id,width:D.width};if(D.hidden){C.columns[B].hidden=true}}if(this.store){var A=this.store.getSortState();if(A){C.sort=A}}return C},afterRender:function(){Ext.grid.GridPanel.superclass.afterRender.call(this);this.view.layout();if(this.deferRowRender){this.view.afterRender.defer(10,this.view)}else{this.view.afterRender()}this.viewReady=true},reconfigure:function(A,B){if(this.loadMask){this.loadMask.destroy();this.loadMask=new Ext.LoadMask(this.bwrap,Ext.apply({},{store:A},this.initialConfig.loadMask))}this.view.initData(A,B);this.store=A;this.colModel=B;if(this.rendered){this.view.refresh(true)}this.fireEvent("reconfigure",this,A,B)},onKeyDown:function(A){this.fireEvent("keydown",A)},onDestroy:function(){if(this.rendered){var A=this.body;A.removeAllListeners();A.update("");Ext.destroy(this.view,this.loadMask)}else{if(this.store&&this.store.autoDestroy){this.store.destroy()}}Ext.destroy(this.colModel,this.selModel);this.store=this.selModel=this.colModel=this.view=this.loadMask=null;Ext.grid.GridPanel.superclass.onDestroy.call(this)},processEvent:function(C,E){this.fireEvent(C,E);var D=E.getTarget();var B=this.view;var G=B.findHeaderIndex(D);if(G!==false){this.fireEvent("header"+C,this,G,E)}else{var F=B.findRowIndex(D);var A=B.findCellIndex(D);if(F!==false){this.fireEvent("row"+C,this,F,E);if(A!==false){this.fireEvent("cell"+C,this,F,A,E)}}}},onClick:function(A){this.processEvent("click",A)},onMouseDown:function(A){this.processEvent("mousedown",A)},onContextMenu:function(B,A){this.processEvent("contextmenu",B)},onDblClick:function(A){this.processEvent("dblclick",A)},walkCells:function(J,C,B,E,I){var H=this.colModel,F=H.getColumnCount();var A=this.store,G=A.getCount(),D=true;if(B<0){if(C<0){J--;D=false}while(J>=0){if(!D){C=F-1}D=false;while(C>=0){if(E.call(I||this,J,C,H)===true){return[J,C]}C--}J--}}else{if(C>=F){J++;D=false}while(J<G){if(!D){C=0}D=false;while(C<F){if(E.call(I||this,J,C,H)===true){return[J,C]}C++}J++}}return null},onResize:function(){Ext.grid.GridPanel.superclass.onResize.apply(this,arguments);if(this.viewReady){this.view.layout()}},getGridEl:function(){return this.body},stopEditing:Ext.emptyFn,getSelectionModel:function(){if(!this.selModel){this.selModel=new Ext.grid.RowSelectionModel(this.disableSelection?{selectRow:Ext.emptyFn}:null)}return this.selModel},getStore:function(){return this.store},getColumnModel:function(){return this.colModel},getView:function(){if(!this.view){this.view=new Ext.grid.GridView(this.viewConfig)}return this.view},getDragDropText:function(){var A=this.selModel.getCount();return String.format(this.ddText,A,A==1?"":"s")}});Ext.reg("grid",Ext.grid.GridPanel);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.GridView=function(A){Ext.apply(this,A);this.addEvents("beforerowremoved","beforerowsinserted","beforerefresh","rowremoved","rowsinserted","rowupdated","refresh");Ext.grid.GridView.superclass.constructor.call(this)};Ext.extend(Ext.grid.GridView,Ext.util.Observable,{deferEmptyText:true,scrollOffset:19,autoFill:false,forceFit:false,sortClasses:["sort-asc","sort-desc"],sortAscText:"Sort Ascending",sortDescText:"Sort Descending",columnsText:"Columns",selectedRowClass:"x-grid3-row-selected",borderWidth:2,tdClass:"x-grid3-cell",hdCls:"x-grid3-hd",markDirty:true,cellSelectorDepth:4,rowSelectorDepth:10,cellSelector:"td.x-grid3-cell",rowSelector:"div.x-grid3-row",firstRowCls:"x-grid3-row-first",lastRowCls:"x-grid3-row-last",rowClsRe:/(?:^|\s+)x-grid3-row-(first|last|alt)(?:\s+|$)/g,initTemplates:function(){var C=this.templates||{};if(!C.master){C.master=new Ext.Template('<div class="x-grid3" hidefocus="true">','<div class="x-grid3-viewport">','<div class="x-grid3-header"><div class="x-grid3-header-inner"><div class="x-grid3-header-offset" style="{ostyle}">{header}</div></div><div class="x-clear"></div></div>','<div class="x-grid3-scroller"><div class="x-grid3-body" style="{bstyle}">{body}</div><a href="#" class="x-grid3-focus" tabIndex="-1"></a></div>',"</div>",'<div class="x-grid3-resize-marker">&#160;</div>','<div class="x-grid3-resize-proxy">&#160;</div>',"</div>")}if(!C.header){C.header=new Ext.Template('<table border="0" cellspacing="0" cellpadding="0" style="{tstyle}">','<thead><tr class="x-grid3-hd-row">{cells}</tr></thead>',"</table>")}if(!C.hcell){C.hcell=new Ext.Template('<td class="x-grid3-hd x-grid3-cell x-grid3-td-{id} {css}" style="{style}"><div {tooltip} {attr} class="x-grid3-hd-inner x-grid3-hd-{id}" unselectable="on" style="{istyle}">',this.grid.enableHdMenu?'<a class="x-grid3-hd-btn" href="#"></a>':"",'{value}<img class="x-grid3-sort-icon" src="',Ext.BLANK_IMAGE_URL,'" />',"</div></td>")}if(!C.body){C.body=new Ext.Template("{rows}")}if(!C.row){C.row=new Ext.Template('<div class="x-grid3-row {alt}" style="{tstyle}"><table class="x-grid3-row-table" border="0" cellspacing="0" cellpadding="0" style="{tstyle}">',"<tbody><tr>{cells}</tr>",(this.enableRowBody?'<tr class="x-grid3-row-body-tr" style="{bodyStyle}"><td colspan="{cols}" class="x-grid3-body-cell" tabIndex="0" hidefocus="on"><div class="x-grid3-row-body">{body}</div></td></tr>':""),"</tbody></table></div>")}if(!C.cell){C.cell=new Ext.Template('<td class="x-grid3-col x-grid3-cell x-grid3-td-{id} {css}" style="{style}" tabIndex="0" {cellAttr}>','<div class="x-grid3-cell-inner x-grid3-col-{id}" unselectable="on" {attr}>{value}</div>',"</td>")}for(var A in C){var B=C[A];if(B&&typeof B.compile=="function"&&!B.compiled){B.disableFormats=true;B.compile()}}this.templates=C;this.colRe=new RegExp("x-grid3-td-([^\\s]+)","")},fly:function(A){if(!this._flyweight){this._flyweight=new Ext.Element.Flyweight(document.body)}this._flyweight.dom=A;return this._flyweight},getEditorParent:function(){return this.scroller.dom},initElements:function(){var C=Ext.Element;var B=this.grid.getGridEl().dom.firstChild;var A=B.childNodes;this.el=new C(B);this.mainWrap=new C(A[0]);this.mainHd=new C(this.mainWrap.dom.firstChild);if(this.grid.hideHeaders){this.mainHd.setDisplayed(false)}this.innerHd=this.mainHd.dom.firstChild;this.scroller=new C(this.mainWrap.dom.childNodes[1]);if(this.forceFit){this.scroller.setStyle("overflow-x","hidden")}this.mainBody=new C(this.scroller.dom.firstChild);this.focusEl=new C(this.scroller.dom.childNodes[1]);this.focusEl.swallowEvent("click",true);this.resizeMarker=new C(A[1]);this.resizeProxy=new C(A[2])},getRows:function(){return this.hasRows()?this.mainBody.dom.childNodes:[]},findCell:function(A){if(!A){return false}return this.fly(A).findParent(this.cellSelector,this.cellSelectorDepth)},findCellIndex:function(C,B){var A=this.findCell(C);if(A&&(!B||this.fly(A).hasClass(B))){return this.getCellIndex(A)}return false},getCellIndex:function(B){if(B){var A=B.className.match(this.colRe);if(A&&A[1]){return this.cm.getIndexById(A[1])}}return false},findHeaderCell:function(B){var A=this.findCell(B);return A&&this.fly(A).hasClass(this.hdCls)?A:null},findHeaderIndex:function(A){return this.findCellIndex(A,this.hdCls)},findRow:function(A){if(!A){return false}return this.fly(A).findParent(this.rowSelector,this.rowSelectorDepth)},findRowIndex:function(A){var B=this.findRow(A);return B?B.rowIndex:false},getRow:function(A){return this.getRows()[A]},getCell:function(B,A){return this.getRow(B).getElementsByTagName("td")[A]},getHeaderCell:function(A){return this.mainHd.dom.getElementsByTagName("td")[A]},addRowClass:function(C,A){var B=this.getRow(C);if(B){this.fly(B).addClass(A)}},removeRowClass:function(C,A){var B=this.getRow(C);if(B){this.fly(B).removeClass(A)}},removeRow:function(A){Ext.removeNode(this.getRow(A));this.syncFocusEl(A)},removeRows:function(C,A){var B=this.mainBody.dom;for(var D=C;D<=A;D++){Ext.removeNode(B.childNodes[C])}this.syncFocusEl(C)},getScrollState:function(){var A=this.scroller.dom;return{left:A.scrollLeft,top:A.scrollTop}},restoreScroll:function(A){var B=this.scroller.dom;B.scrollLeft=A.left;B.scrollTop=A.top},scrollToTop:function(){this.scroller.dom.scrollTop=0;this.scroller.dom.scrollLeft=0},syncScroll:function(){this.syncHeaderScroll();var A=this.scroller.dom;this.grid.fireEvent("bodyscroll",A.scrollLeft,A.scrollTop)},syncHeaderScroll:function(){var A=this.scroller.dom;this.innerHd.scrollLeft=A.scrollLeft;this.innerHd.scrollLeft=A.scrollLeft},updateSortIcon:function(B,A){var D=this.sortClasses;var C=this.mainHd.select("td").removeClass(D);C.item(B).addClass(D[A=="DESC"?1:0])},updateAllColumnWidths:function(){var D=this.getTotalWidth(),I=this.cm.getColumnCount(),F=[],E,B;for(B=0;B<I;B++){F[B]=this.getColumnWidth(B)}this.innerHd.firstChild.style.width=this.getOffsetWidth();this.innerHd.firstChild.firstChild.style.width=D;this.mainBody.dom.style.width=D;for(B=0;B<I;B++){var C=this.getHeaderCell(B);C.style.width=F[B]}var H=this.getRows(),J,G;for(B=0,E=H.length;B<E;B++){J=H[B];J.style.width=D;if(J.firstChild){J.firstChild.style.width=D;G=J.firstChild.rows[0];for(var A=0;A<I;A++){G.childNodes[A].style.width=F[A]}}}this.onAllColumnWidthsUpdated(F,D)},updateColumnWidth:function(B,A){var H=this.getColumnWidth(B);var E=this.getTotalWidth();this.innerHd.firstChild.style.width=this.getOffsetWidth();this.innerHd.firstChild.firstChild.style.width=E;this.mainBody.dom.style.width=E;var D=this.getHeaderCell(B);D.style.width=H;var G=this.getRows(),I;for(var C=0,F=G.length;C<F;C++){I=G[C];I.style.width=E;if(I.firstChild){I.firstChild.style.width=E;I.firstChild.rows[0].childNodes[B].style.width=H}}this.onColumnWidthUpdated(B,H,E)},updateColumnHidden:function(A,E){var D=this.getTotalWidth();this.innerHd.firstChild.style.width=this.getOffsetWidth();this.innerHd.firstChild.firstChild.style.width=D;this.mainBody.dom.style.width=D;var G=E?"none":"";var C=this.getHeaderCell(A);C.style.display=G;var H=this.getRows(),I;for(var B=0,F=H.length;B<F;B++){I=H[B];I.style.width=D;if(I.firstChild){I.firstChild.style.width=D;I.firstChild.rows[0].childNodes[A].style.display=G}}this.onColumnHiddenUpdated(A,E,D);delete this.lastViewWidth;this.layout()},doRender:function(E,G,M,A,L,Q){var B=this.templates,D=B.cell,F=B.row,H=L-1;var C="width:"+this.getTotalWidth()+";";var T=[],N,U,O={},I={tstyle:C},K;for(var P=0,S=G.length;P<S;P++){K=G[P];N=[];var J=(P+A);for(var R=0;R<L;R++){U=E[R];O.id=U.id;O.css=R===0?"x-grid3-cell-first ":(R==H?"x-grid3-cell-last ":"");O.attr=O.cellAttr="";O.value=U.renderer(K.data[U.name],O,K,J,R,M);O.style=U.style;if(Ext.isEmpty(O.value)){O.value="&#160;"}if(this.markDirty&&K.dirty&&typeof K.modified[U.name]!=="undefined"){O.css+=" x-grid3-dirty-cell"}N[N.length]=D.apply(O)}var V=[];if(Q&&((J+1)%2===0)){V[0]="x-grid3-row-alt"}if(K.dirty){V[1]=" x-grid3-dirty-row"}I.cols=L;if(this.getRowClass){V[2]=this.getRowClass(K,J,I,M)}I.alt=V.join(" ");I.cells=N.join("");T[T.length]=F.apply(I)}return T.join("")},processRows:function(A,C){if(!this.ds||this.ds.getCount()<1){return }var B=this.getRows();C=C||!this.grid.stripeRows;A=A||0;Ext.each(B,function(E,D){E.rowIndex=D;E.className=E.className.replace(this.rowClsRe," ");if(!C&&(D+1)%2===0){E.className+=" x-grid3-row-alt"}});if(A===0){Ext.fly(B[0]).addClass(this.firstRowCls)}Ext.fly(B[B.length-1]).addClass(this.lastRowCls)},afterRender:function(){if(!this.ds||!this.cm){return }this.mainBody.dom.innerHTML=this.renderRows()||"&#160;";this.processRows(0,true);if(this.deferEmptyText!==true){this.applyEmptyText()}},renderUI:function(){var D=this.renderHeaders();var A=this.templates.body.apply({rows:"&#160;"});var B=this.templates.master.apply({body:A,header:D,ostyle:"width:"+this.getOffsetWidth()+";",bstyle:"width:"+this.getTotalWidth()+";"});var C=this.grid;C.getGridEl().dom.innerHTML=B;this.initElements();Ext.fly(this.innerHd).on("click",this.handleHdDown,this);this.mainHd.on({scope:this,mouseover:this.handleHdOver,mouseout:this.handleHdOut,mousemove:this.handleHdMove});this.scroller.on("scroll",this.syncScroll,this);if(C.enableColumnResize!==false){this.splitZone=new Ext.grid.GridView.SplitDragZone(C,this.mainHd.dom)}if(C.enableColumnMove){this.columnDrag=new Ext.grid.GridView.ColumnDragZone(C,this.innerHd);this.columnDrop=new Ext.grid.HeaderDropZone(C,this.mainHd.dom)}if(C.enableHdMenu!==false){this.hmenu=new Ext.menu.Menu({id:C.id+"-hctx"});this.hmenu.add({itemId:"asc",text:this.sortAscText,cls:"xg-hmenu-sort-asc"},{itemId:"desc",text:this.sortDescText,cls:"xg-hmenu-sort-desc"});if(C.enableColumnHide!==false){this.colMenu=new Ext.menu.Menu({id:C.id+"-hcols-menu"});this.colMenu.on({scope:this,beforeshow:this.beforeColMenuShow,itemclick:this.handleHdMenuClick});this.hmenu.add("-",{itemId:"columns",hideOnClick:false,text:this.columnsText,menu:this.colMenu,iconCls:"x-cols-icon"})}this.hmenu.on("itemclick",this.handleHdMenuClick,this)}if(C.trackMouseOver){this.mainBody.on({scope:this,mouseover:this.onRowOver,mouseout:this.onRowOut})}if(C.enableDragDrop||C.enableDrag){this.dragZone=new Ext.grid.GridDragZone(C,{ddGroup:C.ddGroup||"GridDD"})}this.updateHeaderSortState()},layout:function(){if(!this.mainBody){return }var C=this.grid;var F=C.getGridEl();var A=F.getSize(true);var B=A.width;if(!C.hideHeaders&&(B<20||A.height<20)){return }if(C.autoHeight){this.scroller.dom.style.overflow="visible";if(Ext.isWebKit){this.scroller.dom.style.position="static"}}else{this.el.setSize(A.width,A.height);var E=this.mainHd.getHeight();var D=A.height-(E);this.scroller.setSize(B,D);if(this.innerHd){this.innerHd.style.width=(B)+"px"}}if(this.forceFit){if(this.lastViewWidth!=B){this.fitColumns(false,false);this.lastViewWidth=B}}else{this.autoExpand();this.syncHeaderScroll()}this.onLayout(B,D)},onLayout:function(A,B){},onColumnWidthUpdated:function(C,A,B){},onAllColumnWidthsUpdated:function(A,B){},onColumnHiddenUpdated:function(B,C,A){},updateColumnText:function(A,B){},afterMove:function(A){},init:function(A){this.grid=A;this.initTemplates();this.initData(A.store,A.colModel);this.initUI(A)},getColumnId:function(A){return this.cm.getColumnId(A)},getOffsetWidth:function(){return(this.cm.getTotalWidth()+this.scrollOffset)+"px"},renderHeaders:function(){var C=this.cm,G=this.templates,E=G.hcell,B=[],H={},A=C.getColumnCount(),F=A-1;for(var D=0;D<A;D++){H.id=C.getColumnId(D);H.value=C.getColumnHeader(D)||"";H.style=this.getColumnStyle(D,true);H.tooltip=this.getColumnTooltip(D);H.css=D===0?"x-grid3-cell-first ":(D==F?"x-grid3-cell-last ":"");if(C.config[D].align=="right"){H.istyle="padding-right:16px"}else{delete H.istyle}B[B.length]=E.apply(H)}return G.header.apply({cells:B.join(""),tstyle:"width:"+this.getTotalWidth()+";"})},getColumnTooltip:function(A){var B=this.cm.getColumnTooltip(A);if(B){if(Ext.QuickTips.isEnabled()){return'ext:qtip="'+B+'"'}else{return'title="'+B+'"'}}return""},beforeUpdate:function(){this.grid.stopEditing(true)},updateHeaders:function(){this.innerHd.firstChild.innerHTML=this.renderHeaders();this.innerHd.firstChild.style.width=this.getOffsetWidth();this.innerHd.firstChild.firstChild.style.width=this.getTotalWidth()},focusRow:function(A){this.focusCell(A,0,false)},focusCell:function(C,A,B){this.syncFocusEl(this.ensureVisible(C,A,B));if(Ext.isGecko){this.focusEl.focus()}else{this.focusEl.focus.defer(1,this.focusEl)}},resolveCell:function(G,D,F){if(typeof G!="number"){G=G.rowIndex}if(!this.ds){return null}if(G<0||G>=this.ds.getCount()){return null}D=(D!==undefined?D:0);var C=this.getRow(G),A=this.cm,E=A.getColumnCount(),B;if(!(F===false&&D===0)){while(D<E&&A.isHidden(D)){D++}B=this.getCell(G,D)}return{row:C,cell:B}},getResolvedXY:function(A){if(!A){return null}var B=this.scroller.dom,D=A.cell,C=A.row;return D?Ext.fly(D).getXY():[this.el.getX(),Ext.fly(C).getY()]},syncFocusEl:function(D,A,C){var B=D;if(!Ext.isArray(B)){D=Math.min(D,Math.max(0,this.getRows().length-1));B=this.getResolvedXY(this.resolveCell(D,A,C))}this.focusEl.setXY(B||this.scroller.getXY())},ensureVisible:function(Q,E,D){var O=this.resolveCell(Q,E,D);if(!O||!O.row){return }var I=O.row,F=O.cell,L=this.scroller.dom,P=0,C=I,M=this.el.dom;while(C&&C!=M){P+=C.offsetTop;C=C.offsetParent}P-=this.mainHd.dom.offsetHeight;var N=P+I.offsetHeight,A=L.clientHeight,K=M+A;M=parseInt(L.scrollTop,10);if(P<M){L.scrollTop=P}else{if(N>K){L.scrollTop=N-A}}if(D!==false){var J=parseInt(F.offsetLeft,10);var H=J+F.offsetWidth;var G=parseInt(L.scrollLeft,10);var B=G+L.clientWidth;if(J<G){L.scrollLeft=J}else{if(H>B){L.scrollLeft=H-L.clientWidth}}}return this.getResolvedXY(O)},insertRows:function(A,H,E,G){var D=A.getCount()-1;if(!G&&H===0&&E>=D){this.refresh()}else{if(!G){this.fireEvent("beforerowsinserted",this,H,E)}var B=this.renderRows(H,E),F=this.getRow(H);if(F){if(H===0){Ext.fly(this.getRow(0)).removeClass(this.firstRowCls)}Ext.DomHelper.insertHtml("beforeBegin",F,B)}else{var C=this.getRow(D-1);if(C){Ext.fly(C).removeClass(this.lastRowCls)}Ext.DomHelper.insertHtml("beforeEnd",this.mainBody.dom,B)}if(!G){this.fireEvent("rowsinserted",this,H,E);this.processRows(H)}else{if(H===0||H>=D){Ext.fly(this.getRow(H)).addClass(H===0?this.firstRowCls:this.lastRowCls)}}}this.syncFocusEl(H)},deleteRows:function(A,C,B){if(A.getRowCount()<1){this.refresh()}else{this.fireEvent("beforerowsdeleted",this,C,B);this.removeRows(C,B);this.processRows(C);this.fireEvent("rowsdeleted",this,C,B)}},getColumnStyle:function(A,C){var B=!C?(this.cm.config[A].css||""):"";B+="width:"+this.getColumnWidth(A)+";";if(this.cm.isHidden(A)){B+="display:none;"}var D=this.cm.config[A].align;if(D){B+="text-align:"+D+";"}return B},getColumnWidth:function(B){var A=this.cm.getColumnWidth(B);if(typeof A=="number"){return(Ext.isBorderBox?A:(A-this.borderWidth>0?A-this.borderWidth:0))+"px"}return A},getTotalWidth:function(){return this.cm.getTotalWidth()+"px"},fitColumns:function(D,G,H){var O=this.cm,I;var J=O.getTotalWidth(false);var A=this.grid.getGridEl().getWidth(true)-this.scrollOffset;if(A<20){return }var E=A-J;if(E===0){return false}var K=O.getColumnCount(true);var Q=K-(typeof H=="number"?1:0);if(Q===0){Q=1;H=undefined}var P=O.getColumnCount();var M=[];var L=0;var C=0;var N;for(I=0;I<P;I++){if(!O.isHidden(I)&&!O.isFixed(I)&&I!==H){N=O.getColumnWidth(I);M.push(I);L=I;M.push(N);C+=N}}var B=(A-O.getTotalWidth())/C;while(M.length){N=M.pop();I=M.pop();O.setColumnWidth(I,Math.max(this.grid.minColumnWidth,Math.floor(N+N*B)),true)}if((J=O.getTotalWidth(false))>A){var F=Q!=K?H:L;O.setColumnWidth(F,Math.max(1,O.getColumnWidth(F)-(J-A)),true)}if(D!==true){this.updateAllColumnWidths()}return true},autoExpand:function(B){var G=this.grid,A=this.cm;if(!this.userResized&&G.autoExpandColumn){var D=A.getTotalWidth(false);var H=this.grid.getGridEl().getWidth(true)-this.scrollOffset;if(D!=H){var F=A.getIndexById(G.autoExpandColumn);var E=A.getColumnWidth(F);var C=Math.min(Math.max(((H-D)+E),G.autoExpandMin),G.autoExpandMax);if(C!=E){A.setColumnWidth(F,C,true);if(B!==true){this.updateColumnWidth(F,C)}}}}},getColumnData:function(){var D=[],A=this.cm,E=A.getColumnCount();for(var C=0;C<E;C++){var B=A.getDataIndex(C);D[C]={name:(typeof B=="undefined"?this.ds.fields.get(C).name:B),renderer:A.getRenderer(C),id:A.getColumnId(C),style:this.getColumnStyle(C)}}return D},renderRows:function(H,C){var D=this.grid,F=D.colModel,A=D.store,I=D.stripeRows;var G=F.getColumnCount();if(A.getCount()<1){return""}var E=this.getColumnData();H=H||0;C=typeof C=="undefined"?A.getCount()-1:C;var B=A.getRange(H,C);return this.doRender(E,B,A,H,G,I)},renderBody:function(){var A=this.renderRows()||"&#160;";return this.templates.body.apply({rows:A})},refreshRow:function(A){var C=this.ds,B;if(typeof A=="number"){B=A;A=C.getAt(B);if(!A){return }}else{B=C.indexOf(A);if(B<0){return }}this.insertRows(C,B,B,true);this.getRow(B).rowIndex=B;this.onRemove(C,A,B+1,true);this.fireEvent("rowupdated",this,B,A)},refresh:function(B){this.fireEvent("beforerefresh",this);this.grid.stopEditing(true);var A=this.renderBody();this.mainBody.update(A).setWidth(this.getTotalWidth());if(B===true){this.updateHeaders();this.updateHeaderSortState()}this.processRows(0,true);this.layout();this.applyEmptyText();this.fireEvent("refresh",this)},applyEmptyText:function(){if(this.emptyText&&!this.hasRows()){this.mainBody.update('<div class="x-grid-empty">'+this.emptyText+"</div>")}},updateHeaderSortState:function(){var B=this.ds.getSortState();if(!B){return }if(!this.sortState||(this.sortState.field!=B.field||this.sortState.direction!=B.direction)){this.grid.fireEvent("sortchange",this.grid,B)}this.sortState=B;var C=this.cm.findColumnIndex(B.field);if(C!=-1){var A=B.direction;this.updateSortIcon(C,A)}},destroy:function(){if(this.colMenu){Ext.menu.MenuMgr.unregister(this.colMenu);this.colMenu.destroy();delete this.colMenu}if(this.hmenu){Ext.menu.MenuMgr.unregister(this.hmenu);this.hmenu.destroy();delete this.hmenu}if(this.grid.enableColumnMove){var C=Ext.dd.DDM.ids["gridHeader"+this.grid.getGridEl().id];if(C){for(var A in C){if(!C[A].config.isTarget&&C[A].dragElId){var B=C[A].dragElId;C[A].unreg();Ext.get(B).remove()}else{if(C[A].config.isTarget){C[A].proxyTop.remove();C[A].proxyBottom.remove();C[A].unreg()}}if(Ext.dd.DDM.locationCache[A]){delete Ext.dd.DDM.locationCache[A]}}delete Ext.dd.DDM.ids["gridHeader"+this.grid.getGridEl().id]}}if(this.dragZone){this.dragZone.unreg()}Ext.fly(this.innerHd).removeAllListeners();Ext.removeNode(this.innerHd);Ext.destroy(this.resizeMarker,this.resizeProxy,this.focusEl,this.mainBody,this.scroller,this.mainHd,this.mainWrap,this.dragZone,this.splitZone,this.columnDrag,this.columnDrop);this.initData(null,null);Ext.EventManager.removeResizeListener(this.onWindowResize,this);this.purgeListeners()},onDenyColumnHide:function(){},render:function(){if(this.autoFill){var A=this.grid.ownerCt;if(A&&A.getLayout()){A.on("afterlayout",function(){this.fitColumns(true,true);this.updateHeaders()},this,{single:true})}else{this.fitColumns(true,true)}}else{if(this.forceFit){this.fitColumns(true,false)}else{if(this.grid.autoExpandColumn){this.autoExpand(true)}}}this.renderUI()},initData:function(B,A){if(this.ds){this.ds.un("load",this.onLoad,this);this.ds.un("datachanged",this.onDataChange,this);this.ds.un("add",this.onAdd,this);this.ds.un("remove",this.onRemove,this);this.ds.un("update",this.onUpdate,this);this.ds.un("clear",this.onClear,this);if(this.ds!==B&&this.ds.autoDestroy){this.ds.destroy()}}if(B){B.on({scope:this,load:this.onLoad,datachanged:this.onDataChange,add:this.onAdd,remove:this.onRemove,update:this.onUpdate,clear:this.onClear})}this.ds=B;if(this.cm){this.cm.un("configchange",this.onColConfigChange,this);this.cm.un("widthchange",this.onColWidthChange,this);this.cm.un("headerchange",this.onHeaderChange,this);this.cm.un("hiddenchange",this.onHiddenChange,this);this.cm.un("columnmoved",this.onColumnMove,this)}if(A){delete this.lastViewWidth;A.on({scope:this,configchange:this.onColConfigChange,widthchange:this.onColWidthChange,headerchange:this.onHeaderChange,hiddenchange:this.onHiddenChange,columnmoved:this.onColumnMove})}this.cm=A},onDataChange:function(){this.refresh();this.updateHeaderSortState();this.syncFocusEl(0)},onClear:function(){this.refresh();this.syncFocusEl(0)},onUpdate:function(B,A){this.refreshRow(A)},onAdd:function(C,A,B){this.insertRows(C,B,B+(A.length-1))},onRemove:function(D,A,B,C){if(C!==true){this.fireEvent("beforerowremoved",this,B,A)}this.removeRow(B);if(C!==true){this.processRows(B);this.applyEmptyText();this.fireEvent("rowremoved",this,B,A)}},onLoad:function(){this.scrollToTop()},onColWidthChange:function(A,B,C){this.updateColumnWidth(B,C)},onHeaderChange:function(A,B,C){this.updateHeaders()},onHiddenChange:function(A,B,C){this.updateColumnHidden(B,C)},onColumnMove:function(A,D,B){this.indexMap=null;var C=this.getScrollState();this.refresh(true);this.restoreScroll(C);this.afterMove(B);this.grid.fireEvent("columnmove",D,B)},onColConfigChange:function(){delete this.lastViewWidth;this.indexMap=null;this.refresh(true)},initUI:function(A){A.on("headerclick",this.onHeaderClick,this)},initEvents:function(){},onHeaderClick:function(B,A){if(this.headersDisabled||!this.cm.isSortable(A)){return }B.stopEditing(true);B.store.sort(this.cm.getDataIndex(A))},onRowOver:function(B,A){var C;if((C=this.findRowIndex(A))!==false){this.addRowClass(C,"x-grid3-row-over")}},onRowOut:function(B,A){var C;if((C=this.findRowIndex(A))!==false&&!B.within(this.getRow(C),true)){this.removeRowClass(C,"x-grid3-row-over")}},handleWheel:function(A){A.stopPropagation()},onRowSelect:function(A){this.addRowClass(A,this.selectedRowClass)},onRowDeselect:function(A){this.removeRowClass(A,this.selectedRowClass)},onCellSelect:function(C,B){var A=this.getCell(C,B);if(A){this.fly(A).addClass("x-grid3-cell-selected")}},onCellDeselect:function(C,B){var A=this.getCell(C,B);if(A){this.fly(A).removeClass("x-grid3-cell-selected")}},onColumnSplitterMoved:function(C,B){this.userResized=true;var A=this.grid.colModel;A.setColumnWidth(C,B,true);if(this.forceFit){this.fitColumns(true,false,C);this.updateAllColumnWidths()}else{this.updateColumnWidth(C,B);this.syncHeaderScroll()}this.grid.fireEvent("columnresize",C,B)},handleHdMenuClick:function(C){var B=this.hdCtxIndex;var A=this.cm,D=this.ds;switch(C.itemId){case"asc":D.sort(A.getDataIndex(B),"ASC");break;case"desc":D.sort(A.getDataIndex(B),"DESC");break;default:B=A.getIndexById(C.itemId.substr(4));if(B!=-1){if(C.checked&&A.getColumnsBy(this.isHideableColumn,this).length<=1){this.onDenyColumnHide();return false}A.setHidden(B,C.checked)}}return true},isHideableColumn:function(A){return !A.hidden&&!A.fixed},beforeColMenuShow:function(){var A=this.cm,C=A.getColumnCount();this.colMenu.removeAll();for(var B=0;B<C;B++){if(A.config[B].fixed!==true&&A.config[B].hideable!==false){this.colMenu.add(new Ext.menu.CheckItem({itemId:"col-"+A.getColumnId(B),text:A.getColumnHeader(B),checked:!A.isHidden(B),hideOnClick:false,disabled:A.config[B].hideable===false}))}}},handleHdDown:function(F,D){if(Ext.fly(D).hasClass("x-grid3-hd-btn")){F.stopEvent();var E=this.findHeaderCell(D);Ext.fly(E).addClass("x-grid3-hd-menu-open");var C=this.getCellIndex(E);this.hdCtxIndex=C;var B=this.hmenu.items,A=this.cm;B.get("asc").setDisabled(!A.isSortable(C));B.get("desc").setDisabled(!A.isSortable(C));this.hmenu.on("hide",function(){Ext.fly(E).removeClass("x-grid3-hd-menu-open")},this,{single:true});this.hmenu.show(D,"tl-bl?")}},handleHdOver:function(D,A){var C=this.findHeaderCell(A);if(C&&!this.headersDisabled){this.activeHd=C;this.activeHdIndex=this.getCellIndex(C);var B=this.fly(C);this.activeHdRegion=B.getRegion();if(!this.cm.isMenuDisabled(this.activeHdIndex)){B.addClass("x-grid3-hd-over");this.activeHdBtn=B.child(".x-grid3-hd-btn");if(this.activeHdBtn){this.activeHdBtn.dom.style.height=(C.firstChild.offsetHeight-1)+"px"}}}},handleHdMove:function(F,D){if(this.activeHd&&!this.headersDisabled){var B=this.splitHandleWidth||5;var E=this.activeHdRegion;var A=F.getPageX();var C=this.activeHd.style;if(A-E.left<=B&&this.cm.isResizable(this.activeHdIndex-1)){C.cursor=Ext.isAir?"move":Ext.isWebKit?"e-resize":"col-resize"}else{if(E.right-A<=(!this.activeHdBtn?B:2)&&this.cm.isResizable(this.activeHdIndex)){C.cursor=Ext.isAir?"move":Ext.isWebKit?"w-resize":"col-resize"}else{C.cursor=""}}}},handleHdOut:function(C,A){var B=this.findHeaderCell(A);if(B&&(!Ext.isIE||!C.within(B,true))){this.activeHd=null;this.fly(B).removeClass("x-grid3-hd-over");B.style.cursor=""}},hasRows:function(){var A=this.mainBody.dom.firstChild;return A&&A.nodeType==1&&A.className!="x-grid-empty"},bind:function(A,B){this.initData(A,B)}});Ext.grid.GridView.SplitDragZone=function(A,B){this.grid=A;this.view=A.getView();this.marker=this.view.resizeMarker;this.proxy=this.view.resizeProxy;Ext.grid.GridView.SplitDragZone.superclass.constructor.call(this,B,"gridSplitters"+this.grid.getGridEl().id,{dragElId:Ext.id(this.proxy.dom),resizeFrame:false});this.scroll=false;this.hw=this.view.splitHandleWidth||5};Ext.extend(Ext.grid.GridView.SplitDragZone,Ext.dd.DDProxy,{b4StartDrag:function(A,E){this.view.headersDisabled=true;var D=this.view.mainWrap.getHeight();this.marker.setHeight(D);this.marker.show();this.marker.alignTo(this.view.getHeaderCell(this.cellIndex),"tl-tl",[-2,0]);this.proxy.setHeight(D);var B=this.cm.getColumnWidth(this.cellIndex);var C=Math.max(B-this.grid.minColumnWidth,0);this.resetConstraints();this.setXConstraint(C,1000);this.setYConstraint(0,0);this.minX=A-C;this.maxX=A+1000;this.startPos=A;Ext.dd.DDProxy.prototype.b4StartDrag.call(this,A,E)},handleMouseDown:function(A){var G=this.view.findHeaderCell(A.getTarget());if(G){var J=this.view.fly(G).getXY(),D=J[0],C=J[1];var H=A.getXY(),B=H[0];var F=G.offsetWidth,E=false;if((B-D)<=this.hw){E=-1}else{if((D+F)-B<=this.hw){E=0}}if(E!==false){this.cm=this.grid.colModel;var I=this.view.getCellIndex(G);if(E==-1){if(I+E<0){return }while(this.cm.isHidden(I+E)){--E;if(I+E<0){return }}}this.cellIndex=I+E;this.split=G.dom;if(this.cm.isResizable(this.cellIndex)&&!this.cm.isFixed(this.cellIndex)){Ext.grid.GridView.SplitDragZone.superclass.handleMouseDown.apply(this,arguments)}}else{if(this.view.columnDrag){this.view.columnDrag.callHandleMouseDown(A)}}}},endDrag:function(D){this.marker.hide();var A=this.view;var B=Math.max(this.minX,D.getPageX());var C=B-this.startPos;A.onColumnSplitterMoved(this.cellIndex,this.cm.getColumnWidth(this.cellIndex)+C);setTimeout(function(){A.headersDisabled=false},50)},autoOffset:function(){this.setDelta(0,0)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.HeaderDragZone=function(A,C,B){this.grid=A;this.view=A.getView();this.ddGroup="gridHeader"+this.grid.getGridEl().id;Ext.grid.HeaderDragZone.superclass.constructor.call(this,C);if(B){this.setHandleElId(Ext.id(C));this.setOuterHandleElId(Ext.id(B))}this.scroll=false};Ext.extend(Ext.grid.HeaderDragZone,Ext.dd.DragZone,{maxDragWidth:120,getDragData:function(C){var A=Ext.lib.Event.getTarget(C);var B=this.view.findHeaderCell(A);if(B){return{ddel:B.firstChild,header:B}}return false},onInitDrag:function(A){this.view.headersDisabled=true;var B=this.dragData.ddel.cloneNode(true);B.id=Ext.id();B.style.width=Math.min(this.dragData.header.offsetWidth,this.maxDragWidth)+"px";this.proxy.update(B);return true},afterValidDrop:function(){var A=this.view;setTimeout(function(){A.headersDisabled=false},50)},afterInvalidDrop:function(){var A=this.view;setTimeout(function(){A.headersDisabled=false},50)}});Ext.grid.HeaderDropZone=function(A,C,B){this.grid=A;this.view=A.getView();this.proxyTop=Ext.DomHelper.append(document.body,{cls:"col-move-top",html:"&#160;"},true);this.proxyBottom=Ext.DomHelper.append(document.body,{cls:"col-move-bottom",html:"&#160;"},true);this.proxyTop.hide=this.proxyBottom.hide=function(){this.setLeftTop(-100,-100);this.setStyle("visibility","hidden")};this.ddGroup="gridHeader"+this.grid.getGridEl().id;Ext.grid.HeaderDropZone.superclass.constructor.call(this,A.getGridEl().dom)};Ext.extend(Ext.grid.HeaderDropZone,Ext.dd.DropZone,{proxyOffsets:[-4,-9],fly:Ext.Element.fly,getTargetFromEvent:function(C){var A=Ext.lib.Event.getTarget(C);var B=this.view.findCellIndex(A);if(B!==false){return this.view.getHeaderCell(B)}},nextVisible:function(C){var B=this.view,A=this.grid.colModel;C=C.nextSibling;while(C){if(!A.isHidden(B.getCellIndex(C))){return C}C=C.nextSibling}return null},prevVisible:function(C){var B=this.view,A=this.grid.colModel;C=C.prevSibling;while(C){if(!A.isHidden(B.getCellIndex(C))){return C}C=C.prevSibling}return null},positionIndicator:function(D,H,G){var A=Ext.lib.Event.getPageX(G);var E=Ext.lib.Dom.getRegion(H.firstChild);var C,F,B=E.top+this.proxyOffsets[1];if((E.right-A)<=(E.right-E.left)/2){C=E.right+this.view.borderWidth;F="after"}else{C=E.left;F="before"}if(this.grid.colModel.isFixed(this.view.getCellIndex(H))){return false}C+=this.proxyOffsets[0];this.proxyTop.setLeftTop(C,B);this.proxyTop.show();if(!this.bottomOffset){this.bottomOffset=this.view.mainHd.getHeight()}this.proxyBottom.setLeftTop(C,B+this.proxyTop.dom.offsetHeight+this.bottomOffset);this.proxyBottom.show();return F},onNodeEnter:function(D,A,C,B){if(B.header!=D){this.positionIndicator(B.header,D,C)}},onNodeOver:function(E,B,D,C){var A=false;if(C.header!=E){A=this.positionIndicator(C.header,E,D)}if(!A){this.proxyTop.hide();this.proxyBottom.hide()}return A?this.dropAllowed:this.dropNotAllowed},onNodeOut:function(D,A,C,B){this.proxyTop.hide();this.proxyBottom.hide()},onNodeDrop:function(B,J,E,C){var D=C.header;if(D!=B){var H=this.grid.colModel;var G=Ext.lib.Event.getPageX(E);var A=Ext.lib.Dom.getRegion(B.firstChild);var K=(A.right-G)<=((A.right-A.left)/2)?"after":"before";var F=this.view.getCellIndex(D);var I=this.view.getCellIndex(B);if(K=="after"){I++}if(F<I){I--}H.moveColumn(F,I);this.grid.fireEvent("columnmove",F,I);return true}return false}});Ext.grid.GridView.ColumnDragZone=function(A,B){Ext.grid.GridView.ColumnDragZone.superclass.constructor.call(this,A,B,null);this.proxy.el.addClass("x-grid3-col-dd")};Ext.extend(Ext.grid.GridView.ColumnDragZone,Ext.grid.HeaderDragZone,{handleMouseDown:function(A){},callHandleMouseDown:function(A){Ext.grid.GridView.ColumnDragZone.superclass.handleMouseDown.call(this,A)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.SplitDragZone=function(A,C,B){this.grid=A;this.view=A.getView();this.proxy=this.view.resizeProxy;Ext.grid.SplitDragZone.superclass.constructor.call(this,C,"gridSplitters"+this.grid.getGridEl().id,{dragElId:Ext.id(this.proxy.dom),resizeFrame:false});this.setHandleElId(Ext.id(C));this.setOuterHandleElId(Ext.id(B));this.scroll=false};Ext.extend(Ext.grid.SplitDragZone,Ext.dd.DDProxy,{fly:Ext.Element.fly,b4StartDrag:function(A,D){this.view.headersDisabled=true;this.proxy.setHeight(this.view.mainWrap.getHeight());var B=this.cm.getColumnWidth(this.cellIndex);var C=Math.max(B-this.grid.minColumnWidth,0);this.resetConstraints();this.setXConstraint(C,1000);this.setYConstraint(0,0);this.minX=A-C;this.maxX=A+1000;this.startPos=A;Ext.dd.DDProxy.prototype.b4StartDrag.call(this,A,D)},handleMouseDown:function(C){var B=Ext.EventObject.setEvent(C);var A=this.fly(B.getTarget());if(A.hasClass("x-grid-split")){this.cellIndex=this.view.getCellIndex(A.dom);this.split=A.dom;this.cm=this.grid.colModel;if(this.cm.isResizable(this.cellIndex)&&!this.cm.isFixed(this.cellIndex)){Ext.grid.SplitDragZone.superclass.handleMouseDown.apply(this,arguments)}}},endDrag:function(C){this.view.headersDisabled=false;var A=Math.max(this.minX,Ext.lib.Event.getPageX(C));var B=A-this.startPos;this.view.onColumnSplitterMoved(this.cellIndex,this.cm.getColumnWidth(this.cellIndex)+B)},autoOffset:function(){this.setDelta(0,0)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.GridDragZone=function(B,A){this.view=B.getView();Ext.grid.GridDragZone.superclass.constructor.call(this,this.view.mainBody.dom,A);this.scroll=false;this.grid=B;this.ddel=document.createElement("div");this.ddel.className="x-grid-dd-wrap"};Ext.extend(Ext.grid.GridDragZone,Ext.dd.DragZone,{ddGroup:"GridDD",getDragData:function(B){var A=Ext.lib.Event.getTarget(B);var D=this.view.findRowIndex(A);if(D!==false){var C=this.grid.selModel;if(!C.isSelected(D)||B.hasModifier()){C.handleMouseDown(this.grid,D,B)}return{grid:this.grid,ddel:this.ddel,rowIndex:D,selections:C.getSelections()}}return false},onInitDrag:function(B){var A=this.dragData;this.ddel.innerHTML=this.grid.getDragDropText();this.proxy.update(this.ddel)},afterRepair:function(){this.dragging=false},getRepairXY:function(B,A){return false},onEndDrag:function(A,B){},onValidDrop:function(A,B,C){this.hideProxy()},beforeInvalidDrop:function(A,B){}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.ColumnModel=function(A){if(A.columns){Ext.apply(this,A);this.setConfig(A.columns,true)}else{this.setConfig(A,true)}this.addEvents("widthchange","headerchange","hiddenchange","columnmoved","configchange");Ext.grid.ColumnModel.superclass.constructor.call(this)};Ext.extend(Ext.grid.ColumnModel,Ext.util.Observable,{defaultWidth:100,defaultSortable:false,getColumnId:function(A){return this.config[A].id},getColumnAt:function(A){return this.config[A]},setConfig:function(D,C){var E,F,A;if(!C){delete this.totalWidth;for(E=0,A=this.config.length;E<A;E++){F=this.config[E];if(F.editor){F.editor.destroy()}}}this.defaults=Ext.apply({width:this.defaultWidth,sortable:this.defaultSortable},this.defaults);this.config=D;this.lookup={};for(E=0,A=D.length;E<A;E++){F=Ext.applyIf(D[E],this.defaults);if(!F.isColumn){var B=Ext.grid.Column.types[F.xtype||"gridcolumn"];F=new B(F);D[E]=F}this.lookup[F.id]=F}if(!C){this.fireEvent("configchange",this)}},getColumnById:function(A){return this.lookup[A]},getIndexById:function(C){for(var B=0,A=this.config.length;B<A;B++){if(this.config[B].id==C){return B}}return -1},moveColumn:function(C,A){var B=this.config[C];this.config.splice(C,1);this.config.splice(A,0,B);this.dataMap=null;this.fireEvent("columnmoved",this,C,A)},getColumnCount:function(C){if(C===true){var D=0;for(var B=0,A=this.config.length;B<A;B++){if(!this.isHidden(B)){D++}}return D}return this.config.length},getColumnsBy:function(D,C){var E=[];for(var B=0,A=this.config.length;B<A;B++){var F=this.config[B];if(D.call(C||this,F,B)===true){E[E.length]=F}}return E},isSortable:function(A){return this.config[A].sortable},isMenuDisabled:function(A){return !!this.config[A].menuDisabled},getRenderer:function(A){if(!this.config[A].renderer){return Ext.grid.ColumnModel.defaultRenderer}return this.config[A].renderer},setRenderer:function(A,B){this.config[A].renderer=B},getColumnWidth:function(A){return this.config[A].width},setColumnWidth:function(B,C,A){this.config[B].width=C;this.totalWidth=null;if(!A){this.fireEvent("widthchange",this,B,C)}},getTotalWidth:function(B){if(!this.totalWidth){this.totalWidth=0;for(var C=0,A=this.config.length;C<A;C++){if(B||!this.isHidden(C)){this.totalWidth+=this.getColumnWidth(C)}}}return this.totalWidth},getColumnHeader:function(A){return this.config[A].header},setColumnHeader:function(A,B){this.config[A].header=B;this.fireEvent("headerchange",this,A,B)},getColumnTooltip:function(A){return this.config[A].tooltip},setColumnTooltip:function(A,B){this.config[A].tooltip=B},getDataIndex:function(A){return this.config[A].dataIndex},setDataIndex:function(A,B){this.config[A].dataIndex=B},findColumnIndex:function(C){var D=this.config;for(var B=0,A=D.length;B<A;B++){if(D[B].dataIndex==C){return B}}return -1},isCellEditable:function(A,B){return(this.config[A].editable||(typeof this.config[A].editable=="undefined"&&this.config[A].editor))?true:false},getCellEditor:function(A,B){return this.config[A].getCellEditor(B)},setEditable:function(A,B){this.config[A].editable=B},isHidden:function(A){return this.config[A].hidden},isFixed:function(A){return this.config[A].fixed},isResizable:function(A){return A>=0&&this.config[A].resizable!==false&&this.config[A].fixed!==true},setHidden:function(A,B){var C=this.config[A];if(C.hidden!==B){C.hidden=B;this.totalWidth=null;this.fireEvent("hiddenchange",this,A,B)}},setEditor:function(A,B){Ext.destroy(this.config[A].editor);this.config[A].editor=B},destroy:function(){for(var B=0,C=this.config,A=C.length;B<A;B++){Ext.destroy(C[B].editor)}this.purgeListeners()}});Ext.grid.ColumnModel.defaultRenderer=function(A){if(typeof A=="string"&&A.length<1){return"&#160;"}return A};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.AbstractSelectionModel=function(){this.locked=false;Ext.grid.AbstractSelectionModel.superclass.constructor.call(this)};Ext.extend(Ext.grid.AbstractSelectionModel,Ext.util.Observable,{init:function(A){this.grid=A;this.initEvents()},lock:function(){this.locked=true},unlock:function(){this.locked=false},isLocked:function(){return this.locked},destroy:function(){this.purgeListeners()}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.RowSelectionModel=function(A){Ext.apply(this,A);this.selections=new Ext.util.MixedCollection(false,function(B){return B.id});this.last=false;this.lastActive=false;this.addEvents("selectionchange","beforerowselect","rowselect","rowdeselect");Ext.grid.RowSelectionModel.superclass.constructor.call(this)};Ext.extend(Ext.grid.RowSelectionModel,Ext.grid.AbstractSelectionModel,{singleSelect:false,initEvents:function(){if(!this.grid.enableDragDrop&&!this.grid.enableDrag){this.grid.on("rowmousedown",this.handleMouseDown,this)}else{this.grid.on("rowclick",function(B,D,C){if(C.button===0&&!C.shiftKey&&!C.ctrlKey){this.selectRow(D,false);B.view.focusRow(D)}},this)}this.rowNav=new Ext.KeyNav(this.grid.getGridEl(),{up:function(C){if(!C.shiftKey||this.singleSelect){this.selectPrevious(false)}else{if(this.last!==false&&this.lastActive!==false){var B=this.last;this.selectRange(this.last,this.lastActive-1);this.grid.getView().focusRow(this.lastActive);if(B!==false){this.last=B}}else{this.selectFirstRow()}}},down:function(C){if(!C.shiftKey||this.singleSelect){this.selectNext(false)}else{if(this.last!==false&&this.lastActive!==false){var B=this.last;this.selectRange(this.last,this.lastActive+1);this.grid.getView().focusRow(this.lastActive);if(B!==false){this.last=B}}else{this.selectFirstRow()}}},scope:this});var A=this.grid.view;A.on("refresh",this.onRefresh,this);A.on("rowupdated",this.onRowUpdated,this);A.on("rowremoved",this.onRemove,this)},onRefresh:function(){var F=this.grid.store,B;var D=this.getSelections();this.clearSelections(true);for(var C=0,A=D.length;C<A;C++){var E=D[C];if((B=F.indexOfId(E.id))!=-1){this.selectRow(B,true)}}if(D.length!=this.selections.getCount()){this.fireEvent("selectionchange",this)}},onRemove:function(A,B,C){if(this.selections.remove(C)!==false){this.fireEvent("selectionchange",this)}},onRowUpdated:function(A,B,C){if(this.isSelected(C)){A.onRowSelect(B)}},selectRecords:function(B,E){if(!E){this.clearSelections()}var D=this.grid.store;for(var C=0,A=B.length;C<A;C++){this.selectRow(D.indexOf(B[C]),true)}},getCount:function(){return this.selections.length},selectFirstRow:function(){this.selectRow(0)},selectLastRow:function(A){this.selectRow(this.grid.store.getCount()-1,A)},selectNext:function(A){if(this.hasNext()){this.selectRow(this.last+1,A);this.grid.getView().focusRow(this.last);return true}return false},selectPrevious:function(A){if(this.hasPrevious()){this.selectRow(this.last-1,A);this.grid.getView().focusRow(this.last);return true}return false},hasNext:function(){return this.last!==false&&(this.last+1)<this.grid.store.getCount()},hasPrevious:function(){return !!this.last},getSelections:function(){return[].concat(this.selections.items)},getSelected:function(){return this.selections.itemAt(0)},each:function(E,D){var C=this.getSelections();for(var B=0,A=C.length;B<A;B++){if(E.call(D||this,C[B],B)===false){return false}}return true},clearSelections:function(A){if(this.isLocked()){return }if(A!==true){var C=this.grid.store;var B=this.selections;B.each(function(D){this.deselectRow(C.indexOfId(D.id))},this);B.clear()}else{this.selections.clear()}this.last=false},selectAll:function(){if(this.isLocked()){return }this.selections.clear();for(var B=0,A=this.grid.store.getCount();B<A;B++){this.selectRow(B,true)}},hasSelection:function(){return this.selections.length>0},isSelected:function(A){var B=typeof A=="number"?this.grid.store.getAt(A):A;return(B&&this.selections.key(B.id)?true:false)},isIdSelected:function(A){return(this.selections.key(A)?true:false)},handleMouseDown:function(D,F,E){if(E.button!==0||this.isLocked()){return }var A=this.grid.getView();if(E.shiftKey&&!this.singleSelect&&this.last!==false){var C=this.last;this.selectRange(C,F,E.ctrlKey);this.last=C;A.focusRow(F)}else{var B=this.isSelected(F);if(E.ctrlKey&&B){this.deselectRow(F)}else{if(!B||this.getCount()>1){this.selectRow(F,E.ctrlKey||E.shiftKey);A.focusRow(F)}}}},selectRows:function(C,D){if(!D){this.clearSelections()}for(var B=0,A=C.length;B<A;B++){this.selectRow(C[B],true)}},selectRange:function(B,A,D){var C;if(this.isLocked()){return }if(!D){this.clearSelections()}if(B<=A){for(C=B;C<=A;C++){this.selectRow(C,true)}}else{for(C=B;C>=A;C--){this.selectRow(C,true)}}},deselectRange:function(C,B,A){if(this.isLocked()){return }for(var D=C;D<=B;D++){this.deselectRow(D,A)}},selectRow:function(B,D,A){if(this.isLocked()||(B<0||B>=this.grid.store.getCount())||(D&&this.isSelected(B))){return }var C=this.grid.store.getAt(B);if(C&&this.fireEvent("beforerowselect",this,B,D,C)!==false){if(!D||this.singleSelect){this.clearSelections()}this.selections.add(C);this.last=this.lastActive=B;if(!A){this.grid.getView().onRowSelect(B)}this.fireEvent("rowselect",this,B,C);this.fireEvent("selectionchange",this)}},deselectRow:function(B,A){if(this.isLocked()){return }if(this.last==B){this.last=false}if(this.lastActive==B){this.lastActive=false}var C=this.grid.store.getAt(B);if(C){this.selections.remove(C);if(!A){this.grid.getView().onRowDeselect(B)}this.fireEvent("rowdeselect",this,B,C);this.fireEvent("selectionchange",this)}},restoreLast:function(){if(this._last){this.last=this._last}},acceptsNav:function(C,B,A){return !A.isHidden(B)&&A.isCellEditable(B,C)},onEditorKey:function(F,E){var C=E.getKey(),G,D=this.grid,B=D.activeEditor;var A=E.shiftKey;if(C==E.TAB){E.stopEvent();B.completeEdit();if(A){G=D.walkCells(B.row,B.col-1,-1,this.acceptsNav,this)}else{G=D.walkCells(B.row,B.col+1,1,this.acceptsNav,this)}}else{if(C==E.ENTER){E.stopEvent();B.completeEdit();if(this.moveEditorOnEnter!==false){if(A){G=D.walkCells(B.row-1,B.col,-1,this.acceptsNav,this)}else{G=D.walkCells(B.row+1,B.col,1,this.acceptsNav,this)}}}else{if(C==E.ESC){B.cancelEdit()}}}if(G){D.startEditing(G[0],G[1])}},destroy:function(){if(this.rowNav){this.rowNav.disable();this.rowNav=null}Ext.grid.RowSelectionModel.superclass.destroy.call(this)}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.Column=function(A){Ext.apply(this,A);if(typeof this.renderer=="string"){this.renderer=Ext.util.Format[this.renderer]}else{if(Ext.isObject(this.renderer)){this.scope=this.renderer.scope;this.renderer=this.renderer.fn}}this.renderer=this.renderer.createDelegate(this.scope||A);if(this.id===undefined){this.id=++Ext.grid.Column.AUTO_ID}if(this.editor){this.editor=Ext.create(this.editor,"textfield")}};Ext.grid.Column.AUTO_ID=0;Ext.grid.Column.prototype={isColumn:true,renderer:function(A){if(typeof A=="string"&&A.length<1){return"&#160;"}return A},getEditor:function(A){return this.editable!==false?this.editor:null},getCellEditor:function(B){var A=this.getEditor(B);if(A){if(!A.startEdit){if(!A.gridEditor){A.gridEditor=new Ext.grid.GridEditor(A)}return A.gridEditor}else{if(A.startEdit){return A}}}return null}};Ext.grid.BooleanColumn=Ext.extend(Ext.grid.Column,{trueText:"true",falseText:"false",undefinedText:"&#160;",constructor:function(A){Ext.grid.BooleanColumn.superclass.constructor.call(this,A);var C=this.trueText,D=this.falseText,B=this.undefinedText;this.renderer=function(E){if(E===undefined){return B}if(!E||E==="false"){return D}return C}}});Ext.grid.NumberColumn=Ext.extend(Ext.grid.Column,{format:"0,000.00",constructor:function(A){Ext.grid.NumberColumn.superclass.constructor.call(this,A);this.renderer=Ext.util.Format.numberRenderer(this.format)}});Ext.grid.DateColumn=Ext.extend(Ext.grid.Column,{format:"m/d/Y",constructor:function(A){Ext.grid.DateColumn.superclass.constructor.call(this,A);this.renderer=Ext.util.Format.dateRenderer(this.format)}});Ext.grid.TemplateColumn=Ext.extend(Ext.grid.Column,{constructor:function(A){Ext.grid.TemplateColumn.superclass.constructor.call(this,A);var B=typeof Ext.isObject(this.tpl)?this.tpl:new Ext.XTemplate(this.tpl);this.renderer=function(D,E,C){return B.apply(C.data)};this.tpl=B}});Ext.grid.Column.types={gridcolumn:Ext.grid.Column,booleancolumn:Ext.grid.BooleanColumn,numbercolumn:Ext.grid.NumberColumn,datecolumn:Ext.grid.DateColumn,templatecolumn:Ext.grid.TemplateColumn};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.RowNumberer=function(A){Ext.apply(this,A);if(this.rowspan){this.renderer=this.renderer.createDelegate(this)}};Ext.grid.RowNumberer.prototype={header:"",width:23,sortable:false,fixed:true,menuDisabled:true,dataIndex:"",id:"numberer",rowspan:undefined,renderer:function(B,C,A,D){if(this.rowspan){C.cellAttr='rowspan="'+this.rowspan+'"'}return D+1}};
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.CheckboxSelectionModel=Ext.extend(Ext.grid.RowSelectionModel,{header:'<div class="x-grid3-hd-checker">&#160;</div>',width:20,sortable:false,menuDisabled:true,fixed:true,dataIndex:"",id:"checker",constructor:function(){Ext.grid.CheckboxSelectionModel.superclass.constructor.apply(this,arguments);if(this.checkOnly){this.handleMouseDown=Ext.emptyFn}},initEvents:function(){Ext.grid.CheckboxSelectionModel.superclass.initEvents.call(this);this.grid.on("render",function(){var A=this.grid.getView();A.mainBody.on("mousedown",this.onMouseDown,this);Ext.fly(A.innerHd).on("mousedown",this.onHdMouseDown,this)},this)},onMouseDown:function(C,B){if(C.button===0&&B.className=="x-grid3-row-checker"){C.stopEvent();var D=C.getTarget(".x-grid3-row");if(D){var A=D.rowIndex;if(this.isSelected(A)){this.deselectRow(A)}else{this.selectRow(A,true)}}}},onHdMouseDown:function(C,A){if(A.className=="x-grid3-hd-checker"){C.stopEvent();var B=Ext.fly(A.parentNode);var D=B.hasClass("x-grid3-hd-checker-on");if(D){B.removeClass("x-grid3-hd-checker-on");this.clearSelections()}else{B.addClass("x-grid3-hd-checker-on");this.selectAll()}}},renderer:function(B,C,A){return'<div class="x-grid3-row-checker">&#160;</div>'}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.CellSelectionModel=function(A){Ext.apply(this,A);this.selection=null;this.addEvents("beforecellselect","cellselect","selectionchange");Ext.grid.CellSelectionModel.superclass.constructor.call(this)};Ext.extend(Ext.grid.CellSelectionModel,Ext.grid.AbstractSelectionModel,{initEvents:function(){this.grid.on("cellmousedown",this.handleMouseDown,this);this.grid.getGridEl().on(Ext.EventManager.useKeydown?"keydown":"keypress",this.handleKeyDown,this);var A=this.grid.view;A.on("refresh",this.onViewChange,this);A.on("rowupdated",this.onRowUpdated,this);A.on("beforerowremoved",this.clearSelections,this);A.on("beforerowsinserted",this.clearSelections,this);if(this.grid.isEditor){this.grid.on("beforeedit",this.beforeEdit,this)}},beforeEdit:function(A){this.select(A.row,A.column,false,true,A.record)},onRowUpdated:function(A,B,C){if(this.selection&&this.selection.record==C){A.onCellSelect(B,this.selection.cell[1])}},onViewChange:function(){this.clearSelections(true)},getSelectedCell:function(){return this.selection?this.selection.cell:null},clearSelections:function(B){var A=this.selection;if(A){if(B!==true){this.grid.view.onCellDeselect(A.cell[0],A.cell[1])}this.selection=null;this.fireEvent("selectionchange",this,null)}},hasSelection:function(){return this.selection?true:false},handleMouseDown:function(B,D,A,C){if(C.button!==0||this.isLocked()){return }this.select(D,A)},select:function(F,C,B,E,D){if(this.fireEvent("beforecellselect",this,F,C)!==false){this.clearSelections();D=D||this.grid.store.getAt(F);this.selection={record:D,cell:[F,C]};if(!B){var A=this.grid.getView();A.onCellSelect(F,C);if(E!==true){A.focusCell(F,C)}}this.fireEvent("cellselect",this,F,C);this.fireEvent("selectionchange",this,this.selection)}},isSelectable:function(C,B,A){return !A.isHidden(B)},handleKeyDown:function(F){if(!F.isNavKeyPress()){return }var E=this.grid,J=this.selection;if(!J){F.stopEvent();var I=E.walkCells(0,0,1,this.isSelectable,this);if(I){this.select(I[0],I[1])}return }var B=this;var H=function(M,K,L){return E.walkCells(M,K,L,B.isSelectable,B)};var C=F.getKey(),A=J.cell[0],G=J.cell[1];var D;switch(C){case F.TAB:if(F.shiftKey){D=H(A,G-1,-1)}else{D=H(A,G+1,1)}break;case F.DOWN:D=H(A+1,G,1);break;case F.UP:D=H(A-1,G,-1);break;case F.RIGHT:D=H(A,G+1,1);break;case F.LEFT:D=H(A,G-1,-1);break;case F.ENTER:if(E.isEditor&&!E.editing){E.startEditing(A,G);F.stopEvent();return }break}if(D){this.select(D[0],D[1]);F.stopEvent()}},acceptsNav:function(C,B,A){return !A.isHidden(B)&&A.isCellEditable(B,C)},onEditorKey:function(E,D){var B=D.getKey(),F,C=this.grid,A=C.activeEditor;if(B==D.TAB){if(D.shiftKey){F=C.walkCells(A.row,A.col-1,-1,this.acceptsNav,this)}else{F=C.walkCells(A.row,A.col+1,1,this.acceptsNav,this)}D.stopEvent()}else{if(B==D.ENTER){A.completeEdit();D.stopEvent()}else{if(B==D.ESC){D.stopEvent();A.cancelEdit()}}}if(F){C.startEditing(F[0],F[1])}}});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.EditorGridPanel=Ext.extend(Ext.grid.GridPanel,{clicksToEdit:2,forceValidation:false,isEditor:true,detectEdit:false,autoEncode:false,trackMouseOver:false,initComponent:function(){Ext.grid.EditorGridPanel.superclass.initComponent.call(this);if(!this.selModel){this.selModel=new Ext.grid.CellSelectionModel()}this.activeEditor=null;this.addEvents("beforeedit","afteredit","validateedit")},initEvents:function(){Ext.grid.EditorGridPanel.superclass.initEvents.call(this);this.on("bodyscroll",this.stopEditing,this,[true]);this.on("columnresize",this.stopEditing,this,[true]);if(this.clicksToEdit==1){this.on("cellclick",this.onCellDblClick,this)}else{if(this.clicksToEdit=="auto"&&this.view.mainBody){this.view.mainBody.on("mousedown",this.onAutoEditClick,this)}this.on("celldblclick",this.onCellDblClick,this)}},onCellDblClick:function(B,C,A){this.startEditing(C,A)},onAutoEditClick:function(C,B){if(C.button!==0){return }var E=this.view.findRowIndex(B);var A=this.view.findCellIndex(B);if(E!==false&&A!==false){this.stopEditing();if(this.selModel.getSelectedCell){var D=this.selModel.getSelectedCell();if(D&&D[0]===E&&D[1]===A){this.startEditing(E,A)}}else{if(this.selModel.isSelected(E)){this.startEditing(E,A)}}}},onEditComplete:function(B,D,A){this.editing=false;this.activeEditor=null;B.un("specialkey",this.selModel.onEditorKey,this.selModel);var C=B.record;var F=this.colModel.getDataIndex(B.col);D=this.postEditValue(D,A,C,F);if(this.forceValidation===true||String(D)!==String(A)){var E={grid:this,record:C,field:F,originalValue:A,value:D,row:B.row,column:B.col,cancel:false};if(this.fireEvent("validateedit",E)!==false&&!E.cancel&&String(D)!==String(A)){C.set(F,E.value);delete E.cancel;this.fireEvent("afteredit",E)}}this.view.focusCell(B.row,B.col)},startEditing:function(F,B){this.stopEditing();if(this.colModel.isCellEditable(B,F)){this.view.ensureVisible(F,B,true);var C=this.store.getAt(F);var E=this.colModel.getDataIndex(B);var D={grid:this,record:C,field:E,value:C.data[E],row:F,column:B,cancel:false};if(this.fireEvent("beforeedit",D)!==false&&!D.cancel){this.editing=true;var A=this.colModel.getCellEditor(B,F);if(!A){return }if(!A.rendered){A.render(this.view.getEditorParent(A))}(function(){A.row=F;A.col=B;A.record=C;A.on("complete",this.onEditComplete,this,{single:true});A.on("specialkey",this.selModel.onEditorKey,this.selModel);this.activeEditor=A;var G=this.preEditValue(C,E);A.startEdit(this.view.getCell(F,B).firstChild,G===undefined?"":G)}).defer(50,this)}}},preEditValue:function(A,C){var B=A.data[C];return this.autoEncode&&typeof B=="string"?Ext.util.Format.htmlDecode(B):B},postEditValue:function(C,A,B,D){return this.autoEncode&&typeof C=="string"?Ext.util.Format.htmlEncode(C):C},stopEditing:function(A){if(this.activeEditor){this.activeEditor[A===true?"cancelEdit":"completeEdit"]()}this.activeEditor=null}});Ext.reg("editorgrid",Ext.grid.EditorGridPanel);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.GridEditor=function(B,A){Ext.grid.GridEditor.superclass.constructor.call(this,B,A);B.monitorTab=false};Ext.extend(Ext.grid.GridEditor,Ext.Editor,{alignment:"tl-tl",autoSize:"width",hideEl:false,cls:"x-small-editor x-grid-editor",shim:false,shadow:false});
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.PropertyRecord=Ext.data.Record.create([{name:"name",type:"string"},"value"]);Ext.grid.PropertyStore=function(A,B){this.grid=A;this.store=new Ext.data.Store({recordType:Ext.grid.PropertyRecord});this.store.on("update",this.onUpdate,this);if(B){this.setSource(B)}Ext.grid.PropertyStore.superclass.constructor.call(this)};Ext.extend(Ext.grid.PropertyStore,Ext.util.Observable,{setSource:function(C){this.source=C;this.store.removeAll();var B=[];for(var A in C){if(this.isEditableValue(C[A])){B.push(new Ext.grid.PropertyRecord({name:A,value:C[A]},A))}}this.store.loadRecords({records:B},{},true)},onUpdate:function(E,A,D){if(D==Ext.data.Record.EDIT){var B=A.data.value;var C=A.modified.value;if(this.grid.fireEvent("beforepropertychange",this.source,A.id,B,C)!==false){this.source[A.id]=B;A.commit();this.grid.fireEvent("propertychange",this.source,A.id,B,C)}else{A.reject()}}},getProperty:function(A){return this.store.getAt(A)},isEditableValue:function(A){if(Ext.isDate(A)){return true}return !(Ext.isObject(A)||Ext.isFunction(A))},setValue:function(B,A){this.source[B]=A;this.store.getById(B).set("value",A)},getSource:function(){return this.source}});Ext.grid.PropertyColumnModel=function(C,B){var D=Ext.grid,E=Ext.form;this.grid=C;D.PropertyColumnModel.superclass.constructor.call(this,[{header:this.nameText,width:50,sortable:true,dataIndex:"name",id:"name",menuDisabled:true},{header:this.valueText,width:50,resizable:false,dataIndex:"value",id:"value",menuDisabled:true}]);this.store=B;var A=new E.Field({autoCreate:{tag:"select",children:[{tag:"option",value:"true",html:"true"},{tag:"option",value:"false",html:"false"}]},getValue:function(){return this.el.value=="true"}});this.editors={date:new D.GridEditor(new E.DateField({selectOnFocus:true})),string:new D.GridEditor(new E.TextField({selectOnFocus:true})),number:new D.GridEditor(new E.NumberField({selectOnFocus:true,style:"text-align:left;"})),"boolean":new D.GridEditor(A)};this.renderCellDelegate=this.renderCell.createDelegate(this);this.renderPropDelegate=this.renderProp.createDelegate(this)};Ext.extend(Ext.grid.PropertyColumnModel,Ext.grid.ColumnModel,{nameText:"Name",valueText:"Value",dateFormat:"m/j/Y",renderDate:function(A){return A.dateFormat(this.dateFormat)},renderBool:function(A){return A?"true":"false"},isCellEditable:function(A,B){return A==1},getRenderer:function(A){return A==1?this.renderCellDelegate:this.renderPropDelegate},renderProp:function(A){return this.getPropertyName(A)},renderCell:function(A){var B=A;if(Ext.isDate(A)){B=this.renderDate(A)}else{if(typeof A=="boolean"){B=this.renderBool(A)}}return Ext.util.Format.htmlEncode(B)},getPropertyName:function(B){var A=this.grid.propertyNames;return A&&A[B]?A[B]:B},getCellEditor:function(A,E){var B=this.store.getProperty(E),D=B.data.name,C=B.data.value;if(this.grid.customEditors[D]){return this.grid.customEditors[D]}if(Ext.isDate(C)){return this.editors.date}else{if(typeof C=="number"){return this.editors.number}else{if(typeof C=="boolean"){return this.editors["boolean"]}else{return this.editors.string}}}},destroy:function(){Ext.grid.PropertyColumnModel.superclass.destroy.call(this);for(var A in this.editors){Ext.destroy(A)}}});Ext.grid.PropertyGrid=Ext.extend(Ext.grid.EditorGridPanel,{enableColumnMove:false,stripeRows:false,trackMouseOver:false,clicksToEdit:1,enableHdMenu:false,viewConfig:{forceFit:true},initComponent:function(){this.customEditors=this.customEditors||{};this.lastEditRow=null;var B=new Ext.grid.PropertyStore(this);this.propStore=B;var A=new Ext.grid.PropertyColumnModel(this,B);B.store.sort("name","ASC");this.addEvents("beforepropertychange","propertychange");this.cm=A;this.ds=B.store;Ext.grid.PropertyGrid.superclass.initComponent.call(this);this.mon(this.selModel,"beforecellselect",function(E,D,C){if(C===0){this.startEditing.defer(200,this,[D,1]);return false}},this)},onRender:function(){Ext.grid.PropertyGrid.superclass.onRender.apply(this,arguments);this.getGridEl().addClass("x-props-grid")},afterRender:function(){Ext.grid.PropertyGrid.superclass.afterRender.apply(this,arguments);if(this.source){this.setSource(this.source)}},setSource:function(A){this.propStore.setSource(A)},getSource:function(){return this.propStore.getSource()}});Ext.reg("propertygrid",Ext.grid.PropertyGrid);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.grid.GroupingView=Ext.extend(Ext.grid.GridView,{groupByText:"Group By This Field",showGroupsText:"Show in Groups",hideGroupedColumn:false,showGroupName:true,startCollapsed:false,enableGrouping:true,enableGroupingMenu:true,enableNoGroups:true,emptyGroupText:"(None)",ignoreAdd:false,groupTextTpl:"{text}",gidSeed:1000,initTemplates:function(){Ext.grid.GroupingView.superclass.initTemplates.call(this);this.state={};var A=this.grid.getSelectionModel();A.on(A.selectRow?"beforerowselect":"beforecellselect",this.onBeforeRowSelect,this);if(!this.startGroup){this.startGroup=new Ext.XTemplate('<div id="{groupId}" class="x-grid-group {cls}">','<div id="{groupId}-hd" class="x-grid-group-hd" style="{style}"><div class="x-grid-group-title">',this.groupTextTpl,"</div></div>",'<div id="{groupId}-bd" class="x-grid-group-body">')}this.startGroup.compile();this.endGroup="</div></div>"},findGroup:function(A){return Ext.fly(A).up(".x-grid-group",this.mainBody.dom)},getGroups:function(){return this.hasRows()?this.mainBody.dom.childNodes:[]},onAdd:function(){if(this.enableGrouping&&!this.ignoreAdd){var A=this.getScrollState();this.refresh();this.restoreScroll(A)}else{if(!this.enableGrouping){Ext.grid.GroupingView.superclass.onAdd.apply(this,arguments)}}},onRemove:function(E,A,B,D){Ext.grid.GroupingView.superclass.onRemove.apply(this,arguments);var C=document.getElementById(A._groupId);if(C&&C.childNodes[1].childNodes.length<1){Ext.removeNode(C)}this.applyEmptyText()},refreshRow:function(A){if(this.ds.getCount()==1){this.refresh()}else{this.isUpdating=true;Ext.grid.GroupingView.superclass.refreshRow.apply(this,arguments);this.isUpdating=false}},beforeMenuShow:function(){var C,A=this.hmenu.items,B=this.cm.config[this.hdCtxIndex].groupable===false;if((C=A.get("groupBy"))){C.setDisabled(B)}if((C=A.get("showGroups"))){C.setDisabled(B);C.setChecked(!!this.getGroupField(),true)}},renderUI:function(){Ext.grid.GroupingView.superclass.renderUI.call(this);this.mainBody.on("mousedown",this.interceptMouse,this);if(this.enableGroupingMenu&&this.hmenu){this.hmenu.add("-",{itemId:"groupBy",text:this.groupByText,handler:this.onGroupByClick,scope:this,iconCls:"x-group-by-icon"});if(this.enableNoGroups){this.hmenu.add({itemId:"showGroups",text:this.showGroupsText,checked:true,checkHandler:this.onShowGroupsClick,scope:this})}this.hmenu.on("beforeshow",this.beforeMenuShow,this)}},onGroupByClick:function(){this.grid.store.groupBy(this.cm.getDataIndex(this.hdCtxIndex));this.beforeMenuShow()},onShowGroupsClick:function(A,B){if(B){this.onGroupByClick()}else{this.grid.store.clearGrouping()}},toggleGroup:function(C,B){this.grid.stopEditing(true);C=Ext.getDom(C);var A=Ext.fly(C);B=B!==undefined?B:A.hasClass("x-grid-group-collapsed");this.state[A.dom.id]=B;A[B?"removeClass":"addClass"]("x-grid-group-collapsed")},toggleAllGroups:function(C){var B=this.getGroups();for(var D=0,A=B.length;D<A;D++){this.toggleGroup(B[D],C)}},expandAllGroups:function(){this.toggleAllGroups(true)},collapseAllGroups:function(){this.toggleAllGroups(false)},interceptMouse:function(B){var A=B.getTarget(".x-grid-group-hd",this.mainBody);if(A){B.stopEvent();this.toggleGroup(A.parentNode)}},getGroup:function(A,D,F,G,B,E){var C=F?F(A,{},D,G,B,E):String(A);if(C===""){C=this.cm.config[B].emptyGroupText||this.emptyGroupText}return C},getGroupField:function(){return this.grid.store.getGroupState()},afterRender:function(){Ext.grid.GroupingView.superclass.afterRender.call(this);if(this.grid.deferRowRender){this.updateGroupWidths()}},renderRows:function(){var A=this.getGroupField();var D=!!A;if(this.hideGroupedColumn){var B=this.cm.findColumnIndex(A);if(!D&&this.lastGroupField!==undefined){this.mainBody.update("");this.cm.setHidden(this.cm.findColumnIndex(this.lastGroupField),false);delete this.lastGroupField}else{if(D&&this.lastGroupField===undefined){this.lastGroupField=A;this.cm.setHidden(B,true)}else{if(D&&this.lastGroupField!==undefined&&A!==this.lastGroupField){this.mainBody.update("");var C=this.cm.findColumnIndex(this.lastGroupField);this.cm.setHidden(C,false);this.lastGroupField=A;this.cm.setHidden(B,true)}}}}return Ext.grid.GroupingView.superclass.renderRows.apply(this,arguments)},doRender:function(D,G,P,A,O,R){if(G.length<1){return""}var Y=this.getGroupField(),N=this.cm.findColumnIndex(Y),V;this.enableGrouping=!!Y;if(!this.enableGrouping||this.isUpdating){return Ext.grid.GroupingView.superclass.doRender.apply(this,arguments)}var H="width:"+this.getTotalWidth()+";";var Q=this.grid.getGridEl().id;var F=this.cm.config[N];var B=F.groupRenderer||F.renderer;var S=this.showGroupName?(F.groupName||F.header)+": ":"";var X=[],K,T,U,M;for(T=0,U=G.length;T<U;T++){var J=A+T,L=G[T],E=L.data[Y];V=this.getGroup(E,L,B,J,N,P);if(!K||K.group!=V){M=Q+"-gp-"+Y+"-"+Ext.util.Format.htmlEncode(V);var C=typeof this.state[M]!=="undefined"?!this.state[M]:this.startCollapsed;var I=C?"x-grid-group-collapsed":"";K={group:V,gvalue:E,text:S+V,groupId:M,startRow:J,rs:[L],cls:I,style:H};X.push(K)}else{K.rs.push(L)}L._groupId=M}var W=[];for(T=0,U=X.length;T<U;T++){V=X[T];this.doGroupStart(W,V,D,P,O);W[W.length]=Ext.grid.GroupingView.superclass.doRender.call(this,D,V.rs,P,V.startRow,O,R);this.doGroupEnd(W,V,D,P,O)}return W.join("")},getGroupId:function(F){var D=this.grid.getGridEl().id;var C=this.getGroupField();var E=this.cm.findColumnIndex(C);var B=this.cm.config[E];var G=B.groupRenderer||B.renderer;var A=this.getGroup(F,{data:{}},G,0,E,this.ds);return D+"-gp-"+C+"-"+Ext.util.Format.htmlEncode(F)},doGroupStart:function(A,D,B,E,C){A[A.length]=this.startGroup.apply(D)},doGroupEnd:function(A,D,B,E,C){A[A.length]=this.endGroup},getRows:function(){if(!this.enableGrouping){return Ext.grid.GroupingView.superclass.getRows.call(this)}var G=[];var F,C=this.getGroups();for(var E=0,A=C.length;E<A;E++){F=C[E].childNodes[1].childNodes;for(var D=0,B=F.length;D<B;D++){G[G.length]=F[D]}}return G},updateGroupWidths:function(){if(!this.enableGrouping||!this.hasRows()){return }var C=Math.max(this.cm.getTotalWidth(),this.el.dom.offsetWidth-this.scrollOffset)+"px";var B=this.getGroups();for(var D=0,A=B.length;D<A;D++){B[D].firstChild.style.width=C}},onColumnWidthUpdated:function(C,A,B){Ext.grid.GroupingView.superclass.onColumnWidthUpdated.call(this,C,A,B);this.updateGroupWidths()},onAllColumnWidthsUpdated:function(A,B){Ext.grid.GroupingView.superclass.onAllColumnWidthsUpdated.call(this,A,B);this.updateGroupWidths()},onColumnHiddenUpdated:function(B,C,A){Ext.grid.GroupingView.superclass.onColumnHiddenUpdated.call(this,B,C,A);this.updateGroupWidths()},onLayout:function(){this.updateGroupWidths()},onBeforeRowSelect:function(D,C){if(!this.enableGrouping){return }var B=this.getRow(C);if(B&&!B.offsetParent){var A=this.findGroup(B);this.toggleGroup(A,true)}}});Ext.grid.GroupingView.GROUP_ID=1000;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
if(!window.Artery){Artery={}}Artery.tpl={};Ext.UpdateManager.defaults.indicatorText='<div class="loading-indicator">加载中，请稍候......</div>';if(Ext.View){Ext.View.prototype.emptyText=""}if(Ext.grid&&Ext.grid.GridPanel){Ext.grid.GridPanel.prototype.ddText="{0} 选择行"}if(Ext.TabPanelItem){Ext.TabPanelItem.prototype.closeText="关闭"}if(Ext.form&&Ext.form.Field){Ext.form.Field.prototype.invalidText="输入值非法"}if(Ext.LoadMask){Ext.LoadMask.prototype.msg="加载中..."}Date.monthNames=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"];Date.dayNames=["日","一","二","三","四","五","六"];if(Ext.MessageBox){Ext.MessageBox.buttonText={ok:"确定",cancel:"取消",yes:"是",no:"否"}}if(Ext.util.Format){Ext.util.Format.date=function(A,B){if(!A){return""}if(!(A instanceof Date)){A=new Date(Date.parse(A))}return A.dateFormat(B||"y年m月d日")}}if(Ext.DatePicker){Ext.apply(Ext.DatePicker.prototype,{todayText:"今天",minText:"日期在最小日期之前",maxText:"日期在最大日期之后",disabledDaysText:"",disabledDatesText:"",monthNames:Date.monthNames,dayNames:Date.dayNames,nextText:"下月 (Control+Right)",prevText:"上月 (Control+Left)",monthYearText:"选择一个月 (Control+Up/Down 来改变年)",todayTip:"{0} (空格键选择)",format:"y年m月d日",okText:"确定",cancelText:"取消"})}if(Ext.PagingToolbar){Ext.apply(Ext.PagingToolbar.prototype,{beforePageText:"第",afterPageText:"页 共{0}页",firstText:"第一页",prevText:"前一页",nextText:"下一页",lastText:"最后页",refreshText:"刷新",displayMsg:"本页显示:{0} - {1} 总记录数:{2}",emptyMsg:"无记录"})}if(Ext.form&&Ext.form.Field){Ext.apply(Ext.form.Field.prototype,{blankText:"该输入项为必输项"})}if(Ext.form&&Ext.form.TextField){Ext.apply(Ext.form.TextField.prototype,{minLengthText:"该输入项的最小长度是 {0}",maxLengthText:"该输入项的最大长度是 {0}",blankText:"该输入项为必输项",regexText:"",emptyText:null})}if(Ext.form&&Ext.form.NumberField){Ext.apply(Ext.form.NumberField.prototype,{minText:"该输入项的最小值是 {0}",maxText:"该输入项的最大值是 {0}",zeroPLengthText:"请输入整数",maxPLengthText:"最多可输入{0}位小数",startEndText:"该输入项不能以“.”开始或结束",nanText:"{0} 不是有效数值"})}if(Ext.form&&Ext.form.DateField){Ext.apply(Ext.form.DateField.prototype,{disabledDaysText:"禁用",disabledDatesText:"禁用",minText:"该输入项的日期必须在 {0} （包括）之后",maxText:"该输入项的日期必须在 {0} （包括）之前",invalidText:"{0} 是无效的日期 - 必须符合格式： {1}",format:"y年m月d日"})}if(Ext.form&&Ext.form.ComboBox){Ext.apply(Ext.form.ComboBox.prototype,{loadingText:"加载...",valueNotFoundText:undefined})}if(Ext.form&&Ext.form.VTypes){Ext.apply(Ext.form.VTypes,{emailText:'该输入项必须是电子邮件地址，格式如： "user@example.com"',urlText:'该输入项必须是URL地址，格式如： "http://www.example.com"',alphaText:"该输入项只能包含字符和_",alphanumText:"该输入项只能包含字符,数字和_"})}if(Ext.grid&&Ext.grid.GridView){Ext.apply(Ext.grid.GridView.prototype,{sortAscText:"正序",sortDescText:"逆序",lockText:"锁列",unlockText:"解锁列",columnsText:"列"})}if(Ext.grid&&Ext.grid.PropertyColumnModel){Ext.apply(Ext.grid.PropertyColumnModel.prototype,{nameText:"名称",valueText:"值",dateFormat:"y年m月d日"})}if(Ext.layout&&Ext.layout.BorderLayout&&Ext.layout.BorderLayout.SplitRegion){Ext.apply(Ext.layout.BorderLayout.SplitRegion.prototype,{splitTip:"拖动来改变尺寸.",collapsibleSplitTip:"拖动来改变尺寸. 双击隐藏."})}Artery.LODDING="正在发送请求，请稍候";Artery.tpl.pageInfo='<span class="x-pagingbar-pageInfo">共有<span class="x-pagingbar-pageInfo-text">{rowCount}</span>条记录，当前显示<span class="x-pagingbar-pageInfo-text">{currentRowCount}</span>条记录</span>';Artery.ajaxLoginTip="用户登录已过期，点击将跳转到登录界面！";Ext.tusc={};Ext.tusc.plugins={};Ext.ux={};if(!window.Artery){Artery={}}Artery.frame={};Artery.script={};Artery.plugin={};Artery.FORM="1";Artery.REPORT="2";Artery.WRIT="3";Artery.PLUGIN="4";Artery.FRAME="5";Artery.PARAMCN="Aty_cnp_";Artery.SCROLLBAR_HEIGHT=18;Artery.escape=function(A){if(Ext.isEmpty(A)){return""}return Artery.PARAMCN+escape(A)};function StringBuffer(){this._strings=new Array()}StringBuffer.prototype.append=function(A){this._strings.push(A);return this};StringBuffer.prototype.toString=function(){return this._strings.join("")};Artery.alertMsg=function(B,A,C){Artery.pwin.Ext.Msg.show({title:B,msg:A,buttons:{ok:"确定"},fn:C})};Artery.confirmMsg=function(B,A,C){Artery.pwin.Ext.Msg.show({title:B,msg:A,buttons:{yes:"是",no:"否"},shadow:false,fn:C})};Artery.promptMsg=function(C,B,D,A){Artery.pwin.Ext.Msg.show({title:C,msg:B,prompt:true,buttons:{yes:"确定",cancel:"取消"},fn:D,value:A})};Artery.waitMsg=function(C,A,B){if(B==null){B="ext-mb-download"}return Artery.pwin.Ext.MessageBox.show({msg:C,progressText:A,width:300,wait:true,waitConfig:{interval:200},icon:B})};Artery.open=function(A){if(A==null){A={}}var B={height:(screen.availHeight-100),width:(screen.availWidth-10),left:0,top:0,status:"no",toolbar:"no",menubar:"no",location:"no",resizable:"yes",titlebar:"no",scrollbars:"yes"};if(A.feature!=null){Ext.apply(B,A.feature)}if(A.center){B.left=parseInt((screen.width-parseInt(B.width))/2);B.top=parseInt((screen.height-parseInt(B.height))/2)}var C=function(F){var G=[];for(var E in F){G.push(E+"="+F[E])}return G.join(",")};A.feature=C(B);if(A.url==null){A.url=""}var D=window.open(A.url,A.name,A.feature);return D};Artery.showMessage=function(B,A){Artery.getExt(top).getTipMessage().showMessage(B,A)};Artery.showInfo=function(A){Artery.showMessage(A,Ext.tusc.TIP_INFO)};Artery.showWarning=function(A){Artery.showMessage(A,Ext.tusc.TIP_WARN)};Artery.showError=function(B){var A=Artery.getExt(top).getTipMessage();A.showMessage(B,Ext.tusc.TIP_ERROR);A.clearTimeout()};Artery.isShowError=function(){var A=Artery.getExt(top).getTipMessage();return A.isError};Artery.loading=function(){Artery.getExt(top).getTipMessage().loading()};Artery.loadTrue=function(A){Artery.getExt(top).getTipMessage().loadTrue(A)};Artery.loadFalse=function(A){Artery.getExt(top).getTipMessage().loadFalse(A)};Artery.hideMessage=function(){Artery.getExt(top).getTipMessage().hideMessage()};Artery.getTipEl=function(){if(Artery.tipEl==null){Artery.tipEl=Ext.get(Ext.DomHelper.insertHtml("beforeEnd",document.body,'<div class="artery-tip x-hidden-display"><div class="artery-tip-right"><div class="artery-tip-close"></div><div class="artery-tip-text"></div></div></div>'))}return Artery.tipEl};Artery.showTip=function(C,A){if(Artery.tipTimeHolder){clearTimeout(Artery.tipTimeHolder)}var B=Artery.getTipEl();B.child(".artery-tip-text").update(C);B.removeClass("artery-tip-error");B.removeClass("artery-tip-warning");B.alignTo(A?A:document.body,"t-t",[0,5]);B.child(".artery-tip-close").on("click",function(){B.hide()},this,{delay:300});B.show();Artery.tipTimeHolder=(function(){Artery.getTipEl().hide()}).defer(parseInt(Ext.tusc.TIP_DEFERTIME)*1000)};Artery.showTipError=function(C,A){if(Artery.tipTimeHolder){clearTimeout(Artery.tipTimeHolder)}var B=Artery.getTipEl();B.child(".artery-tip-text").update(C);B.removeClass("artery-tip-warning");B.addClass("artery-tip-error");B.alignTo(A?A:document.body,"t-t",[0,5]);B.child(".artery-tip-close").on("click",function(){B.hide()},this,{delay:200});B.show()};Artery.showTipWarning=function(C,A){if(Artery.tipTimeHolder){clearTimeout(Artery.tipTimeHolder)}var B=Artery.getTipEl();B.child(".artery-tip-text").update(C);B.removeClass("artery-tip-error");B.addClass("artery-tip-warning");B.alignTo(A?A:document.body,"t-t",[0,5]);B.child(".artery-tip-close").on("click",function(){B.hide()},this,{delay:200});B.show()};Artery.showComment=function(){var C=function(){var D=Artery.getParams({comment:this.comment},this);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=updateDictFieldComment",success:function(F,G){var E=F.responseText;if(E!="ok"){Artery.showError("出错啦，请检查！")}},scope:this,params:D})};var B=function(E){var D=this;if(E.initFileldTip){return }E.initFileldTip=true;E.onRenderBody=function(F){if(Ext.isTrue(D.showCmtEditBtn)){F.update('<textarea class="x-aty-tipPanel-body-container"></textarea><div class="x-aty-tipPanel-footer">修改</div>')}else{F.update('<textarea class="x-aty-tipPanel-body-container">')}E.bodyContainer=E.el.child(".x-aty-tipPanel-body-container");E.bodyContainer.dom.readOnly=true;E.editBtn=E.el.child(".x-aty-tipPanel-footer");if(E.editBtn){E.editBtn.on("click",function(G){if(E.bodyContainer.dom.readOnly){E.dd.lock();E.syncSize();E.editBtn.update("保存");E.bodyContainer.dom.readOnly=false;E.bodyContainer.setStyle("border","1px solid #FF9000");E.bodyContainer.setStyle("background-color","#FFFFC6")}else{E.dd.unlock();E.syncSize();E.editBtn.update("修改");E.bodyContainer.dom.readOnly=true;E.bodyContainer.setStyle("border","0");E.bodyContainer.setStyle("background-color","transparent");E.saveComment()}},E)}E.bodyContainer.on("keyup",function(){E.refreshSize()})};E.saveComment=function(){var F=Artery.get(E.fieldId);F.comment=E.bodyContainer.dom.value;C.call(F)};E.update=function(F){this.bodyContainer.dom.value=F};E.refreshSize=function(){E.bodyContainer.dom.style.height="auto";var F=parseInt((E.bodyContainer.dom.value.length/10)/5)*20;if(150+F>250){E.setWidth(250)}else{E.setWidth(150+F)}if(E.bodyContainer.getHeight()>300){E.bodyContainer.dom.style.height="300px"}var I=Ext.getBody().getHeight();var H=Artery.get(E.fieldId);var G=I-H.el.getY();if(G<E.getHeight()){if(G<100){if(H.el.getY()>E.getHeight()){E.el.setY(H.el.getY()-E.getHeight()+20)}else{E.el.setY(10);E.bodyContainer.dom.style.height=G-50+"px"}}else{E.bodyContainer.dom.style.height=G-50+"px"}}E.syncSize()}};var A=Artery.getCoolTip({key:"fieldCommentTip"});A.fieldId=this.id;B.call(this,A);A.alignTo(this.tipEl,"tr?",[0,-12]);if(A.editBtn){A.editBtn.update("修改")}A.bodyContainer.dom.readOnly=true;A.bodyContainer.setStyle("border","0");A.bodyContainer.setStyle("background-color","transparent");A.update(this.comment);A.dd.unlock();A.refreshSize()};Artery.getLoadingEl=function(){if(Artery.loadingEl==null){Artery.loadingEl=Ext.get(Ext.DomHelper.insertHtml("beforeEnd",document.body,'<div class="artery-loading x-hidden-display"></div>'))}return Artery.loadingEl};Artery.removeLoadingEl=function(){if(Artery.loadingEl!=null){Artery.loadingEl.remove();Artery.loadingEl=null}};Artery.showLoading=function(B,A,C){Artery.getLoadingEl().alignTo(B,A,C);Artery.getLoadingEl().show()};Artery.hideLoading=function(){Artery.removeLoadingEl()};Artery.showSysError=function(A){if(Artery.isShowError()){return }var B="<span style='height:20px;color:red;'>出错啦，请检查！</span>";if(A.itemid){B+="<br><span style='width:60px;'>组件id:</span>"+A.itemid}if(A.prop){B+="<br><span style='width:60px;'>属性名称:</span>"+A.prop}B+="<br><span style='width:60px;'>错误信息:</span>"+A.error;Artery.showError(B);if(A.event){throw A.event}};Artery.applyIf=function(B,C){if(B&&C){for(var A in C){if(typeof B[A]=="undefined"){B[A]=C[A]}}}return B};var timer1;function loadXMLString(C){var A=null;try{var D=new DOMParser();A=D.parseFromString(C,"text/xml")}catch(B){A=new ActiveXObject("Microsoft.XMLDOM");A.loadXML(C)}return A}String.prototype.isEmpty=function(){return((this.replace(/ /g,"").length==0)?true:false)};String.prototype.format=function(B){var A=this;if(arguments.length>0){if(arguments.length==1&&typeof (B)=="object"){for(var D in B){if(B[D]!=undefined){var E=new RegExp("({"+D+"})","g");A=A.replace(E,B[D])}}}else{for(var C=0;C<arguments.length;C++){if(arguments[C]!=undefined){var E=new RegExp("({["+C+"]})","g");A=A.replace(E,arguments[C])}}}}return A};function showTips(B,A){Artery.getExt(top).getTipMessage().showMessage(B,A)}function showProcess(){var A=showProcess.arguments;var C=showProcess.arguments.length;var E=(C>0)?A[0]:"\u8fdb\u5ea6\u663e\u793a";var D=(C>1)?A[1]:"\u6b63\u5728\u5904\u7406\u8bf7\u6c42...";Ext.Msg.show({title:E,msg:D,width:240,progress:true,closable:false});v=0;var B=function(){v=v+1;Ext.Msg.updateProgress((v%20)/20,D)};timer1=setInterval(B,50)}function hideProcess(){clearInterval(timer1);Ext.Msg.hide()}Artery.getCommaSplitValue=function(A){return Artery.getSplitValue(A)};Artery.getSplitValue=function(A){if(!Ext.isEmpty(A)){var B=Artery.getMultiSelectSeparator();if(A.indexOf(",")!=-1&&","!=(B)){return A.replace(/,/g,B)}if(A.indexOf(";")!=-1&&";"!=(B)){return A.replace(/;/g,B)}}return A};Artery.getMultiSelectSeparator=function(){var A=Artery.config.multiSelectSeparator;if(Ext.isEmpty(A)){return";"}else{return A}};Artery.createHiddenInput=function(D,B,C){var A=document.createElement("input");A.type="hidden";A.id=D+"_hidden";A.name=B;A.value=C;return A};Artery.setSubmitHiddenValue=function(C,B){var A=document.getElementById(C+"_hidden");if(A){A.value=B}};Artery.getStateTagName=function(B){var A=null;if(B=="insert"){A="InsertItems"}else{if(B=="update"){A="UpdateItems"}else{if(B=="display"){A="DisplayItems"}else{if(B=="print"){A="PrintItems"}}}}return A};Artery.getExt=function(B){if(Artery.isSameContext(B)){return B.Ext}var A=window;while(A.parent&&A!=A.parent&&A!=B){if(!Artery.isSameContext(A.parent,A)){return A.Ext}A=A.parent}var D=window;while(D.opener&&D!=D.opener&&D!=B){if(!Artery.isSameContext(D.opener,D)){return D.Ext}D=D.opener}var C=window;while(C.dialogArguments&&C!=C.dialogArguments&&C!=B){if(!Artery.isSameContext(C.dialogArguments,C)){return C.Ext}C=C.dialogArguments}return Ext};Artery.isSameContext=function(A,C){try{C=C||window;return C.Artery&&C.sys&&A.Artery&&A.sys&&A.sys.getContextPath()==C.sys.getContextPath()}catch(B){}return false};Artery.Event={addEvent:function(C,A,B){if(document.addEventListener){C.addEventListener(A,B,false)}else{C.attachEvent("on"+A,B)}},onResizend:function(B){var D="normal",A=null,C=function(){A&&clearTimeout(A);A=setTimeout(function(){B&&B();D="normal"},100)};this.addEvent(window,"resize",function(){D="resizing";C()})},onResizestart:function(B){var A=false;this.onResizend(function(){A=false});this.addEvent(window,"resize",function(){if(!A){B&&B();A=true}})}};Ext.EventManager.on(Ext.isIE?document:window,"keydown",function(D,C){var B=C.tagName.toLowerCase();var A=B=="textarea"||B=="input"||C.contentEditable=="true";if(D.getKey()==D.BACKSPACE&&(!A||C.disabled||C.readOnly)){D.stopEvent()}});Ext.encrypt=function(C){var A;var B=new Array();for(A=0;A<C.length;A++){B.push(C.charCodeAt(A))}return B.join("")};Ext.isTrue=function(A){if(A==true||A=="true"){return true}return false};Ext.isNum=function(A){if(Ext.isEmpty(A)){return false}if(/^[0-9.]+$/.test(A)){return true}return false};Ext.getNumber=function(B,A){var C=parseInt(B);if(Ext.isNum(C)){return C}else{return A}};Ext.isEncode=function(B){var A=/^[\w`~!@#$%^&*()-=_+{}|;':",./<>? ]*$/;if(A.test(B)){return false}else{return true}};Ext.apply(String,{escapeQuote:function(A){if(A==null){return""}return A.replace(/(')/g,"\\$1")}});Ext.HtmlEncode=function(A){if(typeof A!="string"){A=A+""}A=A.replace(/&/g,"&amp;");A=A.replace(/</g,"&lt;");A=A.replace(/>/g,"&gt;");return A};Ext.validUpZipFile=function(B){var A=/.+\.zip$/i;if(!A.test(B)){return"请选择Zip文件！"}return true};ajaxCallback=function(A,C){var B=A.responseText;if(!Ext.isEmpty(B)&&B.indexOf('name="j_username"')!=-1&&B.indexOf('name="j_password"')!=-1){alert(Artery.ajaxLoginTip);top.window.location.href=sys.getContextPath()+Artery.config.ajaxLoginPage;if(C){releaseObject(C)}A=null;return true}return false};if(Ext.data.Store){Ext.data.Store.prototype.applySort=function(){if(this.sortInfo&&!this.remoteSort){var C=this.sortInfo,D=C.field;var A=this.fields.get(D).sortType;var B=function(F,E){var H=A(F.data[D]),G=A(E.data[D]);if(typeof (H)=="string"){return H.localeCompare(G)}return H>G?1:(H<G?-1:0)};this.data.sort(C.direction,B);if(this.snapshot&&this.snapshot!=this.data){this.snapshot.sort(C.direction,B)}}}}(function(){Ext.reqInterceptors=[];Ext.regReqInterceptor=function(A){Ext.reqInterceptors.push(A)}})();Ext.lib.Ajax=function(){var E=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],B="Content-Type";function F(R){var Q=R.conn,S;function P(T,U){for(S in U){if(U.hasOwnProperty(S)){T.setRequestHeader(S,U[S])}}}if(I.defaultHeaders){P(Q,I.defaultHeaders)}if(I.headers){P(Q,I.headers);I.headers=null}}function C(S,R,Q,P){return{tId:S,status:Q?-1:0,statusText:Q?"transaction aborted":"communication failure",isAbort:true,isTimeout:true,argument:R}}function H(P,Q){(I.headers=I.headers||{})[P]=Q}function M(W,U){var Q={},S,T=W.conn,P,R;try{S=W.conn.getAllResponseHeaders();Ext.each(S.replace(/\r\n/g,"\n").split("\n"),function(X){P=X.indexOf(":");if(P>=0){R=X.substr(0,P).toLowerCase();if(X.charAt(P+1)==" "){++P}Q[R]=X.substr(P+1)}})}catch(V){}return{tId:W.tId,status:T.status,statusText:T.statusText,getResponseHeader:function(X){return Q[X.toLowerCase()]},getAllResponseHeaders:function(){return S},responseText:T.responseText,responseXML:T.responseXML,argument:U}}function L(P){P.conn=null;P=null}function D(R,X,T,S){if(!X){L(R);return }var V,P;try{if(R.conn.status!==undefined&&R.conn.status!=0){V=R.conn.status}else{V=13030}}catch(W){V=13030}if((V>=200&&V<300)||(Ext.isIE&&V==1223)){P=M(R,X.argument);var Y=P.responseText;var Q=Ext.reqInterceptors.length;for(var U=0;U<Q;U++){if(Ext.reqInterceptors[U].call(this,Y)===false){return }}if(ajaxCallback(P,R)){return }if(X.success){if(!X.scope){X.success(P)}else{X.success.apply(X.scope,[P])}}}else{switch(V){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:P=C(R.tId,X.argument,(T?T:false),S);if(X.failure){if(!X.scope){X.failure(P)}else{X.failure.apply(X.scope,[P])}}break;default:P=M(R,X.argument);if(X.failure){if(!X.scope){X.failure(P)}else{X.failure.apply(X.scope,[P])}}}}L(R);P=null}function K(P,Q){P.conn.onreadystatechange=function(){if(P.conn&&P.conn.readyState==4){D(P,Q)}}}var A=new RegExp("^arterycmd:.*$");function O(Q){var P={};Ext.apply(P,Q);P.success=function(R){var S=R.responseText;if(A.test(S)){var T=S.substr(10);window.open(T,"_top");return }if(Q.success){if(!Q.scope){Q.success(R)}else{Q.success.apply(Q.scope,[R])}}};return P}function G(V,S,U,Q,P){if(P==null){P=true}var T=J()||null;if(T){T.conn.open(V,S,P);if(I.useDefaultXhrHeader){H("X-Requested-With",I.defaultXhrHeader)}if(Q&&I.useDefaultHeader&&(!I.headers||!I.headers[B])){H(B,I.defaultPostHeader)}if(I.defaultHeaders||I.headers){F(T)}var R=O(U);K(T,R);T.conn.send(Q||null)}return T}function J(){var Q;try{if(Q=N(I.transactionId)){I.transactionId++}}catch(P){}finally{return Q}}function N(S){var P;try{P=new XMLHttpRequest()}catch(R){for(var Q=0;Q<E.length;++Q){try{P=new ActiveXObject(E[Q]);break}catch(R){}}}finally{return{conn:P,tId:S}}}var I={request:function(P,S,T,U,Y){var R=true;if(Y){var V=this,Q=Y.xmlData,W=Y.jsonData,X;Ext.applyIf(V,Y);if(Q||W){X=V.headers;if(!X||!X[B]){H(B,Q?"text/xml":"application/json")}U=Q||(Ext.isObject(W)?Ext.encode(W):W)}if(Y.syn!=null){R=Y.syn}}return G(P||Y.method||"POST",S,T,U,R)},serializeForm:function(Q){var R=Q.elements||(document.forms[Q]||Ext.getDom(Q)).elements,X=false,W=encodeURIComponent,U,Y,P,S,T="",V;Ext.each(R,function(Z){P=Z.name;V=Z.type;if(!Z.disabled&&P){if(/select-(one|multiple)/i.test(V)){Ext.each(Z.options,function(a){if(a.selected){T+=String.format("{0}={1}&",W(P),(a.hasAttribute?a.hasAttribute("value"):a.getAttributeNode("value").specified)?a.value:a.text)}})}else{if(!/file|undefined|reset|button/i.test(V)){if(!(/radio|checkbox/i.test(V)&&!Z.checked)&&!(V=="submit"&&X)){T+=W(P)+"="+W(Z.value)+"&";X=/submit/i.test(V)}}}}});return T.substr(0,T.length-1)},useDefaultHeader:true,defaultPostHeader:"application/x-www-form-urlencoded; charset=UTF-8",useDefaultXhrHeader:true,defaultXhrHeader:"XMLHttpRequest",poll:{},timeout:{},pollInterval:50,transactionId:0,abort:function(S,U,P){var R=this,T=S.tId,Q=false;if(R.isCallInProgress(S)){S.conn.abort();clearInterval(R.poll[T]);R.poll[T]=null;if(P){R.timeout[T]=null}D(S,U,(Q=true),P)}return Q},isCallInProgress:function(P){return P.conn&&!{0:true,4:true}[P.conn.readyState]}};return I}();Ext.tusc.TIP_OK="2";Ext.tusc.TIP_INFO="3";Ext.tusc.TIP_WARN="1";Ext.tusc.TIP_ERROR="4";Ext.tusc.TIP_LOADDING="loading";Ext.tusc.TipMessage=Ext.extend(Ext.Component,{msgEl:null,messageAlign:"bl-bl",alignEl:null,tipMessageCls:"x-tip-message",defaultType:"tips_ok",deferTime:4000,isError:false,active:false,initComponent:function(){Ext.tusc.TipMessage.superclass.initComponent.call(this);this.initDeferTime()},initDeferTime:function(){if(!Ext.isEmpty(Ext.tusc.TIP_DEFERTIME)&&Ext.tusc.TIP_DEFERTIME!="null"){this.deferTime=parseInt(Ext.tusc.TIP_DEFERTIME)*1000}},getMsgEl:function(){if(!this.msgEl){this.msgEl=Ext.DomHelper.append(Ext.getBody(),{cls:this.tipMessageCls+" x-hide-offsets"},true);this.msgElBody=this.msgEl.createChild({cls:"tips_body"});this.msgIframe=this.msgEl.createChild({tag:"iframe",frameborder:0,style:"overflow:hidden"});this.msgElCenter=this.msgElBody.insertFirst({cls:"x-message-center",html:"aa"});this.msgElTop=this.msgElBody.insertFirst({cls:"x-message-top"});this.msgElTopClose=this.msgElTop.insertFirst({cls:"x-message-top-close"});this.msgElTop.on("click",function(A){this.hideMessage()},this,{stopEvent:true});this.smallMsgEl=this.msgEl.createChild({cls:"x-tip-message-small"});this.smallMsgEl.on("click",function(A){this.showMsgEl();this.clearTimeout()},this,{stopEvent:true})}return this.msgEl},synWidth:function(){this.msgIframe.setHeight(this.msgElBody.getHeight());this.msgIframe.setWidth(this.msgElBody.getWidth())},setWidth:function(A){this.getMsgEl().dom.style.width=A},clearWidth:function(A){this.getMsgEl().dom.style.width=""},getMessageCenter:function(){if(this.msgElCenter==null){this.getMsgEl()}return this.msgElCenter},getAlignEl:function(){if(this.alignEl!=null){return this.alignEl}else{return Ext.getBody()}},clearTimeout:function(){if(this.cleartimeid){window.clearTimeout(this.cleartimeid);this.cleartimeid=null}},loading:function(){this.setWidth(200);this.animating=true;this.clearTimeout();this.updateMessage(Artery.LODDING,Ext.tusc.TIP_LOADDING);if(!this.active){this.getMsgEl().alignTo(this.getAlignEl(),this.messageAlign,[0,0]).slideIn("b",{duration:0.3,easing:"easeOut",callback:function(){this.animating=false;this.getMsgEl().setTop("auto");this.getMsgEl().setBottom("0px")},scope:this})}this.active=true},loadTrue:function(A){this.showMessage(A,Ext.tusc.TIP_OK)},loadFalse:function(A){this.showMessage(A,Ext.tusc.TIP_ERROR)},showMessage:function(B,A){if(Ext.isEmpty(B)){return }this.showMsgEl(B,A)},showMsgEl:function(B,A){this.clearWidth();this.clearTimeout();this.updateMessage(B,A);this.synWidth();if(!this.active){this.getMsgEl().alignTo(this.getAlignEl(),this.messageAlign,[0,0]).slideIn("b",{duration:0.3,easing:"easeOut",callback:function(){this.getMsgEl().setTop("auto");this.getMsgEl().setBottom("0px")},scope:this})}this.active=true;this.cleartimeid=this.hideMessage.defer(this.deferTime,this)},hideMessage:function(){this.msgElBody.setDisplayed(false);this.msgIframe.setDisplayed(false);this.active=false;this.smallMsgEl.setStyle("display","block");this.getMsgEl().alignTo(this.getAlignEl(),this.messageAlign,[0,0]).slideIn("b",{duration:0.3,easing:"easeOut",callback:function(){this.getMsgEl().setTop("auto");this.getMsgEl().setBottom("0px")},scope:this})},hideSmallMessageBtn:function(){this.smallMsgEl.setStyle("display","none")},updateMessage:function(B,A){this.msgElBody.setDisplayed(true);this.msgIframe.setDisplayed(true);this.smallMsgEl.setStyle("display","none");if(!Ext.isEmpty(B)){var C=String.format('<div class="x-tip-text {0}">{1}</div>',this.getTypeIcon(A),B);this.getMessageCenter().update(C);this.synWidth()}},getTypeIcon:function(A){this.isError=false;if(A==null){return this.defaultType}else{if(A==Ext.tusc.TIP_OK){return"tips_ok"}else{if(A==Ext.tusc.TIP_INFO){return"tips_info"}else{if(A==Ext.tusc.TIP_WARN){return"tips_warning"}else{if(A==Ext.tusc.TIP_ERROR){this.isError=true;return"tips_error"}else{if(A==Ext.tusc.TIP_LOADDING){return"tips_loading"}else{return this.defaultType}}}}}}}});Ext.getTipMessage=function(){if(Ext.tipMessage==null){Ext.tipMessage=new Ext.tusc.TipMessage()}return Ext.tipMessage};Artery.showLicenseMessage=function(){if(!Artery||!Artery.config||!Artery.config.loadType||!Artery.config.license.lt){return }var A=Artery.config.debug;var D=Artery.config.loadType;var B=Artery.config.license.lt;var C=new Artery.Tip();if(A=="true"||D=="3"||D=="1"){C.enable=true;C.addMsg("正在运行在“开发模式”下，页面的打开速度会很慢！")}if(C.enable&&getCookie("tipShow")!="close"){C.show()}};Ext.onReady(function(){if(Artery.pwin){Artery.pwin.Artery.showLicenseMessage()}});Artery.Tip=function(){this.tipDiv=document.createElement("div");this.tipDiv.id="tipDiv";this.tipDiv.style.height="20px";this.tipDiv.style.width="360px";this.tipDiv.style.backgroundColor="#ffffcc";this.tipDiv.style.padding="10px";this.tipDiv.style.position="absolute";this.tipDiv.style.top="0px";this.tipDiv.style.left="0px";this.tipDiv.style.padding=3;this.tipDiv.style.borderWidth=1;this.tipDiv.style.borderColor="#804000";this.tipDiv.style.borderStyle="solid";this.tipDiv.innerHTML='<a href="javascript:Artery.Tip.closeTip();" style="position:absolute;top:3px; right:3px;" >不再提示</a>';this.enable=false;this.show=function(){if(this.enable){if(document.getElementById("tipDiv")==null){document.body.appendChild(this.tipDiv);this.enable=false}}};this.addMsg=function(A){this.tipDiv.innerHTML=A+"</br>"+this.tipDiv.innerHTML}};Artery.Tip.closeTip=function(){document.getElementById("tipDiv").style.visibility="hidden";setCookie("tipShow","close")};function setCookie(A,C){var B=10000;var D=new Date();D.setTime(D.getTime()+B*24*60*60*1000);document.cookie=A+"="+escape(C)+";expires="+D.toGMTString()}function getCookie(B){var A=document.cookie.match(new RegExp("(^| )"+B+"=([^;]*)(;|$)"));if(A!=null){return unescape(A[2])}return null}Ext.onReady(function(){for(var H=0;H<10;H++){var C="ARTERY_MONITOR"+H;var F=Ext.util.Cookies.get(C);if(F!=undefined&&F!=""){var B=F.split("__");if(B[0]=="PARSEID"+Artery.parseId){var G=new Date().getTime()-aty_start_time;var D=window.screen.width+"";var A=window.screen.height+"";var E=D+"*"+A;document.cookie=C+"="+F+"__"+G+"__"+E+";path=/";if(Artery.config.debug=="true"){Ext.Ajax.request({url:"postMonitorData",method:"POST"})}break}}}});Artery.FORM_URL=sys.getContextPath()+"/artery/form/dealParse.do?action=parseForm&formid=";Artery.REPORT_URL=sys.getContextPath()+"/artery/report/dealParse.do?action=parseForm&formid=";Artery.WRIT_URL=sys.getContextPath()+"/artery/writparse.do?action=parse&writtplid=";Artery.SYS_URL=sys.getContextPath()+"/artery/subsys.do?action=enterSystem&sysID=";Artery.PLUGIN_URL=sys.getContextPath()+"/artery/pluginmake.do?action=run";Artery.SCRIPT_URL=sys.getContextPath()+"/artery/script.do?action=run";Artery.MSG_URL=sys.getContextPath()+"/artery/message/dealMessage.do?action=listMessage";var EXPORT_HTML=1;var EXPORT_PDF=2;var EXPORT_EXCEL=3;var EXPORT_CSV=4;var EXPORT_XLS=5;Artery.initItem=function(A){if(A==null){return null}var B=Ext.getCmp(A.id);if(B==null){B=Ext.create(A);B.el=Ext.get(B.id);B.render()}else{if(!B.rendered){B.render()}}return B};Artery.addInitSub=function(B,A){if(document.body!=null){Artery.initItem(A)}else{if(B.initSubs==null){B.initSubs=[]}B.initSubs.push(A)}};Artery.initSubItems=function(B){var A=B.initSubs;if(A&&A.length>0){delete B.initSubs;for(var C=0;C<A.length;C++){Artery.initItem(A[C])}}};Artery.get=function(id){if(Ext.isEmpty(id)||id.indexOf("-")!=-1){return }var cmp=Ext.getCmp(id);if(cmp==null||!cmp.rendered){cmp=eval("Artery.initItem(Artery.cfg_"+id+")")}return cmp};Artery.getCmp=function(A){return Artery.get(A)};Artery.getParams=function(A,B){A=A||{};A=Ext.decode(Ext.encode(A));var C=Ext.apply({},Artery.params);if(B&&B.linktoId){Ext.apply(C,Artery.linktoParams[B.linktoId])}A.formid=A.formid||A.formId||Artery.getFormId(B)||C.formid||C.formId;delete A.formId;delete C.formId;A.itemid=A.itemid||A.itemId||(B&&B.getItemId?B.getItemId():Artery.getEventId(B))||C.itemid||C.itemId;delete A.itemId;delete C.itemId;Ext.apply(C,A);return C};Artery.addItem=function(B,A){if(B==null){return }if(B.items==null){B.items=[]}B.items[B.items.length]=A;A.pid=B.id};Artery.addButton=function(B,A){if(B==null){return }if(B.buttons==null){B.buttons=[]}B.buttons[B.buttons.length]=A};Artery.addChildNode=function(B,A){if(B==null){return }if(B.children==null){B.children=[]}B.children[B.children.length]=A};Artery.getWindow=function(){return window};Artery.createCaller=function(C,A,F){var E="";if(Ext.isString(C)){E=C}else{E=Artery.getEventId(C)}var B=new Artery.script.ScriptRunner();if(C){B.item=C;B.put("itemid",E)}else{return null}if(F){B.put("formid",F)}else{if(Artery.params!=null){if(Artery.params.formid){B.put("formid",Artery.params.formid)}else{if(Artery.params.frameid){B.put("formid",Artery.params.frameid)}else{if(Artery.params.writtplid){B.put("formid",Artery.params.writtplid)}}}}else{return null}}if(A){B.put("eventName",A)}else{return null}if(C.dynamicItem){B.put("dynamicItem","true");var D=C.dynamicEvent[A];if(!Ext.isEmpty(D)){B.put("dynamicMethod",D)}}return B};Artery.getEventId=function(B){if(Ext.isEmpty(B)){return null}if(Ext.isString(B)){var A=B.indexOf("_AcloneA_");if(A!=-1){return B.substring(0,A)}return B}if(B.eventId){return B.eventId}return B.id};Artery.getFormId=function(A){return Ext.isEmpty(A)?null:A.formId};Artery.CParam=function(A){this.id=null;this.value="";this.params=[];this.removeParams=[];Ext.apply(this,A)};Artery.CParam.prototype={toValue:function(){this.value=this.params.join(",");return this.value},addParam:function(B){if(!this.containParam(B)){this.params.push(B);this.toValue()}for(var A=0;A<this.removeParams.length;A++){if(this.removeParams[A]==B){this.removeParams.remove(this.removeParams[A])}}},removeParam:function(B){this.removeParams.push(B);for(var A=0;A<this.params.length;A++){if(this.params[A]==B){this.params.remove(this.params[A]);this.toValue();return }}},containParam:function(B){for(var A=0;A<this.params.length;A++){if(this.params[A]==B){return true}}return false},cleanParams:function(){this.params=[];this.removeParams=[];this.value=""},getParams:function(){var A="{"+this.id+":'"+String.escape(this.value)+"'}";return Ext.decode(A)},getRemoveParams:function(){var A="{"+this.id+":'"+String.escape(this.removeParams.join(","))+"'}";return Ext.decode(A)}};Artery.Win={close:function(){if(opener!=null||window.dialogArguments){window.close()}else{if(window.winObj!=null){window.winObj.close()}}},getCmp:function(A){return this.getWindow().Artery.getCmp(A)},get:function(A){return this.getWindow().Artery.get(A)},getWindow:function(){try{if(opener&&Artery.isSameContext(opener)){return opener}else{if(window.winObj&&window.winObj.opener&&Artery.isSameContext(window.winObj.opener)){return window.winObj.opener}else{if(window.dialogArguments&&Artery.isSameContext(window.dialogArguments)){return window.dialogArguments}else{if(parent&&Artery.isSameContext(parent)){return parent}else{return window}}}}}catch(A){}return null},getWin:function(){return this.getWindow().Artery.getWin()},showTip:function(B,A){this.getWindow().Artery.showTip(B,A)},showTipError:function(B,A){this.getWindow().Artery.showTipError(B,A)},callback:function(B){var A=this.getWindow();(A[B])(window,Artery)}};Artery.getWin=function(D){var A=function(F,K,J){var I=F.frames[K+"_iframe"];if(I!=null&&I.Artery){J.push(K+"_iframe");return I.Artery}for(var G=0;G<F.frames.length;G++){var E=F.frames[G];var H=A(E.window,K,J);if(H!=null){J.push(G);return H}}return null};if(D==null){return Artery.Win}else{var C=[];var B=A(Artery.TopWinManager.getTopWin(),D,C);if(B!=null){return B}if(opener&&opener.Artery){B=A(opener.Artery.TopWinManager.getTopWin(),D,C);if(B!=null){return B}}}};Artery.objMap=new Ext.util.MixedCollection();Artery.addObjToMap=function(A,B){if(arguments.length==1){var C=Ext.id();Artery.objMap.add(C,A);return C}else{Artery.objMap.add(A,B);return A}};Artery.getObjFromMap=function(A){return Artery.objMap.get(A)};Artery.TipPanel=function(A){Ext.apply(this,A);this.initComponent()};Artery.TipPanel.prototype={defaultAutoCreate:{tag:"div",id:"tipPanel-aty",cls:"x-aty-tipPanel x-hidden-display",cn:[{tag:"div",cls:"x-aty-tipPanel-header",cn:[{tag:"span",cls:"x-aty-tipPanel-header-close"}]},{tag:"div",cls:"x-aty-tipPanel-body"}]},initComponent:function(){Ext.DomHelper.append(document.body,this.defaultAutoCreate);this.el=Ext.get("tipPanel-aty");this.header=this.el.child(".x-aty-tipPanel-header");this.headerClose=this.el.child(".x-aty-tipPanel-header-close");this.body=this.el.child(".x-aty-tipPanel-body");this.headerClose.on("click",function(A){this.hide()},this);this.el.on("click",function(A){A.stopEvent()},this);this.el.on("mousedown",function(A){A.stopEvent();this.x=A.getPageX();this.y=A.getPageY();this.ex=this.el.getX();this.ey=this.el.getY()},this);this.el.on("mousemove",function(B){if(B.button==0){var A=this.ex+(B.getPageX()-this.x);var C=this.ey+(B.getPageY()-this.y);this.el.setXY([A,C])}},this)},showAt:function(A){this.adjustForConstraints(A);this.el.setXY(A);this.el.show();this.hidden=false},alignTo:function(B,A,C){this.el.show();this.el.alignTo(B,A,C)},adjustForConstraints:function(A){A[0]=A[0]+10;A[1]=A[1]+10},hide:function(){this.el.hide()},update:function(A){this.body.update(A)}};Artery.tipp=[];Artery.getTipPanel=function(A){if(Artery.tipp[A.key]==null){Artery.tipp[A.key]=new Artery.TipPanel(A)}return Artery.tipp[A.key]};if(Ext.Tip){Artery.CoolTip=Ext.extend(Ext.Tip,{arrowDirection:"left",initComponent:function(){this.width=150;this.cls="x-aty-tipWin-"+this.arrowDirection;this.draggable=true;Artery.CoolTip.superclass.initComponent.call(this)},onRender:function(B,A){Artery.CoolTip.superclass.onRender.call(this,B,A);Ext.DomHelper.overwrite(this.body,{tag:"div",cn:[{tag:"div",cls:"x-aty-tipPanel-header",cn:[{tag:"span",cls:"x-aty-tipPanel-header-close"}]},{tag:"div",cls:"x-aty-tipPanel-body"}]});this.header=this.el.child(".x-aty-tipPanel-header");this.headerClose=this.el.child(".x-aty-tipPanel-header-close");this.headerClose.on("click",function(C){this.hide()},this);this.bodyCt=this.el.child(".x-aty-tipPanel-body");this.onRenderBody(this.bodyCt)},onRenderBody:function(A){},afterRender:function(){Artery.CoolTip.superclass.afterRender.call(this);this.dd.setHandleElId(this.el.id)},alignTo:function(B,A,C){this.show();this.el.alignTo(B,A,C)},update:function(A){this.bodyCt.update(A)},changeTipPosition:function(A){this.el.replaceClass("x-aty-tipWin-"+this.arrowDirection,"x-aty-tipWin-"+A);this.arrowDirection=A}});Artery.coolTip=[];Artery.getCoolTip=function(A){if(Artery.coolTip[A.key]==null){Artery.coolTip[A.key]=new Artery.CoolTip(A)}return Artery.coolTip[A.key]};Artery.getFieldErrorCollTip=function(){return Artery.getCoolTip({key:"fieldValidTip",arrowDirection:"top",bodyStyle:"padding-bottom:15px;",style:"z-index:19999;"})}}Artery.correctTipPosition=function(){if(Ext.Tip){var A=Artery.getFieldErrorCollTip();if(A.isVisible()){A.correctPosition()}}};Artery.getXY=function(D,E){var G=function(N){var L={};var K=0;var O=0;while(Artery.pwin!=N){var M=N.parent.Ext.get(N.frameElement);K+=M.getLeft();O+=M.getTop();N=N.parent}L.x=K;L.y=O;return L};var I=0,F=0;var A=Ext.get(D.srcElement?D.srcElement:D.target).parent(".x-form-field-wrap");if(Artery.pwin==window){I=A.getLeft()+(A.getWidth()-E.getWidth());F=A.getTop()+A.getHeight();if((Ext.getBody().getHeight()+Ext.getBody().getScroll().top-F)<202){F=Ext.getBody().getHeight()+Ext.getBody().getScroll().top-202-A.getHeight()}}else{var J=G(window);I=J.x;F=J.y;var H=parent.Ext.get(window.frameElement);I+=A.getLeft()+(A.getWidth()-E.getWidth());F+=A.getTop()+A.getHeight();var C=G(parent);var B=C.y+parent.Ext.getBody().getHeight();if((B+parent.Ext.getBody().getScroll().top-F)<202){F=B+parent.Ext.getBody().getScroll().top-202-A.getHeight()}}if(I<0){I=0}return[I,F]};Artery.logout=function(A){Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=parseLogout",success:function(B,C){var D=B.responseText;if(D!=null){D=Ext.decode(D)}if(D!=null&&D.success==false){Artery.showError("出错啦，请检查！<br>"+D.error)}else{if(A!=null&&typeof A=="function"){A.call(this,D)}}},params:Artery.getParams(),scope:this})};Artery.openForm=function(B){if(B){if(!B.runTimeType){B.runTimeType="update"}if(!B.target){B.target="_self"}if(!B.params){B.params={}}if(B.paramsRequest){for(var F in Artery.params){if(F=="action"||F=="formid"||F=="runTimeType"||F=="formType"||F=="itemid"||F=="itemType"||F=="moreProp"||F=="buttonItemid"){continue}if(B.params[F]===undefined){B.params[F]=Artery.params[F]}}}Artery.parseWinCfg(B,Artery.awinid);var D=Artery.getParams();if(D.system){B.system=D.system}var E=null;var C=null;var A=false;C=Ext.tusc.getLinkUrl(B);if(!(C&&B)){return }if((B.urlmethod&&B.urlmethod.replace(/^\s+|\s+$/g,"").toLowerCase()=="post")||(C.length>1000&&(!B.urlmethod||B.urlmethod.replace(/^\s+|\s+$/g,"").toLowerCase()!="get"))){if(B.target=="_self"){Artery.autoSubmitForm(window,B);return }if(B.url){B.urlbak=B.url}else{B.urlbak=""}B.url="about:blank";B.urlmethod="post";A=true}if(B.formId||B.url){if(B.target=="_window"){E=Ext.getWindow(B)}else{E=Ext.getBlankWindow(B)}}if(E&&A){B.url=B.urlbak;Artery.autoSubmitForm(E,B)}if(E&&B.target!="_window"&&B.forceFocus){E.focus()}return E}};Artery.autoSubmitForm=function(E,F){var H=null;var A="";var C="_self";try{if(F.target=="_window"){H=E.getIframe().contentWindow.document;C=E.getIframe().name}else{C=E.name;try{H=window.frames(E.name).document}catch(G){H=E.document}}}catch(G){}if(H){A=Ext.tusc.getBaseUrl(F);try{var B=H.createElement("FORM");H.appendChild(B);B.method="POST";B.action=A;if(C&&C!=""){B.target=C}if(F.expName){B.onclick="window.open('about:blank',"+F.expName+")";B.target=F.expName}var D;for(var I in F.params){D=H.createElement("input");D.setAttribute("name",I);D.setAttribute("type","hidden");D.setAttribute("value",F.params[I]);B.appendChild(D)}B.submit()}catch(G){}}};Artery.download=function(D){var C=Artery.getParams(D);var B=Artery.getFormId(Artery.get(C.itemid));if(B){C.formid=B}var A=sys.getContextPath()+"/artery/form/dealParse.do?action=download&"+Ext.urlEncode(C);if(A.length>1000){cfg={};cfg.params=C;cfg.url="/artery/form/dealParse.do?action=download";Artery.autoSubmitForm(window,cfg)}else{if(Ext.isIE6){(function(){window.location.href=A}).defer(10)}else{window.location.href=A}}};Artery.getFormUrl=function(A){return Artery.getParseUrl(A,Artery.FORM)};Artery.getReportUrl=function(A){return Artery.getParseUrl(A,Artery.REPORT)};Artery.getWritUrl=function(A){return Artery.getParseUrl(A,Artery.WRIT)};Artery.getPluginUrl=function(A){return Artery.getParseUrl(A,Artery.PLUGIN)};Artery.getParseUrl=function(D,C){var A=sys.getContextPath();var B;if(C==null||C==Artery.FORM){B=A+"/artery/form/dealParse.do?action=parseForm&formid={0}&formType="+Artery.FORM}else{if(C==Artery.REPORT){B=A+"/artery/report/dealParse.do?action=parseForm&formid={0}&formType="+Artery.REPORT}else{if(C==Artery.WRIT){B=A+"/artery/writparse.do?action=parse&writtplid={0}&formType="+Artery.WRIT}else{if(C==Artery.PLUGIN){B=A+"/artery/pluginmake.do?action=run&id={0}&formType="+Artery.PLUGIN}}}}return String.format(B,D)};Artery.urlEncode=function(F,E){var C,A=[],B,D=encodeURIComponent;for(B in F){C=Ext.isEmpty(F[B]);Ext.each(C?B:F[B],function(H,G){A.push("&",D(B),"=",(H!=B||!C)?D(H):"")})}if(!E){A.shift();E=""}return E+A.join("")};Ext.tusc.encodeParam=function(B){for(var A in B){if(Ext.isEncode(B[A])){B[A]=Artery.escape(B[A])}}};Ext.tusc.getBaseUrl=function(A){var B=null;if(A.url!=null&&A.url.trim()!=""){B=A.url;var C=B.substring(0,1);if(A.forceContextPath!=false&&C=="/"){B=sys.getContextPath()+B}}else{if(A.formType==null||A.formType==Artery.FORM){B=Artery.getFormUrl(A.formId)}else{if(A.formType==Artery.REPORT){B=Artery.getReportUrl(A.formId)}else{if(A.formType==Artery.WRIT){B=Artery.getWritUrl(A.formId)}else{if(A.formType==Artery.PLUGIN){B=Artery.getPluginUrl(A.formId)}}}}}if(A.system){B=B+"&system="+A.system}return B};Ext.tusc.getLinkUrl=function(B){if(B&&B.url!=null&&B.url=="about:blank"){return B.url}var D=null;D=Ext.tusc.getBaseUrl(B);if(B.params==null){B.params={}}if(D){if(D.charAt(0)=="/"&&B.forceContextPath!==false){if(B.runTimeType){B.params.runTimeType=B.runTimeType}Ext.tusc.encodeParam(B.params);if(B.params.runTimeType=="parent"){if(Artery.params&&Artery.params.runTimeType){B.params.runTimeType=Artery.params.runTimeType}}}var E=Ext.apply({},B.params);var C=Artery.getValidParams();if(C){Ext.apply(E,C)}var A=Artery.urlEncode(E);if(!Ext.isEmpty(A)){if(D.lastIndexOf("?")==-1){D+="?"+A}else{D+="&"+A}}}return D};Artery.TopWinManager=(function(){var A=(function(){try{if(top.Artery&&top.Artery.plugin&&top.location.host==location.host&&top.sys.getContextPath()==sys.getContextPath()){return top}}catch(C){}try{if(parent.Artery&&parent.Artery.plugin&&parent.location.host==location.host&&parent.sys.getContextPath()==sys.getContextPath()){return parent}}catch(C){}return window})();if(A.winmap==null){A.winmap=[]}var B=12000;return{getZIndex:function(){B++;return B},getTopWin:function(){return A},getWinMap:function(){return A.winmap},getShowWinMap:function(){var C=[];Ext.each(A.winmap,function(E,D){if(!E.hidden){C.push(E)}});return C},closeAll:function(){Ext.each(A.winmap,function(E,C,D){E.tools.close.dom.click()})}}})();Artery.getTopWin=function(F){var H=Artery.TopWinManager.getWinMap();var B=H.length;var E=null;var I=false;for(var D=0;D<B;D++){if(F.single&&H[D].winId==F.winId){E=H[D]}if(E==null&&H[D].winId==null){E=H[D]}}if(E&&Ext.isEmpty(F.wincfg)){E.winId=F.winId;Artery.updateWin(E,F);return E}if(F.title!=null&&F.title!="undefine"){I=true}var A=Ext.id();var C={id:A,layout:"fit",shadow:false,winId:F.winId,closeAction:"hide",height:500,width:500,html:{tag:"iframe",id:A+"iframe",name:A+"iframe",style:"width:100%;height:100%;",frameborder:0,allowTransparency:"true",onload:'Artery.onWindowLoaded("'+A+'",'+I+");"}};if(!Ext.isEmpty(F.wincfg)){if(typeof F.wincfg=="string"){F.wincfg=Ext.decode(F.wincfg)}if(typeof F.wincfg=="string"){F.wincfg=Ext.decode(F.wincfg)}Ext.apply(C,F.wincfg);C.closeAction="close"}E=new Ext.Window(C);E.setSrc=function(J){document.getElementById(A+"iframe").src=J};E.clearSrc=function(){document.getElementById(A+"iframe").src="about:blank"};E.getIframe=function(){return document.getElementById(A+"iframe")};var G=function(K){var L=document.getElementById(A+"iframe");if(K.linktoCfg){if(K.linktoCfg.themeStyle){K.removeClass("x-theme-win-"+K.linktoCfg.themeStyle)}if(K.linktoCfg.closeHandler){var J=L.contentWindow;K.linktoCfg.closeHandler(J,J.Artery)}}K.linktoCfg=null;L.src="about:blank";K.winId=null;K.opener=null};E.on("close",function(J){G(J)});E.on("hide",function(J){G(J)});Artery.updateWin(E,F);if(Ext.isEmpty(F.wincfg)){H.push(E)}E.winId=F.winId;return E};Artery.pwin=function(){return Artery.TopWinManager.getTopWin()}();Artery.onWindowLoaded=function(D,A){var B=window.frames[D+"iframe"];if(B!=null){if(B.Artery&&B.Artery.cfg_bodyPanel){B.winObj=Ext.getCmp(D);if(!A||A=="false"){B.winObj.setTitle(B.document.title)}if(B.Artery.cfg_bodyPanel.themeName){var C="x-window-iframe-"+B.Artery.cfg_bodyPanel.themeName;B.document.body.className+=" "+C;B.winObj.el.addClass(C)}}}};Artery.updateWin=function(F,C){F.linktoCfg=C;if(Ext.isTrue(C.modal)){F.modal=true}else{F.modal=false}var D=!F.rendered;var E=Ext.getNumber(parseInt(C.targetWidth),500);var B=Ext.getNumber(parseInt(C.targetHeight),500);F.width=E;F.height=B;if(C.themeStyle){F.addClass("x-theme-win-"+C.themeStyle)}F.show();if(F.resizer){if(Ext.isTrue(C.resizable)||C.resizable==1||C.resizable=="1"){F.resizer.enabled=true;F.resizer.el.removeClass("x-window-noresize")}else{F.resizer.enabled=false;F.resizer.el.addClass("x-window-noresize")}}F.setWidth(E);F.setHeight(B);if(F.tools.close){F.tools.close.setVisible(C.closable!==false)}F.opener=C.window;F.setTitle(Ext.tusc.getWindowTitle(C));if(C.x||C.y){F.setPosition(C.x,C.y)}var A,H;if(!Ext.isEmpty(C.targetLeft)){A=parseInt(C.targetLeft)}if(!Ext.isEmpty(C.targetTop)){H=parseInt(C.targetTop)}if(!Ext.isEmpty(C.targetRight)){A=document.body.clientWidth-parseInt(E)-parseInt(C.targetRight)}if(!Ext.isEmpty(C.targetBottom)){H=document.body.clientHeight-parseInt(B)-parseInt(C.targetBottom)}if(A||H){F.setPosition(A,H)}F.setSrc(C.linkUrl);if(C.x==null&&C.y==null&&A==null&&H==null){F.center()}var G=F.getPosition();G[1]=G[1]<0?0:G[1];G[0]=G[0]<0?0:G[0];F.setPosition(G[0],G[1]);F.setZIndex(Artery.TopWinManager.getZIndex());F.winId=C.winId};Artery.parseWinCfg=function(A,B){if(!A){return }if(A.single==null){A.single=true}if(A.winId==null){if(B){A.winId="win"+B}else{A.winId="win"+(Ext.id()+(new Date()).getTime())}}};Ext.getWindow=function(A){A.window=window;A.linkUrl=Ext.tusc.getLinkUrl(A);return Artery.TopWinManager.getTopWin().Artery.getTopWin(A)};Ext.getBlankWindow=function(A){if(A.target&&A.target!="_blank"&&A.target!="_self"&&A.target!="_parent"&&A.target!="_top"){var D=Artery.get(A.target);if(!D&&parent.Artery){D=parent.Artery.get(A.target)}if(D){if(A.urlmethod&&A.urlmethod=="post"){return D.iframeEl}return D.showLink(Ext.tusc.getLinkUrl(A))}}if(A.target&&(A.target=="_blank"||A.target=="_window")&&A.modal=="1"){Ext.getModalWindow(A);return }var E="";if(!Ext.isEmpty(A.location)){E+=",location="+A.location}if(!Ext.isEmpty(A.menubar)){E+=",menubar="+A.menubar}if(!Ext.isEmpty(A.status)){E+=",status="+A.status}if(!Ext.isEmpty(A.titlebar)){E+=",titlebar="+A.titlebar}if(!Ext.isEmpty(A.toolbar)){E+=",toolbar="+A.toolbar}if(!Ext.isEmpty(A.scrollbars)){E+=",scrollbars="+A.scrollbars}if(Ext.isEmpty(A.resizable)){E+=",resizable=1"}else{E+=",resizable="+A.resizable}if(!Ext.isEmpty(A.targetLeft)){E+=",left="+A.targetLeft}if(!Ext.isEmpty(A.targetTop)){E+=",top="+A.targetTop}if(!Ext.isEmpty(A.targetRight)){E+=",left="+(document.body.clientWidth-Ext.getNumber(parseInt(A.targetWidth),500)-parseInt(A.targetRight))}if(!Ext.isEmpty(A.targetBottom)){E+=",top="+(document.body.clientHeight-Ext.getNumber(parseInt(A.targetHeight),500)-parseInt(A.targetBottom))}if(!Ext.isEmpty(A.targetHeight)){E+=",height="+A.targetHeight}if(!Ext.isEmpty(A.targetWidth)){E+=",width="+A.targetWidth}if(!Ext.isEmpty(A.targetWidth)||!Ext.isEmpty(A.targetHeight)){if(Ext.isEmpty(A.targetLeft)&&Ext.isEmpty(A.targetTop)&&Ext.isEmpty(A.targetRight)&&Ext.isEmpty(A.targetBottom)){E+=",left="+parseInt((screen.availWidth-parseInt(A.targetWidth))/2);E+=",top="+parseInt((screen.availHeight-parseInt(A.targetHeight))/2)}}if(Ext.isTrue(A.fullScreen)){E+=",top=0,width="+screen.availWidth;E+=",left=0,height="+(screen.availHeight-30)}var H=null;try{H=window.open(Ext.tusc.getLinkUrl(A),A.target,E)}catch(G){}if(H&&(A.title||A.formName)){var C=function(){if(H.document){try{H.document.title=A.title||A.formName}catch(I){}window.clearInterval(F)}};var F=window.setInterval(C,200)}if(H&&A.closeHandler){var B=new Artery.WindowCloseListener(H,A.closeHandler);B.startListener()}if(H){H.focus()}(function(){if(H){H.focus()}}).defer(10);return H};Ext.getWindow=function(A){A.window=window;A.linkUrl=Ext.tusc.getLinkUrl(A);return Artery.TopWinManager.getTopWin().Artery.getTopWin(A)};Artery.WindowCloseListener=Ext.extend(function(A,B){this.subWin=A;this.closeFunc=B},{subWin:null,closeFunc:null,needAttach:false,startListener:function(){var C=this;var B=0;var A=function(){B++;if(C.subWin.document.readyState=="complete"){C.subWin.attachEvent("onbeforeunload",function(){C.beforeFunc()})}else{if(B<50){A.defer(100)}}};A()},beforeFunc:function(){var A=this.subWin;this.closeFunc(A,A.Artery)}});Ext.getModalWindow=function(A){var B="";if(!Ext.isEmpty(A.status)){B+="status:"+A.status+";"}if(!Ext.isEmpty(A.resizable)){B+="resizable:"+A.resizable+";"}if(!Ext.isEmpty(A.targetLeft)&&A.fullScreen!=true){B+="dialogLeft:"+A.targetLeft+";"}if(!Ext.isEmpty(A.targetTop)&&A.fullScreen!=true){B+="dialogTop:"+A.targetTop+";"}if(!Ext.isEmpty(A.targetRight)&&A.fullScreen!=true){B+="dialogLeft:"+(document.body.clientWidth-Ext.getNumber(parseInt(A.targetWidth),500)-parseInt(A.targetRight))+";"}if(!Ext.isEmpty(A.targetBottom)&&A.fullScreen!=true){B+="dialogTop:"+(document.body.clientHeight-Ext.getNumber(parseInt(A.targetHeight),500)-parseInt(A.targetBottom))+";"}if(!Ext.isEmpty(A.targetHeight)&&A.fullScreen!=true){B+="dialogHeight:"+A.targetHeight+"px;"}if(!Ext.isEmpty(A.targetWidth)&&A.fullScreen!=true){B+="dialogWidth:"+A.targetWidth+"px;"}if(Ext.isTrue(A.fullScreen)){B+="dialogLeft:"+0+"px;";B+="dialogTop:"+0+"px;";B+="dialogHeight:"+(screen.availHeight-30)+"px;";B+="dialogWidth:"+screen.availWidth+"px;"}A.url=A.urlbak;window.showModalDialog(Ext.tusc.getLinkUrl(A),window,B)};Ext.tusc.getWindowTitle=function(A){if(A.title){return A.title}else{if(A.runTimeType=="insert"){return"新建表单"}else{if(A.runTimeType=="update"){return"修改表单"}else{if(A.runTimeType=="display"){return"展现表单"}else{return""}}}}};Artery.runLogic=function(A){Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",success:function(C,D){var B=C.responseText;if(B!=null){try{B=Ext.decode(B)}catch(E){}}if(B!=null&&B.success==false){Artery.showError("出错啦，请检查！<br>"+B.error)}else{if(A.callback!=null&&typeof A.callback=="function"){A.callback.call(A.scope||this,B)}}},scope:A.scope,syn:A.syn,params:Artery.getParams(A.params)})};Artery.regItemEvent=function(item,eventName,serverName,acparams){if(Ext.isEmpty(item[eventName])){return }if(serverName!=null){if(serverName=="onClickServer"||serverName=="onDownloadServer"){Artery.params.itemid=Artery.getEventId(item)}var rc=Artery.createCaller(item,serverName,Artery.getFormId(item))}if(acparams){for(var i in acparams){eval("var "+i+'=acparams["'+i+'"];')}}var checked=true;if(item.checked){checked=!item.checked}eval("var fn = function(){"+item[eventName]+"\n}");return fn.call(item)};Artery.regLinktoEvent=function(C,B){var A;if(C.onRender){Artery.params.itemid=Artery.getEventId(C);A=C[B]}else{A=C}Artery.openForm(A)};Artery.parseItem=function(A,B){var C=Artery.getParams(A.params,B);if(A.changeId===false){C.changeId=false}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=parseItem",callback:function(F,G,E){var D=E.responseText;if(D!=null){D=Ext.decode(D)}if(D!=null&&D.success==false){Artery.showError("出错啦，请检查！<br>"+D.error)}else{if(A.callback!=null&&typeof A.callback=="function"){A.callback.call(A.scope||this,D)}}},scope:A.scope,syn:A.asyn,params:C})};Artery.fetchItemPorp=function(C,A){var B={};B.formid=Artery.params.formid;B.itemid=C;B.propName=A;var D;Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=fetchItemPorp",success:function(E,F){D=E.responseText},syn:false,params:B});return D};Artery.getAllFormAreas=function(){var A=[];Ext.select("form.a-formArea").each(function(C,B){A.push(Artery.get(C.dom.id.replace("-atbody","")))});return A};Artery.getCurrentFormId=function(){return Artery.params.formid};Artery.recoverFormData=function(A){if(A==null||Ext.isEmpty(A)){return }if(Ext.isString(A)){A=Ext.decode(A)}for(var B in A){if(Artery.get(B)!=null&&Artery.get(B).setValue){Artery.get(B).setValue(A[B])}}};Artery.getFormData=function(){var B={};var A=function(E){if(E.xtype=="apformarea"){var F=Artery.get(E.id);Ext.apply(B,F.getFormData())}else{if(E.items){var D=E.items.length;for(var C=0;C<D;C++){A(E.items[C])}}}};A(Artery.cfg_bodyPanel);return Ext.encode(B)};Artery.getFormDataId=function(){var G=Artery.cfg_bodyPanel.namedParams;if(Ext.isEmpty(G)){var A;var D=function(J){if(J.xtype=="apFaIdentity"){A=J;return }else{if(J.items){var I=J.items.length;for(var H=0;H<I;H++){D(J.items[H])}}}};D(Artery.cfg_bodyPanel);if(A){return Artery.get(A.id).getValue()}return""}var D=function(I){var H=Artery.params[I];if(H){return H}H=Artery.get(I).getValue();return H};var F={};var C=G.split(",");var E=C.length;for(var B=0;B<E;B++){F[C[B]]=D(C[B])}return Ext.decode(F)};Artery.request=function(cfg){if(cfg.success){cfg.success=cfg.success.createInterceptor(function(response,options){var text=response.responseText;if(!Ext.isEmpty(text)){if(text.indexOf("arterySysError")!=-1){try{text=Ext.decode(text);if(!Ext.isEmpty(text.arterySysError)){if(Artery.config.exceptionTip){if(Artery.config.exceptionTip=="2"){Artery.showTipError(text.arterySysError)}else{if(Artery.config.exceptionTip=="1"){Artery.showError("出错啦，请检查！<br>"+text.arterySysError)}else{var fn=eval(Artery.config.exceptionTip);fn.call(this,text.arterySysError)}}}else{Artery.showError("出错啦，请检查！<br>"+text.arterySysError)}return false}}catch(e){}}}},cfg.scope)}if(cfg.params&&cfg.scope&&cfg.scope.custParams){cfg.params.custParams=Ext.encode(cfg.scope.custParams)}Ext.Ajax.request(cfg)};Artery.swapStyleSheet=function(D,A){Ext.util.CSS.swapStyleSheet(D,A);for(var B=0;B<window.frames.length;B++){var C=window.frames[B];if(C.Artery){C.Artery.swapStyleSheet(D,A)}}};Artery.findWindowByFormId=function(D){if(window.Artery&&Artery.params&&Artery.params.formid&&Artery.params.formid==D){return window}for(var A=0;A<window.frames.length;A++){var C=window.frames[A];if(C.Artery){var B=C.Artery.findWindowByFormId(D);if(B!=null){return B}}}};Artery.addImports=function(B,L){var D=function(){var N=[];var M=Ext.query("script",document.getElementsByTagName("head")[0]);if(M&&M.length!=0){for(var O=0;O<M.length;O++){if(M[O].src){N[M[O].src]=true}}}return N};var G=function(){var N=[];var M=Ext.query("link",document.getElementsByTagName("head")[0]);if(M&&M.length!=0){for(var O=0;O<M.length;O++){if(M[O].href){N[M[O].href]=true}}}return N};var A=function(M,P,O,R,Q){while(Q[P]){P=M.script.shift()}if(P){var N=document.createElement("script");N.type="text/javascript";N.src=P;O.appendChild(N);N.onload=N.onreadystatechange=function(T,S){if(S||!N.readyState||/loaded|complete/.test(N.readyState)){N.onload=N.onreadystatechange=null;P=M.script.shift();if(P){A(M,P,O,R,Q)}else{R()}}}}else{R()}};if(B.script){var C=B.script.length;if(C!=0){var I=D();var J=document.getElementsByTagName("head")[0];var E=B.script.shift();if(E){A(B,E,J,L,I)}else{L()}}else{L()}}else{L()}if(B.css){var C=B.css.length;if(C!=0){var K=G();var J=document.getElementsByTagName("head")[0];for(var F=0;F<C;F++){if(K[B.css[F]]){continue}var H=document.createElement("link");H.type="text/css";H.rel="stylesheet";H.href=B.css[F];J.appendChild(H)}}}};Artery.cascadeDestroy=function(D){var C=D.first();while(C){var A=C;C=C.next();Artery.cascadeDestroy(A)}var B=Ext.getCmp(D.id);if(B){try{B.destroy();Ext.ComponentMgr.unregister(B)}catch(E){}}};Artery.debugTimeArray=[];Artery.debug=function(A){Artery.debugTimeArray.push([A,(new Date()).getTime()])};Artery.showDebug=function(){var A=Artery.debugTimeArray.length;var D=[];var B;var E;for(var C=0;C<A;C++){var F=Artery.debugTimeArray[C][0]+":";E=Artery.debugTimeArray[C][1];if(B){F+=E-B}else{F+="0"}D.push(F);B=E}alert(D.join("\n"))};Artery.getFilePath=function(B){if(Ext.isIE){try{B.select();return document.selection.createRange().text}catch(A){return B.value}}else{return B.value}};Artery.plugin.BaseButton=Ext.extend(Ext.Button,{allowDepress:false,icon:null,loadingState:false,timeoutId:null,onRender:function(C,A){var B=Ext.get(this.id);this.btnEl=B.child(".x-btn-button");this.mon(this.btnEl,{scope:this,focus:this.onFocus,blur:this.onBlur});this.initButtonEl(B,this.btnEl);Ext.ButtonToggleMgr.register(this)},initButtonEl:function(B,C){this.el=B;if(this.id){this.el.dom.id=this.el.id=this.id}if(this.tabIndex!==undefined){C.dom.tabIndex=this.tabIndex}if(this.handleMouseEvents){this.mon(B,{scope:this,mouseover:this.onMouseOver,mousedown:this.onMouseDown})}if(this.menu){this.mon(this.menu,{scope:this,show:this.onMenuShow,hide:this.onMenuHide})}if(this.repeat){var A=new Ext.util.ClickRepeater(B,Ext.isObject(this.repeat)?this.repeat:{});this.mon(A,"click",this.onClick,this)}this.mon(B,this.clickEvent,this.onClick,this)},setTooltip:function(A){this.el.dom.title=A},onDisableChange:function(A){if(this.el){this.el[A?"addClass":"removeClass"](this.disabledClass);this.el.dom.disabled=A}this.disabled=A},doAutoWidth:function(){},onClick:function(A){A.stopEvent();if(this.cancleClick){return }if(this.loadingState){this.timeoutId=this.showLoading.defer(1000,this);this.cancleClick=true}Artery.plugin.BaseButton.superclass.onClick.call(this,A)},showLoading:function(){this.cancleClick=true;this.hideIcon();Artery.showLoading(this.el,"l-l",[3,-1])},hideLoading:function(){if(this.timeoutId){clearTimeout(this.timeoutId);this.timeoutId=null}this.cancleClick=false;Artery.hideLoading();this.showIcon()},hideIcon:function(){this.el.removeClass("x-btn-text-icon");this.el.addClass("x-btn-text");this.btnEl.setStyle("background-image","none")},showIcon:function(){if(!Ext.isEmpty(this.icon)){this.el.removeClass("x-btn-text");this.el.addClass("x-btn-text-icon");this.btnEl.setStyle("background-image",'url("'+sys.getContextPath()+this.icon+'")')}},setText:function(A){this.text=A;if(this.btnEl){this.btnEl.update(A)}return this},setIcon:function(A){this.icon=A;this.el.removeClass("x-btn-text");this.el.addClass("x-btn-text-icon");this.btnEl.setStyle("background-image",'url("'+sys.getContextPath()+A+'")')},isHidden:function(){return this.hidden},isDisabled:function(){return this.disabled}});Ext.reg("apBaseButton",Artery.plugin.BaseButton);Ext.override(Ext.form.Field,{autoEl:null,unique:false,readOnlyClass:"x-item-readonly",msgTarget:"cooltip",validArray:null,onListValidEvent:null,onListChangeEvent:null,onValidEvent:null,labelSeparator:":",showValueTip:false,initComponent:function(){this.on("change",function(field,newValue,oldValue){if(this.isDisplayType()){this.initDefaultOnChange(field,newValue,oldValue)}else{if(this.isValid()&&this.initDefaultOnChange){this.initDefaultOnChange(field,newValue,oldValue)}}},this);Ext.form.Field.superclass.initComponent.call(this);this.addEvents("focus","blur","specialkey","change","invalid","valid");if(this.onListChangeEvent){this.on("change",function(field,newValue,oldValue){if(this.validate()){if(this.rowIdx){Artery.listRowIdx=this.rowIdx}var rc=Artery.createCaller(this.colitemid==null?this.id:this.colitemid,"onChangeServer",Artery.getFormId(this));rc.sync=true;eval("var fn = function(field,newValue,oldValue){"+this.onListChangeEvent+"\n}");fn.call(this,field,newValue,oldValue)}})}this.validArray=[];if(this.unique){var fn=function(val){if(this.initColVal&&val==this.initColVal){return true}if(this.originalValue===undefined||val+""==this.originalValue){return true}var returnVal=true;var itemid=this.colitemid==null?Artery.getEventId(this):this.colitemid;var p={itemid:itemid,formid:Artery.getFormId(this)};p[itemid]=val;Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=validateUnique",success:function(response,options){var result=Ext.decode(response.responseText);if(result.success){if(result.unique){returnVal=true}else{returnVal="此输入项必须唯一！"}}else{if(result.errorText){Artery.showError(result.errorText);returnVal="验证失败，请检查！"}}},scope:this,syn:false,params:Artery.getParams(p,this)});return returnVal};this.validArray.push(fn)}if(this.onListValidEvent){var f=function(value){if(this.rowIdx){Artery.listRowIdx=this.rowIdx}var rc=Artery.createCaller(this.colitemid==null?this.id:this.colitemid,"onValidServer",Artery.getFormId(this));rc.sync=true;if(this.onListValidEvent.indexOf("return")==-1){eval("var fn = function(value){return "+this.onListValidEvent+"\n}")}else{eval("var fn = function(value){"+this.onListValidEvent+"\n}")}var returnValue=fn.call(this,value);if(returnValue==null){return true}return returnValue};this.validArray.push(f)}if(this.onValidEvent){var f=function(value){if(this.hasFocus!=false){return true}var returnValue=Artery.regItemEvent(this,"onValidEvent","onValidServer",{value:value});if(returnValue==null||returnValue==true){return true}return returnValue};this.validArray.push(f)}if(this.validArray.length!=0&&!this.isDisplayType()){this.validator=function(val){for(var i=0;i<this.validArray.length;i++){var returnVal=this.validArray[i].call(this,val);if(returnVal!==true){return returnVal}}return true}}if(this.msgTarget=="cooltip"){this.on("invalid",function(field,msg){this.isInvalid=true;var tip=Artery.getFieldErrorCollTip();this.initErrorTip(tip);var cf=tip.currentField;if(tip.isVisible()&&cf&&cf.field.id==this.id&&cf.msg==msg){return }tip.pushField(this,msg);tip.showErrorTip(this)},this);this.on("valid",function(field){this.isInvalid=false;var tip=Artery.getFieldErrorCollTip();this.initErrorTip(tip);if(tip.isVisible()){tip.hideErrorTip(field)}},this);this.on("focus",function(field){if(this.isInvalid){var tip=Artery.getFieldErrorCollTip();var cf=tip.currentField;if(tip.isVisible()&&cf&&cf.field.id==this.id){return }tip.currentField=tip.findField(this);tip.showErrorTip(field)}},this)}},getErrorTipEl:function(){return this.el},markInvalid:function(C){var D=this.getErrorTipEl();if(!D){return }if(!this.rendered||this.preventMark||this.isHidden()){return }C=C||this.invalidText;var A=this.getMessageHandler();if(A){A.mark({el:D,invalidClass:this.invalidClass},C)}else{if(this.msgTarget){D.addClass(this.invalidClass);var B=Ext.getDom(this.msgTarget);if(B){B.innerHTML=C;B.style.display=this.msgDisplay}}}this.fireEvent("invalid",this,C)},clearInvalid:function(){var C=this.getErrorTipEl();if(!C){return }if(!this.rendered||this.preventMark){return }C.removeClass(this.invalidClass);var A=this.getMessageHandler();if(A){if(typeof (msg)!="undefined"&&msg!=null){A.clear({el:C,invalidClass:this.invalidClass},msg)}}else{if(this.msgTarget){C.removeClass(this.invalidClass);var B=Ext.getDom(this.msgTarget);if(B){B.innerHTML="";B.style.display="none"}}}this.fireEvent("valid",this)},initErrorTip:function(A){var B=this;if(A.initErrorTip){return }A.initErrorTip=true;A.messageFields=[];A.currentField=null;A.pushField=function(C,E){var D=A.findField(C);if(!D){A.messageFields.push({field:C,msg:E})}else{D.msg=E}};A.findField=function(E){var D=A.messageFields.length;for(var C=0;C<D;C++){if(A.messageFields[C]!=null&&A.messageFields[C].field==E){return A.messageFields[C]}}return null};A.deleteField=function(E){var D=A.messageFields.length;for(var C=0;C<D;C++){if(A.messageFields[C]!=null&&A.messageFields[C].field==E){A.messageFields[C]=null}}};A.showErrorTip=function(C){if(A.currentField==null||(C!=null&&C.hasFocus)){A.currentField=A.findField(C)}if(A.currentField&&(C==null||A.currentField.field==C)){if(!A.isVisible()){A.show()}A.update(A.currentField.msg);A.correctPosition()}};A.hideErrorTip=function(C){if(A.currentField&&A.currentField.field==C){A.hide();A.deleteField(C);A.currentField=A.findFirstField();if(A.currentField){A.showErrorTip()}}else{A.deleteField(C)}};A.correctPosition=function(){A.alignTo(A.currentField.field.getErrorTipEl(),"tl-bl",[0,0]);A.changeTipPosition("top");var D=A.currentField.field;var C=D.getErrorTipEl().getY()-Ext.getBody().getScroll().top;var E=Ext.lib.Dom.getViewHeight()-C-D.getErrorTipEl().getSize().height;if(E<A.getHeight()){if(C>A.getHeight()){A.changeTipPosition("bottom");A.alignTo(A.currentField.field.getErrorTipEl(),"bl-tl",[0,0])}}};A.findFirstField=function(){var D=A.messageFields.length;for(var C=0;C<D;C++){if(A.messageFields[C]!=null){return A.messageFields[C]}}return null};A.clear=function(){A.messageFields=[];A.currentField=null;A.hide()};A.reset=function(){var C=[];Ext.each(A.messageFields,function(E,D){if(E&&E.field&&E.field.el&&E.field.el.dom){C.push(E)}});A.messageFields=C;if(!A.currentField||!A.currentField.field||!A.currentField.field.el||!A.currentField.field.el.dom){A.currentField=null}}},validate:function(A){if(this.isDisplayType()){return true}if(Ext.isTrue(this.readOnly)&&!Ext.isTrue(this.validOnReadOnly)){this.clearInvalid();return true}var A=A||this.processValue(this.getRawValue());if(this.disabled){this.clearInvalid();return true}var B=false;if(Ext.isTrue(this.freeData)&&Ext.isFunction(this.validateRightValue)){B=this.validateValue(A)&&this.validateRightValue(A)}else{B=this.validateValue(A)}if(B){this.clearInvalid();return true}return false},afterRender:function(){Ext.form.Field.superclass.afterRender.call(this);this.initSte=true;if(!this.isDisplayType()){this.initEvents()}this.initValue();this.initSte=false;if(!Ext.isEmpty(this.comment)){this.tipEl=Ext.get("comment_"+this.id);if(this.tipEl){this.tipEl.on("click",Artery.showComment,this)}}},initValue:function(){if(this.value!==undefined){this.setValue(this.value)}else{if(!Ext.isEmpty(this.el.dom.value)&&this.el.dom.value!=this.emptyText){this.setValue(this.el.dom.value)}}this.originalValue=this.getValue();this.previousValue=this.originalValue},initEvents:function(){if(this.el.dom.tagName.toLowerCase()=="input"){this.el.on("keypress",function(B){if(B.getKey()==Ext.EventObject.ENTER){B.preventDefault()}})}this.mon(this.el,Ext.EventManager.useKeydown?"keydown":"keypress",this.fireKey,this);this.mon(this.el,"focus",this.onFocus,this);var A=this.inEditor&&Ext.isWindows&&Ext.isGecko?{buffer:10}:null;this.mon(this.el,"blur",this.dealBlur,this,A)},dealBlur:function(){this.onBlur();this.updateValueTip()},updateValueTip:function(){if(!this.showValueTip){return }var A=this.el.dom.value;if(!Ext.isEmpty(A)){this.el.dom.title=A}else{this.el.dom.title=""}},getItemId:function(){if(this.geditor&&this.geditor.colitemid){return this.geditor.colitemid}return Artery.getEventId(this)},isDisplayType:function(){return this.displayType=="display"},isReadOnlyType:function(){return this.displayType=="readOnly"},isHidden:function(){return this.hidden==true||(this.getActionEl().dom.offsetWidth==0&&this.getActionEl().dom.offsetHeight==0)},initDefaultOnChange:function(C,B,A){this.value=B},setValueNoValid:function(B){var A=this.disabled;this.disabled=true;this.setValue(B);this.disabled=A},setValue:function(A){this.value=A;if(this.isDisplayType()){if(this.el&&!(this.el.dom.tagName.toLowerCase()=="input"&&this.el.dom.type.toLowerCase()=="hidden")){this.el.dom.innerHTML=Ext.HtmlEncode(A)}return }if(this.rendered){if(this.el.dom.value!=(""+A)){this.el.dom.value=(A===null||A===undefined?"":(""+A))}}this.updateValueTip();this.afterSetValue()},afterSetValue:function(){if(!Ext.isTrue(this.initSte)){this.validate()}},getValue:function(){if(this.isDisplayType()){return this.el.dom.innerHTML}if(!this.rendered){return this.value}var A=this.el.getValue();if(A===this.emptyText||A===undefined){A=""}return A},getValueText:function(){var A=this.el.dom.value;if(!Ext.isEmpty(this.emptyText)&&this.emptyText==A){A=""}return A},changePrevious:function(){if(!this.rendered){return }this.previousValue=this.getValue()},reset:function(){if(!this.rendered){return }if(this.originalValue+""==this.getValue()+""){return }this.clearInvalid();this.setValueNoValid(this.originalValue)},setOriginalValue:function(A){this.originalValue=A},onHide:function(){var A=this.getContanerEl();this.clearInvalid();if(A){A.addClass("x-hide-"+this.hideMode);if(this.hideMode=="visibility"){A.dom.style.visibility="hidden"}}else{this.getActionEl().addClass("x-hide-"+this.hideMode)}},onShow:function(){var A=this.getContanerEl();if(A){A.removeClass("x-hide-"+this.hideMode);if(this.hideMode=="visibility"){A.dom.style.visibility=""}}else{this.getActionEl().removeClass("x-hide-"+this.hideMode)}},getContanerEl:function(){return this.el.findParentNode("td.x-form-td-cust",50,true)},getLabelEl:function(){if(this.labelEl==null){this.labelEl=Ext.get("label_"+this.id)}return this.labelEl},setLabel:function(B){this.fieldLabel=B;var A=this.getLabelTpl();if(this.getLabelEl()!=null){this.getLabelEl().update(A.replace("{label}",this.fieldLabel+this.labelSeparator))}},setLabelColor:function(A){if(this.getLabelEl()!=null){this.getLabelEl().setStyle("color",A)}},setLabelStyle:function(A){if(this.getLabelEl()!=null){this.getLabelEl().applyStyles(A)}},setValueStyle:function(A){this.el.applyStyles(A)},setLabelCntStyle:function(A){if(this.getLabelEl()!=null){this.getLabelEl().parent().applyStyles(A)}},setRequired:function(B){this.allowBlank=!B;var A=this.getLabelTpl();if(this.getLabelEl()!=null){this.getLabelEl().update(A.replace("{label}",this.fieldLabel+this.labelSeparator))}if(this.allowBlank){this.clearInvalid()}else{this.setLabelStyle(this.labelStyle)}},getLabelTpl:function(){if(this.allowBlank){return Artery.config.inputLabelNotRequired}else{return Artery.config.inputLabelRequired}},read:function(){if(this.isDisplayType()){return }this.readOnly=true;this.el.dom.readOnly=true;if(!Ext.isEmpty(this.valueStyleRead)){this.getActionEl().applyStyles(this.valueStyleRead)}},edit:function(){if(this.isDisplayType()){return }this.readOnly=false;if(this.editable===false){}else{this.el.dom.readOnly=false}if(!Ext.isEmpty(this.valueStyle)){this.getActionEl().applyStyles(this.valueStyle)}},disable:function(A){this.clearInvalid();return Ext.form.Field.superclass.disable.call(this)},onDisable:function(){if(this.isDisplayType()){return }this.getActionEl().addClass(this.disabledClass);if(!Ext.isTrue(this.submitDisabled)){this.el.dom.disabled=true;if(this.hiddenField){this.hiddenField.disabled=true}}if(this.getLabelEl()!=null){this.getLabelEl().addClass("x-form-label-disabled")}},onEnable:function(){if(this.isDisplayType()){return }Ext.form.Field.superclass.onEnable.call(this);if(this.hiddenField){this.hiddenField.disabled=false}if(this.getLabelEl()!=null){this.getLabelEl().removeClass("x-form-label-disabled")}},update:function(){Artery.showSysError({itemid:this.id,error:"控件被以update()的方式调用，此方式可能会引起问题，请检查！"})},showInvalid:function(A){this.focus();this.markInvalid(A)},beforeDestroy:function(){this.clearInvalid();Ext.form.Field.superclass.beforeDestroy.call(this)}});Ext.override(Ext.form.TextField,{parseValLength:function(D){if(Artery.config.fieldValidLength=="1"){return D.length}var B=parseInt(Artery.config.fieldValidLength);var A=0;for(var C=0;C<D.length;C++){if(D.charAt(C).match(/[^\x00-\xff]/ig)!=null){A+=B}else{A+=1}}return A},validateValue:function(B){if(Ext.isFunction(this.validator)){var D=this.validator(B);if(D!==true){this.markInvalid(D);return false}}if(Ext.isEmpty(B)||(this.allowBlankWhenRequired==false&&B.trim()=="")||B===this.emptyText){if(this.allowBlank){this.clearInvalid();return true}else{this.markInvalid(this.blankText);return false}}var A=this.parseValLength(B);if(A<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));return false}if(A>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));return false}if(this.vtype){var C=Ext.form.VTypes;if(!C[this.vtype](B,this)){this.markInvalid(this.vtypeText||C[this.vtype+"Text"]);return false}}if(this.regex&&!this.regex.test(B)){this.markInvalid(this.regexText);return false}return true},setValue:function(A){if(this.isDisplayType()){Ext.form.TextField.superclass.setValue.apply(this,arguments)}else{if(this.emptyText&&this.el&&!Ext.isEmpty(A)){this.el.removeClass(this.emptyClass)}Ext.form.TextField.superclass.setValue.apply(this,arguments);this.applyEmptyText();this.autoSize()}return this},applyEmptyText:function(){if(this.rendered&&this.emptyText&&(this.getRawValue().length<1||(this.el&&this.el.hasClass(this.emptyClass)))&&!this.hasFocus){this.setRawValue(this.emptyText);this.el.addClass(this.emptyClass)}},setEmptyText:function(B,A){if(Ext.isTrue(A)||this.getRawValue().length<1||(this.el&&this.el.hasClass(this.emptyClass))){this.emptyText=B;this.reset()}else{this.emptyText=B}this.on("focus",this.preFocus,this);this.on("blur",this.postBlur,this)}});Artery.plugin.TwinTriggerField=Ext.extend(Ext.form.TwinTriggerField,{allowDomMove:false,trigger1Class:"x-form-clear-trigger",valueText:"",initComponent:function(){Artery.plugin.TwinTriggerField.superclass.initComponent.call(this);this.initComponentTigger()},initComponentTigger:function(){if(this.readOnly){this.hideTrigger1=true;this.hideTrigger2=true}if(Ext.isEmpty(this.getValue())){this.hideTrigger1=true}},initEvents:function(){Artery.plugin.TwinTriggerField.superclass.initEvents.call(this);this.initClearValueTaskEvent()},initClearValueTaskEvent:function(){if(Ext.isTrue(this.editable)){this.clearValueTask=new Ext.util.DelayedTask(function(){if(Ext.isEmpty(this.getValueText())){this.setValue(null)}},this);this.mon(this.el,"keyup",function(A){if(!A.isNavKeyPress()){this.clearValueTask.delay(250)}},this)}},hideTrg:function(){if(this.getTrigger(0)!=null){this.getTrigger(0).hide()}if(this.getTrigger(1)!=null){this.getTrigger(1).hide()}},showTrg:function(){if(this.triggers.length>1){if(!Ext.isEmpty(this.getValue())&&this.getTrigger(0)!=null){this.getTrigger(0).show()}if(this.getTrigger(1)!=null){this.getTrigger(1).show()}}else{if(this.getTrigger(0)!=null){this.getTrigger(0).show()}}},setValueText:function(A){if(Ext.isEmpty(A)){A=""}this.valueText=A;A=this.value;Artery.plugin.TwinTriggerField.superclass.setValue.call(this,this.valueText);this.value=A},setValue:function(B,A){if(this.hiddenField){this.hiddenField.value=Ext.isEmpty(B)?"":B}this.setTriggerState(B);if(Ext.isEmpty(B)){this.valueText="";Artery.plugin.TwinTriggerField.superclass.setValue.call(this,this.valueText);this.value=B}else{if(A===undefined&&this.upValueText){this.value=B;this.upValueText(B)}else{this.valueText=A;Artery.plugin.TwinTriggerField.superclass.setValue.call(this,this.valueText);this.value=B}}if(!Ext.isTrue(this.initSte)){this.validate()}},afterSetValue:function(){},getValue:function(){return Ext.isEmpty(this.value)?"":this.value+""},upValueText:function(A){this.setValueText(A)},setTriggerState:function(A){if(this.triggers&&this.triggers.length>1&&!this.readOnly){if(A!=null&&A!=""){this.getTrigger(0).show()}else{this.getTrigger(0).hide()}}},onTrigger1Click:function(){if(this.disabled){return }var A=this.getValue();this.setValue(null);this.getTrigger(0).hide();if(!Ext.isEmpty(A)){this.startValue=this.getValue();this.fireEvent("change",this,null,A)}},setFieldEditable:function(){if(!Ext.isTrue(this.readOnly)&&this.editable!==undefined){if(!this.editable){this.editable=true;this.setEditable(false)}else{this.editable=false;this.setEditable(true)}}},onRender:function(C,A){if(!Ext.get(this.id)){Artery.plugin.TwinTriggerField.superclass.onRender.call(this,C,A);this.hiddenField=this.el.insertSibling({tag:"input",type:"hidden",name:this.id},"after",true);this.el.dom.removeAttribute("name");return }if(this.isDisplayType()){this.el=Ext.get(this.id);return }this.wrap=Ext.get(this.id+"_wrap");this.el=Ext.get(this.id);this.checkbox=Ext.get(this.id+"_checkbox");if(this.checkbox){this.checkbox.on("click",function(){this.setCascade(this.checkbox.dom.checked)},this)}this.initHTMLTrigger();this.hiddenField=this.el.next("input").dom;this.setFieldEditable();if(this.tabIndex!==undefined){this.el.dom.setAttribute("tabIndex",this.tabIndex)}if(this.hideTrigger){for(var B=0;B<this.triggers.length;B++){this.triggers[B].setDisplayed(false)}}},onTriggerClick:function(A){this.onTrigger2Click(A)},initValue:function(){if(this.value!==undefined){this.setValue(this.value,this.valueText)}this.originalValue=this.getValue();this.previousValue=this.originalValue},initTrigger:function(){var A=this.trigger.select(".x-form-trigger",true);var B=this;A.each(function(D,F,C){D.hide=function(){var G=B.wrap.getWidth();this.dom.style.display="none";B.el.setWidth(G-B.trigger.getWidth())};D.show=function(){var G=B.wrap.getWidth();this.dom.style.display="";B.el.setWidth(G-B.trigger.getWidth())};var E="Trigger"+(C+1);if(this["hide"+E]){D.dom.style.display="none"}D.on("click",this["on"+E+"Click"],this,{preventDefault:true});D.addClassOnOver("x-form-trigger-over");D.addClassOnClick("x-form-trigger-click")},this);this.triggers=A.elements},initHTMLTrigger:function(){var A=this.wrap.select(".x-form-trigger",true).elements;var C=this;if(A.length>0){var B=0;if(A.length==2){B=1;A[0].hide=function(){if(this.dom.parentNode){this.dom.parentNode.style.display="none"}};A[0].show=function(){if(this.dom.parentNode){this.dom.parentNode.style.display=""}};if(C.hideTrigger1){if(A[0].dom.parentNode){A[0].dom.parentNode.style.display="none"}}A[0].on("click",C.onTrigger1Click,C,{preventDefault:true});A[0].addClassOnOver("x-form-trigger-over");A[0].addClassOnClick("x-form-trigger-click")}A[B].hide=function(){this.dom.parentNode.style.display="none"};A[B].show=function(){this.dom.parentNode.style.display=""};if(C.hideTrigger2){A[B].dom.parentNode.style.display="none"}A[B].on("click",C.onTrigger2Click,C,{preventDefault:true});A[B].addClassOnOver("x-form-trigger-over");A[B].addClassOnClick("x-form-trigger-click")}this.triggers=A},read:function(){Artery.plugin.TwinTriggerField.superclass.read.call(this);this.hideTrg();this.el.addClass("x-field-readonly");this.editable=false;this.setFieldEditable()},edit:function(){Artery.plugin.TwinTriggerField.superclass.edit.call(this);this.showTrg();this.el.removeClass("x-field-readonly");this.editable=true;this.setFieldEditable()},getPositionEl:function(){return this.wrap||this.el},setRequired:function(B){this.allowBlank=!B;var A=this.getLabelTpl();if(this.getLabelEl()!=null){this.getLabelEl().update(A.replace("{label}",this.fieldLabel+this.labelSeparator))}if(this.allowBlank){this.clearInvalid()}else{this.setLabelStyle(this.labelStyle)}}});Ext.reg("apTwinTrigger",Artery.plugin.TwinTriggerField);Artery.plugin.PopupTrigger=Ext.extend(Artery.plugin.TwinTriggerField,{listAlign:"tl-bl?",minLayerWidth:150,layerHeight:300,minLayerHeight:0,layerEl:null,restrictLayerTask:new Ext.util.DelayedTask(),restrictLayer:function(B,A){this.restrictLayerTask.delay(10,this.restrictLayerDirect,this,[B,A])},restrictLayerDirect:function(F,N){F.show();N.show();var C=Math.max(this.wrap.getWidth(),this.minLayerWidth);var L=this.getPosInParent(this.wrap);var D=Artery.pwin.Ext.getBody().getRight()-L[0];if(D<C){L[0]=Math.max(L[0]-(C-D),0)}var J=L[1]-Artery.pwin.Ext.getBody().getScroll().top;var G=Artery.pwin.Ext.lib.Dom.getViewHeight()-J-this.wrap.getHeight();var B=Math.max(J,G,this.minHeight||0)-5;var I=N.el.child("ul").dom;var H=Math.max(I.clientHeight,I.offsetHeight,I.scrollHeight);if(C<I.scrollWidth){H=H+20}var A=N.el.child(".x-panel-bbar").dom;var M=H+A.clientHeight+2;var E=Math.min(B,this.layerHeight,M);E=Math.max(E,this.minLayerHeight);var K=null;if((J>G)&&(this.layerHeight>(G-5))){K=[L[0],(L[1]-E)]}else{K=[L[0],(L[1]+this.wrap.getHeight())]}F.beginUpdate();N.setSize(C,E);F.endUpdate();F.setSize(C,0);F.setXY(K)},getPosInParent:function(C){var A=0,D=0;var B=function(F){while(Artery.pwin!=F){var E=F.parent.Ext.get(F.frameElement);A+=E.getLeft();D+=E.getTop();F=F.parent}};if(Artery.pwin==window){A=C.getLeft();D=C.getTop()}else{B(window);A+=C.getLeft();D+=C.getTop()}return[A,D]},isExpanded:function(){return this.layerEl&&this.layerEl.isVisible()},collapseIf:function(A){if(!A){this.collapse(true);return }if(!A.within(this.wrap)&&!A.within(this.layerEl)){this.collapse(true)}},collapse:function(A){if(!this.isExpanded()){return }this.restrictLayerTask.cancel();if(A===true&&this.clearTempValue){this.clearTempValue()}this.layerEl.hide();this.focus();this.validate();if(this.geditor){this.geditor.allowBlur=false;this.geditor.completeEdit()}},onBeforeload:function(A,B){A.baseParams.itemid=this.dynamicNodeId;A.baseParams.formid=Artery.getFormId(this);A.baseParams.node_type=B.attributes.type;A.baseParams.node_cid=B.attributes.cid;A.baseParams.node_name=B.text;A.baseParams.node_leaf=B.isLeaf()+"";if(B.attributes.iconId){A.baseParams.node_iconId=B.attributes.iconId}if(this.filterField){var C=this.filterField.getValue();if(!Ext.isEmpty(C)){A.baseParams.filterValue=C}else{A.baseParams.filterValue=""}}else{A.baseParams.filterValue=""}Ext.applyIf(A.baseParams,Artery.getParams({},this));if(this.onBeforeLoadEvent){Artery.regItemEvent(this,"onBeforeLoadEvent",null,{loader:A,node:B})}}});Artery.plugin.faTreeFunc={setCascade:function(A){this.cascade=Ext.isTrue(A)},skinSelectedNode:function(A,C){var B=function(E){var D=false;if(E.attributes.cid==C){D=true}if(D){E.select()}else{E.unselect()}if(E.ui.checkbox){E.ui.checkbox.checked=D}if(!E.isLeaf()&&E.isLoaded&&E.isLoaded()){E.eachChild(B)}};B(A.root)},getCascadeValue:function(){if(!this.cascade){throw"没有开启级联功能"}var A=document.getElementById(this.id+"Cascade");if(A){return A.value}else{return""}},sureSelectedNode:function(C){if(!this.custTree){return }var A=this;var B=function(D){A.sureNode(D,C);if(!D.isLeaf()&&(!D.isLoaded||D.isLoaded())){D.eachChild(B)}};B(this.custTree.root)},sureNode:function(B,A){if(this.custStore.getById(B.attributes.cid)!=null){if(B.ui.checkbox){B.ui.checkbox.checked=true}if(this.cascade){B.attributes.cascadestatus="2"}}else{if(B.ui.checkbox){B.ui.checkbox.checked=false}}if(A){delete B.attributes.cascadestatus}},onSubmitValue:function(){var D=[],A=[];this.custStore.each(function(E){D[D.length]=E.get("id");A[A.length]=E.get("name")});var B=this.getValue();var C=Artery.getMultiSelectSeparator();this.value=D.join(C);this.valueText=A.join(C);this.setValue(this.value,this.valueText,false);this.startValue=this.getValue();this.fireEvent("change",this,this.value,B)},onExpandnode:function(C){var A=function(E){var D=E.parentNode;while(D!=null){if(D.isClick===true){return true}D=D.parentNode}return false};var B=false;C.eachChild(function(D){if(this.cascade&&C.attributes.cascadestatus=="2"){if(D.ui.checkbox&&D.attributes.disablecheck!=true){if(D.ui.checkbox.checked){B=true}}}},this);C.eachChild(function(D){if(this.cascade){if(C.attributes.cascadestatus=="0"){if(D.ui.checkbox){D.ui.checkbox.checked=false;this.delRecord(D)}D.attributes.cascadestatus="0"}else{if(C.attributes.cascadestatus=="1"){}else{if(C.attributes.cascadestatus=="2"&&A(D)&&!B){if(D.ui.checkbox&&D.attributes.disablecheck!=true){D.ui.checkbox.checked=true;this.addRecord(D)}D.attributes.cascadestatus="2"}else{this.sureNode(D)}}}}else{this.sureNode(D)}},this)},isParentClick:function(B){var A=B.parentNode;while(A!=null){if(A.isClick===true){return true}A=A.parentNode}return false},onCheckchange:function(B,A){B.isClick=true;if(this.cascade){this.onCascadeNode(B,A)}if(A){this.addRecord(B)}else{this.delRecord(B)}},onCascadeNode:function(C,B){var A=this;var D=function(F){if(A.cascade&&F.isLoaded&&!F.isLoaded()){F.reload();if(F.isExpanded()){F.collapse(false,false)}}if(F.ui.checkbox){F.ui.checkbox.checked=B}if(B){F.attributes.cascadestatus="2";A.addRecord(F)}else{F.attributes.cascadestatus="0";A.delRecord(F)}if(!F.isLeaf()&&(!F.isLoaded||F.isLoaded())){F.eachChild(D)}};D(C);if((A.cascadeParent=="allchild"||A.cascadeParent=="singlechild")&&C.parentNode){var E=function(G){if(G==A.root){return }var F={"0":0,"1":0,"2":0};G.eachChild(function(H){if(H.attributes.cascadestatus!==undefined){F[H.attributes.cascadestatus]++}else{if(H.ui.checkbox){if(H.ui.checkbox.checked){F["2"]++}else{F["0"]++}}else{F["2"]++}}});if(F["0"]==G.childNodes.length){G.attributes.cascadestatus="0";A.delRecord(G)}else{if(F["2"]==G.childNodes.length){G.attributes.cascadestatus="2";A.addRecord(G)}else{if(A.cascadeParent=="allchild"){G.attributes.cascadestatus="1";A.delRecord(G)}if(A.cascadeParent=="singlechild"){G.attributes.cascadestatus="2";A.addRecord(G)}}}if(G.ui.checkbox){if(A.cascadeParent=="allchild"){G.ui.checkbox.checked=F["2"]==G.childNodes.length}if(A.cascadeParent=="singlechild"){G.ui.checkbox.checked=F["2"]>0}}E(G.parentNode)};E(C.parentNode)}},genCascadeValue:function(){if(!this.custTree){return }var E=[];var D=function(J,G){var K={cid:J.attributes.cid,name:J.text,type:J.attributes.type,leaf:J.isLeaf()+""};if(J.attributes.iconId){K.iconId=J.attributes.iconId}if(J.ui.checkbox){K.checked=J.ui.checkbox.checked+""}if(J.attributes.cascadestatus!==undefined){K.cascadestatus=J.attributes.cascadestatus}else{if(J.checked!==undefined){if(J.checked=="true"){K.cascadestatus="2"}else{K.cascadestatus="0"}}}G.push(K);if(!J.isLeaf()&&(!J.isLoaded||J.isLoaded())){var I=J.childNodes;K.children=[];for(var H=0,F=I.length;H<F;H++){D(I[H],K.children)}}};var C=this.root.childNodes;for(var B=0,A=C.length;B<A;B++){D(C[B],E)}this.cascadeField.value=Ext.encode(E)},clearCascadeValue:function(){if(!this.custTree){return }var D=function(H){H.attributes.cascadestatus="0";if(!H.isLeaf()&&(!H.isLoaded||H.isLoaded())){var G=H.childNodes;for(var F=0,E=G.length;F<E;F++){D(G[F])}}};var C=this.root.childNodes;for(var B=0,A=C.length;B<A;B++){D(C[B])}this.cascadeField.value=""},addRecord:function(B){var A=B.attributes;if(this.custStore.getById(A.cid)==null){var C=[];C.push([A.cid,B.text,A.pinyin==null?"":A.pinyin]);this.custStore.loadData(C,true)}},delRecord:function(A){var B=this.custStore.getById(A.attributes.cid);if(B){this.custStore.remove(B)}},singleClickCheckHandler:function(B,C){var A=B.getUI();if(A.disabled||A.node.disabled){return }if(A.checkbox&&!A.checkbox.disabled){A.toggleCheck()}},dblClickReturnHandler:function(A,B){if(this.okBtn){this.okBtn.fireEvent("click",this.okBtn)}else{if(Ext.isFunction(this.submitValue)){this.submitValue()}}}};Artery.plugin.faClassCodeFunc={searchField:null,searchNodePaths:null,searchText:null,searchNodeIndex:0,createBottombar:function(A){var B=[];this.searchField=new Artery.pwin.Ext.form.TextField({emptyText:"请输入名称",width:230,enableKeyEvents:true,listeners:{keydown:{fn:function(D,C){if(C.getKey()==Ext.EventObject.ENTER){this.searchCode()}else{}},scope:this}}});B.push(this.searchField);B.push("-");B.push({text:"查找",handler:this.searchCode,scope:this});if(A){B.push("->");B.push({text:"确定",handler:this.submitValue,scope:this})}return B},searchCode:function(){if(this.searchField==null){return }var B=this.searchField.getValue();if(Ext.isEmpty(B)){return }if(B==this.searchText){this.expandSearchNode(this.searchNodeIndex+1);return }var A=Artery.getParams({searchText:B,codeType:this.codeType},this);if(!Artery.params){A.itemType=this.itemType;A.moreProp=this.moreProp}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=searchClassCode",success:function(C,D){this.searchNodePaths=null;this.searchText=null,this.searchNodeIndex=0;var E=Ext.decode(C.responseText);if(E.nodeList&&E.nodeList.length>0){this.searchNodePaths=E.nodeList;this.searchText=B;this.expandSearchNode(0)}},scope:this,params:A})},expandSearchNode:function(A){var B=this.searchNodePaths.length;this.searchNodeIndex=A%B;var C=this.searchNodePaths[this.searchNodeIndex];this.expandNode(C,false)},expandNode:function(E,C){var B=this;var A=function(G){var I=G.split(",");while(I.length>0){var H=I.shift();if(H==B.rootId){break}}return I};var D=function(G){if(F.length==1){var H=G.findChild("cid",F.shift());if(H){H.select();Ext.fly(H.ui.elNode).scrollIntoView();if(C==true&&H.ui.checkbox){H.ui.checkbox.checked=true}}return }var I=G.findChild("cid",F.shift());if(I==null){return }I.expand(false,false,D)};var F=A(E);this.root.expand(false,false,D)}};Artery.plugin.BaseComponent=Ext.extend(Ext.Component,{allowDomMove:false,onRender:function(B,A){this.el=Ext.get(this.id);Artery.plugin.BaseComponent.superclass.onRender.call(this,B,A)}});Artery.plugin.BaseContainer=Ext.extend(Ext.Container,{allowDomMove:false,getLayout:function(){return this.layout},onRender:function(B,A){this.el=Ext.get(this.id);Artery.plugin.BaseContainer.superclass.onRender.call(this,B,A)},lookupComponent:function(A){if(typeof A=="string"){return Ext.ComponentMgr.get(A)}else{var B=Ext.getCmp(A.id);if(B){return B}else{if(!A.events){return this.createComponent(A)}}}return A},collapse:function(){this.fireEvent("beforecollapse",this,false);this.el.hide();this.fireEvent("collapse",this)},expand:function(){this.fireEvent("beforeexpand",this,false);this.el.show();this.fireEvent("expand",this)},alignTo:function(B,A,C){this.show();this.el.setStyle("position","absolute");Ext.getBody().appendChild(this.el);this.el.alignTo(B,A,C)},center:function(){this.show();this.el.setStyle("position","absolute");Ext.getBody().appendChild(this.el);this.el.center()}});Artery.plugin.BasePanel=Ext.extend(Ext.Panel,{allowDomMove:false,deferHeight:false,getLayout:function(){return this.layout},onRender:function(B,A){this.el=Ext.get(this.id);Ext.Panel.superclass.onRender.call(this,B,A);this.createClasses();var C=this.el,E=C.dom,F;if(E.firstChild){this.header=Ext.get(this.id+"-atheader");this.bwrap=Ext.get(this.id+"-atbwrap");this.tbar=Ext.get(this.id+"-attbar");this.body=Ext.get(this.id+"-atbody");this.bbar=Ext.get(this.id+"-atbbar");this.footer=Ext.get(this.id+"-atfooter");this.fromMarkup=true}if(this.buttons){this.elements+=",footer"}if(this.header){this.header.unselectable();if(this.headerAsText){if(this.iconCls){this.setIconClass(this.iconCls)}}}if(this.floating){this.makeFloating(this.floating)}if(this.collapsible){this.tools=this.tools?this.tools.slice(0):[];if(!this.hideCollapseTool){this.tools[this.collapseFirst?"unshift":"push"]({id:"toggle",handler:this.toggleCollapse,scope:this})}if(this.titleCollapse&&this.header){this.mon(this.header,"click",this.toggleCollapse,this);this.header.setStyle("cursor","pointer")}}if(this.tools){var D=this.tools;this.tools={};this.addTool.apply(this,D)}else{this.tools={}}this.toolbars=[];if(this.fbar){this.fbar=Ext.create(this.fbar,"toolbar");this.toolbars.push(this.fbar)}if(this.tbar&&this.topToolbar){if(Ext.isArray(this.topToolbar)){this.topToolbar=new Ext.Toolbar(this.topToolbar)}else{if(!this.topToolbar.events){this.topToolbar=Ext.create(this.topToolbar,"toolbar")}}this.topToolbar.ownerCt=this;this.toolbars.push(this.topToolbar)}if(this.bbar&&this.bottomToolbar){if(Ext.isArray(this.bottomToolbar)){this.bottomToolbar=new Ext.Toolbar(this.bottomToolbar)}else{if(!this.bottomToolbar.events){this.bottomToolbar=Ext.create(this.bottomToolbar,"toolbar")}}this.bottomToolbar.ownerCt=this;this.toolbars.push(this.bottomToolbar)}},afterRender:function(){if(this.floating&&!this.hidden){this.el.show()}if(this.html){this.body.update(Ext.isObject(this.html)?Ext.DomHelper.markup(this.html):this.html);delete this.html}if(this.contentEl){var A=Ext.getDom(this.contentEl);Ext.fly(A).removeClass(["x-hidden","x-hide-display"]);this.body.dom.appendChild(A)}if(this.collapsed){this.collapsed=false;this.collapse(false)}Ext.Panel.superclass.afterRender.call(this);this.initEvents();if(!this["bwrap"].isDisplayed()){this.collapsed=true}},initEvents:function(){if(this.keys){this.getKeyMap()}if(this.draggable){this.initDraggable()}},onResize:function(){},setSize:function(A,B){if(this.region){Artery.plugin.BasePanel.superclass.setSize.call(this,A,B)}},alignTo:function(B,A,C){this.show();this.el.setStyle("position","absolute");Ext.getBody().appendChild(this.el);this.el.alignTo(B,A,C)},center:function(){this.show();this.el.setStyle("position","absolute");Ext.getBody().appendChild(this.el);this.el.center()}});Ext.reg("apBasePanel",Artery.plugin.BasePanel);Artery.plugin.AtyLayout=Ext.extend(Ext.layout.ContainerLayout,{renderItem:function(C,A,B){if(C&&!C.rendered){C.render(B,A)}}});Ext.Container.LAYOUTS.atylayout=Artery.plugin.AtyLayout;Artery.plugin.BasePagingbar=Ext.extend(Artery.plugin.BaseContainer,{pageInfoTpl:null,pageInfoTplContent:null,isOnePageHideBar:false,initComponent:function(){Artery.plugin.BasePagingbar.superclass.initComponent.call(this);if(!Ext.isEmpty(this.pageInfoTplContent)){this.pageInfoTpl=new Ext.XTemplate(this.pageInfoTplContent)}else{this.pageInfoTpl=new Ext.XTemplate(Artery.tpl.pageInfo)}this.pageInfoTpl.compile()}});Ext.reg("apBasePagingbar",Artery.plugin.BasePagingbar);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.MessageBox=function(){var R,B,N,Q;var G,J,P,A,K,M,H,F;var O,S,L,C="";var D=function(U){if(R.isVisible()){R.hide();T();Ext.callback(B.fn,B.scope||window,[U,S.dom.value,B],1)}};var T=function(){if(B&&B.cls){R.el.removeClass(B.cls)}K.reset()};var E=function(W,U,V){if(B&&B.closable!==false){R.hide();T()}if(V){V.stopEvent()}};var I=function(U){var W=0;if(!U){O.ok.hide();O.cancel.hide();O.yes.hide();O.no.hide();return W}R.footer.dom.style.display="";for(var V in O){if(typeof O[V]!="function"){if(U[V]){O[V].show();O[V].setText(typeof U[V]=="string"?U[V]:Ext.MessageBox.buttonText[V]);W+=O[V].el.getWidth()+15}else{O[V].hide()}}}return W};return{getDialog:function(U){if(!R){R=new Ext.Window({autoCreate:true,title:U,resizable:false,constrain:true,constrainHeader:true,minimizable:false,maximizable:false,stateful:false,modal:true,shim:true,buttonAlign:"center",width:400,height:100,minHeight:80,plain:true,footer:true,closable:true,close:function(){if(B&&B.buttons&&B.buttons.no&&!B.buttons.cancel){D("no")}else{D("cancel")}}});O={};var V=this.buttonText;O.ok=R.addButton({text:V.ok,cls:"x-dlg-btn-ok"},D.createCallback("ok"));O.yes=R.addButton({text:V.yes,cls:"x-dlg-btn-yes"},D.createCallback("yes"));O.no=R.addButton({text:V.no,cls:"x-dlg-btn-no"},D.createCallback("no"));O.cancel=R.addButton({text:V.cancel,cls:"x-dlg-btn-cancel"},D.createCallback("cancel"));O.ok.hideMode=O.yes.hideMode=O.no.hideMode=O.cancel.hideMode="offsets";O.yes.on("mouseover",function(){this.el.addClass("x-btn-yes-over")},O.yes);O.yes.on("mouseout",function(){this.el.removeClass("x-btn-yes-over")},O.yes);O.no.on("mouseover",function(){this.el.addClass("x-btn-no-over")},O.no);O.no.on("mouseout",function(){this.el.removeClass("x-btn-no-over")},O.no);R.render(document.body);R.getEl().addClass("x-window-dlg");N=R.mask;G=R.body.createChild({html:'<div class="ext-mb-icon"></div><div class="ext-mb-content"><span class="ext-mb-text"></span><br /><div class="ext-mb-fix-cursor"><input type="text" class="ext-mb-input" /><textarea class="ext-mb-textarea"></textarea></div></div>'});H=Ext.get(G.dom.firstChild);var W=G.dom.childNodes[1];J=Ext.get(W.firstChild);P=Ext.get(W.childNodes[2].firstChild);P.enableDisplayMode();P.addKeyListener([10,13],function(){if(R.isVisible()&&B&&B.buttons){if(B.buttons.ok){D("ok")}else{if(B.buttons.yes){D("yes")}}}});A=Ext.get(W.childNodes[2].childNodes[1]);A.enableDisplayMode();K=new Ext.ProgressBar({renderTo:G});G.createChild({cls:"x-clear"})}return R},updateText:function(X){if(!R.isVisible()&&!B.width){R.setSize(this.maxWidth,100)}R.setWidth(400,100);J.update(X||"&#160;");var V=C!=""?(H.getWidth()+H.getMargins("lr")):0;var Z=J.getWidth()+J.getMargins("lr");var W=R.getFrameWidth("lr");var Y=R.body.getFrameWidth("lr");if(Ext.isIE&&V>0){V+=3}var U=Math.max(Math.min(B.width||V+Z+W+Y,this.maxWidth),Math.max(B.minWidth||this.minWidth,L||0));if(B.prompt===true){S.setWidth(U-V-W-Y)}if(B.progress===true||B.wait===true){K.setSize(U-V-W-Y)}if(Ext.isIE&&U==L){U+=6}R.setSize(U,"auto").center();return this},updateProgress:function(V,U,W){K.updateProgress(V,U);if(W){this.updateText(W)}return this},isVisible:function(){return R&&R.isVisible()},hide:function(){var U=R?R.activeGhost:null;if(this.isVisible()||U){R.hide();T();if(U){R.unghost(false,false)}}return this},show:function(X){if(this.isVisible()){this.hide()}B=X;var Y=this.getDialog(B.title||"&#160;");Y.setTitle(B.title||"&#160;");var U=(B.closable!==false&&B.progress!==true&&B.wait!==true);Y.tools.close.setDisplayed(U);S=P;B.prompt=B.prompt||(B.multiline?true:false);if(B.prompt){if(B.multiline){P.hide();A.show();A.setHeight(typeof B.multiline=="number"?B.multiline:this.defaultTextHeight);S=A}else{P.show();A.hide()}}else{P.hide();A.hide()}S.dom.value=B.value||"";if(B.prompt){Y.focusEl=S}else{var W=B.buttons;var V=null;if(W&&W.ok){V=O.ok}else{if(W&&W.yes){V=O.yes}}if(V){Y.focusEl=V}}if(B.iconCls){Y.setIconClass(B.iconCls)}this.setIcon(B.icon);if(B.cls){Y.el.addClass(B.cls)}Y.proxyDrag=B.proxyDrag===true;Y.modal=B.modal!==false;Y.mask=B.modal!==false?N:false;Y.on("beforeshow",function(){Y.keyMap.setDisabled(U!==true);Y.doLayout();this.setIcon(B.icon);L=I(B.buttons);K.setVisible(B.progress===true||B.wait===true);this.updateProgress(0,B.progressText);this.updateText(B.msg);if(B.wait===true){K.wait(B.waitConfig)}},this,{single:true});if(!Y.isVisible()){document.body.appendChild(R.el.dom);Y.setAnimateTarget(B.animEl);Y.show(B.animEl)}return this},setIcon:function(U){if(U&&U!=""){H.removeClass("x-hidden");H.replaceClass(C,U);G.addClass("x-dlg-icon");C=U}else{H.replaceClass(C,"x-hidden");G.removeClass("x-dlg-icon");C=""}return this},progress:function(W,V,U){this.show({title:W,msg:V,buttons:false,progress:true,closable:false,minWidth:this.minProgressWidth,progressText:U});return this},wait:function(W,V,U){this.show({title:V,msg:W,buttons:false,closable:false,wait:true,modal:true,minWidth:this.minProgressWidth,waitConfig:U});return this},alert:function(X,W,V,U){this.show({title:X,msg:W,buttons:this.OK,fn:V,scope:U});return this},confirm:function(X,W,V,U){this.show({title:X,msg:W,buttons:this.YESNO,fn:V,scope:U,icon:this.QUESTION});return this},prompt:function(Z,Y,W,V,U,X){this.show({title:Z,msg:Y,buttons:this.OKCANCEL,fn:W,minWidth:250,scope:V,prompt:true,multiline:U,value:X});return this},OK:{ok:true},CANCEL:{cancel:true},OKCANCEL:{ok:true,cancel:true},YESNO:{yes:true,no:true},YESNOCANCEL:{yes:true,no:true,cancel:true},INFO:"ext-mb-info",WARNING:"ext-mb-warning",QUESTION:"ext-mb-question",ERROR:"ext-mb-error",defaultTextHeight:75,maxWidth:600,minWidth:110,minProgressWidth:250,buttonText:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No"}}}();Ext.Msg=Ext.MessageBox;Ext.override(Ext.Component,{initComponent:function(){if(!Ext.isEmpty(this.onBeforeChangeEvent)){this.on("beforeselect",function(C,B,A){if(B==null){B=""}if(A==null){A=""}if(B.toString()==A.toString()){return }var D=this.getValueTextByValue(B);return Artery.regItemEvent(this,"onBeforeChangeEvent","onBeforeChangeServer",{newValue:B,newValueText:D,oldValue:A})},this)}if(!Ext.isEmpty(this.onChangeEvent)){this.on("change",function(C,B,A){if(B==null){B=""}if(A==null){A=""}if(B.toString()==A.toString()){return }Artery.regItemEvent(this,"onChangeEvent","onChangeServer",{newValue:B,oldValue:A})},this)}if(!Ext.isEmpty(this.onClickEvent)){this.on("click",function(A,B){Artery.regItemEvent(this,"onClickEvent","onClickServer")},this)}if(!Ext.isEmpty(this.linktoEvent)){this.on("click",function(A,B){if(!Ext.isEmpty(B)){B.stopEvent()}if(this.cancleLinkto!==true&&this.cancelLinkto!==true){Artery.regLinktoEvent(this,"linktoEvent")}},this)}if(!Ext.isEmpty(this.onKeyupEvent)){this.on("keyup",function(A,C){var B=A.getValue();Artery.regItemEvent(this,"onKeyupEvent","onKeyupServer",{value:B,eventObject:C})},this)}},getVisibiltyEl:function(){if((this.hiddenId)&&(Ext.get(this.hiddenId))){return Ext.get(this.hiddenId)}else{return this.hideParent?this.container:this.getActionEl()}}});Ext.override(Ext.Container,{add:function(A){this.initItems();var B=arguments.length>1;if(B||Ext.isArray(A)){Ext.each(B?arguments:A,function(E){this.add(E)},this);return }if(this.getLayout()){var D=this.lookupComponent(this.applyDefaults(A));var C=this.items.length;if(this.fireEvent("beforeadd",this,D,C)!==false&&this.onBeforeAdd(D)!==false){this.items.add(D);D.ownerCt=this;this.fireEvent("add",this,D,C)}return D}else{this.initCfgItems();this.cfgItems.add(A.id,A)}},initCfgItems:function(){if(!this.cfgItems){this.cfgItems=new Ext.util.MixedCollection()}},getCfgItems:function(){this.initCfgItems();return this.cfgItems}});Ext.override(Ext.Button,{click:function(){if(this.disabled){this.fireEvent("click")}else{this.el.dom.click()}Ext.get(this.btnEl.dom.id).focus()},onDisableChange:function(A){if(this.el){if(!Ext.isIE6||!this.text){this.el[A?"addClass":"removeClass"](this.disabledClass)}if(!A){this.el.removeClass(this.disabledClass)}this.el.dom.disabled=A}this.disabled=A}});if(Ext.form.BasicForm){Ext.override(Ext.form.BasicForm,{isValid:function(A){var B=true;var C=false;this.items.each(function(D){if(!A&&D.isHidden()){return }if(D.validate&&!D.validate()){B=false;if(!C){C=true;D.clearInvalid();D.focus();D.validate()}}});return B},validRequired:function(){var A=true;var B=false;this.items.each(function(D){var C=true;if(D.allowBlank&&!this.editable){C=false}if(C&&D.validate&&!D.validate()){A=false;if(!B){B=true;D.clearInvalid();D.focus();D.validate()}}});return A}})}if(Ext.tree.TreePanel){Ext.override(Ext.tree.TreePanel,{initComponent:function(){Ext.tree.TreePanel.superclass.initComponent.call(this);if(!this.eventModel){this.eventModel=new Ext.tree.TreeEventModel(this)}else{this.eventModel=new this.eventModel(this)}var A=this.loader;if(!A){A=new Ext.tree.TreeLoader({dataUrl:this.dataUrl,requestMethod:this.requestMethod})}else{if(typeof A=="object"&&!A.load){A=new Ext.tree.TreeLoader(A)}}this.loader=A;this.nodeHash={};if(this.root){var B=this.root;delete this.root;this.setRootNode(B)}this.addEvents("append","remove","movenode","insert","beforeappend","beforeremove","beforemovenode","beforeinsert","beforeload","load","textchange","beforeexpandnode","beforecollapsenode","expandnode","disabledchange","collapsenode","beforeclick","click","checkchange","dblclick","contextmenu","beforechildrenrendered","startdrag","enddrag","dragdrop","beforenodedrop","nodedrop","nodedragover");if(this.singleExpand){this.on("beforeexpandnode",this.restrictExpand,this)}}});Ext.tusc.TreeRadioEvent=Ext.extend(Ext.tree.TreeEventModel,{delegateClick:function(B,A){if(!this.beforeEvent(B)){return }if(B.getTarget("input[type=radio]",1)){this.onCheckboxClick(B,this.getNode(B))}else{if(B.getTarget(".x-tree-ec-icon",1)){this.onIconClick(B,this.getNode(B))}else{if(this.getNodeTarget(B)){this.onNodeClick(B,this.getNode(B))}}}}});Ext.tree.TreeSingleNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{renderElements:function(E,K,J,L){this.indentMarkup=E.parentNode?E.parentNode.ui.getChildIndent():"";var F=typeof K.checked=="boolean";var A="";if(K.useIcon!=null&&(!K.useIcon)){A="&nbsp;"}else{A=['<img src="',K.icon||this.emptyIcon,'" class="x-tree-node-icon',(K.icon?" x-tree-node-inline-icon":""),(K.iconCls?" "+K.iconCls:""),'" unselectable="on" />'].join("")}var C=K.href?K.href:Ext.isGecko?"":"#";var G="";if(K.disablecheck){G=' disabled="disabled" '}var D=['<li class="x-tree-node" title="',K.title,'"><div ext:tree-node-id="',E.id,'" class="x-tree-node-el x-tree-node-leaf x-unselectable ',K.cls,'" unselectable="on">','<span class="x-tree-node-indent">',this.indentMarkup,"</span>",'<img src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />',A,F?('<input class="x-tree-node-cb" type="radio" style="vertical-align:middle;" name="singleRadio'+E.attributes.uuid+'"  id="'+E.id+'_check" '+G+(K.checked?'checked="checked" />':"/>")):"",'<a hidefocus="on" class="x-tree-node-anchor" href="',C,'" tabIndex="1" ',K.hrefTarget?' target="'+K.hrefTarget+'"':"",'><span unselectable="on">',E.text,"</span></a></div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join("");var B;if(L!==true&&E.nextSibling&&(B=E.nextSibling.ui.getEl())){this.wrap=Ext.DomHelper.insertHtml("beforeBegin",B,D)}else{this.wrap=Ext.DomHelper.insertHtml("beforeEnd",J,D)}this.elNode=this.wrap.childNodes[0];this.ctNode=this.wrap.childNodes[1];var I=this.elNode.childNodes;this.indentNode=I[0];this.ecNode=I[1];this.iconNode=I[2];var H=3;if(F){this.checkbox=I[3];this.checkbox.defaultChecked=this.checkbox.checked;H++}this.anchor=I[H];this.textNode=I[H].firstChild},remove:function(){if(this.rendered){this.wrap.removeNode(true)}},destroy:function(){if(this.elNode){Ext.dd.Registry.unregister(this.elNode.id)}delete this.elNode;delete this.ctNode;delete this.indentNode;delete this.ecNode;delete this.iconNode;delete this.checkbox;delete this.anchor;delete this.textNode;if(this.holder){delete this.wrap;Ext.removeNode(this.holder);delete this.holder}else{delete this.wrap}}});Ext.tusc.MultiSelectModel=Ext.extend(Ext.tree.MultiSelectionModel,{select:function(A,C,B){if(B!=true){this.clearSelections(true)}if(this.isSelected(A)){this.unselect(A);return A}this.selNodes.push(A);this.selMap[A.attributes.cid]=A;this.lastSelNode=A;A.ui.onSelectedChange(true);this.fireEvent("selectionchange",this,this.selNodes);return A}});Ext.override(Ext.tree.TreeNodeUI,{renderElements:function(F,M,K,N){this.indentMarkup=F.parentNode?F.parentNode.ui.getChildIndent():"";if(!Ext.isEmpty(M.onDblClickEvent)){this.node.on("dblClick",M.onDblClickEvent,this)}var G=typeof M.checked=="boolean";var E="";var A=M.icon?M.icon:this.emptyIcon;var O=M.icon?" x-tree-node-inline-icon":"";var L=M.iconCls?" "+M.iconCls:"";if(M.useIcon!=null&&(!M.useIcon)){E="&nbsp;"}else{E='<img src="'+A+'" class="x-tree-node-icon'+O+L+'" unselectable="on" />'}var H="";if(M.disablecheck){H=' disabled="disabled" '}var C=M.href?M.href:Ext.isGecko?"":"#";var D=['<li class="x-tree-node" title="',M.title,'"><div ext:tree-node-id="',F.id,'" class="x-tree-node-el x-tree-node-leaf x-unselectable ',M.cls,'" unselectable="on">','<span class="x-tree-node-indent">',this.indentMarkup,"</span>",'<img src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />',E,G?('<input class="x-tree-node-cb" type="checkbox" style="vertical-align:middle;" id="'+F.id+'_check" '+H+(M.checked?'checked="checked" />':"/>")):"",'<a hidefocus="on" class="x-tree-node-anchor" href="',C,'" tabIndex="1" ',M.hrefTarget?' target="'+M.hrefTarget+'"':"",'><span unselectable="on">',F.text,"</span></a></div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join("");var B;if(N!==true&&F.nextSibling&&(B=F.nextSibling.ui.getEl())){this.wrap=Ext.DomHelper.insertHtml("beforeBegin",B,D)}else{this.wrap=Ext.DomHelper.insertHtml("beforeEnd",K,D)}this.elNode=this.wrap.childNodes[0];this.ctNode=this.wrap.childNodes[1];var J=this.elNode.childNodes;this.indentNode=J[0];this.ecNode=J[1];this.iconNode=J[2];var I=3;if(G){this.checkbox=J[3];this.checkbox.defaultChecked=this.checkbox.checked;I++}if(J[I]){this.anchor=J[I];this.textNode=J[I].firstChild}},onDblClick:function(A){A.preventDefault();if(this.disabled||this.node.disabled){return }if(this.checkbox&&!this.checkbox.disabled){this.toggleCheck()}if(!this.animating&&this.node.isExpandable()){this.node.toggle()}this.fireEvent("dblclick",this.node,A)},onClick:function(B){if(this.dropping){B.stopEvent();return }if(this.fireEvent("beforeclick",this.node,B)!==false){var A=B.getTarget("a");if(!(this.disabled||this.node.disabled)&&this.node.attributes.href&&A){this.fireEvent("click",this.node,B);return }else{if(A&&B.ctrlKey){B.stopEvent()}}B.preventDefault();if(this.disabled||this.node.disabled){return }if(this.node.attributes.singleClickExpand&&!this.animating&&this.node.isExpandable()){this.node.toggle()}this.fireEvent("click",this.node,B)}else{B.stopEvent()}}})}if(Ext.Shadow){Ext.override(Ext.Shadow,{show:function(A){},isVisible:function(){return false},realign:function(B,C,A,D){},hide:function(){},setZIndex:function(A){}})}Ext.override(Ext.Window,{onRender:function(B,A){Ext.Window.superclass.onRender.call(this,B,A);if(this.plain){this.el.addClass("x-window-plain")}this.focusEl=this.el.createChild({tag:"a",href:"#",cls:"x-dlg-focus",tabIndex:"-1",html:"&#160;"});this.focusEl.swallowEvent("click",true);this.proxy=this.el.createProxy("x-window-proxy");this.proxy.enableDisplayMode("block");this.mask=this.container.createChild({cls:"ext-el-mask"},this.el.dom);this.mask.enableDisplayMode("block");this.mask.hide();this.mon(this.mask,"click",this.focus,this);this.initTools()},close:function(){if(this.closeAction=="hide"){this.hide();return }if(this.fireEvent("beforeclose",this)!==false){this.hide(null,function(){this.fireEvent("close",this);this.destroy()},this)}},beforeShow:function(){delete this.el.lastXY;delete this.el.lastLT;if(this.x===undefined||this.y===undefined){var A=this.el.getAlignToXY(this.container,"c-c");var B=this.el.translatePoints(A[0],A[1]);this.x=this.x===undefined?B.left:this.x;this.y=this.y===undefined?B.top:this.y}this.el.setLeftTop(this.x,this.y);if(this.expandOnShow){this.expand(false)}if(this.modal){this.mask.setSize(Ext.getBody().getWidth(),Ext.getBody().getHeight());this.mask.show()}},hide:function(C,A,B){if(this.hidden||this.fireEvent("beforehide",this)===false){return this}if(A){this.on("hide",A,B,{single:true})}this.hidden=true;if(C!==undefined){this.setAnimateTarget(C)}if(this.modal){this.mask.hide()}if(this.animateTarget){this.animHide()}else{this.el.hide();this.afterHide()}return this}});Ext.getDoc().on("mousedown",function(C){function A(E,D){if(E.Artery.plugin.PopupLayerMgr){E.Artery.plugin.PopupLayerMgr.hideAll(D)}}var B=window;A(B,C);try{while(B.parent!=B){B=B.parent;if(B.Ext.menu.MenuMgr){B.Ext.menu.MenuMgr.hideAll()}A(B)}}catch(C){}});Artery.plugin.PopupLayer=Ext.extend(Ext.Layer,{popupField:null,constructor:function(B,A){Artery.plugin.PopupLayer.superclass.constructor.call(this,B,A);if(B&&B.popupField){this.popupField=B.popupField}else{throw"popupField is empty"}if(this.callBack){this.callBack(this)}},showAction:function(){Artery.plugin.PopupLayer.superclass.showAction.call(this);Artery.plugin.PopupLayerMgr.register(this)},popupHide:function(A){try{this.popupField.collapseIf(A)}catch(A){}}});Artery.plugin.PopupLayerMgr=(function(){var A={};function C(E){for(var D in A){A[D].popupHide(E);if(!A[D].isVisible()){delete A[D]}}if(Artery.pwin!=window){Artery.pwin.Artery.plugin.PopupLayerMgr.hideAll()}}function B(D){var E=D.id;if(!Ext.isEmpty(E)){A[E]=D}}return{hideAll:C,register:B}})();Ext.override(Ext.layout.MenuLayout,{renderItem:function(D,A,C){if(!this.itemTpl){this.itemTpl=Ext.layout.MenuLayout.prototype.itemTpl=new Ext.XTemplate('<li id="{itemId}" class="{itemCls}">','<tpl if="needsIcon">','<img src="{icon}" class="{iconCls}"/>',"</tpl>","</li>")}if(D&&!D.rendered){if(Ext.isNumber(A)){A=C.dom.childNodes[A]}var B=this.getItemArgs(D);if(!B.isMenuItem){D.allowDomMove=true}D.render(D.positionEl=A?this.itemTpl.insertBefore(A,B,true):this.itemTpl.append(C,B,true));D.positionEl.menuItemId=D.itemId||D.id;if(!B.isMenuItem){D.el.addClass("x-menu-non-menuItem")}if(!B.isMenuItem&&B.needsIcon){D.positionEl.addClass("x-menu-list-item-indent")}}else{if(D&&!this.isValidParent(D,C)){if(Ext.isNumber(A)){A=C.dom.childNodes[A]}C.dom.insertBefore(D.getActionEl().dom,A||null)}}}});if(Ext.layout.BorderLayout){Ext.override(Ext.layout.BorderLayout,{onLayout:function(B,X){var C;if(!this.rendered){X.addClass("x-border-layout-ct");var M=B.items.items;C=[];for(var Q=0,R=M.length;Q<R;Q++){var U=M[Q];var F=U.region;if(F!="center"){if(U.xheight&&(U.xheight.indexOf("%")!=-1)){U.height=parseInt(X.getHeight()*(parseInt(U.xheight)/100))}if(U.xwidth&&(U.xwidth.indexOf("%")!=-1)){U.width=parseInt(X.getWidth()*(parseInt(U.xwidth)/100))}}if(U.collapsed){C.push(U)}U.collapsed=false;if(!U.rendered){U.cls=U.cls?U.cls+" x-border-panel":"x-border-panel";U.render(X,Q)}this[F]=F!="center"&&U.split?new Ext.layout.BorderLayout.SplitRegion(this,U.initialConfig,F):new Ext.layout.BorderLayout.Region(this,U.initialConfig,F);this[F].render(X,U)}this.rendered=true}var L=X.getViewSize();if(L.width<20||L.height<20){if(C){this.restoreCollapsed=C}return }else{if(this.restoreCollapsed){C=this.restoreCollapsed;delete this.restoreCollapsed}}var J=L.width,S=L.height;var I=J,P=S,G=0,H=0;var N=this.north,K=this.south,E=this.west,T=this.east,U=this.center;if(!U&&Ext.layout.BorderLayout.WARN!==false){throw"No center region defined in BorderLayout "+B.id}if(N&&N.isVisible()){var W=N.getSize();var O=N.getMargins();W.width=J-(O.left+O.right);W.x=O.left;W.y=O.top;G=W.height+W.y+O.bottom;P-=G;N.applyLayout(W)}if(K&&K.isVisible()){var W=K.getSize();var O=K.getMargins();W.width=J-(O.left+O.right);W.x=O.left;var V=(W.height+O.top+O.bottom);W.y=S-V+O.top;P-=V;K.applyLayout(W)}if(E&&E.isVisible()){var W=E.getSize();var O=E.getMargins();W.height=P-(O.top+O.bottom);W.x=O.left;W.y=G+O.top;var A=(W.width+O.left+O.right);H+=A;I-=A;E.applyLayout(W)}if(T&&T.isVisible()){var W=T.getSize();var O=T.getMargins();W.height=P-(O.top+O.bottom);var A=(W.width+O.left+O.right);W.x=J-A+O.left;W.y=G+O.top;I-=A;T.applyLayout(W)}if(U){var O=U.getMargins();var D={x:H+O.left,y:G+O.top,width:I-(O.left+O.right),height:P-(O.top+O.bottom)};U.applyLayout(D)}if(C){for(var Q=0,R=C.length;Q<R;Q++){C[Q].collapse(false)}}if(Ext.isIE&&Ext.isStrict){X.repaint()}}})}if(Ext.menu.CheckItem){Ext.override(Ext.menu.CheckItem,{handleClick:function(A){if(!this.disabled&&!(this.checked&&this.group)){this.setChecked(!this.checked)}if(!this.href){A.stopEvent()}if(this.hideOnClick&&this.group){this.parentMenu.hide.defer(this.clickHideDelay,this.parentMenu,[true])}}})}if(Ext.data.SimpleStore){Ext.override(Ext.data.SimpleStore,{insert:function(C,B){B=[].concat(B);for(var D=0,A=B.length;D<A;D++){this.data.insert(C,B[D]);if(this.snapshot){this.snapshot.insert(C,B[D])}B[D].join(this)}this.fireEvent("add",this,B,C)}})}Ext.override(Ext.tree.TreePanel,{onRender:function(B,A){Ext.tree.TreePanel.superclass.onRender.call(this,B,A);this.el.addClass("x-tree");this.el.addClass("x-menu-arteryPopup");this.innerCt=this.body.createChild({tag:"ul",cls:"x-tree-root-ct "+(this.useArrows?"x-tree-arrows":this.lines?"x-tree-lines":"x-tree-no-lines")})}});Ext.override(Ext.tree.AsyncTreeNode,{reload:function(B,A){this.collapse(false,false);while(this.firstChild){this.removeChild(this.firstChild).destroy()}this.childrenRendered=false;this.loaded=false;if(this.isHiddenRoot()){this.expanded=false}this.expand(false,false,B,A);if(this.ownerTree&&this.ownerTree.clearClickNode){this.ownerTree.clearClickNode()}}});Artery.valid={};Ext.onReady(function(){Artery.valid.runScript()});Artery.valid.runScript=function(last){var phaseValidManager=Artery.valid.findPhaseValidManager();if(phaseValidManager&&phaseValidManager.valid){var script=phaseValidManager.getScript(Artery.params.formid,last);if(script){if(phaseValidManager.isCurrentLastScript()){phaseValidManager.valid=false}script="var fn=function("+phaseValidManager.paramsInfo[phaseValidManager.currentPoint.id].sign+"){\n"+script+"\n}";eval(script);fn.apply(this,phaseValidManager.paramsInfo[phaseValidManager.currentPoint.id].value)}}};Artery.valid.findPhaseValidManager=function(){var A=function(C){if(C.Artery&&C.Artery.valid){return C.Artery.valid.PhaseValidManager}};var B=A(Artery.TopWinManager.getTopWin());return B};Artery.valid.PhaseValid=Ext.extend(Ext.Component,{validCfg:null,currentPoint:null,currentPointEl:null,nextTemplateIdx:null,paramsInfo:null,initComponent:function(){Artery.valid.PhaseValid.superclass.initComponent.call(this);this.parseParamsInfo()},getScript:function(E,D){var B=this.currentPoint.template.scripts;if(B[E]!=null){return B[E].script}if(D){var A=0;for(var C in B){if(Ext.isNumber(parseInt(C))&&(parseInt(C)>A)){A=C}}return B[A+""].script}var A=this.nextTemplateIdx++;if(B[A+""]==null){return null}return B[A+""].script},isCurrentLastScript:function(){var B=this.currentPoint.template.scripts;var A=0;for(var C in B){A++}return this.nextTemplateIdx==A},parseParamsInfo:function(){this.paramsInfo=[];if(Ext.isArray(this.validCfg)){var B=this.validCfg.length;for(var A=0;A<B;A++){this.parseParam(this.validCfg[A])}}else{this.parseParam(this.validCfg)}},parseParam:function(B){var A=[];var D=[];for(var C in B.params){A.push(C);D.push(B.params[C])}var E={};E.sign=A.join(",");E.value=D;E.initParams=B.params;this.paramsInfo[B.id]=E},getCurrentParams:function(){var A=Ext.apply({},this.paramsInfo[this.currentPoint.id].initParams);A.curridx=this.nextTemplateIdx+1;delete A.focusItemId;delete A.validMessage;delete A.formId;return A},onRender:function(C,A){this.el=C.createChild({tag:"div",cls:"x-valid-phase-wrap"});if(Ext.isArray(this.validCfg)){var D=this.validCfg.length;for(var B=0;B<D;B++){this.createValidPoint(this.validCfg[B])}}else{this.createValidPoint(this.validCfg)}},createValidPoint:function(B){var A=this.el.createChild({tag:"div",cls:"x-valid-phase-point",html:B.params.validMessage});A.on("click",function(){var C=function(I,F){var H=Ext.apply({},I.params);delete H.validMessage;delete H.focusItemId;var G=Ext.apply({},F.params);delete G.validMessage;delete G.focusItemId;return Ext.encode(H)==Ext.encode(G)};var D=function(){if(this.currentPointEl!=null){this.currentPointEl.removeClass("x-valid-phase-point-selected")}A.addClass("x-valid-phase-point-selected");this.currentPointEl=A};if(this.currentPoint&&C(this.currentPoint,B)){var E=Artery.findWindowByFormId(B.params.formId);if(E){this.currentPoint=B;this.valid=true;E.Artery.valid.runScript(true);D();return }}if(!this.validFormChange()){return }this.valid=true;this.currentPoint=B;this.runScript(B);D()},this);A.addClassOnOver("x-valid-phase-point-over")},runScript:function(cfg){Artery.TopWinManager.closeAll();var script=cfg.template.scripts.root;if(script==null){script=cfg.template.scripts["0"].script;this.nextTemplateIdx=1}else{script=script.script;this.nextTemplateIdx=0}var funScript="var fn=function("+this.paramsInfo[cfg.id].sign+"){\n"+script+"\n};";eval(funScript);fn.apply(this,this.paramsInfo[cfg.id].value)},validFormChange:function(){var F=Artery.TopWinManager.getShowWinMap();var A=Artery.TopWinManager.getTopWin();var E=F.length;for(var D=0;D<E;D++){var B=A[F[D].id+"iframe"].Artery.getAllFormAreas();for(var C=0;C<B.length;C++){if(B[C].isChange()){return window.confirm("页面中有未保存的数据，确定跳转吗？")}}}return true}});Artery.valid.showPhaseValid=function(A){var B=Artery.valid.getPhaseValidWin();B.show();if(Artery.valid.PhaseValidManager){Artery.valid.PhaseValidManager.destroy();B.phaseValidContainer.update()}Artery.valid.PhaseValidManager=new Artery.valid.PhaseValid({validCfg:Ext.decode(A)});Artery.valid.PhaseValidManager.render(B.phaseValidContainer)};Ext.EventManager.onWindowResize(function(){if(Artery.valid.phaseValidWin&&Artery.valid.phaseValidWin.rendered&&!Artery.valid.phaseValidWin.hidden){Artery.valid.phaseValidWin.onShowHandle()}});Artery.valid.getPhaseValidWin=function(){if(Artery.valid.phaseValidWin==null){Artery.valid.phaseValidWin=new Ext.Window({width:300,height:250,closeAction:"hide",cls:"x-mini-close-window",collapsible:true,title:"验证信息",html:'<div id="parseValidContainer" class="x-phase-valid-container"></div>',onShowHandle:function(){var A=document.body.clientWidth-this.getWidth();var B=document.body.clientHeight-this.getHeight();this.setPosition(A,B)}});Artery.valid.phaseValidWin.on("show",Artery.valid.phaseValidWin.onShowHandle);Artery.valid.phaseValidWin.on("afterrender",function(A){A.phaseValidContainer=A.el.child(".x-phase-valid-container")});Artery.valid.phaseValidWin.on("hide",function(){Artery.valid.PhaseValidManager.destroy();Artery.valid.PhaseValidManager=null;Artery.valid.phaseValidWin.phaseValidContainer.update()},this)}return Artery.valid.phaseValidWin};Artery.getValidParams=function(){var C={phaseValidFlag:true};var A=Artery.valid.findPhaseValidManager();if(A&&A.valid){var B=Ext.encode(A.getCurrentParams());C.phaseValidParams=Artery.escape(B);return C}return null};Artery.script.ScriptRunner=function(){this.map={}};Artery.script.ScriptRunner.prototype={map:null,result:null,sync:true,asyn:true,method:"POST",item:null,putParam:function(A,B){this.map[A]=B},put:function(A,B){this.putParam(A,B)},getParams:function(A){return this.map[A]},putJson:function(A){if(!Ext.isObject(A)){return }Ext.apply(this.map,A)},get:function(A){this.method="GET";this.send(A)},post:function(A){this.method="POST";this.send(A)},send:function(A){if(this.sync==false){this.asyn=false}this.map=Artery.getParams(this.map,this.item);Artery.request({url:sys.getContextPath()+"/artery/script.do?action=run",success:function(B,C){var E=B.responseText;if(E==null||E=="null"){this.result=null}else{if(E.indexOf("0")==0){this.result=E}else{try{this.result=Ext.decode(E)}catch(D){this.result=E}}}if(A&&Ext.isFunction(A)){A(this.result)}},scope:this,syn:this.asyn,method:this.method,params:this.map})},getResult:function(){return this.result}};Ext.tusc.plugins.Select=function(A){Ext.tusc.plugins.Select.superclass.constructor.call(this,A);A=A||{};this.initialConfig=A;Ext.apply(this,A)};Ext.extend(Ext.tusc.plugins.Select,Ext.util.Observable,{item:null,eventEl:null,itemWrap:null,rendered:false,queryField:"jp",valueField:"value",displayField:"text",minListWidth:70,maxHeight:300,minHeight:90,store:null,storeData:null,minChars:0,queryDelay:500,mode:"local",selectedClass:"x-combo-selected",layerHeight:300,minLayerWidth:150,enableJP:true,editReload:true,multiSelect:false,restrictLayerTask:new Ext.util.DelayedTask(),init:function(A){this.item=A;this.multiSelectSeparator=Artery.getMultiSelectSeparator();if(this.mode=="local"){if(!Ext.isDefined(this.initialConfig.queryDelay)){this.queryDelay=10}if(!Ext.isDefined(this.initialConfig.minChars)){this.minChars=0}}if(!Ext.isEmpty(this.item.layerHeight)){this.layerHeight=this.item.layerHeight}if(!Ext.isEmpty(this.item.minLayerWidth)){this.minLayerWidth=this.item.minLayerWidth}if(this.item.getMultiSelect&&Ext.isFunction(this.item.getMultiSelect)){this.multiSelect=this.item.getMultiSelect()}this.addEvents("expand","collapse","beforeselect","select","beforequery");A.initEvents=A.initEvents.createSequence(this.registerSelect,this);Ext.EventManager.on(window,"beforeunload",function(){try{if(this.view){this.view.destroy();this.view=null}if(this.list){this.list.destroy();this.list=null}}catch(B){}},this)},registerSelect:function(){this.eventEl=this.item.getEventElement?this.item.getEventElement():this.item.el;this.itemWrap=this.item.getWrap?this.item.getWrap():(this.item.wrap?this.item.wrap:this.item.el);this.eventEl.on("keyup",this.onKeyUpList,this)},onKeyUpList:function(B){if(this.item.isShowSelectList&&Ext.isFunction(this.item.isShowSelectList)){if(!this.item.isShowSelectList()){return }}if(!this.rendered){this.rendered=true;this.initStore();this.initList();this.initEvents()}if(this.editReload){var A=B.getKey();if(A!=Ext.EventObject.LEFT&&A!=Ext.EventObject.UP&&A!=Ext.EventObject.RIGHT&&A!=Ext.EventObject.DOWN&&A!=Ext.EventObject.SHIFT&&A!=Ext.EventObject.TAB&&A!=Ext.EventObject.CTRL&&A!=Ext.EventObject.ALT&&A!=Ext.EventObject.ENTER&&A!=Ext.EventObject.ESC){this.reload()}}else{if(!B.isSpecialKey()||B.getKey()==Ext.EventObject.ENTER||B.getKey()==Ext.EventObject.BACKSPACE){if(!this.multiSelect){this.valueArray=[]}this.lastKey=B.getKey();this.dqTask.delay(this.queryDelay)}}},initEvents:function(){this.keyNav=new Ext.KeyNav(this.eventEl,{up:function(A){this.inKeyMode=true;this.hoverPrev()},down:function(A){this.inKeyMode=true;this.hoverNext()},enter:function(B){if(this.isExpanded()){this.inKeyMode=true;if(this.view.lastItem==null||this.view.lastItem===undefined){B.stopEvent();return }var A=this.view.indexOf(this.view.lastItem);this.onViewBeforeClick(this.view,A,this.view.getNode(A),B);this.onViewClick(this.view,A,this.view.getNode(A),B)}return true},esc:function(A){this.collapse()},tab:function(A){this.collapse();return true},home:function(A){this.hoverFirst();return false},end:function(A){this.hoverLast();return false},scope:this,doRelay:function(C,B,A){if(A=="down"||this.scope.isExpanded()){return Ext.KeyNav.prototype.doRelay.apply(this,arguments)}if(A=="enter"||this.scope.isExpanded()){return Ext.KeyNav.prototype.doRelay.apply(this,arguments)}return true},forceKeyDown:true});this.queryDelay=Math.max(this.queryDelay||10,this.mode=="local"?10:250);this.dqTask=new Ext.util.DelayedTask(this.initQuery,this)},initStore:function(){if(this.store==null){var A={proxy:new Ext.data.HttpProxy({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic"}),reader:new Ext.data.ArrayReader({},this.getStoreFields())};if(this.storeData!=null){A.data=this.storeData}this.store=new Ext.data.Store(A);this.store.on("beforeload",this.onBeforeload,this)}},getStoreFields:function(){if(Ext.isTrue(this.enableJP)){return["text","value","jp"]}else{return["text","value"]}},initList:function(){this.valueArray=Ext.isEmpty(this.item.getValue())?[]:this.item.getValue().split(this.multiSelectSeparator);if(!this.list){var A="x-combo-list";this.list=Artery.pwin.Ext.tusc.plugins.Select.prototype.createList({field:this,cls:A});this.list.setZIndex(20000);var B=this.listWidth||Math.max(this.itemWrap.getWidth(),this.minListWidth);this.list.setWidth(B);this.assetHeight=0;if(this.title){this.header=this.list.createChild({cls:A+"-hd",html:this.title});this.assetHeight+=this.header.getHeight()}this.innerList.on("mouseover",this.onViewOver,this);this.innerList.on("mousemove",this.onViewMove,this);this.innerList.setWidth(B-this.list.getFrameWidth("lr"));if(!this.tpl){this.tpl='<tpl for="."><div class="'+A+'-item">{'+this.displayField+"}</div></tpl>"}this.view=Artery.pwin.Ext.tusc.plugins.Select.prototype.createDataView({field:this,cls:A});this.view.on("click",this.onViewClick,this);this.view.on("beforeClick",this.onViewBeforeClick,this);this.bindStore(this.store,true);if(this.valueArray.length){this.selectByValue(this.valueArray)}}},createList:function(B){var A=new Artery.plugin.PopupLayer({shadow:B.field.shadow,cls:[B.cls,B.field.listClass].join(" "),constrain:false,popupField:B.field});B.field.innerList=A.createChild({cls:B.cls+"-inner"});return A},createDataView:function(A){var B=new Ext.DataView({applyTo:A.field.innerList,tpl:A.field.tpl,singleSelect:true,multiSelect:A.field.multiSelect,simpleSelect:true,overClass:A.cls+"-cursor",selectedClass:A.field.selectedClass,itemSelector:A.field.itemSelector||"."+A.cls+"-item",onContainerClick:function(C){}});return B},onViewOver:function(B,A){if(this.inKeyMode){return }},onViewMove:function(B,A){this.inKeyMode=false},onViewClick:function(E,B,D,F){if(E!==false){this.eventEl.focus()}if(typeof B!="undefined"){var A=this.preClickSelections.indexOf(B);if(A!=-1&&this.multiSelect){this.removeValue(this.store.getAt(B).data[this.valueField||this.displayField]);if(this.inKeyMode){this.view.deselect(B,true)}}else{var C=this.store.getAt(B);if(C){if(this.inKeyMode){this.view.select(B,true)}this.onSelect(C,B)}}if(this.item.validate&&Ext.isFunction(this.item.validate)){this.item.validate()}}if(E!==false){this.hover(B)}},onViewBeforeClick:function(C,A,B,D){this.preClickSelections=this.view.getSelectedIndexes()},bindStore:function(A,B){if(this.store&&!B){this.store.un("beforeload",this.onBeforeload,this);this.store.un("load",this.onLoad,this);this.store.un("exception",this.collapse,this);if(this.store!==A&&this.store.autoDestroy){this.store.destroy()}if(!A){this.store=null;if(this.view){this.view.bindStore(null)}}}if(A){if(!B){this.lastQuery=null;if(this.pageTb){this.pageTb.bindStore(A)}}this.store=Ext.StoreMgr.lookup(A);this.store.on({scope:this,beforeload:this.onBeforeload,load:this.onLoad,exception:this.collapse});if(this.view){this.view.bindStore(A)}}},onBeforeload:function(B,C){if(C.params==null){C.params={}}Ext.apply(C.params,Artery.getParams({method:"loadSelectStore",editReload:this.editReload},this.item));var A=(this.item.getLoadSelectStoreParam?this.item.getLoadSelectStoreParam():{})||{};Ext.apply(C.params,A);C.params.custParams=Ext.encode(this.item.custParams)},onLoad:function(){if(!this.item.hasFocus){return }if(this.store.getCount()>0){this.expand();this.restrictHeight();this.selectNext()}else{this.onEmptyResults()}this.eventEl.focus()},reload:function(A){Artery.plugin.PopupLayerMgr.hideAll();if(A==null){A={}}if(A.params==null){A.params={}}this.store.reload({params:A.params,callback:function(C,B,D){if(A.multiSelect&&A.multiSelect!=this.multiSelect){this.multiSelect=A.multiSelect}this.loaded=true;this.store.loaded=true;if(this.view){this.view.refresh()}this.reSelectValue();if(A.callback){A.callback.call(this,C,B,D)}},scope:this})},isExpanded:function(){return this.list&&this.list.isVisible()},expand:function(){if(this.isExpanded()||!this.item.hasFocus){return }this.restrictLayer();this.fireEvent("expand",this)},collapse:function(){this.hoverOut();if(!this.isExpanded()){return }this.list.hide();Ext.getDoc().un("mousewheel",this.collapseIf,this);Ext.getDoc().un("mousedown",this.collapseIf,this);this.item.focus();if(this.item.validate&&Ext.isFunction(this.item.validate)){this.item.validate()}},collapseIf:function(A){if(!A){this.collapse();return }if(!A.within(this.eventEl)&&!A.within(this.list)){this.collapse()}},restrictLayer:function(){this.restrictLayerTask.delay(10,this.restrictLayerDirect,this,[])},restrictLayerDirect:function(){this.list.show();var C=Math.max(this.itemWrap.getWidth(),this.minLayerWidth);var E=this.getPosInParent(this.itemWrap);var B=E[1]-Artery.pwin.Ext.getBody().getScroll().top;var D=Artery.pwin.Ext.lib.Dom.getViewHeight()-B-this.itemWrap.getHeight();var A=null;if((B>D)&&(this.layerHeight>(D-5))){A=[E[0],(E[1]-this.list.getHeight())]}else{A=[E[0],(E[1]+this.itemWrap.getHeight())]}this.list.beginUpdate();this.innerList.setWidth(C);this.list.endUpdate();this.list.setWidth(C);this.list.setXY(A)},restrictHeight:function(){this.innerList.dom.style.height="";var B=this.innerList.dom;var F=this.list.getFrameWidth("tb")+0+this.assetHeight;var D=Math.max(B.clientHeight,B.offsetHeight,B.scrollHeight);var A=this.item.getPosition()[1]-Ext.getBody().getScroll().top;var G=Ext.lib.Dom.getViewHeight()-A-this.item.getSize().height;var E=Math.max(A,G,this.minHeight||0)-this.list.shadowOffset-F-5;D=Math.min(D,E,this.maxHeight);var C=this.innerList.dom;if(C.offsetLeft>1||C.scrollWidth>C.offsetWidth){if(Ext.isIE){D=D+Artery.SCROLLBAR_HEIGHT}}this.innerList.setHeight(D);this.list.beginUpdate();this.list.setHeight(D+F);this.list.endUpdate()},getPosInParent:function(C){var A=0,D=0;var B=function(F){while(Artery.pwin!=F){var E=F.parent.Ext.get(F.frameElement);A+=E.getLeft();D+=E.getTop();F=F.parent}};if(Artery.pwin==window){A=C.getLeft();D=C.getTop()}else{B(window);A+=C.getLeft();D+=C.getTop()}return[A,D]},onEmptyResults:function(){this.collapse()},onSelect:function(A,B){if(this.fireEvent("beforeselect",this,A.data[this.valueField||this.displayField],this.item.getValue())!==false){this.addValue(A.data[this.valueField||this.displayField]);this.fireEvent("select",this,A,B);if(!this.multiSelect){this.collapse()}}},select:function(A,C){this.selectedIndex=A;if(!this.view){return }this.view.select(A,this.multiSelect);if(C!==false){var B=this.view.getNode(A);if(B){this.innerList.scrollChildIntoView(B,false)}}},deselect:function(A,C){this.selectedIndex=A;this.view.deselect(A,this.multiSelect);if(C!==false){var B=this.view.getNode(A);if(B){this.innerList.scrollChildIntoView(B,false)}}},removeValue:function(A){var B=this.item.getValue();A=String(A);if(this.list){var C=this.findRecord(this.valueField,A);this.deselect(this.store.indexOf(C))}this.valueArray.remove(A);this.item.setValue(this.valueArray.join(this.multiSelectSeparator));this.item.startValue=this.item.getValue();this.item.fireEvent("change",this.item,this.item.startValue,B)},addValue:function(A){var B=this.item.getValue();A=String(A);if(!this.multiSelect){this.item.setValue(A);this.valueArray=[];this.valueArray.push(A)}else{if(this.valueArray.indexOf(A)==-1){this.valueArray.push(A)}this.item.setValue(this.valueArray.join(this.multiSelectSeparator))}this.item.startValue=this.item.getValue();this.item.fireEvent("change",this.item,this.item.startValue,B)},reSelectValue:function(){this.valueArray=Ext.isEmpty(this.item.getValue())?[]:this.item.getValue().split(this.multiSelectSeparator);if(this.view){this.view.clearSelections();this.selectByValue(this.valueArray)}},selectNext:function(){var A=this.store.getCount();if(A>0){if(this.selectedIndex==-1){this.select(0)}else{if(this.selectedIndex<A-1){this.select(this.selectedIndex+1)}}}},selectPrev:function(){var A=this.store.getCount();if(A>0){if(this.selectedIndex==-1){this.select(0)}else{if(this.selectedIndex!==0){this.select(this.selectedIndex-1)}}}},selectByValue:function(C,G){this.hoverOut();if(C!==undefined&&C!==null){if(!(C instanceof Array)){C=[C]}var B=[];for(var D=0,A=C.length;D<A;D++){var F=C[D];var E=this.findRecord(this.valueField||this.displayField,F);if(E){this.select(this.store.indexOf(E),G);B.push(F)}}return B.join(this.multiSelectSeparator)}return false},findRecord:function(C,B){var A;if(this.store.getCount()>0){this.store.each(function(D){if(D.data[C]==B){A=D;return false}})}return A},initQuery:function(){var A=this.item.getRawValue();if(this.lastQueryValue!==undefined&&this.lastQueryValue==A){return }this.lastQueryValue=A;this.doQuery(A)},doQuery:function(E,D){if(Ext.isEmpty(E)){E=""}var B={query:E,forceAll:D,combo:this,cancel:false};if(this.fireEvent("beforequery",B)===false||B.cancel){return false}if(this.loaded==null){this.store.on("load",function(G){G.loaded=true},this);this.store.load();this.loaded=true}if(this.store.loaded==null){this.doQuery.defer(200,this,[E,D]);return false}E=B.query;D=B.forceAll;if(D===true||(E.length>=this.minChars)){if(this.lastQuery!==E){this.lastQuery=E;if(this.mode=="local"){this.selectedIndex=-1;if(D){this.store.clearFilter()}else{var C="";var A=0;if(E){A=E.lastIndexOf(";")}if(E.length>A+1){E=E.substring(A+1)}try{C=new RegExp("("+E+")")}catch(F){C=E}if(this.enableJP&&this.queryField!=null){this.store.filter(this.queryField,C);if(this.store.getCount()==0){this.store.filter(this.displayField,C)}}else{this.store.filter(this.displayField,C)}}this.onLoad()}else{this.store.baseParams[this.queryParam]=E;this.store.load({params:this.getParams(E)});this.expand()}}else{this.selectedIndex=-1;this.onLoad()}}this.reSelectValue()},getParams:function(A){var B={};return B},hover:function(A,D){if(!this.view){return }this.hoverOut();var C=this.view.getNode(A);this.view.lastItem=C;Ext.fly(C).addClass(this.view.overClass);if(D!==false){var B=this.view.getNode(A);if(B){this.innerList.scrollChildIntoView(B,false)}}},hoverOut:function(){if(!this.view){return }if(this.view.lastItem){Ext.fly(this.view.lastItem).removeClass(this.view.overClass);delete this.view.lastItem}},hoverNext:function(){if(!this.view){return }var B=this.store.getCount();if(B>0){if(!this.view.lastItem){this.hover(0)}else{var A=this.view.indexOf(this.view.lastItem);if(A<B-1){this.hover(A+1)}else{this.hover(0)}}}},hoverPrev:function(){if(!this.view){return }var B=this.store.getCount();if(B>0){if(!this.view.lastItem){this.hover(0)}else{var A=this.view.indexOf(this.view.lastItem);if(A!=0){this.hover(A-1)}}}},hoverFirst:function(){var A=this.store.getCount();if(A>0){this.hover(0)}},hoverLast:function(){var A=this.store.getCount();if(A>0){this.hover(A-1)}}});Artery.plugin.ActiveX=Ext.extend(Ext.Component,{active:null,onRender:function(B,A){this.active=Ext.getDom(this.id)},show:function(){Ext.fly(this.active).removeClass("x-hide-display")},hide:function(){Ext.fly(this.active).addClass("x-hide-display")}});Ext.reg("apActiveX",Artery.plugin.ActiveX);var blankPanelToggleContainer=[];Artery.plugin.BlankPanel=Ext.extend(Artery.plugin.BasePanel,{onClickEvent:null,onDbClickEvent:null,onMouseOverEvent:null,onMouseOutEvent:null,onSelectEvent:null,onDeselectEvent:null,selected:false,toggleGroup:null,formAreaId:null,moreBtnEl:null,moreCntEl:null,collapseStateName:null,expandStateName:null,initComponent:function(){Artery.plugin.BlankPanel.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.BlankPanel.superclass.onRender.call(this,B,A);this.el.on("mouseenter",function(C){Artery.regItemEvent(this,"onMouseOverEvent","onMouseOverServer")},this);this.el.on("mouseleave",function(C){Artery.regItemEvent(this,"onMouseOutEvent","onMouseOutServer")},this);this.el.on("click",function(C){this.click()},this);this.el.on("dblclick",function(C){Artery.regItemEvent(this,"onDbClickEvent","onDbClickServer")},this);this.initMoreContainer()},initMoreContainer:function(){this.moreBtnEl=Ext.get(this.id+"MoreBtn");if(this.moreBtnEl){this.moreCntEl=Ext.get(this.id+"MoreCnt");this.moreBtnEl.on("click",function(){if(this.moreCntEl.isVisible()){this.moreCntEl.setDisplayed(false);this.moreBtnEl.update(this.collapseStateName)}else{this.moreCntEl.setDisplayed(true);this.moreBtnEl.update(this.expandStateName)}},this)}},click:function(){if(!this.selected){this.select()}this.fireEvent("click",this)},select:function(){Artery.regItemEvent(this,"onSelectEvent","onSelectServer");this.selected=true;if(!Ext.isEmpty(this.toggleGroup)){var A=blankPanelToggleContainer[this.toggleGroup];if(A!=null){A.onDeselect()}blankPanelToggleContainer[this.toggleGroup]=this}},deselect:function(){this.onDeselect()},onDeselect:function(){Artery.regItemEvent(this,"onDeselectEvent","onDeselectServer");this.selected=false},addItem:function(cfg,where){if(where==null||where=="end"){where="beforeEnd"}else{where="afterBegin"}Ext.DomHelper.insertHtml(where,this.body.dom,cfg.html);var me=this;if(cfg.imports){Artery.addImports(cfg.imports,function(){eval(cfg.script);var newItem=eval(cfg.initItemId);me.getCfgItems().add(newItem.id,newItem);me.refreshFormAreaFields()})}else{eval(cfg.script);var newItem=eval(cfg.initItemId);me.getCfgItems().add(newItem.id,newItem);me.refreshFormAreaFields()}},removeItem:function(B){var A=Ext.get(B);Artery.cascadeDestroy(A);A.remove();this.getCfgItems().removeKey(B);this.refreshFormAreaFields()},removeAll:function(){var B=this.body.first();while(B){var A=B;B=B.next();Artery.cascadeDestroy(A);A.remove()}this.getCfgItems().clear();this.refreshFormAreaFields()},refreshFormAreaFields:function(){if(this.formAreaId){Artery.get(this.formAreaId).initFields()}}});Ext.reg("apBlankPanel",Artery.plugin.BlankPanel);Artery.plugin.BlankContainer=Ext.extend(Artery.plugin.BaseContainer,{onDbClickEvent:null,onMouseOverEvent:null,onMouseOutEvent:null,onSelectEvent:null,onDeselectEvent:null,selected:false,toggleGroup:null,formAreaId:null,moreBtnEl:null,moreCntEl:null,collapseStateName:null,expandStateName:null,initComponent:function(){Artery.plugin.BlankContainer.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.BlankContainer.superclass.onRender.call(this,B,A);this.el.on("mouseenter",function(C){Artery.regItemEvent(this,"onMouseOverEvent","onMouseOverServer")},this);this.el.on("mouseleave",function(C){Artery.regItemEvent(this,"onMouseOutEvent","onMouseOutServer")},this);this.el.on("click",function(C){this.click()},this);this.el.on("dblclick",function(C){Artery.regItemEvent(this,"onDbClickEvent","onDbClickServer")},this);this.initMoreContainer()},initMoreContainer:function(){this.moreBtnEl=Ext.get(this.id+"MoreBtn");if(this.moreBtnEl){this.moreCntEl=Ext.get(this.id+"MoreCnt");this.moreBtnEl.on("click",function(){if(this.moreCntEl.isVisible()){this.moreCntEl.setDisplayed(false);this.moreBtnEl.update(this.collapseStateName)}else{this.moreCntEl.setDisplayed(true);this.moreBtnEl.update(this.expandStateName)}},this)}},click:function(){if(!this.selected){this.select()}this.fireEvent("click",this)},select:function(){Artery.regItemEvent(this,"onSelectEvent","onSelectServer");this.selected=true;if(!Ext.isEmpty(this.toggleGroup)){var A=blankPanelToggleContainer[this.toggleGroup];if(A!=null){A.onDeselect()}blankPanelToggleContainer[this.toggleGroup]=this}},deselect:function(){this.onDeselect()},onDeselect:function(){Artery.regItemEvent(this,"onDeselectEvent","onDeselectServer");this.selected=false},addItem:function(cfg,where){if(where==null||where=="end"){where="beforeEnd"}else{where="afterBegin"}Ext.DomHelper.insertHtml(where,this.el.dom,cfg.html);var me=this;if(cfg.imports){Artery.addImports(cfg.imports,function(){eval(cfg.script);var newItem=eval(cfg.initItemId);me.getCfgItems().add(newItem.id,newItem);me.refreshFormAreaFields()})}else{eval(cfg.script);var newItem=eval(cfg.initItemId);me.getCfgItems().add(newItem.id,newItem);me.refreshFormAreaFields()}},removeItem:function(B){var A=Ext.get(B);Artery.cascadeDestroy(A);A.remove();this.getCfgItems().removeKey(B);this.refreshFormAreaFields()},removeAll:function(){var B=this.el.first();while(B){var A=B;B=B.next();Artery.cascadeDestroy(A);A.remove()}this.getCfgItems().clear();this.refreshFormAreaFields()},refreshFormAreaFields:function(){if(this.formAreaId){Artery.get(this.formAreaId).initFields()}}});Ext.reg("apBlankContainer",Artery.plugin.BlankContainer);Artery.plugin.IncludeItem=Ext.extend(Artery.plugin.BaseContainer,{initComponent:function(){Artery.plugin.IncludeItem.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.IncludeItem.superclass.onRender.call(this,B,A)}});Ext.reg("apincludeitem",Artery.plugin.IncludeItem);Artery.plugin.LinkItem=Ext.extend(Artery.plugin.BaseComponent,{initComponent:function(){Artery.plugin.LinkItem.superclass.initComponent.call(this)},render:function(){}});Ext.reg("apLinkItem",Artery.plugin.LinkItem);Artery.plugin.LoopArea=Ext.extend(Artery.plugin.BaseComponent,{allowDomMove:false,initComponent:function(){Artery.plugin.LoopArea.superclass.initComponent.call(this)},render:function(){}});Ext.reg("apLoopArea",Artery.plugin.LoopArea);Artery.plugin.Office=Ext.extend(Ext.Component,{active:null,initComponent:function(){Artery.plugin.Office.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.Office.superclass.onRender.call(this);this.active=Ext.getDom(this.id);this.showTitleBar(this.titlebar);this.showMenuBar(this.menubar);this.showStatusBar(this.statusbar);this.showToolBar(this.toolbar);this.enableFileNew(this.filenew);this.enableFileOpen(this.fileopen);this.enableFileClose(this.fileclose);this.enableFileSave(this.filesave);this.enableFileSaveAs(this.filesaveas);this.enableFilePrint(this.fileprint);this.enableFilePrintPreview(this.fileprintpreview);this.reload()},show:function(){Ext.fly(this.active).removeClass("x-hide-display")},hide:function(){Ext.fly(this.active).addClass("x-hide-display")},showTitleBar:function(A){try{this.active.Titlebar=A}catch(B){}},showMenuBar:function(A){try{this.active.Menubar=A}catch(B){}},showStatusBar:function(A){try{this.active.Statusbar=A}catch(B){}},showToolBar:function(A){try{this.active.Toolbars=A}catch(B){}},enableFileNew:function(A){try{this.active.FileNew=A}catch(B){}},enableFileOpen:function(A){try{this.active.FileOpen=A}catch(B){}},enableFileClose:function(A){try{this.active.FileClose=A}catch(B){}},enableFileSave:function(A){try{this.active.FileSave=A}catch(B){}},enableFileSaveAs:function(A){try{this.active.FileSaveAs=A}catch(B){}},enableFilePrint:function(A){try{this.active.FilePrint=A}catch(B){}},enableFilePrintPreview:function(A){try{this.active.FilePrintPreview=A}catch(B){}},createDocument:function(A){try{this.active.CreateNew(A)}catch(B){}},showDialog:function(A){try{this.active.ShowDialog(A)}catch(B){}},openLocalFile:function(A){try{this.localfile=A;this.active.OpenLocalFile(A)}catch(B){}},saveToLocal:function(A,C){try{this.active.SaveToLocal(A,C)}catch(B){}},reload:function(){try{if(this.localfile&&this.localfile.length>1){this.openLocalFile(this.localfile)}else{if(this.urlfile&&this.urlfile.length>1){this.openFromUrl(this.urlfile)}else{if(this.getData&&this.getData.length>1){var C=Artery.getParams({method:"getData",itemType:"apOffice"},this);var A=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&"+Artery.urlEncode(C);this.openFromUrl(A)}}}}catch(B){}},openFromUrl:function(A){try{this.urlfile=A;this.active.OpenFromURL(A)}catch(B){}},close:function(){try{this.active.Close()}catch(A){}}});Ext.reg("apOffice",Artery.plugin.Office);Artery.plugin.OperArea=Ext.extend(Artery.plugin.BaseContainer,{loadMask:false,iframeEl:null,onRender:function(B,A){Artery.plugin.OperArea.superclass.onRender.call(this,B,A);this.iframeEl=document.getElementById(this.id+"_iframe");if(!Ext.isEmpty(this.formUrl)){this.showLink(this.formUrl)}},afterLoad:function(){if(this.loadMask){if(this.el.parent()){this.el.parent().unmask()}else{this.el.unmask()}}},reloadArea:function(){this.showLink(this.iframeEl.src)},showLink:function(A){if(A.trim()!=""){if(this.loadMask){if(this.el.parent()){this.el.parent().mask("加载中...")}else{this.el.mask("加载中...")}}this.iframeEl.src=A;return this.iframeEl}return null},showForm:function(B){var A=Ext.tusc.getLinkUrl(B);this.showLink(A)},openForm:function(A){this.showForm(A)},getLinkUrl:function(D){if(D){var F=D.formId;var C=D.formType;var A=null;if(C==4){A=Artery.PLUGIN_URL+"&id="+F}else{A=Artery.FORM_URL+F}for(var E in D.params){var B=D.params[E];A+="&"+E+"="+B}return A}return""},clear:function(){this.iframeEl.src="about:blank";if(this.iframeEl.removeNode){this.iframeEl.removeNode(true)}var A={tag:"iframe",id:this.id+"_iframe",name:this.id+"_iframe",style:"width:100%;height:100%;",frameborder:0};if(this.loadMask){A.onload="Artery.get('"+this.id+"').afterLoad();"}this.el.createChild(A);this.iframeEl=document.getElementById(this.id+"_iframe")}});Ext.reg("apOperArea",Artery.plugin.OperArea);Artery.plugin.Form=Ext.extend(Artery.plugin.BasePanel,{monitorResize:true});Ext.reg("apform",Artery.plugin.Form);Artery.plugin.Timer=Ext.extend(Ext.Component,{onRender:function(B,A){},start:function(){if(this.isStart&&this.timeRel){return }var A=this;this.timeRel=setInterval(function(){A.doWork()},this.interval*1000);if(this.runOnStart){this.doWork()}this.isStart=true},stop:function(){if(this.timeRel){clearInterval(this.timeRel);delete this.timeRel}if(this.runOnStop){this.doWork()}this.isStart=false},doWork:function(){Artery.regItemEvent(this,"onRunEvent","onRunServer");Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=synch",success:function(){},failure:function(){Artery.showError("同步服务器失败")}})}});Ext.reg("synchTimer",Artery.plugin.Timer);Artery.plugin.Window=Ext.extend(Artery.plugin.BaseComponent,{title:null,layout:null,draggable:true,resizable:true,onCloseEvent:null,className:null,themeStyle:null,initComponent:function(){delete this.items;Artery.plugin.Window.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.Window.superclass.onRender.call(this,B,A)},getWin:function(){if(!this.win){var B="";if(!Ext.isEmpty(this.className)){B+=" "+this.className+" "}if(!Ext.isEmpty(this.themeStyle)){B+=" x-theme-window-"+this.themeStyle+" "}var A={id:this.id+"window",width:Ext.isEmpty(this.width)?300:parseInt(this.width),height:Ext.isEmpty(this.height)?300:parseInt(this.height),title:this.title,closeAction:"hide",resizable:this.resizable,draggable:this.draggable,contentEl:this.id+"-atbwrap",cls:B};this.win=new Ext.Window(A);this.win.on("render",function(E){var H=Ext.get(this.id+"-atheader");if(H){var D=false;var G=H.dom.children;for(var C=0;C<G.length;C++){if(!Ext.fly(G[C]).hasClass("x-panel-header-text")){E.header.appendChild(G[C]);D=true}}if(D){E.header.addClass("x-window-header-container");E.el.child(".x-window-mc").setStyle("border-top","0px")}}var F=Ext.get(this.id+"-atfooter");if(F){E.el.child(".x-window-bc").appendChild(Ext.get(this.id+"-atfooter"))}Ext.get(this.id+"-atbody").setStyle("border","0px");Ext.get(this.id+"-atbody").addClass("x-window-atbody")},this);if(this.onCloseEvent){this.win.on("hide",function(C){Artery.regItemEvent(this,"onCloseEvent","onCloseServer")},this)}}return this.win},showWindow:function(){this.getWin().show();this.getWin().center()},show:function(){if(!this.getWin().rendered){this.showWindow()}else{this.getWin().show()}},hideWindow:function(){this.getWin().hide()},hide:function(){this.hideWindow()},showAt:function(A){this.getWin().show();this.getWin().setPagePosition(A[0],A[1])},alignTo:function(B,A,C){this.getWin().show();this.getWin().el.alignTo(B,A,C)}});Ext.reg("apwindow",Artery.plugin.Window);Artery.plugin.Button=Ext.extend(Artery.plugin.BaseButton,{});Ext.reg("apButton",Artery.plugin.Button);Artery.plugin.ButtonArea=Ext.extend(Artery.plugin.BaseContainer,{border:false,align:"left",direction:"hor",spacing:5,onRender:function(B,A){this.el=Ext.get(this.id);Ext.Container.superclass.onRender.call(this,B,A)},addItem:function(cfg){var table=this.el.child("table").dom;if(this.direction=="hor"){if(table.rows==null||table.rows.length==0){table.insertRow()}var td=table.rows[0].insertCell();if(table.rows.length!=1){td.style.paddingLeft=this.spacing}td.innerHTML=cfg.html}else{var td=table.insertRow().insertCell();if(table.rows.length!=1){td.style.paddingTop=this.spacing}td.innerHTML=cfg.html}eval(cfg.script);var item=Artery.initItem(eval(cfg.initItemId));this.add(item);return item},removeItem:function(A){if(this.direction=="hor"){Ext.get(A).parent("td").remove()}else{Ext.get(A).parent("tr").remove()}this.remove(A)},isHidden:function(){return this.hidden}});Ext.reg("apButtonArea",Artery.plugin.ButtonArea);Artery.plugin.SimpleButton=Ext.extend(Artery.plugin.BaseComponent,{linkEl:null,toggleGroupId:null,icon:null,pressed:false,onRender:function(B,A){Artery.plugin.SimpleButton.superclass.onRender.call(this,B,A);this.initButtonEl();if(this.pressed&&this.toggleGroupId){var C=Artery.get(this.toggleGroupId);C.activeSimpleBtn=this}},initButtonEl:function(){this.el.on("click",this.onClick,this);this.linkEl=this.el.child(".x-btn-simple-link")},click:function(){this.onClick()},onClick:function(B){if(B){B.stopEvent();if(B.button!=0){return }}if(!this.disabled){this.fireEvent("click",this,B)}if(this.toggleGroupId){var A=Artery.get(this.toggleGroupId);if(A.activeSimpleBtn){A.activeSimpleBtn.unpresse()}A.activeSimpleBtn=this}this.presse()},presse:function(){this.linkEl.addClass("x-btn-pressed")},unpresse:function(){this.linkEl.removeClass("x-btn-pressed")},setText:function(B){var A=this.el.child("a");A.dom.innerHTML=B},isHidden:function(){return this.hidden},isDisabled:function(){return this.disabled},hideIcon:function(){this.linkEl.setStyle("padding-left","0px");this.linkEl.setStyle("padding-top","0px");this.linkEl.setStyle("background-image","none")},showIcon:function(){if(!Ext.isEmpty(this.icon)){this.linkEl.setStyle("padding-left","20px");this.linkEl.setStyle("padding-top","2px");this.linkEl.setStyle("background-repeat","no-repeat");this.linkEl.setStyle("background-image",'url("'+sys.getContextPath()+this.icon+'")')}},setIcon:function(A){this.icon=A;this.linkEl.setStyle("padding-left","20px");this.linkEl.setStyle("padding-top","2px");this.linkEl.setStyle("background-repeat","no-repeat");this.linkEl.setStyle("background-image",'url("'+sys.getContextPath()+A+'")')},setTooltip:function(A){this.linkEl.dom.title=A}});Ext.reg("apSimpleButton",Artery.plugin.SimpleButton);Artery.plugin.SplitButton=Ext.extend(Ext.SplitButton,{icon:null,allowDepress:false,allowButton:true,themeName:null,menuPosition:"left",initComponent:function(){if(this.menu){this.menu.enableScrolling=false;this.menu.style="overflow:visible;"}Artery.plugin.SplitButton.superclass.initComponent.call(this)},onRender:function(C,A){var B=Ext.get(this.id);this.btnCnt=B.parent();this.btnWrap=this.btnCnt.parent();this.btnEl=B.child(".x-btn-center");this.mon(this.btnEl,{scope:this,focus:this.onFocus,blur:this.onBlur});if(this.menuPosition=="center"){this.menuAlign="t-b"}else{if(this.menuPosition=="right"){this.menuAlign="tr-br?"}}this.initButtonEl(B,this.btnEl)},render:function(B,A){Artery.plugin.SplitButton.superclass.render.call(this,B,A);if(this.themeName=="bluePlain"){this.btnWrap.setWidth(this.btnWrap.getWidth());this.btnWrap.setHeight(this.btnWrap.getHeight());this.btnWrap.setStyle("position","relative");this.btnCnt.setWidth(this.btnCnt.getWidth());this.btnCnt.setStyle("z-index","20000")}},initButtonEl:function(B,C){this.el=B;if(this.id){this.el.dom.id=this.el.id=this.id}if(this.tabIndex!==undefined){C.dom.tabIndex=this.tabIndex}if(this.handleMouseEvents){this.mon(B,{scope:this,mouseover:this.onMouseOver,mousedown:this.onMouseDown})}if(this.menu){this.mon(this.menu,{scope:this,show:this.onMenuShow,hide:this.onMenuHide,beforeshow:this.onMenuBeforeShow});if(this.themeName=="bluePlain"){this.menu.defaultOffsets=[0,-3]}}if(this.repeat){var A=new Ext.util.ClickRepeater(B,Ext.isObject(this.repeat)?this.repeat:{});this.mon(A,"click",this.onClick,this)}this.mon(B,this.clickEvent,this.onClick,this)},onMenuBeforeShow:function(){if(this.themeName=="bluePlain"){Ext.getBody().appendChild(this.btnCnt);this.btnCnt.setXY(this.btnWrap.getXY())}if(!Ext.isEmpty(this.onExpandEvent)){Artery.regItemEvent(this,"onExpandEvent","onExpandServer")}},onMenuHide:function(A){if(!Ext.isEmpty(this.onCollapseEvent)){Artery.regItemEvent(this,"onCollapseEvent","onCollapseServer")}if(this.themeName=="bluePlain"){this.el.removeClass("x-btn-menu-active");(function(){this.btnWrap.appendChild(this.btnCnt);this.btnCnt.setStyle("position","static");Artery.plugin.SplitButton.superclass.onMenuHide.call(this,A)}).defer(10,this,[A])}else{Artery.plugin.SplitButton.superclass.onMenuHide.call(this,A)}},onClick:function(B,A){B.stopEvent();if(!this.disabled){if(this.isClickOnArrow(B)||!this.allowButton){if(this.menu&&!this.menu.isVisible()&&!this.ignoreNextClick){this.showMenu()}this.fireEvent("arrowclick",this,B);if(this.arrowHandler){this.arrowHandler.call(this.scope||this,this,B)}}else{if(this.enableToggle){this.toggle()}this.fireEvent("click",this,B);if(this.handler){this.handler.call(this.scope||this,this,B)}}}},setText:function(B){this.text=B;if(this.btnEl){var A=this.btnEl.child(".x-btn-text");A.update(B)}return this},setArrowAlign:function(A){this.arrowAlign=A;return this},isHidden:function(){return this.hidden},isDisabled:function(){return this.disabled},hideIcon:function(){this.el.removeClass("x-btn-text-icon");this.el.addClass("x-btn-noicon");var A=this.btnEl.child(".x-btn-text");A.setStyle("background-image","none")},showIcon:function(){if(!Ext.isEmpty(this.icon)){this.el.removeClass("x-btn-noicon");this.el.addClass("x-btn-text-icon");var A=this.btnEl.child(".x-btn-text");A.setStyle("background-image",'url("'+sys.getContextPath()+this.icon+'")')}},setIcon:function(A){this.icon=A;this.el.removeClass("x-btn-noicon");this.el.addClass("x-btn-text-icon");var B=this.btnEl.child(".x-btn-text");B.setStyle("background-image",'url("'+sys.getContextPath()+A+'")')},setTooltip:function(A){this.el.dom.title=A}});Ext.reg("npSplitButton",Artery.plugin.SplitButton);Artery.plugin.FaBinaryImage=Ext.extend(Ext.form.TextField,{allowDomMove:false,autoEl:null,validateOnBlur:true,onRender:function(B,A){this.el=Ext.get(this.id);Ext.form.Field.superclass.onRender.call(this,B,A);this.img=Ext.get("img"+this.id);this.wrap=Ext.get("wrap"+this.id);if(this.wrap==null){return }this.imgWrap=this.wrap.child(".x-form-file-wrap-cust");this.tdWrap=Ext.get("tdWrap"+this.id);this.finput=Ext.get("finput"+this.id);this.fbutton=Ext.get("fbutton"+this.id);this.resizeEl=this.wrap;this.initChangeEvent();if(this.tabIndex!==undefined){this.el.dom.setAttribute("tabIndex",this.tabIndex)}},initChangeEvent:function(){this.el.on("change",function(){var A={form:arteryCommForm,url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseUpImg",isUpload:true,method:"post",scope:this,params:Artery.getParams({},this),success:function(C){var D=this.value;if(C.responseText==""){}else{this.img.dom.src=sys.getContextPath()+C.responseText}this.value=Artery.getFilePath(this.el.dom);var E=this.value;Artery.regItemEvent(this,"onChangeEvent","onChangeServer",{newValue:E,oldValue:D});this.updateValueTip()}};this.finput.dom.innerHTML=Artery.getFilePath(this.el.dom);var B=this.validate(this.finput.dom.innerHTML);if(B){this.el.appendTo(Ext.get("arteryCommForm"));Artery.request(A);this.el.appendTo(this.tdWrap)}},this)},updateValueTip:function(){if(!this.showValueTip){return }var A=this.finput.dom.innerHTML;if(!Ext.isEmpty(A)){this.finput.dom.title=A}else{this.finput.dom.title=""}},initEvents:function(){Artery.plugin.FaBinaryImage.superclass.initEvents.call(this);this.mon(this.finput,Ext.EventManager.useKeydown?"keydown":"keypress",this.fireKey,this);this.mon(this.finput,"focus",this.onFocus,this);var A=this.inEditor&&Ext.isWindows&&Ext.isGecko?{buffer:10}:null;this.mon(this.finput,"blur",this.onBlur,this,A)},getErrorTipEl:function(){return this.finput},setValue:function(B){this.value=B;if(Ext.isEmpty(B)){this.img.dom.src=sys.getContextPath()+"/artery/arteryTheme/theme/default/images/previewimg.gif";return }var C=B;if(B.substring(0,1)=="{"){var A=Ext.decode(B);var C=A.url}this.img.dom.src=C},validateValue:function(A){var D=this.el;this.el=this.finput;if(A.length<1||A===this.emptyText){if(this.allowBlank||this.img.dom.src.indexOf("/artery/arteryTheme/theme/default/images/")==-1){this.clearInvalid();this.el=D}else{this.markInvalid(this.blankText);this.el=D;return false}}if(A.length<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));this.el=D;return false}if(A.length>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));this.el=D;return false}if(this.vtype){var C=Ext.form.VTypes;if(!C[this.vtype](A,this)){this.markInvalid(this.vtypeText||C[this.vtype+"Text"]);this.el=D;return false}}if(typeof this.validator=="function"){var B=this.validator(A);if(B!==true){this.markInvalid(B);this.el=D;return false}}if(this.regex&&!this.regex.test(A)){this.markInvalid(this.regexText);this.el=D;return false}this.clearInvalid();this.el=D;return true},onDisable:function(){Artery.plugin.FaBinaryImage.superclass.onDisable.call(this);this.finput.dom.disabled=true;this.fbutton.addClass("x-item-disabled")},onEnable:function(){Artery.plugin.FaBinaryImage.superclass.onEnable.call(this);this.finput.dom.disabled=false;this.fbutton.removeClass("x-item-disabled")},clear:function(){this.setValue("");if(this.finput&&this.finput.dom){this.finput.dom.innerHTML=""}if(Ext.isIE){this.el=this.el.replaceWith(this.el.dom.cloneNode());this.initChangeEvent()}else{this.el.dom.value=""}}});Ext.reg("apfabinaryimage",Artery.plugin.FaBinaryImage);Artery.plugin.FaBinaryFileData=function(A){Ext.apply(this,A);this.init()};Artery.plugin.FaBinaryFileData.prototype={ct:null,index:0,active:false,value:null,valid:true,init:function(){if(Ext.isEmpty(this.value)){this.value={}}this.render();this.toggleFile();this.hide();this.initEvent();if(this.active){this.show()}},render:function(){if(Ext.get("item"+this.getDataId())!=null){this.itemEl=Ext.get("item"+this.getDataId());this.fileNameEl=this.itemEl.child("span.x-form-field-filename-cust");this.fileClearEl=this.itemEl.child("span.x-form-field-fileclear-cust")}else{this.itemEl=this.ct.itemWrap.createChild({id:"item"+this.getDataId()});this.fileNameEl=this.itemEl.createChild({tag:"span",cls:"x-form-field-filename-cust"});this.fileClearEl=this.itemEl.createChild({tag:"span",cls:"x-form-field-fileclear-cust"})}this.el=Ext.get(this.getDataId());if(this.el==null){this.el=this.ct.fileWrap.createChild({tag:"input",type:"file",id:this.getDataId(),name:this.ct.el.dom.name,cls:"x-form-file-cust"})}this.itemEl.setStyle({"text-align":"left"});if(this.ct.multiple&&"horizontal"===this.ct.filesAlign){this.itemEl.setStyle({"float":"left","white-space":"nowrap"})}},initEvent:function(){this.initChangeEvent();this.fileClearEl.on("click",function(){this.clear()},this)},initChangeEvent:function(){if(!this.ct.multiple){this.el.on("change",function(){var B=this.ct.validate(this.el.getValue());if(B){this.ct.finput.dom.value=Artery.getFilePath(this.el.dom);var A=this.ct.finput.dom.value;this.parseFile();this.toggleFile();this.show();var C=this.ct.finput.dom.value;this.regOnChangeEvent(A,C)}else{if(Ext.isIE){this.el=this.el.replaceWith(this.el.dom.cloneNode());this.initChangeEvent()}else{this.ct.el.dom.value=""}}},this)}else{this.el.on("change",function(){var B=this.ct.validate(Artery.getFilePath(this.el.dom));if(B){this.ct.finput.dom.value=Artery.getFilePath(this.el.dom);var A=this.ct.getValue();this.parseFile();this.toggleFile();this.add();var C=this.ct.getValue();this.regOnChangeEvent(A,C)}else{if(Ext.isIE){this.el=this.el.replaceWith(this.el.dom.cloneNode());this.initChangeEvent()}else{this.ct.el.dom.value=""}}},this)}},getDataId:function(){if(!this.ct.multiple||(this.index==0&&Ext.isEmpty(this.value))){return this.ct.id}else{return this.ct.id+"_"+this.index}},getClearDataId:function(){if(!this.ct.multiple||this.index==0){return this.ct.id+"Clear"}else{return this.ct.id+"Clear_"+this.index}},hide:function(){if(Ext.isEmpty(this.value.name)){this.itemEl.setDisplayed(false)}this.el.setDisplayed(false)},show:function(){this.ct.el=Ext.get(this.getDataId());this.el.setDisplayed(true);if(!Ext.isEmpty(this.value.name)){this.itemEl.setDisplayed(true)}},remove:function(){if(Ext.isEmpty(Artery.getFilePath(this.el.dom))){var A=this.ct.fileCleanHiddenEl.dom;A.value=A.value+this.getClearValue()+";"}this.itemEl.remove();if(Ext.isIE){this.el=this.el.replaceWith(this.el.dom.cloneNode());this.initChangeEvent()}else{this.el.remove()}this.valid=false},getClearValue:function(){if(!Ext.isEmpty(this.value.value)){return this.value.value}return this.value.name},add:function(){this.hide();this.ct.addFileData({index:this.index+1,active:true})},clear:function(){var A=this.ct.getValue();if(!this.ct.multiple){this.value.name="";this.toggleFile();if(!Ext.isEmpty(this.value.value)){this.ct.fileCleanHiddenEl.dom.value=this.value.value}else{this.ct.fileCleanHiddenEl.dom.value="true"}if(Ext.isIE){this.el=this.el.replaceWith(this.el.dom.cloneNode());this.initChangeEvent()}else{this.ct.el.dom.value=""}}else{this.remove()}var B=this.ct.getValue();this.regOnChangeEvent(A,B);this.ct.finput.dom.value="";this.ct.validate()},parseFile:function(){var B=Artery.getFilePath(this.el.dom);if(Ext.isEmpty(B)){this.value.name=""}else{var A=B.lastIndexOf("\\");if(A==-1){this.value.name=B}else{this.value.name=B.substring(A+1)}}this.value.url=""},toggleFile:function(){if(!Ext.isEmpty(this.value.name)){this.fileNameEl.update(this.getFileUrl());this.addDownloadEvent();this.itemEl.setDisplayed(true)}else{this.fileNameEl.update("");this.itemEl.setDisplayed(false)}},getFileUrl:function(){if(this.value.url){return"<a href='"+this._getUrl()+"'>"+this.value.name+"</a>"}return this.value.name==null?"":this.value.name},_getUrl:function(){if(this.value.url.indexOf(sys.getContextPath()+"/")==0){return this.value.url}else{return sys.getContextPath()+this.value.url}},addDownloadEvent:function(){if(this.ct.onDownloadEvent&&Ext.isEmpty(Artery.getFilePath(this.el.dom))){var B=this.value.name;var A=this.value.value;if(!this.flag){this.fileNameEl.on("click",function(){if(!this.multiple&&this.files.length>0&&!Ext.isEmpty(this.files[0].el.dom.value)){return }Artery.regItemEvent(this,"onDownloadEvent","onDownloadServer",{fileName:B,fileId:A})},this.ct);this.flag=true;this.fileNameEl.setStyle("cursor","hand")}}},regOnChangeEvent:function(A,B){Artery.regItemEvent(this.ct,"onChangeEvent","onChangeServer",{newValue:B,oldValue:A})},read:function(){this.fileClearEl.setDisplayed(false)},edit:function(){this.fileClearEl.setDisplayed(true)},disable:function(){this.fileClearEl.setDisplayed(false)},enable:function(){this.fileClearEl.setDisplayed(true)},isValid:function(){return this.valid}};Artery.plugin.FaBinaryFile=Ext.extend(Ext.form.TextField,{autoEl:null,multiple:false,files:null,allowDomMove:false,validateOnBlur:true,initComponent:function(){Artery.plugin.FaBinaryFile.superclass.initComponent.call(this);this.files=[];if(this.multiple){if(Ext.isEmpty(this.value)){this.value=[]}else{if((typeof this.value)=="string"&&this.value.charAt(0)=="{"){this.value=Ext.decode("["+this.value+"]")}else{this.value=Ext.decode(this.value)}}}else{if(Ext.isEmpty(this.value)){this.value={}}else{if((typeof this.value)=="string"&&this.value.charAt(0)=="{"){this.value=Ext.decode(this.value)}}}},initEvents:function(){Artery.plugin.FaBinaryFile.superclass.initEvents.call(this);this.mon(this.finput,Ext.EventManager.useKeydown?"keydown":"keypress",this.fireKey,this);this.mon(this.finput,"focus",this.onFocus,this);var A=this.inEditor&&Ext.isWindows&&Ext.isGecko?{buffer:10}:null;this.mon(this.finput,"blur",this.onBlur,this,A)},getErrorTipEl:function(){return this.finput},getRawValue:function(){return this.getValue()},validateValue:function(B){var F=this.el;this.el=this.finput;if(Ext.isEmpty(B)&&Ext.isEmpty(this.getFileName())){if(this.allowBlank){this.clearInvalid();this.el=F}else{this.markInvalid(this.blankText);this.el=F;return false}}if(this.maxLength!==undefined){var C=this.el.getValue();var A=C.lastIndexOf("\\");if(A!=-1){C=B.substring(A+1)}if(C.length<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));this.el=F;return false}if(C.length>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));this.el=F;return false}}if(this.vtype){var E=Ext.form.VTypes;if(!E[this.vtype](B,this)){this.markInvalid(this.vtypeText||E[this.vtype+"Text"]);this.el=F;return false}}if(typeof this.validator=="function"){var D=this.validator(B);if(D!==true){this.markInvalid(D);this.el=F;return false}}if(this.regex&&!this.regex.test(B)){this.markInvalid(this.regexText);this.el=F;return false}this.clearInvalid();this.el=F;return true},updateValueTip:function(){if(!this.showValueTip){return }var A=this.finput.dom.value;if(!Ext.isEmpty(A)){this.finput.dom.title=A}else{this.finput.dom.title=""}},addFileData:function(A){var B={ct:this};if(A){Ext.apply(B,A)}this.files.push(new Artery.plugin.FaBinaryFileData(B))},onRender:function(F,A){this.el=Ext.get(this.id);Ext.form.Field.superclass.onRender.call(this,F,A);if((this.displayType=="display")&&this.displayAllowDownLoad){var H=[];var G=Ext.fly(this.id).child("div");var C=0;H[C++]=G;while(G!=null){sec=G.next("div");if(sec!=null){H[C++]=sec}G=sec}var E=this;for(var D=0;D<H.length;D++){if(H[D]!=null){if(D<E.value.length){H[D].fileName=this.value[D].name;H[D].fileId=this.value[D].value;H[D].on("click",function(){Artery.regItemEvent(E,"onDownloadEvent","onDownloadServer",{fileName:this.fileName,fileId:this.fileId})},H[D])}}}}this.wrap=Ext.get("wrap"+this.id);if(this.wrap==null){return }this.itemWrap=this.wrap.child(".file-name-wrap");this.fileWrap=this.wrap.child(".x-form-file-wrap-cust");this.resizeEl=this.wrap;this.finput=Ext.get("finput"+this.id);this.fbutton=Ext.get("fbutton"+this.id);this.fileCleanHiddenEl=Ext.get(this.id+"Clear");if(this.multiple){if(!this.value){this.value=[]}var B=this.value.length;for(var D=0;D<B;D++){this.addFileData({index:D,value:this.value[D]})}}this.el.on("change",function(){this.finput.dom.value=Artery.getFilePath(this.el.dom);this.updateValueTip()},this);if(this.tabIndex!==undefined){this.el.dom.setAttribute("tabIndex",this.tabIndex)}},setValue:function(v){if(this.displayType=="display"){this.value=v;return }var temp=v;if(typeof (v)!="string"){temp=Ext.encode(v)}var l=v.length;this.clear();while(this.itemWrap.dom.firstChild){this.itemWrap.dom.removeChild(this.itemWrap.dom.firstChild)}this.fileCleanHiddenEl.dom.value="";if(typeof (temp)=="string"){if(temp.length!=0){this.value=eval("("+temp+")")}else{this.value=temp}}if(this.value!=null&&this.value.length){var l=this.value.length;for(var i=0;i<l;i++){this.addFileData({index:i,value:this.value[i]})}this.addFileData({index:l,active:true})}else{this.addFileData({index:0,value:this.value,active:true})}if(this.files&&this.files.length>0){for(var j=0;j<this.files.length;j++){var file=this.files[j];if(file.value.name){file.toggleFile()}}}},getValue:function(){if(this.multiple){var B=this.files.length;var A=[];for(var C=0;C<B;C++){if(this.files[C].isValid()&&!Ext.isEmpty(this.files[C].value.name)){A.push(this.files[C].el.dom.value)}}return A.join(",")}else{return Artery.plugin.FaBinaryFile.superclass.getValue.call(this)}},getFileName:function(){var B=this.files.length;var A=[];for(var C=0;C<B;C++){if(this.files[C].isValid()&&!Ext.isEmpty(this.files[C].value.name)){A.push(this.files[C].value.name)}}return A.join(",")},getFileCount:function(){var A=this.files.length;var C=0;for(var B=0;B<A;B++){if(this.files[B].isValid()&&!Ext.isEmpty(this.files[B].value.name)){C++}}return C},reset:function(){this.clear();if(this.fileCleanHiddenEl&&this.fileCleanHiddenEl.dom){this.fileCleanHiddenEl.dom.value=""}},clear:function(){var A=this.files.length;for(var B=0;B<A;B++){if(!Ext.isEmpty(this.files[B].value.name)){this.files[B].clear()}}if(this.finput&&this.finput.dom){this.finput.dom.value=""}},read:function(){Artery.plugin.FaBinaryFile.superclass.read.call(this);var A=this.files.length;for(var B=0;B<A;B++){this.files[B].read()}},edit:function(){Artery.plugin.FaBinaryFile.superclass.edit.call(this);var A=this.files.length;for(var B=0;B<A;B++){this.files[B].edit()}},disable:function(){Artery.plugin.FaBinaryFile.superclass.disable.call(this);var A=this.files.length;for(var B=0;B<A;B++){this.files[B].disable()}},enable:function(){Artery.plugin.FaBinaryFile.superclass.enable.call(this);var A=this.files.length;for(var B=0;B<A;B++){this.files[B].enable()}},onDisable:function(){Artery.plugin.FaBinaryFile.superclass.onDisable.call(this);this.finput.dom.disabled=true;this.fbutton.dom.disabled=true},onEnable:function(){Artery.plugin.FaBinaryFile.superclass.onEnable.call(this);this.finput.dom.disabled=false;this.fbutton.dom.disabled=false}});Ext.reg("apfabinaryfile",Artery.plugin.FaBinaryFile);Artery.plugin.FaBlankLayout=Ext.extend(Artery.plugin.BaseContainer,{layout:"atylayout",afterRender:function(){Artery.plugin.FaBlankLayout.superclass.afterRender.call(this);this.trimTable();if(!Ext.isEmpty(this.comment)){this.tipEl=Ext.get("comment_"+this.id);if(this.tipEl){this.tipEl.on("click",Artery.showComment,this)}}},trimTable:function(){var D=this.el.child("table.x-form-table-cust",true);var E=D.rows;var F;for(var C=0;C<E.length;C++){var B=E[C].cells;for(var A=0;A<B.length;A++){F=B[A];if(C==0){B[A].style.borderTop="0px";B[A].style.paddingTop="0px"}if(C==E.length-1){B[A].style.borderBottom="0px";B[A].style.paddingBottom="0px"}if(A==0){B[A].style.borderLeft="0px";B[A].style.paddingLeft="0px"}if(A==B.length-1){B[A].style.borderRight="0px";B[A].style.paddingRight="0px"}}}},readAllSub:function(A){this.items.each(function(){if(!Ext.isTrue(A)&&this.readAllSub){this.readAllSub()}else{if(this.read){this.read()}}})},editAllSub:function(A){this.items.each(function(){if(!Ext.isTrue(A)&&this.editAllSub){this.editAllSub()}else{if(this.edit){this.edit()}}})},disableAllSub:function(A){this.items.each(function(){if(!Ext.isTrue(A)&&this.disableAllSub){this.disableAllSub()}else{if(this.disable){this.disable()}}})},enableAllSub:function(A){this.items.each(function(){if(!Ext.isTrue(A)&&this.enableAllSub){this.enableAllSub()}else{if(this.enable){this.enable()}}})}});Ext.reg("apfablanklayout",Artery.plugin.FaBlankLayout);Artery.plugin.SClassCodeTree=Ext.extend(Artery.plugin.TwinTriggerField,{margin:true,codeTree:null,codeWin:null,readOnly:false,codeType:"",selType:"1",rootName:"Root",rootId:"rootid",valuePath:"",initComponent:function(){if(this.margin){this.defaultAutoCreate.style="margin:0;"}Artery.plugin.SClassCodeTree.superclass.initComponent.call(this);Ext.EventManager.on(window,"beforeunload",function(){try{if(this.codeWin){this.codeWin.destroy();this.codeWin=null}}catch(A){}try{if(this.codeTree){this.codeTree.destroy();this.codeTree=null}}catch(A){}try{if(this.searchField){this.searchField.destroy();this.searchField=null}}catch(A){}try{if(this.searchBtn){this.searchBtn.destroy();this.searchBtn=null}}catch(A){}try{if(this.okBtn){this.okBtn.destroy();this.okBtn=null}}catch(A){}try{if(this.closeBtn){this.closeBtn.destroy();this.closeBtn=null}}catch(A){}try{this.root=null}catch(A){}},this)},submitValue:function(){var A=this.getValue();if(this.valueTemp!==undefined&&this.valueTextTemp!==undefined){this.setValue(this.valueTemp,this.valueTextTemp)}this.startValue=this.getValue();this.fireEvent("change",this,this.value,A);this.codeWin.hide()},clearTempValue:function(){delete this.valueTemp;delete this.valueTextTemp},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.codeWin==null){var A=Artery.getParams({codeType:this.codeType},this);if(!Artery.params){A.itemType="faClassCode";A.moreProp="STree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseClassCode",success:function(B,C){if(Ext.isEmpty(B.responseText)){Artery.alertMsg("错误提示","根节点错误！");return }var D=Ext.decode(B.responseText);this.rootId=D.rootId;this.rootName=D.rootName;this.initClassCodeWin();this.showCodeWin()},params:A,scope:this})}else{this.showCodeWin()}},showCodeWin:function(){this.codeWin.show();if(this.geditor){this.geditor.allowBlur=true}if(Ext.isEmpty(this.getValue())){this.clearTree()}else{Artery.plugin.faTreeFunc.skinSelectedNode(this.codeTree,this.getValue());this.expandNodePath()}},getItemId:Artery.plugin.PopupTrigger.prototype.getItemId,createTreePanel:function(A){try{if(A.field.searchField){A.field.searchField.destroy()}if(A.field.searchBtn){A.field.searchBtn.destroy()}if(A.field.okBtn){A.field.okBtn.destroy()}}catch(E){}var C=[];A.field.searchField=new Ext.form.TextField({emptyText:"请输入名称",width:230,enableKeyEvents:true});C.push(A.field.searchField);C.push("-");A.field.searchBtn=new Ext.Button({text:"查找"});C.push(A.field.searchBtn);var B=Ext.id();var D=new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,border:false,bbar:C,loader:new Ext.tree.TreeLoader({baseAttrs:{uiProvider:Ext.tree.TreeSingleNodeUI,uuid:B},dataUrl:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadClassCodeTree"}),eventModel:Ext.tusc.TreeRadioEvent});return D},createRootNode:function(B){var A={text:B.rootName,draggable:false,cid:B.cid};return new Ext.tree.AsyncTreeNode(A)},initRootNode:function(){if(this.root){this.root.destroy()}this.root=Artery.pwin.Artery.plugin.SClassCodeTree.prototype.createRootNode({text:this.rootName,cid:this.rootId});this.codeTree.setRootNode(this.root)},createWin:function(A){try{if(A.field.okBtn){A.field.okBtn.destroy()}if(A.field.closeBtn){A.field.closeBtn.destroy()}}catch(C){}A.field.okBtn=new Ext.Button({text:"确定",disabled:false});A.field.closeBtn=new Ext.Button({text:"关闭"});var B=new Artery.pwin.Ext.Window({layout:"fit",width:300,height:400,closeAction:"hide",modal:true,shadow:false,resizable:false,items:[A.field.codeTree],buttons:[A.field.okBtn,A.field.closeBtn]});return B},initClassCodeWin:function(){this.codeTree=Artery.pwin.Artery.plugin.SClassCodeTree.prototype.createTreePanel({field:this});this.codeTree.on("checkchange",this.onCheckchange,this);this.codeTree.on("beforeload",this.onBeforeload,this);if(this.searchField){this.searchField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.searchCode()}},this)}if(this.searchBtn){this.searchBtn.on("click",function(){this.searchCode()},this)}this.initRootNode();this.root.expand();this.codeWin=Artery.pwin.Artery.plugin.SClassCodeTree.prototype.createWin({field:this});if(this.okBtn){this.okBtn.on("click",this.submitValue,this)}if(this.closeBtn){this.closeBtn.on("click",function(){this.codeWin.hide();delete this.valueTemp;delete this.valueTextTemp},this)}this.codeWin.on("hide",function(A){this.clearTempValue();this.focus();this.validate();if(this.geditor){this.geditor.allowBlur=false;this.geditor.completeEdit()}},this)},onCheckchange:function(C,B){var A=C.attributes;this.valueTextTemp=A.text;this.valueTemp=A.cid;C.select()},onBeforeload:function(B){var A=this.codeTree.loader;A.baseParams.code=B.attributes.cid;A.baseParams.codeType=this.codeType;A.baseParams.selType=this.selType;A.baseParams.custParams=Ext.encode(this.custParams);Ext.applyIf(A.baseParams,Artery.getParams({},this));if(!Artery.params){A.baseParams.itemType="faClassCode";A.baseParams.moreProp="STree"}},clearTree:function(){var A=this.codeTree.getSelectionModel().getSelectedNode();if(A){A.unselect();if(A.ui.checkbox){A.ui.checkbox.checked=false;A.ui.checkbox.defaultChecked=false}}},expandNodePath:function(){if(!Ext.isEmpty(this.valuePath)&&!Ext.isEmpty(this.value)){this.expandNode(this.valuePath,true);this.valuePath=null}},upValueText:function(){var A=Artery.getParams({code:this.getValue(),codeType:this.codeType},this);if(!Artery.params){A.itemType="faClassCode";A.moreProp="STree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getClassNodeDetail",success:function(B,C){var E=Ext.decode(B.responseText);var D=E.valueText;if(Ext.isEmpty(D)){D=this.value}this.valuePath=E.valuePath;this.setValueText(D)},scope:this,syn:false,params:A})}});Ext.override(Artery.plugin.SClassCodeTree,Artery.plugin.faClassCodeFunc);Ext.reg("apSClassCodeTree",Artery.plugin.SClassCodeTree);Artery.plugin.MClassCodeTree=Ext.extend(Artery.plugin.TwinTriggerField,{codeStore:null,codeTree:null,codeWin:null,readOnly:false,codeType:"",selType:"1",rootName:"Root",rootId:"rootid",valueText:"",valuePinyin:"",enableFilter:false,initComponent:function(){if(this.margin){this.defaultAutoCreate.style="margin:0;"}Artery.plugin.MClassCodeTree.superclass.initComponent.call(this);if(!this.codeStore){this.codeStore=new Artery.pwin.Ext.data.SimpleStore({fields:["id","name","pinyin"],data:this.getStoreData(),id:0})}Ext.EventManager.on(window,"beforeunload",function(){try{if(this.codeTree){this.codeTree.destroy();this.codeTree=null}}catch(A){}try{if(this.codeWin){this.codeWin.destroy();this.codeWin=null}}catch(A){}try{if(this.searchField){this.searchField.destroy();this.searchField=null}}catch(A){}try{if(this.searchBtn){this.searchBtn.destroy();this.searchBtn=null}}catch(A){}try{if(this.okBtn){this.okBtn.destroy();this.okBtn=null}}catch(A){}try{if(this.closeBtn){this.closeBtn.destroy();this.closeBtn=null}}catch(A){}try{this.root=null}catch(A){}},this)},submitValue:function(){var E=[],A=[],B=[];this.codeStore.each(function(F){E[E.length]=F.get("id");A[A.length]=F.get("name");if(F.get("pinyin")!=null){B[B.length]=F.get("pinyin")}},this);var C=this.getValue();var D=Artery.getMultiSelectSeparator();this.value=E.join(D);this.valueText=A.join(D);this.valuePinyin=B.join(D);this.setValue(this.value,this.valueText);this.startValue=this.getValue();this.codeWin.hide();this.fireEvent("change",this,this.value,C)},clearTempValue:function(){this.codeStore.loadData(this.getStoreData())},getStoreData:function(){var D=[];if(!Ext.isEmpty(this.value)){var E=Artery.getMultiSelectSeparator();var F=(this.value+"").split(E);var B=this.valueText.split(E);var A=null;if(!Ext.isEmpty(this.valuePinyin)){A=this.valuePinyin.split(E)}for(var C=0;C<F.length;C++){if(!Ext.isEmpty(F[C])){D[D.length]=[F[C],B[C],A==null?"":A[C]]}}}return D},setValue:function(A,D,B){var C=this.getValue();A=Artery.getCommaSplitValue(A);D=Artery.getCommaSplitValue(D);Artery.plugin.MClassCodeTree.superclass.setValue.call(this,A,D);this.codeStore.loadData(this.getStoreData());if(B===true&&A!=C){this.fireEvent("change",this,A,C)}},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.codeWin==null){var A=Artery.getParams({codeType:this.codeType},this);if(!Artery.params){A.itemType="faClassCode";A.moreProp="MTree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseClassCode",success:function(B,C){if(Ext.isEmpty(B.responseText)){Artery.alertMsg("错误提示","根节点错误！");return }var D=Ext.decode(B.responseText);this.rootId=D.rootId;this.rootName=D.rootName;this.initClassCodeWin();this.showCodeWin()},params:A,scope:this})}else{this.showCodeWin()}},showCodeWin:function(){this.codeWin.show();if(this.geditor){this.geditor.allowBlur=true}var B=this.codeStore;var A=function(D){var C=false;if(B.getById(D.attributes.cid)!=null){C=true}if(D.ui.checkbox){D.ui.checkbox.checked=C}if(!D.isLeaf()&&D.isLoaded()){D.eachChild(A)}};A(this.codeTree.root)},getItemId:Artery.plugin.PopupTrigger.prototype.getItemId,createTreePanel:function(A){var C=[];A.field.searchField=new Ext.form.TextField({emptyText:"请输入名称",width:230,enableKeyEvents:true});C.push(A.field.searchField);C.push("-");A.field.searchBtn=new Ext.Button({text:"查找"});C.push(A.field.searchBtn);var B=Ext.id();var D=new Ext.tree.TreePanel({region:"center",autoScroll:true,animate:false,enableDD:false,border:false,bbar:C,style:"background-color:#fff;",loader:new Artery.pwin.Ext.tree.TreeLoader({baseAttrs:{uuid:B},dataUrl:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadClassCodeTree"})});return D},createRootNode:function(A){var B={text:A.rootName,draggable:false,cid:A.cid};if(this.selType==2){B.checked=false}return new Ext.tree.AsyncTreeNode(B)},initRootNode:function(){if(this.root){this.root.destroy()}this.root=Artery.pwin.Artery.plugin.MClassCodeTree.prototype.createRootNode({text:this.rootName,cid:this.rootId});this.codeTree.setRootNode(this.root)},createWin:function(A){try{if(A.field.okBtn){A.field.okBtn.destroy()}if(A.field.closeBtn){A.field.closeBtn.destroy()}}catch(C){}A.field.okBtn=new Ext.Button({text:"确定"});A.field.closeBtn=new Ext.Button({text:"关闭"});var B=new Artery.pwin.Ext.Window({layout:"border",width:300,height:400,closeAction:"hide",plain:true,modal:true,shadow:false,resizable:false,items:[A.field.codeTree],buttons:[A.field.okBtn,A.field.closeBtn]});return B},initClassCodeWin:function(){this.codeTree=Artery.pwin.Artery.plugin.MClassCodeTree.prototype.createTreePanel({field:this});if(this.searchField){this.searchField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.searchCode()}},this)}if(this.searchBtn){this.searchBtn.on("click",function(){this.searchCode()},this)}this.codeTree.on("append",this.onAppendNode,this);this.codeTree.on("checkchange",this.onCheckchange,this);this.codeTree.on("beforeload",this.onBeforeload,this);this.initRootNode();this.root.expand();this.codeWin=Artery.pwin.Artery.plugin.MClassCodeTree.prototype.createWin({field:this});if(this.okBtn){this.okBtn.on("click",this.submitValue,this)}if(this.closeBtn){this.closeBtn.on("click",function(){this.codeWin.hide()},this)}this.codeWin.on("hide",function(A){this.clearTempValue();this.focus();this.validate();if(this.geditor){this.geditor.allowBlur=false;this.geditor.completeEdit()}},this)},onAppendNode:function(B,C,D,A){if(this.codeStore.getById(D.attributes.cid)!=null){if(D.attributes.checked!==undefined){D.attributes.checked=true}}},onBeforeload:function(B){var A=this.codeTree.loader;A.baseParams.code=B.attributes.cid;A.baseParams.codeType=this.codeType;A.baseParams.selType=this.selType;A.baseParams.custParams=Ext.encode(this.custParams);Ext.applyIf(A.baseParams,Artery.getParams({},this));if(!Artery.params){A.baseParams.itemType="faClassCode";A.baseParams.moreProp="MTree"}},onCheckchange:function(B,A){if(A){this.addRecord(B)}else{this.delRecord(B)}},addRecord:function(B){var A=B.attributes;if(this.codeStore.getById(A.cid)==null){var C=[];C.push([A.cid,B.text,A.pinyin==null?"":A.pinyin]);this.codeStore.loadData(C,true)}},delRecord:function(A){var B=this.codeStore.getById(A.attributes.cid);if(B){this.codeStore.remove(B)}},upValueText:function(){var A=Artery.getParams({code:this.getValue(),codeType:this.codeType},this);if(!Artery.params){A.itemType="faClassCode";A.moreProp="MTree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getClassNodeDetail",success:function(B,C){var E=Ext.decode(B.responseText);var D=E.valueText;if(Ext.isEmpty(D)){D=this.value}this.setValueText(D);this.codeStore.loadData(this.getStoreData())},scope:this,syn:false,params:A})}});Ext.override(Artery.plugin.MClassCodeTree,Artery.plugin.faClassCodeFunc);Ext.reg("apMClassCodeTree",Artery.plugin.MClassCodeTree);Artery.plugin.SClassCodePopup=Ext.extend(Artery.plugin.PopupTrigger,{codeTree:null,codeLayer:null,readOnly:false,codeType:"",selType:"1",rootName:"Root",rootId:"rootid",valuePath:"",initComponent:function(){Artery.plugin.SClassCodePopup.superclass.initComponent.call(this);Ext.EventManager.on(window,"beforeunload",function(){try{if(this.codeTree){this.codeTree.destroy();this.codeTree=null}}catch(A){}try{if(this.searchField){this.searchField.destroy();this.searchField=null}}catch(A){}try{if(this.searchBtn){this.searchBtn.destroy();this.searchBtn=null}}catch(A){}try{if(this.okBtn){this.okBtn.destroy();this.okBtn=null}}catch(A){}try{if(this.codeLayer){this.codeLayer.destroy();this.codeLayer=null}}catch(A){}try{this.layerEl=null;this.root=null}catch(A){}},this)},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.codeLayer==null){var A=Artery.getParams({codeType:this.codeType},this);if(!Artery.params){A.itemType="faClassCode";A.moreProp="STree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseClassCode",success:function(B,C){if(Ext.isEmpty(B.responseText)){Artery.alertMsg("错误提示","根节点错误！");return }var D=Ext.decode(B.responseText);this.rootId=D.rootId;this.rootName=D.rootName;this.initClassCodeLayer();this.showTreeLayer()},params:A,scope:this})}else{this.showTreeLayer()}},showTreeLayer:function(){if(this.isExpanded()){return }if(this.searchField){var A=Math.max(this.wrap.getWidth(),this.minLayerWidth);this.searchField.setWidth(A-85)}if(this.geditor){this.geditor.allowBlur=true}if(!this.codeTree.rendered){this.codeTree.render(this.codeLayer.dom)}this.skinTree();this.restrictLayer(this.codeLayer,this.codeTree)},skinTree:function(){if(Ext.isEmpty(this.getValue())){this.clearTree()}else{Artery.plugin.faTreeFunc.skinSelectedNode(this.codeTree,this.getValue());this.expandNodePath()}},onExpandnode:function(){if(this.codeLayer.isVisible()){this.restrictLayer(this.codeLayer,this.codeTree)}},onCollapsenode:function(){if(this.codeLayer.isVisible()){this.restrictLayer(this.codeLayer,this.codeTree)}},CreateTreePanel:function(B){try{if(B.field.searchField){B.field.searchField.destroy();B.field.searchField=null}if(B.field.searchBtn){B.field.searchBtn.destroy();B.field.searchBtn=null}if(B.field.okBtn){B.field.okBtn.destroy();B.field.okBtn=null}}catch(E){}var D=[];B.field.searchField=new Ext.form.TextField({emptyText:"请输入名称",width:230,enableKeyEvents:true});D.push(B.field.searchField);D.push("-");B.field.searchBtn=new Ext.Button({text:"查找"});D.push(B.field.searchBtn);D.push("->");B.field.okBtn=new Ext.Button({text:"确定"});D.push(B.field.okBtn);var C=Ext.id();var A=new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,border:true,height:this.layerHeight,bbar:D,loader:new Artery.pwin.Ext.tree.TreeLoader({baseAttrs:{uiProvider:Artery.pwin.Ext.tree.TreeSingleNodeUI,uuid:C},dataUrl:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadClassCodeTree"}),eventModel:Artery.pwin.Ext.tusc.TreeRadioEvent});return A},createPopupLayer:function(A){return new Artery.plugin.PopupLayer({shadow:true,constrain:false,zindex:20000,popupField:A.popupField})},initClassCodeLayer:function(){this.codeTree=Artery.pwin.Artery.plugin.SClassCodePopup.prototype.CreateTreePanel({field:this});this.codeTree.on("expandnode",this.onExpandnode,this);this.codeTree.on("collapsenode",this.onCollapsenode,this);this.codeTree.on("checkchange",this.onCheckchange,this);this.codeTree.on("beforeload",this.onBeforeload,this);this.searchField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.searchCode()}},this);if(this.okBtn){this.okBtn.on("click",this.submitValue,this)}if(this.searchBtn){this.searchBtn.on("click",function(){this.searchCode()},this)}this.initRootNode();this.root.expand();this.codeLayer=Artery.pwin.Artery.plugin.SClassCodePopup.prototype.createPopupLayer({popupField:this});this.layerEl=this.codeLayer},createRootNode:function(A){var B={text:A.rootName,draggable:false,cid:A.rootId,uiProvider:Ext.tree.TreeSingleNodeUI};if(this.selType==2){B.checked=false;B.uuid=A.uuid}return new Ext.tree.AsyncTreeNode(B)},initRootNode:function(){if(this.root){this.root.destroy()}this.root=Artery.pwin.Artery.plugin.SClassCodePopup.prototype.createRootNode({rootName:this.rootName,rootId:this.rootId,uuid:this.codeTree.loader.baseAttrs.uuid});this.codeTree.setRootNode(this.root)},submitValue:function(){var A=this.getValue();if(this.valueTemp!==undefined&&this.valueTextTemp!==undefined){this.setValue(this.valueTemp,this.valueTextTemp)}this.startValue=this.getValue();this.collapse(true);this.fireEvent("change",this,this.value,A)},clearTempValue:function(){delete this.valueTemp;delete this.valueTextTemp},onCheckchange:function(C,B){if(B){var A=C.attributes;this.valueTextTemp=A.text;this.valueTemp=A.cid}else{this.clearTempValue()}C.select()},onBeforeload:function(B){var A=this.codeTree.loader;A.baseParams.code=B.attributes.cid;A.baseParams.codeType=this.codeType;A.baseParams.selType=this.selType;A.baseParams.custParams=Ext.encode(this.custParams);Ext.applyIf(A.baseParams,Artery.getParams({},this));if(!Artery.params){A.baseParams.itemType="faClassCode";A.baseParams.moreProp="STree"}},clearTree:function(){var A=this.codeTree.getSelectionModel().getSelectedNode();if(A){A.unselect();if(A.ui.checkbox){A.ui.checkbox.checked=false;A.ui.checkbox.defaultChecked=false}}},expandNodePath:function(){if(!Ext.isEmpty(this.valuePath)&&!Ext.isEmpty(this.value)){this.expandNode(this.valuePath,true);this.valuePath=null}},upValueText:function(){var A=Artery.getParams({code:this.getValue(),codeType:this.codeType},this);if(!Artery.params){A.itemType="faClassCode";A.moreProp="STree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getClassNodeDetail",success:function(B,C){var E=Ext.decode(B.responseText);var D=E.valueText;if(Ext.isEmpty(D)){D=this.value}this.valuePath=E.valuePath;this.setValueText(D)},scope:this,syn:false,params:A})}});Ext.override(Artery.plugin.SClassCodePopup,Artery.plugin.faClassCodeFunc);Ext.reg("apSClassCodePopup",Artery.plugin.SClassCodePopup);Artery.plugin.MClassCodePopup=Ext.extend(Artery.plugin.PopupTrigger,{codeStore:null,codeGrid:null,codeTree:null,codeLayer:null,readOnly:false,codeType:"",selType:"1",rootName:"Root",rootId:"rootid",valueText:"",valuePinyin:"",enableFilter:false,initComponent:function(){Artery.plugin.MClassCodeTree.superclass.initComponent.call(this);if(!this.codeStore){this.codeStore=new Ext.data.SimpleStore({fields:["id","name","pinyin"],data:this.getStoreData(),id:0})}Ext.EventManager.on(window,"beforeunload",function(){try{if(this.codeTree){this.codeTree.destroy();this.codeTree=null}}catch(A){}try{if(this.searchField){this.searchField.destroy();this.searchField=null}}catch(A){}try{if(this.searchBtn){this.searchBtn.destroy();this.searchBtn=null}}catch(A){}try{if(this.okBtn){this.okBtn.destroy();this.okBtn=null}}catch(A){}try{if(this.codeLayer){this.codeLayer.destroy();this.codeLayer=null}}catch(A){}try{this.layerEl=null;this.root=null}catch(A){}},this)},getStoreData:function(){var D=[];if(!Ext.isEmpty(this.value)){var E=Artery.getMultiSelectSeparator();var F=(this.value+"").split(E);var B=this.valueText.split(E);var A=null;if(!Ext.isEmpty(this.valuePinyin)){A=this.valuePinyin.split(E)}for(var C=0;C<F.length;C++){if(!Ext.isEmpty(F[C])){D[D.length]=[F[C],B[C],A==null?"":A[C]]}}}return D},setValue:function(A,B){A=Artery.getCommaSplitValue(A);B=Artery.getCommaSplitValue(B);Artery.plugin.MClassCodeTree.superclass.setValue.call(this,A,B);this.codeStore.loadData(this.getStoreData())},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.codeLayer==null){var A=Artery.getParams({codeType:this.codeType},this);if(!Artery.params){A.itemType="faClassCode";A.moreProp="MTree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseClassCode",success:function(B,C){if(Ext.isEmpty(B.responseText)){Artery.alertMsg("错误提示","根节点错误！");return }var D=Ext.decode(B.responseText);this.rootId=D.rootId;this.rootName=D.rootName;this.initClassCodeLayer();this.showTreeLayer()},params:A,scope:this})}else{this.showTreeLayer()}},showTreeLayer:Artery.plugin.SClassCodePopup.prototype.showTreeLayer,skinTree:function(){var B=this.codeStore;var A=function(D){var C=false;if(B.getById(D.attributes.cid)!=null){C=true}if(D.ui.checkbox){D.ui.checkbox.checked=C}if(!D.isLeaf()&&D.isLoaded()){D.eachChild(A)}};A(this.codeTree.root)},onExpandnode:function(){if(this.codeLayer.isVisible()){this.restrictLayer(this.codeLayer,this.codeTree)}},onCollapsenode:function(){if(this.codeLayer.isVisible()){this.restrictLayer(this.codeLayer,this.codeTree)}},createTreePanel:function(A){try{if(A.field.searchField){A.field.searchField.destroy();A.field.searchField=null}if(A.field.searchBtn){A.field.searchBtn.destroy();A.field.searchBtn=null}if(A.field.okBtn){A.field.okBtn.destroy();A.field.okBtn=null}}catch(E){}var C=[];A.field.searchField=new Ext.form.TextField({emptyText:"请输入名称",width:230,enableKeyEvents:true});C.push(A.field.searchField);A.field.searchBtn=new Ext.Button({text:"查找"});C.push(A.field.searchBtn);C.push("->");A.field.okBtn=new Ext.Button({text:"确定"});C.push(A.field.okBtn);var B=Ext.id();var D=new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,border:true,height:this.layerHeight,bbar:C,loader:new Artery.pwin.Ext.tree.TreeLoader({baseAttrs:{uuid:B},dataUrl:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadClassCodeTree"})});return D},createPopupLayer:function(A){return new Artery.pwin.Artery.plugin.PopupLayer({shadow:true,constrain:false,zindex:20000,popupField:A.popupField})},initClassCodeLayer:function(){this.codeTree=Artery.pwin.Artery.plugin.MClassCodePopup.prototype.createTreePanel({field:this});this.codeTree.on("expandnode",this.onExpandnode,this);this.codeTree.on("collapsenode",this.onCollapsenode,this);this.codeTree.on("append",this.onAppendNode,this);this.codeTree.on("checkchange",this.onCheckchange,this);this.codeTree.on("beforeload",this.onBeforeload,this);this.searchField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.searchCode()}},this);if(this.okBtn){this.okBtn.on("click",this.submitValue,this)}if(this.searchBtn){this.searchBtn.on("click",function(){this.searchCode()},this)}this.initRootNode();this.root.expand();this.codeLayer=Artery.pwin.Artery.plugin.MClassCodePopup.prototype.createPopupLayer({popupField:this});this.layerEl=this.codeLayer},createRootNode:function(A){var B={text:A.rootName,draggable:false,cid:A.rootId};if(this.selType==2){B.checked=false}return new Ext.tree.AsyncTreeNode(B)},initRootNode:function(){if(this.root){this.root.destroy()}this.root=Artery.pwin.Artery.plugin.MClassCodePopup.prototype.createRootNode({rootName:this.rootName,rootId:this.rootId,uuid:this.codeTree.loader.baseAttrs.uuid});this.codeTree.setRootNode(this.root)},submitValue:function(){var D=[],A=[];this.codeStore.each(function(E){D[D.length]=E.get("id");A[A.length]=E.get("name")});var B=this.getValue();var C=Artery.getMultiSelectSeparator();this.value=D.join(C);this.valueText=A.join(C);this.setValue(this.value,this.valueText);this.startValue=this.getValue();this.collapse(true);this.fireEvent("change",this,this.value,B)},clearTempValue:function(){this.codeStore.loadData(this.getStoreData())},onBeforeload:function(B){var A=this.codeTree.loader;A.baseParams.code=B.attributes.cid;A.baseParams.codeType=this.codeType;A.baseParams.selType=this.selType;A.baseParams.custParams=Ext.encode(this.custParams);Ext.applyIf(A.baseParams,Artery.getParams({},this));if(!Artery.params){A.baseParams.itemType="faClassCode";A.baseParams.moreProp="MTree"}},onAppendNode:function(B,C,D,A){if(this.codeStore.getById(D.attributes.cid)!=null){if(D.attributes.checked!==undefined){D.attributes.checked=true}}},onCheckchange:function(B,A){if(A){this.addRecord(B)}else{this.delRecord(B)}},addRecord:function(B){var A=B.attributes;if(this.codeStore.getById(A.cid)==null){var C=[];C.push([A.cid,B.text,A.pinyin==null?"":A.pinyin]);this.codeStore.loadData(C,true)}},delRecord:function(A){var B=this.codeStore.getById(A.attributes.cid);if(B){this.codeStore.remove(B)}},upValueText:function(){var A=Artery.getParams({code:this.getValue(),codeType:this.codeType},this);if(!Artery.params){A.itemType="faClassCode";A.moreProp="MTree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getClassNodeDetail",success:function(B,C){var E=Ext.decode(B.responseText);var D=E.valueText;if(Ext.isEmpty(D)){D=this.value}this.setValueText(D);this.codeStore.loadData(this.getStoreData())},scope:this,syn:false,params:A})}});Ext.override(Artery.plugin.MClassCodePopup,Artery.plugin.faClassCodeFunc);Ext.reg("apMClassCodePopup",Artery.plugin.MClassCodePopup);Ext.apply(Ext.DataView.prototype,{deselect:function(B,A){if(this.isSelected(B)){var B=this.getNode(B);this.selected.removeElement(B);if(this.last==B.viewIndex){this.last=false}Ext.fly(B).removeClass(this.selectedClass);if(!A){this.fireEvent("selectionchange",this,this.selected.elements)}}}});Ext.ux.Andrie={};Ext.ux.Andrie.Select=function(A){if(A.transform&&typeof A.multiSelect=="undefined"){var B=Ext.getDom(A.transform);A.multiSelect=(Ext.isIE?B.getAttributeNode("multiple").specified:B.hasAttribute("multiple"))}if(A.multiSelect){A.selectOnFocus=false}A.hideTrigger2=A.hideTrigger2||A.hideTrigger;Ext.ux.Andrie.Select.superclass.constructor.call(this,A)};Ext.extend(Ext.ux.Andrie.Select,Ext.form.ComboBox,{multiSelect:false,clearTrigger:true,history:false,historyMaxLength:0,listClass:" x-menu-arteryPopup ",layerHeight:300,minLayerWidth:150,initComponent:function(){this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger2Class}]};Ext.ux.Andrie.Select.superclass.initComponent.call(this);if(this.multiSelect){this.typeAhead=false;this.triggerAction="all"}var A=Artery.getMultiSelectSeparator();this.valueArray=this.getValue()?this.getValue().split(A):[];Ext.EventManager.on(window,"beforeunload",function(){try{if(this.view){this.view.destroy();this.view=null}if(this.list){this.list.destroy();this.list=null}}catch(B){}},this)},hideTrigger1:false,hideTrigger2:false,trigger1Class:"x-form-clear-trigger",restrictLayerTask:new Ext.util.DelayedTask(),onTrigger2Click:function(){this.onTriggerClick()},onTrigger1Click:function(){this.clearValue(true)},initQuery:function(){var A=this.getRawValue();if(this.lastQueryValue!==undefined&&this.lastQueryValue==A){return }this.lastQueryValue=A;this.doQuery(A)},clearValue:function(A){this.setValue("",A);Ext.ux.Andrie.Select.superclass.clearValue.call(this);this.clearAllSelect.call(this)},clearAllSelect:function(){if(this.view==null){return }this.valueArray=[];var B=Ext.apply([],this.view.getSelectedNodes());for(var C=0,A=B.length;C<A;C++){this.view.deselect(B[C],true)}},reset:function(){var B=Ext.apply([],this.view.getSelectedNodes());for(var C=0,A=B.length;C<A;C++){this.view.deselect(B[C],true)}Ext.ux.Andrie.Select.superclass.reset.call(this)},createList:function(B){var A=new Artery.plugin.PopupLayer({shadow:B.field.shadow,cls:[B.cls,B.field.listClass].join(" "),constrain:false,popupField:B.field});B.field.innerList=A.createChild({cls:B.cls+"-inner"});return A},createDataView:function(A){var B=new Ext.DataView({applyTo:A.field.innerList,tpl:A.field.tpl,singleSelect:true,multiSelect:A.field.multiSelect,simpleSelect:true,overClass:A.cls+"-cursor",selectedClass:A.field.selectedClass,itemSelector:A.field.itemSelector||"."+A.cls+"-item",onContainerClick:function(C){}});return B},initList:function(){if(!this.list){var A="x-combo-list";this.list=Artery.pwin.Ext.ux.Andrie.Select.prototype.createList({field:this,cls:A});this.list.setZIndex(20000);var B=this.listWidth||Math.max(this.wrap.getWidth(),this.minListWidth);this.list.setWidth(B);this.assetHeight=0;if(this.title){this.header=this.list.createChild({cls:A+"-hd",html:this.title});this.assetHeight+=this.header.getHeight()}this.innerList.on("mouseover",this.onViewOver,this);this.innerList.on("mousemove",this.onViewMove,this);this.innerList.setWidth(B-this.list.getFrameWidth("lr"));if(this.pageSize){this.footer=this.list.createChild({cls:A+"-ft"});this.pageTb=new Ext.PagingToolbar({store:this.store,pageSize:this.pageSize,renderTo:this.footer});this.assetHeight+=this.footer.getHeight()}if(!this.tpl){this.tpl='<tpl for="."><div class="'+A+'-item">{'+this.displayField+"}</div></tpl>"}this.view=Artery.pwin.Ext.ux.Andrie.Select.prototype.createDataView({field:this,cls:A});this.view.on("click",this.onViewClick,this);this.view.on("beforeClick",this.onViewBeforeClick,this);this.bindStore(this.store,true);if(this.valueArray.length){this.selectByValue(this.valueArray)}if(this.resizable){this.resizer=new Ext.Resizable(this.list,{pinned:true,handles:"se"});this.resizer.on("resize",function(E,C,D){this.maxHeight=D-this.handleHeight-this.list.getFrameWidth("tb")-this.assetHeight;this.listWidth=C;this.innerList.setWidth(C-this.list.getFrameWidth("lr"));this.restrictHeight()},this);this[this.pageSize?"footer":"innerList"].setStyle("margin-bottom",this.handleHeight+"px")}}},onViewOver:function(B,A){if(this.inKeyMode){return }},initEvents:function(){Ext.form.ComboBox.superclass.initEvents.call(this);this.keyNav=new Ext.KeyNav(this.el,{up:function(A){this.inKeyMode=true;this.hoverPrev()},down:function(A){if(!this.isExpanded()){this.onTriggerClick()}else{this.inKeyMode=true;this.hoverNext()}},enter:function(B){if(this.isExpanded()){this.inKeyMode=true;this.selectByEnter=true;if(this.view.lastItem==null){B.stopEvent();return }var A=this.view.indexOf(this.view.lastItem);this.onViewBeforeClick(this.view,A,this.view.getNode(A),B);this.onViewClick(this.view,A,this.view.getNode(A),B)}else{this.onSingleBlur()}this.blur();this.focus();return true},esc:function(A){this.collapse()},tab:function(A){this.collapse();return true},home:function(A){this.hoverFirst();return false},end:function(A){this.hoverLast();return false},scope:this,doRelay:function(C,B,A){if(A=="down"||this.scope.isExpanded()){return Ext.KeyNav.prototype.doRelay.apply(this,arguments)}if(A=="enter"||this.scope.isExpanded()){return Ext.KeyNav.prototype.doRelay.apply(this,arguments)}return true},forceKeyDown:true});this.queryDelay=Math.max(this.queryDelay||10,this.mode=="local"?10:250);this.dqTask=new Ext.util.DelayedTask(this.initQuery,this);if(this.typeAhead){this.taTask=new Ext.util.DelayedTask(this.onTypeAhead,this)}if(this.editable!==false){this.el.on("keyup",this.onKeyUp,this)}if(this.forceSelection){this.on("blur",this.doForce,this)}else{if(!this.multiSelect){this.on("focus",this.onSingleFocus,this);this.on("blur",this.onSingleBlur,this)}}this.initClearValueTaskEvent()},initClearValueTaskEvent:Artery.plugin.TwinTriggerField.prototype.initClearValueTaskEvent,onBlur:function(){this.beforeBlur();if(!Ext.isOpera&&this.focusClass){this.el.removeClass(this.focusClass)}this.hasFocus=false;if(this.validationEvent!==false&&this.validateOnBlur&&this.validationEvent!="blur"){this.validate()}var A=this.getValue();if(String(A)!==String(this.startValue)){}},onChange:function(){if(!this.clearTrigger){return }if(this.getValue()!=""){this.triggers[0].show()}else{this.triggers[0].hide()}},selectFirst:function(){var A=this.store.getCount();if(A>0){this.select(0)}},selectLast:function(){var A=this.store.getCount();if(A>0){this.select(A)}},hover:function(A,D){if(!this.view){return }this.hoverOut();var C=this.view.getNode(A);if(!C){return }this.view.lastItem=C;Ext.fly(C).addClass(this.view.overClass);if(D!==false){var B=this.view.getNode(A);if(B){this.innerList.scrollChildIntoView(B,false)}}},hoverOut:function(){if(!this.view){return }if(this.view.lastItem){Ext.fly(this.view.lastItem).removeClass(this.view.overClass);delete this.view.lastItem}},hoverNext:function(){if(!this.view){return }var B=this.store.getCount();if(B>0){if(!this.view.lastItem){this.hover(0)}else{var A=this.view.indexOf(this.view.lastItem);if(A<B-1){this.hover(A+1)}}}},hoverPrev:function(){if(!this.view){return }var B=this.store.getCount();if(B>0){if(!this.view.lastItem){this.hover(0)}else{var A=this.view.indexOf(this.view.lastItem);if(A!=0){this.hover(A-1)}}}},hoverFirst:function(){var A=this.store.getCount();if(A>0){this.hover(0)}},hoverLast:function(){var A=this.store.getCount();if(A>0){this.hover(A)}},collapse:function(){this.hoverOut();Ext.ux.Andrie.Select.superclass.collapse.call(this)},collapseIf:function(A){if(!A){this.collapse();return }if(!A.within(this.wrap)&&!A.within(this.list)){this.collapse()}},expand:function(){if(this.isExpanded()||!this.hasFocus||this.isDisplayType()||this.disabled||this.readOnly){return }this.restrictLayer();this.fireEvent("expand",this)},restrictLayer:function(){this.restrictLayerTask.delay(10,this.restrictLayerDirect,this,[])},restrictLayerDirect:function(){this.list.show();var C=Math.max(this.wrap.getWidth(),this.minLayerWidth);var E=this.getPosInParent(this.wrap);var B=E[1]-Artery.pwin.Ext.getBody().getScroll().top;var D=Artery.pwin.Ext.lib.Dom.getViewHeight()-B-this.wrap.getHeight();var A=null;if((B>D)&&(this.layerHeight>(D-5))){A=[E[0],(E[1]-this.list.getHeight())]}else{A=[E[0],(E[1]+this.wrap.getHeight())]}this.list.beginUpdate();this.innerList.setWidth(C);this.list.endUpdate();this.list.setWidth(C);this.list.setXY(A)},getPosInParent:function(C){var A=0,D=0;var B=function(F){while(Artery.pwin!=F){var E=F.parent.Ext.get(F.frameElement);A+=E.getLeft();D+=E.getTop();F=F.parent}};if(Artery.pwin==window){A=C.getLeft();D=C.getTop()}else{B(window);A+=C.getLeft();D+=C.getTop()}return[A,D]},onSelect:function(A,B){if(this.fireEvent("beforeselect",this,A.data[this.valueField||this.displayField],this.getValue())!==false){this.addValue(A.data[this.valueField||this.displayField]);this.fireEvent("select",this,A,B);if(!this.multiSelect){this.collapse()}}},addValue:function(A){A=String(A);if(!this.multiSelect){this.setValue(A,true);return }if(this.valueArray.indexOf(A)==-1){this.valueArray.push(A);this.setValue(this.valueArray,true)}},removeValue:function(A){A=String(A);if(this.list){var B=this.findRecord(this.valueField,A);this.deselect(this.store.indexOf(B))}this.valueArray.remove(A);this.setValue(this.valueArray,true)},setValue:function(C,E){var H=[];if(!(C instanceof Array)){C=[C]}if(!this.multiSelect&&C instanceof Array){C=C.slice(0,1)}if(C.length==1&&Ext.isEmpty(C[0])){C=[]}for(var D=0,A=C.length;D<A;D++){var F=C[D];H.push(F)}var G=Artery.getMultiSelectSeparator();C=H.join(G);this.valueArray=H;if(this.hiddenField){this.hiddenField.value=C}this.value=C;this.reSelectValue();if(this.oldValueArray+""!=this.valueArray+""){var B=this.oldValueArray;if(this.valueArray==null){this.oldValueArray=null}else{this.oldValueArray=Ext.apply([],this.valueArray)}if(!Ext.isTrue(this.initSte)&&E==true){var G=Artery.getMultiSelectSeparator();this.fireEvent("change",this,this.value,B==null?"":B.join(G))}}if(this.history&&!this.multiSelect&&this.mode=="local"){this.addHistory(this.getRawValue())}},reSelectValue:function(){if(this.view){this.view.clearSelections();this.selectByValue(this.valueArray)}},onLoad:function(){Artery.plugin.PopupLayerMgr.hideAll();if(!this.hasFocus){return }if(this.store.getCount()>0){this.expand();this.restrictHeight();if(this.lastQuery==this.allQuery){if(this.editable){this.el.dom.focus()}this.selectByValue(this.value,true)}else{this.selectNext();if(this.typeAhead&&this.lastKey!=Ext.EventObject.BACKSPACE&&this.lastKey!=Ext.EventObject.DELETE){this.taTask.delay(this.typeAheadDelay)}}}else{this.onEmptyResults()}},restrictHeight:function(){if(!this.list){return }this.innerList.dom.style.height="";var B=this.innerList.dom;var F=this.list.getFrameWidth("tb")+(this.resizable?this.handleHeight:0)+this.assetHeight;var D=Math.max(B.clientHeight,B.offsetHeight,B.scrollHeight);var A=this.getPosition()[1]-Ext.getBody().getScroll().top;var G=Ext.lib.Dom.getViewHeight()-A-this.getSize().height;var E=Math.max(A,G,this.minHeight||0)-this.list.shadowOffset-F-5;D=Math.min(D,E,this.maxHeight);var C=this.innerList.dom;if(C.offsetLeft>1||C.scrollWidth>C.offsetWidth){if(Ext.isIE){D=D+Artery.SCROLLBAR_HEIGHT}}this.innerList.setHeight(D);this.list.beginUpdate();this.list.setHeight(D+F);this.list.endUpdate()},selectByValue:function(C,H){this.hoverOut();if(C!==undefined&&C!==null){if(!(C instanceof Array)){C=[C]}var B=[];for(var D=0,A=C.length;D<A;D++){var F=C[D];var E=this.findRecord(this.valueField||this.displayField,F);if(E){this.select(this.store.indexOf(E),H);B.push(F)}}var G=Artery.getMultiSelectSeparator();return B.join(G)}return false},onViewBeforeClick:function(C,A,B,D){this.preClickSelections=this.view.getSelectedIndexes()},onViewClick:function(E,B,D,F){if(E!==false){this.el.focus()}if(typeof B!="undefined"){var A=this.preClickSelections.indexOf(B);if(A!=-1&&this.multiSelect){this.removeValue(this.store.getAt(B).data[this.valueField||this.displayField]);if(this.inKeyMode){this.view.deselect(B,true)}}else{var C=this.store.getAt(B);if(C){if(this.inKeyMode){this.view.select(B,true)}this.onSelect(C,B)}}this.validate()}if(E!==false){this.hover(B)}if(this.gridEditor&&!this.multiSelect){this.gridEditor.hide()}},validateValue:function(A){this.clearInvalid();if(!Ext.ux.Andrie.Select.superclass.validateValue.call(this,A)){return false}if(this.valueArray.length<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));return false}if(this.valueArray.length>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));return false}return true},clearLastVRV:function(){delete this.lastVRV_V;delete this.lastVRV_Result;delete this.lastVRV_M},validateRightValue:function(D){if(this.isExpanded()){this.clearLastVRV();return true}if(Ext.isTrue(this.isCallByVRV)){return this.lastVRV_Result}if(this.lastVRV_V&&this.lastVRV_V==D){if(!this.lastVRV_Result){this.markInvalid(this.lastVRV_M)}return this.lastVRV_Result}this.lastVRV_V=D;var B=D.substr(D.length-1);if(B==","||B==";"||B=="；"){return }var C=D.replace(/；/g,Artery.getMultiSelectSeparator());var F=Artery.getParams(this.lastReloadParams,this);var A={formid:this.formId,itemid:Artery.getEventId(this),itemType:"faCode",codeType:this.codeType,value:C};Ext.apply(F,A);var E=true;Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=isRightValue",success:function(G,H){var I=Ext.decode(G.responseText);if(I.value!==undefined&&I.value!=this.getValue()&&this.setValue){this.isCallByVRV=true;this.setValue(I.value,true);delete this.isCallByVRV}if(!I.success===true){E=false;this.isCallByVRV=true;this.setValueText(C);delete this.isCallByVRV;this.lastVRV_M=I.message;this.markInvalid(I.message)}},syn:false,params:F,scope:this});this.lastVRV_Result=E;return E},select:function(A,C){this.selectedIndex=A;if(!this.view){return }this.view.select(A,this.multiSelect);if(C!==false){var B=this.view.getNode(A);if(B){this.innerList.scrollChildIntoView(B,false)}}},deselect:function(A,C){this.selectedIndex=A;this.view.deselect(A,this.multiSelect);if(C!==false){var B=this.view.getNode(A);if(B){this.innerList.scrollChildIntoView(B,false)}}},doForce:function(){if(this.el.dom.value.length>0){if(this.el.dom.value==this.emptyText){this.clearValue(false)}else{this.el.dom.value=this.lastSelectionText===undefined?"":this.lastSelectionText;this.applyEmptyText()}}},onSingleBlur:function(){var A=this.findRecord(this.displayField,this.getRawValue());if(A){this.select(this.store.indexOf(A));return }},onSingleFocus:function(){this.oldValue=this.getRawValue()},addHistory:function(B){if(!B.length){return }var A=this.findRecord(this.displayField,B);if(A){this.store.remove(A)}else{var C=this.store.reader.readRecords([[B]]);A=C.records[0]}this.store.clearFilter();this.store.insert(0,A);this.pruneHistory()},pruneHistory:function(){if(this.historyMaxLength==0){return }if(this.store.getCount()>this.historyMaxLength){var C=this.store.getRange(this.historyMaxLength,this.store.getCount());for(var B=0,A=C.length;B<A;B++){this.store.remove(C[B])}}}});Ext.reg("select",Ext.ux.Andrie.Select);Artery.plugin.Select=Ext.extend(Ext.ux.Andrie.Select,{queryField:"dmjp",valueField:"codeValue",displayField:"codeName",ajaxLoad:true,codeType:null,valueText:"",editReload:false,dmjp:true,store:null,storeData:null,mode:"local",triggerAction:"all",forceSelection:false,multiSelect:false,shadow:false,getTrigger:Artery.plugin.TwinTriggerField.prototype.getTrigger,initTrigger:Artery.plugin.TwinTriggerField.prototype.initTrigger,initHTMLTrigger:Artery.plugin.TwinTriggerField.prototype.initHTMLTrigger,initComponentTigger:Artery.plugin.TwinTriggerField.prototype.initComponentTigger,hideTrg:Artery.plugin.TwinTriggerField.prototype.hideTrg,showTrg:Artery.plugin.TwinTriggerField.prototype.showTrg,setFieldEditable:Artery.plugin.TwinTriggerField.prototype.setFieldEditable,getPositionEl:Artery.plugin.TwinTriggerField.prototype.getPositionEl,read:function(){Artery.plugin.TwinTriggerField.prototype.read.call(this);this.onBeforeRead()},edit:function(){Artery.plugin.TwinTriggerField.prototype.edit.call(this);this.onBeforeEdit()},setValueText:Artery.plugin.TwinTriggerField.prototype.setValueText,initComponent:function(){Artery.plugin.Select.superclass.initComponent.call(this);this.initStore();this.parseValueText();this.initComponentTigger();this.on("collapse",function(){this.focus();this.validate()},this)},initStore:function(){if(this.store==null){if(this.ajaxLoad){var A={proxy:new Ext.data.HttpProxy({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic"}),reader:new Ext.data.ArrayReader({},this.getStoreFields())};if(this.storeData!=null){A.data=this.storeData}this.store=new Ext.data.Store(A);this.store.on("beforeload",this.onBeforeload,this)}else{this.store=new Ext.data.SimpleStore({fields:this.getStoreFields(),data:this.storeData})}}},onBeforeload:function(A,B){if(B.params==null){B.params={}}B.params=Artery.getParams(B.params,this);Ext.apply(B.params,{codeType:this.codeType,value:this.value,valueText:this.getValueText(),method:"parseAjaxCode"});B.params.custParams=Ext.encode(this.custParams);if(!Artery.params){B.params.itemType="faCode";B.params.moreProp=this.multiSelect?"MSelect":"SSelect"}},getStoreFields:function(){if(Ext.isTrue(this.dmjp)){return["codeName","codeValue","dmjp"]}else{return["codeName","codeValue"]}},onTriggerClick:function(){if(this.isDisplayType()||this.disabled||this.readOnly){return }this.initList();if(this.isExpanded()){this.collapse();this.el.focus()}else{this.onFocus({});if(this.triggerAction=="all"){this.doQuery(this.allQuery,true)}else{this.doQuery(this.getRawValue())}this.el.focus()}},onTrigger1Click:function(){if(this.disabled){return }var A=this.getValue();this.clearValue(true);if(!Ext.isEmpty(A)){this.startValue=this.getValue();this.fireEvent("change",this,null,A)}},clearValue:function(A){this.setValue(null,false);Ext.ux.Andrie.Select.superclass.clearValue.call(this,A);this.clearAllSelect.call(this)},parseValueText:function(A){if(Ext.isEmpty(A)){A=this.value}if(!Ext.isEmpty(A)&&Ext.isEmpty(this.valueText)){var B=Artery.getParams({codeType:this.codeType,codeValue:A,method:"getCodeValueText"},this);if(!Artery.params){B.itemType="faCode";B.moreProp=this.multiSelect?"MSelect":"SSelect"}if(this.lastReloadParams){Ext.apply(B,this.lastReloadParams)}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",scope:this,syn:false,params:B,success:function(C,D){this.setValueText(C.responseText)}})}},getValueTextByValue:function(A){var D;if(A==null){A=""}else{A=A+""}A=Artery.getCommaSplitValue(A);if(!(A instanceof Array)){if(this.multiSelect){var C=Artery.getMultiSelectSeparator();A=A.split(C)}else{A=[A]}}if(Ext.isEmpty(A)){return D}if(this.store.getCount()<=0){var B=Artery.getParams({codeType:this.codeType,codeValue:A,method:"getCodeValueText"},this);if(!Artery.params){B.itemType="faCode";B.moreProp=this.multiSelect?"MSelect":"SSelect"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",scope:this,syn:false,params:B,success:function(E,F){D=E.responseText}})}else{D=this.findValueText(A)}return D},beforeBlur:function(){},setValue:function(A,C){if(Ext.isEmpty(C)){var G=Artery.config.faCodeSetValueFireChangeEvent=="true"?true:false;C=G}var B=this.value;var E=A;if(A==null){A=""}else{A=A+""}A=Artery.getCommaSplitValue(A);if(!(A instanceof Array)){if(this.multiSelect){var D=Artery.getMultiSelectSeparator();A=A.split(D)}else{A=[A]}}if(this.store.getCount()<=0){this.valueText=null;this.parseValueText(A)}else{var F=this.findValueText(A);this.setValueText(F)}Artery.plugin.Select.superclass.setValue.call(this,A,C);Artery.plugin.TwinTriggerField.prototype.setTriggerState.call(this,A)},findValueText:function(G){var I=[];var B=this.store.isFiltered();var C;if(B){C=this.store.data;this.store.data=this.store.snapshot}for(var D=0,F=G.length;D<F;D++){var H=G[D];if(this.valueField){var A=this.findRecord(this.valueField,H);if(A){H=A.data[this.displayField]}else{if(this.valueNotFoundText!==undefined){H=this.valueNotFoundText}}}I.push(H)}var E=Artery.getMultiSelectSeparator();vt=I.join(E);if(B){this.store.data=C;delete C}return vt},reset:function(){if(!this.rendered){return }if(this.view!=null){var B=Ext.apply([],this.view.getSelectedNodes());for(var C=0,A=B.length;C<A;C++){this.view.deselect(B[C],true)}}Ext.ux.Andrie.Select.superclass.reset.call(this)},onRender:function(B,A){Artery.plugin.TwinTriggerField.prototype.onRender.call(this,B,A);if(!this.lazyInit){this.initList()}else{this.on("focus",this.initList,this,{single:true})}if(this.displayType=="editable"){this.onBeforeEdit()}},onBeforeEdit:function(){if(this.editReload){this.onEditReloadHandler=function(B){var A=B.getKey();if(A!=37&&A!=38&&A!=39&&A!=40&&A!=16&&A!=17&&A!=18&&A!=13&&A!=27){this.reload()}};this.el.on("keyup",this.onEditReloadHandler,this)}},onDisable:function(){Ext.form.ComboBox.superclass.onDisable.apply(this,arguments);if(!Ext.isTrue(this.submitDisabled)&&this.hiddenField){this.hiddenField.disabled=true}},onBeforeRead:function(){if(this.editReload){this.el.un("keyup",this.onEditReloadHandler,this)}},reload:function(A){if(!this.ajaxLoad){alert("单值代码控件非异步加载时不能调用reload方法");return }this.clearLastVRV();var B={};if(A){B=Ext.decode(Ext.encode(A));if(A.callback){B.callback=A.callback}}if(B.params==null){B.params={}}this.lastReloadParams={};Ext.apply(this.lastReloadParams,B.params);if(!Ext.isEmpty(B.codeType)){B.codeType=B.codeType+"";this.codeType=B.codeType;this.clearValue(false)}this.store.reload({params:B.params,callback:function(D,C,E){if(B.multiSelect&&B.multiSelect!=this.multiSelect){this.multiSelect=B.multiSelect}this.loaded=true;this.store.loaded=true;if(this.view){this.view.refresh()}if(B.callback){B.callback.call(this,D,C,E)}},scope:this})},selectMulti:function(A){if(A!=this.multiSelect){this.multiSelect=A;this.list=null;this.initList()}},doQuery:function(E,D){if(E===undefined||E===null){E=""}var B={query:E,forceAll:D,combo:this,cancel:false};if(this.fireEvent("beforequery",B)===false||B.cancel){return false}if(this.ajaxLoad){if(this.loaded==null){this.store.on("load",function(G){G.loaded=true},this);this.store.load();this.loaded=true}if(this.store.loaded==null){this.doQuery.defer(200,this,[E,D]);return false}}E=B.query;D=B.forceAll;if(D===true||(E.length>=this.minChars)){if(this.lastQuery!==E){this.lastQuery=E;if(this.mode=="local"){this.selectedIndex=-1;if(D){this.store.clearFilter()}else{var C="";var A=0;if(E){C=new RegExp("；","g");E=E.replace(C,";");A=E.lastIndexOf(";")}if(E.length>A+1){E=E.substring(A+1)}try{C=new RegExp("("+E+")")}catch(F){C=E}if(this.dmjp&&this.queryField!=null){this.store.filter(this.queryField,C);if(this.store.getCount()==0){this.store.filter(this.displayField,C)}}else{this.store.filter(this.displayField,C)}}this.onLoad()}else{this.store.baseParams[this.queryParam]=E;this.store.load({params:this.getParams(E)});this.expand()}}else{this.selectedIndex=-1;this.onLoad()}}this.reSelectValue()},onLoad:function(){Artery.plugin.PopupLayerMgr.hideAll();if(!this.hasFocus){return }if(this.store.getCount()>0){this.expand();this.restrictHeight();if(this.lastQuery==this.allQuery){if(this.editable){this.el.dom.focus()}this.selectByValue(this.value,true)}else{this.selectNext()}}else{this.onEmptyResults()}},onKeyUp:function(A){if(this.readOnly!==true&&this.editable!==false&&(!A.isSpecialKey()||A.getKey()==8||A.getKey()==13)&&this.editReload==false){if(A.getKey()==13&&this.selectByEnter){delete this.selectByEnter;return }if(!this.multiSelect){this.valueArray=[]}this.lastKey=A.getKey();this.dqTask.delay(this.queryDelay)}},setCodeType:function(A){this.codeType=A;this.clearValue(false);this.store.reload()}});Ext.reg("apselect",Artery.plugin.Select);Artery.plugin.FaCodeSRadio=Ext.extend(Ext.form.Field,{hideClass:"x-hide-display",actionMode:"wrap",reload:function(A){var B={};if(A){B=Ext.decode(Ext.encode(A));if(A.callback){B.callback=A.callback}}if(B.params==null){B.params={}}Ext.apply(B.params,Artery.getParams({codeType:this.codeType,value:this.value,valueText:this.getValueText(),method:"parseAjaxCode"},this));Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",success:function(C,D){if(Ext.isEmpty(C.responseText)){Artery.alertMsg("错误提示","加载代码错误");return }this.wrap.dom.innerHTML=C.responseText;if(B.callback){B.callback.call(this)}},params:B.params,scope:this})},onRender:function(B,A){this.el=Ext.get(this.id);if(!this.isDisplayType()){this.readDom=Ext.getDom(this.id+"_read");this.textDom=Ext.getDom(this.id+"Text");this.wrap=Ext.get(this.id+"_wrap");if(this.wrap){this.wrap.on("click",this.onWrapClick,this)}}},onWrapClick:function(F,C,G){var A=C.tagName.toLowerCase();if(A=="input"){var B=this.el.dom.value;var E=C.value;var D=this;this.el.dom.value=E;this.validate();this.initDefaultOnChange(this,E,B);this.valueText=this.textDom.value=this.getRadioText(C);if(!Ext.isEmpty(this.onChangeEvent)&&!this.disabled){Artery.regItemEvent(this,"onChangeEvent","onChangeServer",{newValue:E,oldValue:B})}}},read:function(){if(!this.rendered){return }this.readDom.innerHTML=this.getValueText();Ext.fly(this.readDom).removeClass(this.hideClass);this.wrap.addClass(this.hideClass);if(!Ext.isEmpty(this.valueStyleRead)){this.getActionEl().parent("td").applyStyles(this.valueStyleRead)}},edit:function(){if(!this.rendered){return }Ext.fly(this.readDom).addClass(this.hideClass);this.wrap.removeClass(this.hideClass);if(!Ext.isEmpty(this.valueStyle)){this.getActionEl().parent("td").applyStyles(this.valueStyle)}},disable:function(){Artery.plugin.FaCodeSRadio.superclass.disable.call(this);var A=Ext.query("input",this.wrap.dom);Ext.each(A,function(C,B){C.disabled=true})},enable:function(){Artery.plugin.FaCodeSRadio.superclass.enable.call(this);var A=Ext.query("input",this.wrap.dom);Ext.each(A,function(C,B){C.disabled=false})},setValue:function(A){if(this.isDisplayType()){var C=this.getValueTextByValue(A);Artery.plugin.FaCodeSRadio.superclass.setValue.call(this,C);return }Artery.plugin.FaCodeSRadio.superclass.setValue.call(this,A);var B=Ext.query("input",this.wrap.dom);Ext.each(B,function(E,D){if(E.value==A){E.checked=true;this.valueText=this.textDom.value=this.getRadioText(E)}else{E.checked=false}},this)},initValue:function(){this.originalValue=this.getValue();this.previousValue=this.originalValue},getValueText:function(){return this.textDom.value},getRadioText:function(B){var A=Ext.fly(B.parentNode).child("span",true);return A.innerHTML},disableItem:function(B){if(Ext.isEmpty(B)){return }var A=Ext.query("input",this.wrap.dom);Ext.each(A,function(D,C){if(D.value==B){D.disabled=true}})},enableItem:function(B){if(Ext.isEmpty(B)){return }var A=Ext.query("input",this.wrap.dom);Ext.each(A,function(D,C){if(D.value==B){D.disabled=false}})},setCodeType:function(A){this.codeType=A;this.setValue(null);this.reload()},validateValue:function(A){if(Ext.isFunction(this.validator)){var B=this.validator(A);if(B!==true){this.markInvalid(B);return false}}if(this.allowBlank==false){if(Ext.isEmpty(A)){this.markInvalid(this.blankText);return false}this.clearInvalid()}return true},getErrorTipEl:function(){return this.wrap},getValueTextByValue:function(A){var C;var B=Artery.getParams({codeType:this.codeType,codeValue:A,method:"getCodeValueText"},this);if(!Artery.params){B.itemType="faCode";B.moreProp="SRadio"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",scope:this,syn:false,params:B,success:function(D,E){C=D.responseText}});return C}});Ext.reg("apfacodesradio",Artery.plugin.FaCodeSRadio);Artery.plugin.FaCodeMCheckbox=Ext.extend(Ext.form.Field,{hideClass:"x-hide-display",checked:false,actionMode:"wrap",reload:function(A){var B={};if(A){B=Ext.decode(Ext.encode(A));if(A.callback){B.callback=A.callback}}if(B.params==null){B.params={}}Ext.apply(B.params,Artery.getParams({codeType:this.codeType,value:this.value,method:"parseAjaxCode"},this));Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",success:function(C,D){if(Ext.isEmpty(C.responseText)){Artery.alertMsg("错误提示","加载代码错误");return }this.wrap.dom.innerHTML=C.responseText;Artery.plugin.FaCodeSRadio.superclass.setValue.call(this,this.getCheckedValue());if(B.callback){B.callback.call(this)}},params:B.params,scope:this})},onRender:function(B,A){this.el=Ext.get(this.id);if(!this.isDisplayType()){this.readDom=Ext.getDom(this.id+"_read");this.textDom=Ext.getDom(this.id+"Text");this.wrap=Ext.get(this.id+"_wrap");if(this.wrap){this.wrap.on("click",this.onWrapClick,this)}}},onWrapClick:function(D,I,C){var H=I.tagName.toLowerCase();if(H=="input"){var A=this.el.dom.value;var B=this.getCheckedValue();var G=I.checked;var F=I.value;var E=this;this.el.dom.value=B;this.validate();this.initDefaultOnChange(this,B,A);this.valueText=this.textDom.value=this.getCheckedText(I);if(!Ext.isEmpty(this.onChangeEvent)&&!this.disabled){Artery.regItemEvent(this,"onChangeEvent","onChangeServer",{newValue:B,oldValue:A})}}},getCheckedValue:function(){var A=[];var B=Ext.query("input",this.wrap.dom);Ext.each(B,function(E,D){if(E.checked){A.push(E.value)}});var C=Artery.getMultiSelectSeparator();return A.join(C)},read:Artery.plugin.FaCodeSRadio.prototype.read,edit:Artery.plugin.FaCodeSRadio.prototype.edit,disable:Artery.plugin.FaCodeSRadio.prototype.disable,enable:Artery.plugin.FaCodeSRadio.prototype.enable,disableItem:Artery.plugin.FaCodeSRadio.prototype.disableItem,enableItem:Artery.plugin.FaCodeSRadio.prototype.enableItem,setValue:function(A){A=Artery.getCommaSplitValue(A);if(this.isDisplayType()){var E=this.getValueTextByValue(A);Artery.plugin.FaCodeSRadio.superclass.setValue.call(this,E);return }Artery.plugin.FaCodeSRadio.superclass.setValue.call(this,A);var C;if(A!=null&&A!=""){var D=Artery.getMultiSelectSeparator();C=A.split(D)}else{C=[]}var B=Ext.query("input",this.wrap.dom);Ext.each(B,function(G,F){if(C.indexOf(G.value)!=-1){G.checked=true}else{G.checked=false}});this.valueText=this.textDom.value=this.getCheckedText()},initValue:Artery.plugin.FaCodeSRadio.prototype.initValue,getValues:function(){var A=[];var B=Ext.query("input",this.wrap.dom);Ext.each(B,function(E,D){A.push(E.value)});var C=Artery.getMultiSelectSeparator();return A.join(C)},getValueText:function(){return this.textDom.value},getCheckedText:function(){var C=[];var A=Ext.query("input",this.wrap.dom);Ext.each(A,function(F,D){if(F.checked){var E=Ext.fly(F.parentNode).child("span",true);C.push(E.innerHTML)}},this);var B=Artery.getMultiSelectSeparator();return C.join(B)},checkAll:function(){this.setValue(this.getValues())},setCodeType:function(A){this.codeType=A;this.setValue(null);this.reload()},validateValue:function(A){if(Ext.isFunction(this.validator)){var B=this.validator(A);if(B!==true){this.markInvalid(B);return false}}if(this.allowBlank==false){if(Ext.isEmpty(A)){this.markInvalid(this.blankText);return false}this.clearInvalid()}return true},getErrorTipEl:function(){return this.wrap},getValueTextByValue:function(A){var C;var B=Artery.getParams({codeType:this.codeType,codeValue:A,method:"getCodeValueText"},this);if(!Artery.params){B.itemType="faCode";B.moreProp="MCheckbox"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",scope:this,syn:false,params:B,success:function(D,E){C=D.responseText}});return C}});Ext.reg("apfacodemcheckbox",Artery.plugin.FaCodeMCheckbox);Artery.plugin.FaCodeCheckbox=Ext.extend(Ext.form.Field,{getActionEl:function(){return this.checkEl},onRender:function(B,A){this.el=Ext.get(this.id);if(this.displayType=="display"){this.checkEl=Ext.get(this.id)}else{this.checkEl=Ext.get(this.id+"_checkbox")}this.checkEl.on("click",function(){var C=this.el.dom.value;var E;if(this.checkEl.dom.checked){E=this.el.dom.value="1"}else{E=this.el.dom.value="0"}var D=this;this.validate();this.initDefaultOnChange(this,E,C);if(!Ext.isEmpty(this.onChangeEvent)&&!this.disabled){Artery.regItemEvent(this,"onChangeEvent","onChangeServer",{newValue:E,oldValue:C})}},this)},getErrorTipEl:function(){var A=this.checkEl.parent(".x-form-el-td-cust");return A},setValue:function(A){Artery.plugin.FaCodeCheckbox.superclass.setValue.call(this,A);this.el.dom.value=A;if(A=="1"||A=="true"){this.checkEl.dom.checked=true}else{this.checkEl.dom.checked=false}},isChecked:function(){if(this.value=="1"||this.value=="true"){return true}return false},validateValue:function(A){if(Ext.isFunction(this.validator)){var B=this.validator(A);if(B!==true){this.markInvalid(B);return false}}return true},disable:function(){Artery.plugin.FaCodeCheckbox.superclass.disable.call(this);this.checkEl.dom.disabled=true},enable:function(){Artery.plugin.FaCodeCheckbox.superclass.enable.call(this);this.checkEl.dom.disabled=false}});Ext.reg("apfacodecheckbox",Artery.plugin.FaCodeCheckbox);Artery.plugin.SCodePopup=Ext.extend(Artery.plugin.PopupTrigger,{codeTree:null,codeLayer:null,readOnly:false,codeType:"",selType:"1",rootName:"Root",rootId:"rootid",valuePath:"",ajaxLoad:true,treeLoaderData:null,codeNodeMap:null,searchCount:-1,searchPaths:[],reloadParams:null,initComponent:function(){Artery.plugin.SCodePopup.superclass.initComponent.call(this);Ext.EventManager.on(window,"beforeunload",function(){try{if(this.codeTree){this.codeTree.destroy();this.codeTree=null}if(this.searchField){this.searchField.destroy();this.searchField=null}if(this.okBtn){this.okBtn.destroy();this.okBtn=null}if(this.searchBtn){this.searchBtn.destroy();this.searchBtn=null}this.root=null;this.layerEl=null}catch(A){}},this)},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.layerEl==null){this.initCodeLayer()}this.showTreeLayer()},showTreeLayer:function(){if(this.isExpanded()){return }if(this.searchField){var A=Math.max(this.wrap.getWidth(),this.minLayerWidth);this.searchField.setWidth(A-85)}if(this.geditor){this.geditor.allowBlur=true}if(!this.codeTree.rendered){this.codeTree.render(this.layerEl.dom)}this.skinTree();this.restrictLayer(this.layerEl,this.codeTree)},skinTree:function(){if(Ext.isEmpty(this.getValue())){Artery.plugin.faTreeFunc.skinSelectedNode(this.codeTree,this.getValue())}else{Artery.plugin.faTreeFunc.skinSelectedNode(this.codeTree,this.getValue());this.expandNodePath()}},onExpandnode:function(){if(this.layerEl.isVisible()){this.restrictLayer(this.layerEl,this.codeTree)}},onCollapsenode:function(){if(this.layerEl.isVisible()){this.restrictLayer(this.layerEl,this.codeTree)}},createTree:function(B){var H={baseAttrs:{uiProvider:Ext.tree.TreeSingleNodeUI,uuid:B.uuid}};if(B.field.ajaxLoad){H.dataUrl=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadCodeTree"}B.field.treeLoader=new Ext.tree.TreeLoader(H);if(B.field.reloadParams!=null){Ext.apply(B.field.treeLoader.baseParams,B.field.reloadParams);B.field.reloadParams=null}try{if(B.field.searchField){B.field.searchField.destroy();B.field.searchField=null}if(B.field.okBtn){B.field.okBtn.destroy();B.field.okBtn=null}if(B.field.searchBtn){B.field.searchBtn.destroy();B.field.searchBtn=null}}catch(F){}var E=null;if(B.field.enablePinyin){E="请输入名称或简拼"}else{E="请输入名称"}var G=[];B.field.searchField=new Ext.form.TextField({emptyText:E,width:150,enableKeyEvents:true});G.push(B.field.searchField);G.push("-");var D=new Ext.Button({text:"查找"});B.field.searchBtn=D;G.push(D);G.push("->");var C=new Ext.Button({text:"确定"});B.field.okBtn=C;G.push(C);var A=new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,border:true,height:this.layerHeight,rootVisible:false,bbar:G,loader:B.field.treeLoader,eventModel:Ext.tusc.TreeRadioEvent});return A},createLayer:function(A){var B=new Artery.plugin.PopupLayer({shadow:true,constrain:false,zindex:20000,popupField:A.field});return B},initCodeLayer:function(){var A=Ext.id();this.codeTree=Artery.pwin.Artery.plugin.SCodePopup.prototype.createTree({field:this,uuid:A});if(this.ajaxLoad){this.codeTree.on("beforeload",this.onBeforeload,this)}this.codeTree.on("expandnode",this.onExpandnode,this);this.codeTree.on("collapsenode",this.onCollapsenode,this);this.codeTree.on("append",this.onAppendNode,this);this.codeTree.on("checkchange",this.onCheckchange,this);if(Ext.isTrue(this.singleClickCheck)){this.codeTree.on("click",this.singleClickCheckHandler,this)}if(Ext.isTrue(this.dblClickReturn)){this.codeTree.on("dblclick",this.dblClickReturnHandler,this)}if(this.searchField){this.searchField.on("keydown",function(D,C){if(C.getKey()==Ext.EventObject.ENTER){this.searchCode();this.searchField.focus()}else{this.searchCount=-1}},this)}if(this.okBtn){this.okBtn.on("click",this.submitValue,this)}if(this.searchBtn){this.searchBtn.on("click",this.searchCode,this)}this.root=this.createRootNode(A);this.codeTree.setRootNode(this.root);this.layerEl=Artery.pwin.Artery.plugin.SCodePopup.prototype.createLayer({field:this});if(this.isExpandNode){var B=function(C){if(C==null||C.childNodes.length==0){return }var D=C.childNodes[0];if(D==null){return }D.expand(false,false)};this.root.expand(false,false,B)}},reload:function(A){var D={};var C=this;if(A){D=Ext.decode(Ext.encode(A));if(A.callback){D.callback=A.callback}}if(D.params==null){D.params={}}this.lastReloadParams={};Ext.apply(this.lastReloadParams,D.params);if(!Ext.isEmpty(D.codeType)){D.codeType=D.codeType+"";this.codeType=D.codeType}if(!this.ajaxLoad){var B=Artery.getParams({codeType:this.codeType,ajaxLoad:this.ajaxLoad,selType:this.selType,method:"getCodeTreeJsonReload"},this);Ext.apply(B,D.params);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",scope:this,syn:false,params:B,success:function(E,F){var G=Ext.decode(E.responseText);this.treeLoaderData=G.treeLoaderData;this.codeNodeMap=G.codeNodeMap;if(this.codeTree!=null){this.root=this.createRootNode();this.codeTree.setRootNode(this.root)}C.setValue("");if(D.callback){D.callback.call(this,E,F,true)}}})}else{var C=this;if(this.treeLoader!=null){Ext.apply(this.treeLoader.baseParams,D.params);this.codeTree.root.reload(function(){C.setValue("");if(D.callback){D.callback.call(C,null,null,true)}})}else{this.reloadParams=D.params;C.setValue("");if(D.callback){D.callback.call(C,null,null,true)}}}},getWinBbar:function(){var A=null;if(this.enablePinyin){A="请输入名称或简拼"}else{A="请输入名称"}var B=[];this.searchField=Artery.pwin.Artery.plugin.SCodePopup.prototype.createSearchField({field:this,et:A});B.push(this.searchField);B.push("-");B.push({text:"查找",handler:this.searchCode,scope:this});B.push("->");B.push({text:"确定",handler:this.submitValue,scope:this});return B},createSearchField:function(A){var B=new Ext.form.TextField({emptyText:A.et,width:150,enableKeyEvents:true});return B},searchCode:function(){var B=this.searchField.getValue();if(Ext.isEmpty(B)){return }if(this.searchCount==-1){var A=Artery.getParams({searchText:B,enablePinyin:this.enablePinyin,codeType:this.codeType},this);if(!Artery.params){A.itemType="faCode";A.moreProp="STree"}Ext.apply(A,this.lastReloadParams);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getCodePaths",success:function(C,D){this.searchPaths=Ext.decode(C.responseText);this.searchCount=0;this.doExpandCode()},scope:this,syn:false,params:A})}else{this.doExpandCode()}},doExpandCode:function(){if(this.searchPaths.length==0){return }this.searchCount=(this.searchCount)%(this.searchPaths.length);this.expandNode(this.searchPaths[this.searchCount],false);this.searchCount++},createRootNode:function(A){var B={text:this.rootName,draggable:false,cid:this.rootId};if(!this.ajaxLoad){B.children=this.treeLoaderData}return Artery.pwin.Artery.plugin.SCodePopup.prototype.createRootNode_bak(B)},createRootNode_bak:function(A){return new Ext.tree.AsyncTreeNode(A)},submitValue:function(){if(this.fireEvent("beforeselect",this,this.valueTemp,this.getValue())!==false){var A=this.getValue();if(this.valueTemp!==undefined&&this.valueTextTemp!==undefined){this.setValue(this.valueTemp,this.valueTextTemp)}this.startValue=this.getValue();this.collapse(true);this.fireEvent("change",this,this.value,A)}},clearTempValue:function(){delete this.valueTemp;delete this.valueTextTemp},onAppendNode:function(B,C,D,A){if(this.getValue()==D.attributes.cid){if(D.attributes.checked!==undefined){D.attributes.checked=true}}},onCheckchange:function(C,B){if(B){var A=C.attributes;this.valueTextTemp=A.text;this.valueTemp=A.cid}else{this.clearTempValue()}C.select()},onBeforeload:function(B){var A=this.codeTree.loader;A.baseParams.code=B.attributes.cid;A.baseParams.codeType=this.codeType;A.baseParams.selType=this.selType;A.baseParams.custParams=Ext.encode(this.custParams);Ext.apply(A.baseParams,Artery.getParams({},this));if(!Artery.params){A.baseParams.itemType="faCode";A.baseParams.moreProp="STree"}},singleClickCheckHandler:Artery.plugin.faTreeFunc.singleClickCheckHandler,dblClickReturnHandler:Artery.plugin.faTreeFunc.dblClickReturnHandler,expandNodePath:function(){if(!Ext.isEmpty(this.valuePath)&&!Ext.isEmpty(this.getValue())){this.expandNode(this.valuePath,true);this.valuePath=null}},expandNode:function(C,A){var D=C.split(",");var B=function(E){if(D.length==1){var F=E.findChild("cid",D.shift());if(F){F.select();if(F.ui.wasLeaf==true&&A==true){F.ui.checkbox.checked=true}}return }var G=E.findChild("cid",D.shift());if(G==null){return }G.expand(false,false,B)};this.root.expand(false,false,B)},upValueText:function(){if(this.ajaxLoad){this.upTextAjax()}else{this.upTextCache()}},upTextAjax:function(){var A=Artery.getParams({codeValue:this.getValue(),codeType:this.codeType},this);if(!Artery.params){A.itemType="faCode";A.moreProp="STree"}if(this.lastReloadParams){Ext.apply(A,this.lastReloadParams)}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getCodeValueText",success:function(B,C){var E=Ext.decode(B.responseText);var D=E.valueText;if(Ext.isEmpty(D)){D=this.value}this.setValueText(D);this.valuePath=E.valuePath},scope:this,syn:false,params:A})},upTextCache:function(){var E=Artery.getMultiSelectSeparator();var D=this.getValue().split(E);var C={},B=[];for(var A=0;A<D.length;A++){if(this.codeNodeMap[D[A]]===undefined){B.push(D[A])}else{B.push(this.codeNodeMap[D[A]].valueText);this.valuePath=this.codeNodeMap[D[A]].valuePath}}this.setValueText(B.join(E))},validateValue:function(A){if(!Artery.plugin.PopupTrigger.superclass.validateValue.call(this,A)){return false}var B=this.value?this.value:"";if(B.length<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));return false}if(B.length>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));return false}return true},validateRightValue:function(D){if(D){var B=D.split(";");if(B.length>1){var F={};for(var C in B){if(F[B[C]]){return true}F[B[C]]=true}}}if(Ext.isTrue(this.isCallByVRV)){return this.lastVRV_Result}if(this.lastVRV_V&&this.lastVRV_V==D){if(!this.lastVRV_Result){this.markInvalid(this.lastVRV_M)}return this.lastVRV_Result}this.lastVRV_V=D;var G=Artery.getParams(this.lastReloadParams,this);var A={formid:Artery.getFormId(this),itemid:Artery.getEventId(this),itemType:"faCode",codeType:this.codeType,value:D};Ext.apply(G,A);var E=true;Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=isRightValue",success:function(H,I){var J=Ext.decode(H.responseText);if(!J.success===true){this.lastVRV_M=J.message;this.markInvalid(J.message);E=false}else{if(J.value&&this.setValue){this.isCallByVRV=true;this.setValue(J.value);delete this.isCallByVRV}}},syn:false,params:G,scope:this});this.lastVRV_Result=E;return E}});Ext.reg("apSCodePopup",Artery.plugin.SCodePopup);Artery.plugin.MCodePopup=Ext.extend(Artery.plugin.PopupTrigger,{codeStore:null,codeTree:null,codeLayer:null,readOnly:false,codeType:"",selType:"1",rootName:"Root",rootId:"rootid",ajaxLoad:true,treeLoaderData:null,codeNodeMap:null,searchCount:-1,searchPaths:[],reloadParams:null,initComponent:function(){Artery.plugin.MCodePopup.superclass.initComponent.call(this);if(!this.codeStore){this.codeStore=new Ext.data.SimpleStore({fields:["id","name"],data:this.getStoreData(),id:0})}Ext.EventManager.on(window,"beforeunload",function(){try{if(this.codeTree){this.codeTree.destroy();this.codeTree=null}if(this.searchField){this.searchField.destroy();this.searchField=null}if(this.okBtn){this.okBtn.destroy();this.okBtn=null}if(this.searchBtn){this.searchBtn.destroy();this.searchBtn=null}this.root=null;this.layerEl=null}catch(A){}},this)},getStoreData:function(){var C=[];if(!Ext.isEmpty(this.value)){var D=Artery.getMultiSelectSeparator();var E=(this.value+"").split(D);var A=this.valueText.split(D);for(var B=0;B<E.length;B++){if(!Ext.isEmpty(E[B])){C[C.length]=[E[B],A[B]]}}}return C},setValue:function(A,B){A=Artery.getCommaSplitValue(A);B=Artery.getCommaSplitValue(B);Artery.plugin.MCodePopup.superclass.setValue.call(this,A,B);this.codeStore.loadData(this.getStoreData())},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.layerEl==null){this.initCodeLayer()}this.showTreeLayer()},showTreeLayer:Artery.plugin.SCodePopup.prototype.showTreeLayer,skinTree:function(){var B=this.codeStore;var A=function(D){var C=false;if(B.getById(D.attributes.cid)!=null){C=true}if(D.ui.checkbox){D.ui.checkbox.checked=C}if(!D.isLeaf()&&D.isLoaded()){D.eachChild(A)}};A(this.codeTree.root)},onExpandnode:function(){if(this.layerEl.isVisible()){this.restrictLayer(this.layerEl,this.codeTree)}},onCollapsenode:function(){if(this.layerEl.isVisible()){this.restrictLayer(this.layerEl,this.codeTree)}},createTree:function(B){var G={};if(B.field.ajaxLoad){G.dataUrl=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadCodeTree"}B.field.treeLoader=new Ext.tree.TreeLoader(G);if(B.field.reloadParams!=null){Ext.apply(B.field.treeLoader.baseParams,B.field.reloadParams);B.field.reloadParams=null}var E=null;if(B.field.enablePinyin){E="请输入名称或简拼"}else{E="请输入名称"}var F=[];B.field.searchField=new Ext.form.TextField({emptyText:E,width:150,enableKeyEvents:true});F.push(B.field.searchField);F.push("-");var D=new Ext.Button({text:"查找"});B.field.searchBtn=D;F.push(D);F.push("->");var C=new Ext.Button({text:"确定"});B.field.okBtn=C;F.push(C);var A=new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,border:true,rootVisible:false,height:B.field.layerHeight,bbar:F,loader:B.field.treeLoader});return A},createLayer:function(A){var B=new Artery.plugin.PopupLayer({shadow:true,constrain:false,zindex:20000,popupField:A.field});return B},initCodeLayer:function(){this.codeTree=Artery.pwin.Artery.plugin.MCodePopup.prototype.createTree({field:this});if(this.ajaxLoad){this.codeTree.on("beforeload",this.onBeforeload,this)}this.codeTree.on("expandnode",this.onExpandnode,this);this.codeTree.on("collapsenode",this.onCollapsenode,this);this.codeTree.on("append",this.onAppendNode,this);this.codeTree.on("checkchange",this.onCheckchange,this);if(Ext.isTrue(this.singleClickCheck)){this.codeTree.on("click",this.singleClickCheckHandler,this)}if(this.searchField){this.searchField.on("keydown",function(C,B){if(B.getKey()==Ext.EventObject.ENTER){this.searchCode()}else{this.searchCount=-1}},this)}if(this.okBtn){this.okBtn.on("click",this.submitValue,this)}if(this.searchBtn){this.searchBtn.on("click",this.searchCode,this)}this.root=this.createRootNode();this.codeTree.setRootNode(this.root);this.layerEl=Artery.pwin.Artery.plugin.MCodePopup.prototype.createLayer({field:this});if(this.isExpandNode){var A=function(B){if(B==null||B.childNodes.length==0){return }var C=B.childNodes[0];if(C==null){return }C.expand(false,false)};this.root.expand(false,false,A)}},reload:function(A){var D={};var C=this;if(A){D=Ext.decode(Ext.encode(A));if(A.callback){D.callback=A.callback}}if(D.params==null){D.params={}}this.lastReloadParams={};Ext.apply(this.lastReloadParams,D.params);if(!this.ajaxLoad){var B=Artery.getParams({codeType:this.codeType,ajaxLoad:this.ajaxLoad,selType:this.selType,method:"getCodeTreeJsonReload"},this);Ext.apply(B,D.params);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",scope:this,syn:false,params:B,success:function(E,F){var G=Ext.decode(E.responseText);this.treeLoaderData=G.treeLoaderData;this.codeNodeMap=G.codeNodeMap;if(this.codeTree!=null){this.root=this.createRootNode();this.codeTree.setRootNode(this.root)}C.setValue("");if(D.callback){D.callback.call(this,E,F,true)}}})}else{var C=this;if(this.treeLoader!=null){Ext.apply(this.treeLoader.baseParams,D.params);this.codeTree.root.reload(function(){C.setValue("");if(D.callback){D.callback.call(C,null,null,true)}})}else{this.reloadParams=D.params;C.setValue("");if(D.callback){D.callback.call(C,null,null,true)}}}},getWinBbar:Artery.plugin.SCodePopup.prototype.getWinBbar,searchCode:function(){var B=this.searchField.getValue();if(Ext.isEmpty(B)){return }if(this.searchCount==-1){var A=Artery.getParams({searchText:B,enablePinyin:this.enablePinyin,codeType:this.codeType},this);if(!Artery.params){A.itemType="faCode";A.moreProp="MTree"}Ext.apply(A,this.lastReloadParams);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getCodePaths",success:function(C,D){this.searchPaths=Ext.decode(C.responseText);this.searchCount=0;this.doExpandCode()},scope:this,syn:false,params:A})}else{this.doExpandCode()}},doExpandCode:Artery.plugin.SCodePopup.prototype.doExpandCode,submitValue:function(){var D=[],A=[];this.codeStore.each(function(E){D[D.length]=E.get("id");A[A.length]=E.get("name")});var B=this.getValue();var C=Artery.getMultiSelectSeparator();this.value=D.join(C);this.valueText=A.join(C);this.setValue(this.value,this.valueText);this.startValue=this.getValue();this.collapse(true);this.fireEvent("change",this,this.value,B)},clearTempValue:function(){this.codeStore.loadData(this.getStoreData())},createRootNode:function(){var A={text:this.rootName,draggable:false,cid:this.rootId};if(!this.ajaxLoad){A.children=this.treeLoaderData}return new Artery.pwin.Artery.plugin.MCodePopup.prototype.createRootNode_bak(A)},createRootNode_bak:function(A){return new Ext.tree.AsyncTreeNode(A)},onBeforeload:function(B){var A=this.codeTree.loader;A.baseParams.code=B.attributes.cid;A.baseParams.codeType=this.codeType;A.baseParams.selType=this.selType;A.baseParams.custParams=Ext.encode(this.custParams);Ext.applyIf(A.baseParams,Artery.getParams({},this));if(!Artery.params){A.baseParams.itemType="faCode";A.baseParams.moreProp="MTree"}},singleClickCheckHandler:Artery.plugin.faTreeFunc.singleClickCheckHandler,onAppendNode:function(B,C,D,A){if(this.codeStore.getById(D.attributes.cid)!=null){if(D.attributes.checked!==undefined){D.attributes.checked=true}}},onCheckchange:function(B,A){if(A){this.addRecord(B)}else{this.delRecord(B)}},addRecord:function(B){var A=B.attributes;if(this.codeStore.getById(A.cid)==null){var C=[];C.push([A.cid,B.text]);this.codeStore.loadData(C,true)}},delRecord:function(A){var B=this.codeStore.getById(A.attributes.cid);if(B){this.codeStore.remove(B)}},expandNode:Artery.plugin.SCodePopup.prototype.expandNode,upValueText:function(){if(this.ajaxLoad){this.upTextAjax()}else{this.upTextCache()}},upTextAjax:function(){var A=Artery.getParams({codeValue:this.getValue(),codeType:this.codeType},this);if(!Artery.params){A.itemType="faCode";A.moreProp="MTree"}if(this.lastReloadParams){Ext.apply(A,this.lastReloadParams)}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getCodeValueText",success:function(B,C){var D=B.responseText;if(Ext.isEmpty(D)){D=this.value}this.setValueText(D);this.codeStore.loadData(this.getStoreData())},scope:this,syn:false,params:A})},upTextCache:function(){var E=Artery.getMultiSelectSeparator();var D=this.getValue().split(E);var C={},B=[];for(var A=0;A<D.length;A++){if(this.codeNodeMap[D[A]]===undefined){B.push(D[A])}else{B.push(this.codeNodeMap[D[A]].valueText)}}this.setValueText(B.join(E));this.codeStore.loadData(this.getStoreData())},validateValue:Artery.plugin.SCodePopup.prototype.validateValue,validateRightValue:Artery.plugin.SCodePopup.prototype.validateRightValue});Ext.reg("apMCodePopup",Artery.plugin.MCodePopup);Ext.ux.form={};Ext.ux.form.Spinner=function(A){Ext.ux.form.Spinner.superclass.constructor.call(this,A);this.addEvents({spin:true,spinup:true,spindown:true})};Ext.extend(Ext.ux.form.Spinner,Ext.form.TriggerField,{triggerClass:"x-form-spinner-trigger",splitterClass:"x-form-spinner-splitter",alternateKey:Ext.EventObject.shiftKey,strategy:undefined,allowDomMove:true,onRender:function(B,A){Ext.ux.form.Spinner.superclass.onRender.call(this,B,A);this.initSpinner()},initTrigger:function(){this.trigger.addClassOnOver("x-form-trigger-over");this.trigger.addClassOnClick("x-form-trigger-click")},initSpinner:function(){this.keyNav=new Ext.KeyNav(this.el,{up:function(A){A.preventDefault();this.onSpinUp()},down:function(A){A.preventDefault();this.onSpinDown()},pageUp:function(A){A.preventDefault();this.onSpinUpAlternate()},pageDown:function(A){A.preventDefault();this.onSpinDownAlternate()},scope:this});this.trigger.un("click",this.onTriggerClick);this.repeater=new Ext.util.ClickRepeater(this.trigger);this.repeater.on("click",this.onTriggerClick,this,{preventDefault:true});this.trigger.on("mouseover",this.onMouseOver,this,{preventDefault:true});this.trigger.on("mouseout",this.onMouseOut,this,{preventDefault:true});this.trigger.on("mousemove",this.onMouseMove,this,{preventDefault:true});this.trigger.on("mousedown",this.onMouseDown,this,{preventDefault:true});this.trigger.on("mouseup",this.onMouseUp,this,{preventDefault:true});this.wrap.on("mousewheel",this.handleMouseWheel,this);if("object"==typeof this.strategy&&this.strategy.xtype){switch(this.strategy.xtype){case"number":this.strategy=new Ext.ux.form.Spinner.NumberStrategy(this.strategy);break;case"date":this.strategy=new Ext.ux.form.Spinner.DateStrategy(this.strategy);break;case"time":this.strategy=new Ext.ux.form.Spinner.TimeStrategy(this.strategy);break;default:delete (this.strategy);break}delete (this.strategy.xtype)}if(this.strategy==undefined){this.strategy=new Ext.ux.form.Spinner.NumberStrategy()}},onMouseOver:function(){if(this.disabled){return }var A=this.getMiddle();this.__tmphcls=(Ext.EventObject.getPageY()<A)?"x-form-spinner-overup":"x-form-spinner-overdown";this.trigger.addClass(this.__tmphcls)},onMouseOut:function(){this.trigger.removeClass(this.__tmphcls)},onMouseMove:function(){if(this.disabled){return }var A=this.getMiddle();if(((Ext.EventObject.getPageY()>A)&&this.__tmphcls=="x-form-spinner-overup")||((Ext.EventObject.getPageY()<A)&&this.__tmphcls=="x-form-spinner-overdown")){}},onMouseDown:function(){if(this.disabled){return }var A=this.getMiddle();this.__tmpccls=(Ext.EventObject.getPageY()<A)?"x-form-spinner-clickup":"x-form-spinner-clickdown";this.trigger.addClass(this.__tmpccls)},onMouseUp:function(){this.trigger.removeClass(this.__tmpccls)},onTriggerClick:function(){if(this.disabled||this.getEl().dom.readOnly){return }var B=this.getMiddle();var A=(Ext.EventObject.getPageY()<B)?"Up":"Down";this["onSpin"+A]()},getMiddle:function(){var B=this.trigger.getTop();var C=this.trigger.getHeight();var A=B+(C/2);return A},handleMouseWheel:function(A){if(this.disabled||this.getEl().dom.readOnly){Ext.EventObject.preventDefault();return }var B=A.getWheelDelta();if(B>0){this.onSpinUp();A.stopEvent()}else{if(B<0){this.onSpinDown();A.stopEvent()}}},startDrag:function(){this.proxy.show();this._previousY=Ext.fly(this.dd.getDragEl()).getTop()},endDrag:function(){this.proxy.hide()},onDrag:function(){if(this.disabled){return }var B=Ext.fly(this.dd.getDragEl()).getTop();var A="";if(this._previousY>B){A="Up"}if(this._previousY<B){A="Down"}if(A!=""){this["onSpin"+A]()}this._previousY=B},onSpinUp:function(){if(Ext.EventObject.shiftKey==true){this.onSpinUpAlternate();return }else{this.strategy.onSpinUp(this)}this.fireEvent("spin",this);this.fireEvent("spinup",this)},onSpinDown:function(){if(Ext.EventObject.shiftKey==true){this.onSpinDownAlternate();return }else{this.strategy.onSpinDown(this)}this.fireEvent("spin",this);this.fireEvent("spindown",this)},onSpinUpAlternate:function(){this.strategy.onSpinUpAlternate(this);this.fireEvent("spin",this);this.fireEvent("spinup",this)},onSpinDownAlternate:function(){this.strategy.onSpinDownAlternate(this);this.fireEvent("spin",this);this.fireEvent("spindown",this)}});Ext.reg("uxspinner",Ext.ux.form.Spinner);Ext.ux.form.Spinner.Strategy=function(A){Ext.apply(this,A)};Ext.extend(Ext.ux.form.Spinner.Strategy,Ext.util.Observable,{defaultValue:0,minValue:undefined,maxValue:undefined,incrementValue:1,alternateIncrementValue:5,onSpinUp:function(A){this.spin(A,false,false)},onSpinDown:function(A){this.spin(A,true,false)},onSpinUpAlternate:function(A){this.spin(A,false,true)},onSpinDownAlternate:function(A){this.spin(A,true,true)},spin:function(A,C,B){},fixBoundries:function(A){return A}});Ext.ux.form.Spinner.NumberStrategy=function(A){Ext.ux.form.Spinner.NumberStrategy.superclass.constructor.call(this,A)};Ext.extend(Ext.ux.form.Spinner.NumberStrategy,Ext.ux.form.Spinner.Strategy,{allowDecimals:true,decimalPrecision:2,spin:function(B,E,C){Ext.ux.form.Spinner.NumberStrategy.superclass.spin.call(this,B,E,C);var A=parseFloat(B.getValue());var D=(C==true)?this.alternateIncrementValue:this.incrementValue;(E==true)?A-=D:A+=D;A=(isNaN(A))?this.defaultValue:A;A=this.fixBoundries(A);B.setRawValue(A)},fixBoundries:function(B){var A=B;if(this.minValue!=undefined&&A<this.minValue){A=this.minValue}if(this.maxValue!=undefined&&A>this.maxValue){A=this.maxValue}return this.fixPrecision(A)},fixPrecision:function(B){var A=isNaN(B);if(!this.allowDecimals||this.decimalPrecision==-1||A||!B){return A?"":B}return parseFloat(parseFloat(B).toFixed(this.decimalPrecision))}});Ext.ux.form.Spinner.DateStrategy=function(A){Ext.ux.form.Spinner.DateStrategy.superclass.constructor.call(this,A)};Ext.extend(Ext.ux.form.Spinner.DateStrategy,Ext.ux.form.Spinner.Strategy,{defaultValue:new Date(),format:"Y-m-d",incrementValue:1,incrementConstant:Date.DAY,alternateIncrementValue:1,alternateIncrementConstant:Date.MONTH,spin:function(D,G,E){Ext.ux.form.Spinner.DateStrategy.superclass.spin.call(this);var A=D.getRawValue();if(A.length==1){A="0"+A}A=Date.parseDate(A,this.format);var C=(G==true)?-1:1;var F=(E==true)?this.alternateIncrementValue:this.incrementValue;var B=(E==true)?this.alternateIncrementConstant:this.incrementConstant;if(typeof this.defaultValue=="string"){alert(this.defaultValue+":"+this.format);this.defaultValue=Date.parseDate(this.defaultValue,this.format)}A=(A)?A.add(B,C*F):this.defaultValue;A=this.fixBoundries(A);D.setRawValue(Ext.util.Format.date(A,this.format))},fixBoundries:function(B){var D=B;var C=(typeof this.minValue=="string")?Date.parseDate(this.minValue,this.format):this.minValue;var A=(typeof this.maxValue=="string")?Date.parseDate(this.maxValue,this.format):this.maxValue;if(this.minValue!=undefined&&D<C){D=C}if(this.maxValue!=undefined&&D>A){D=A}return D}});Ext.ux.form.Spinner.TimeStrategy=function(A){Ext.ux.form.Spinner.TimeStrategy.superclass.constructor.call(this,A)};Ext.extend(Ext.ux.form.Spinner.TimeStrategy,Ext.ux.form.Spinner.DateStrategy,{format:"H:i",incrementValue:1,incrementConstant:Date.MINUTE,alternateIncrementValue:1,alternateIncrementConstant:Date.HOUR});Artery.plugin.DateTrigger=Ext.extend(Ext.form.TriggerField,{width:45,editable:true});Ext.override(Ext.DatePicker,{showTime:false,timeType:1,showToday:true,todayTip:"{0}",listClass:" x-menu-arteryPopup ",handleDateClick:function(B,A){B.stopEvent();if(A.dateValue&&!Ext.fly(A.parentNode).hasClass("x-date-disabled")){this.setValue(new Date(A.dateValue));if(!this.showTime){this.fireEvent("select",this,this.value)}}},handleDateDbClick:function(B,A){B.stopEvent();if(A.dateValue&&!Ext.fly(A.parentNode).hasClass("x-date-disabled")){if(this.showTime){this.selectDateTime()}}},activeDateDisabled:function(A){if(!A){return false}var B=true;if(this.cells){this.cells.each(function(C){if(C.hasClass("x-date-active")&&C.dom.firstChild.dateValue==A.getTime()){B=false}})}return B},setValue:function(B,C){if(this.showTime&&C==true&&this.el){this.hourSpiner.setValue(B.getHours());this.minuteSpiner.setValue(B.getMinutes());this.secondSpiner.setValue(B.getSeconds())}var A=this.value;this.value=B.clearTime(true);this.oldVal=B;this.value.tdate=B.tdate;if(this.el){this.update(this.value)}},onRender:function(A,H){var D=['<table cellspacing="0" style="width:',this.showTime?300:200,'">','<tr><td class="x-date-left"><a href="#" title="',this.prevText,'">&#160;</a></td><td class="x-date-middle" align="right"></td><td class="x-date-middle" align="left"></td><td class="x-date-right"><a href="#" title="',this.nextText,'">&#160;</a></td></tr>','<tr><td colspan="4"><table class="x-date-inner" cellspacing="0"><thead><tr>'];var G=this.dayNames;for(var F=0;F<7;F++){var J=this.startDay+F;if(J>6){J=J-7}D.push("<th><span>",G[J].substr(0,1),"</span></th>")}D[D.length]="</tr></thead><tbody><tr>";for(var F=0;F<42;F++){if(F%7==0&&F!=0){D[D.length]="</tr><tr>"}D[D.length]='<td><a href="#" hidefocus="on" class="x-date-date" tabIndex="1"><em><span>ABC</span></em></a></td>'}var I="";if(!this.showTime){I='<table border=0 cellpadding=0 cellspacing=0 width=100%><tr><td class="x-date-todaybtn" align=center></td></tr></table>'}D[D.length]='</tr></tbody></table></td></tr><tr><td colspan="4" align="center" class="x-date-bottom">'+I+'</td></tr></table><div class="x-date-mp"></div>';var B=document.createElement("div");B.className="x-date-picker";B.innerHTML=D.join("");A.dom.insertBefore(B,H);if(this.showTime){var C=document.createElement("div");C.className="x-date-bottom x-date-table-wrap";C.innerHTML='<table cellpadding=0 cellspacing=0 width=285 style="height:32px;margin-left:10px;"><tr><td width=50  class="x-date-todaybtn"></td><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="x-date-hourtd"></td><td style="font-weight: bold;">：</td><td class="x-date-minutetd"></td><td style="font-weight: bold;">：</td><td class="x-date-secondtd"></td><td width=100%></td><td width=50 class="x-date-okbtn"></td></tr></table>';A.dom.appendChild(C);Ext.get(C).on("click",function(L){L.stopEvent()});this.timeTable=C.firstChild}this.el=Ext.get(B);this.eventEl=Ext.get(B.firstChild);this.leftcr=new Ext.util.ClickRepeater(this.el.child("td.x-date-left a"),{handler:this.showPrevMonth,scope:this,preventDefault:true,stopDefault:true});this.rightcr=new Ext.util.ClickRepeater(this.el.child("td.x-date-right a"),{handler:this.showNextMonth,scope:this,preventDefault:true,stopDefault:true});this.eventEl.on("mousewheel",this.handleMouseWheel,this);this.monthPicker=this.el.down("div.x-date-mp");this.monthPicker.enableDisplayMode("block");this.yearPicker=this.el.down("div.x-date-mp");this.yearPicker.enableDisplayMode("block");this.keyNav=new Ext.KeyNav(this.eventEl,{left:function(L){L.ctrlKey?this.showPrevMonth():this.update(this.activeDate.add("d",-1))},right:function(L){L.ctrlKey?this.showNextMonth():this.update(this.activeDate.add("d",1))},up:function(L){L.ctrlKey?this.showNextYear():this.update(this.activeDate.add("d",-7))},down:function(L){L.ctrlKey?this.showPrevYear():this.update(this.activeDate.add("d",7))},pageUp:function(L){this.showNextMonth()},pageDown:function(L){this.showPrevMonth()},enter:function(L){if(this.activeDateDisabled(this.activeDate)){L.stopPropagation();return false}if(this.showTime){this.selectDateTime()}else{this.setValue(this.activeDate);this.fireEvent("select",this,this.value)}L.stopPropagation();return true},scope:this});this.eventEl.on("click",this.handleDateClick,this,{delegate:"a.x-date-date"});this.eventEl.on("dblclick",this.handleDateDbClick,this,{delegate:"a.x-date-date"});this.el.unselectable();this.cells=this.el.select("table.x-date-inner tbody td");this.textNodes=this.el.query("table.x-date-inner tbody span");this.ybtn=new Ext.Button({text:"&#160;",renderTo:this.el.query("td.x-date-middle")[0]});this.ybtn.el.child("em").addClass("x-btn-arrow");this.ybtn.on("click",this.showYearPicker,this);this.ybtn.el.child(this.ybtn.menuClassTarget).addClass("x-btn-with-menu");this.mbtn=new Ext.Button({text:"&#160;",renderTo:this.el.query("td.x-date-middle")[1]});this.mbtn.el.child("em").addClass("x-btn-arrow");this.mbtn.on("click",this.showMonthPicker,this);this.mbtn.el.child(this.mbtn.menuClassTarget).addClass("x-btn-with-menu");if(this.showToday){this.todayKeyListener=this.eventEl.addKeyListener(Ext.EventObject.SPACE,this.selectToday,this);var K=(new Date()).dateFormat(this.format);this.todayBtn=new Ext.Button({renderTo:A.child("td.x-date-todaybtn",true),text:String.format(this.todayText,K),tooltip:String.format(this.todayTip,K),tooltipType:"title",handler:this.selectToday,scope:this});this.todayBtn.on("mouseover",function(M,N){var L=(new Date()).dateFormat(this.format);M.setTooltip(L)},this)}if(this.showTime){var E=this;this.okBtn=new Ext.Button({renderTo:A.child("td.x-date-okbtn",true),text:"确定",handler:this.selectDateTime,scope:this});this.hourSpiner=new Ext.ux.form.Spinner({renderTo:A.child("td.x-date-hourtd",true),width:55,value:"01",strategy:new Ext.ux.form.Spinner.TimeStrategy({format:"H",incrementConstant:Date.HOUR,alternateIncrementValue:3,alternateIncrementConstant:Date.HOUR})});this.minuteSpiner=new Ext.ux.form.Spinner({renderTo:A.child("td.x-date-minutetd",true),width:55,strategy:new Ext.ux.form.Spinner.TimeStrategy({format:"i",incrementConstant:Date.MINUTE,alternateIncrementValue:5,alternateIncrementConstant:Date.MINUTE})});this.secondSpiner=new Ext.ux.form.Spinner({renderTo:A.child("td.x-date-secondtd",true),width:55,strategy:new Ext.ux.form.Spinner.TimeStrategy({format:"s",incrementConstant:Date.SECOND,alternateIncrementValue:5,alternateIncrementConstant:Date.SECOND})});this.hourSpiner.setValue(this.oldVal.getHours());this.minuteSpiner.setValue(this.oldVal.getMinutes());this.secondSpiner.setValue(this.oldVal.getSeconds());this.disableTimeState()}if(Ext.isIE){this.el.repaint()}this.update(this.value)},createMonthPicker:function(){var C=false;if(!this.monthPicker.dom.firstChild){C=true}var A=['<table border="0" cellspacing="0">'];for(var B=0;B<6;B++){A.push('<tr><td class="x-date-mp-month"><a href="#">',Date.getShortMonthName(B),"</a></td>",'<td class="x-date-mp-month x-date-mp-sep"><a href="#">',Date.getShortMonthName(B+6),"</a></td>")}A.push('<tr class="x-date-mp-btns"><td colspan="4">','</button><button type="button" class="x-date-mp-cancel">',this.cancelText,"</button></td></tr>","</table>");this.monthPicker.update(A.join(""));this.mpMonths=this.yearPicker.select("td.x-date-mp-month");this.mpYears=this.yearPicker.select("td.x-date-mp-year");if(C){this.mon(this.monthPicker,"click",this.onDateDblClick,this);this.mon(this.monthPicker,"dblclick",this.onDateDblClick,this)}this.mpMonths=this.monthPicker.select("td.x-date-mp-month");this.mpYears=this.monthPicker.select("td.x-date-mp-year");this.mpMonths.each(function(D,E,F){F+=1;if((F%2)===0){D.dom.xmonth=5+Math.round(F*0.5)}else{D.dom.xmonth=Math.round((F-1)*0.5)}})},showMonthPicker:function(){if(!this.disabled){this.createMonthPicker();var A=this.el.getSize();this.monthPicker.setSize(A);this.monthPicker.child("table").setSize(A);this.mpSelMonth=(this.activeDate||this.value).getMonth();this.updateMPMonth(this.mpSelMonth);this.monthPicker.slideIn("t",{duration:0.2})}},onDateDblClick:function(F,C){F.stopEvent();var D=new Ext.Element(C),B;if(D.is("button.x-date-mp-cancel")){this.hideDatePicker()}else{if(D.is("a.x-date-mp-prev")){this.updateMPYear(this.mpyear-10)}else{if(D.is("a.x-date-mp-next")){this.updateMPYear(this.mpyear+10)}}}if((B=D.up("td.x-date-mp-month",2))){var E=parseInt(B.dom.xmonth);var A=new Date((this.activeDate||this.value).getFullYear(),E,(this.activeDate||this.value).getDate());while(A.getMonth()>E){A.setDate(A.getDate()-1)}this.update(A);this.hideDatePicker()}else{if((B=D.up("td.x-date-mp-year",2))){this.update(new Date(B.dom.xyear,(this.activeDate||this.value).getMonth(),(this.activeDate||this.value).getDate()));this.hideDatePicker()}}},hideDatePicker:function(A){if(this.monthPicker){if(A===true){this.monthPicker.hide()}else{this.monthPicker.slideOut("t",{duration:0.2})}}if(this.yearPicker){if(A===true){this.yearPicker.hide()}else{this.yearPicker.slideOut("t",{duration:0.2})}}},createYearPicker:function(){var C=false;if(!this.yearPicker.dom.firstChild){C=true}var A=['<table border="0" cellspacing="0">'];for(var B=0;B<6;B++){A.push(B===0?'<td class="x-date-mp-ybtn" align="center"><a class="x-date-mp-prev"></a></td><td class="x-date-mp-ybtn" align="center"><a class="x-date-mp-next"></a></td></tr>':'<td class="x-date-mp-year"><a href="#"></a></td><td class="x-date-mp-year"><a href="#"></a></td></tr>')}A.push('<tr class="x-date-mp-btns"><td colspan="4">','</button><button type="button" class="x-date-mp-cancel">',this.cancelText,"</button></td></tr>","</table>");this.yearPicker.update(A.join(""));if(C){this.mon(this.yearPicker,"click",this.onDateDblClick,this);this.mon(this.yearPicker,"dblclick",this.onDateDblClick,this)}this.mpMonths=this.yearPicker.select("td.x-date-mp-month");this.mpYears=this.yearPicker.select("td.x-date-mp-year")},showYearPicker:function(){if(!this.disabled){this.createYearPicker();var A=this.el.getSize();this.yearPicker.setSize(A);this.yearPicker.child("table").setSize(A);this.mpSelYear=(this.activeDate||this.value).getFullYear();this.updateMPYear(this.mpSelYear);this.yearPicker.slideIn("t",{duration:0.2})}},disableTimeState:function(){if(this.timeType==3){this.minuteSpiner.setValue(0);this.secondSpiner.setValue(0);this.timeTable.rows[0].cells[3].style.display="none";this.timeTable.rows[0].cells[4].style.display="none";this.timeTable.rows[0].cells[5].style.display="none";this.timeTable.rows[0].cells[6].style.display="none"}else{if(this.timeType==2){this.secondSpiner.setValue(0);this.timeTable.rows[0].cells[5].style.display="none";this.timeTable.rows[0].cells[6].style.display="none"}}},selectToday:function(){var A=new Date().clearTime();A.tdate=new Date();if(this.timeType==3){A.tdate.setMinutes(0);A.tdate.setSeconds(0)}else{if(this.timeType==2){A.tdate.setSeconds(0)}}this.setValue(A);this.fireEvent("select",this,this.value)},selectDateTime:function(){var B=this.activeDate;if(this.activeDateDisabled(this.activeDate)){B=this.value}B.tdate=B.clone();var D=this.hourSpiner.getValue();if(isNaN(D)||D<0||D>23){this.hourSpiner.setValue(23)}var A=this.minuteSpiner.getValue();if(isNaN(A)||A<0||A>59){this.minuteSpiner.setValue(59)}var C=this.secondSpiner.getValue();if(isNaN(C)||C<0||C>59){this.secondSpiner.setValue(59)}B.tdate.setHours(this.hourSpiner.getValue(),this.minuteSpiner.getValue(),this.secondSpiner.getValue());this.setValue(B);this.fireEvent("select",this,this.value)},update:function(a,U){var A=this.activeDate;this.activeDate=a;if(!U&&A&&this.el){var K=a.getTime();if(A.getMonth()==a.getMonth()&&A.getFullYear()==a.getFullYear()){this.cells.removeClass("x-date-selected");this.cells.each(function(d){if(d.dom.firstChild.dateValue==K){d.addClass("x-date-selected");return false}});return }}var G=a.getDaysInMonth();var L=a.getFirstDateOfMonth();var D=L.getDay()-this.startDay;if(D<=this.startDay){D+=7}var V=a.add("mo",-1);var E=V.getDaysInMonth()-D;var C=this.cells.elements;var M=this.textNodes;G+=D;var R=86400000;var X=(new Date(V.getFullYear(),V.getMonth(),E)).clearTime();var W=new Date().clearTime().getTime();var P=a.clearTime().getTime();var O=this.minDate?this.minDate.clearTime():Number.NEGATIVE_INFINITY;var S=this.maxDate?this.maxDate.clearTime():Number.POSITIVE_INFINITY;var Z=this.disabledDatesRE;var N=this.disabledDatesText;var e=this.disabledDays?this.disabledDays.join(""):false;var Y=this.disabledDaysText;var T=this.format;if(this.showToday){var I=new Date().clearTime();var B=(I<O||I>S||(Z&&T&&Z.test(I.dateFormat(T)))||(e&&e.indexOf(I.getDay())!=-1));this.todayBtn.setDisabled(B);this.todayKeyListener[B?"disable":"enable"]()}var H=function(i,d){d.title="";var g=X.getTime();d.firstChild.dateValue=g;if(g==W){d.className+=" x-date-today";d.title=i.todayText}if(g==P){d.className+=" x-date-selected";setTimeout(function(){try{d.firstChild.focus()}catch(j){}},50)}if(g<O){d.className=" x-date-disabled";d.title=i.minText;return }if(g>S){d.className=" x-date-disabled";d.title=i.maxText;return }if(e){if(e.indexOf(X.getDay())!=-1){d.title=Y;d.className=" x-date-disabled"}}if(Z&&T){var h=X.dateFormat(T);if(Z.test(h)){d.title=N.replace("%0",h);d.className=" x-date-disabled"}}};var Q=0;for(;Q<D;Q++){M[Q].innerHTML=(++E);X.setDate(X.getDate()+1);C[Q].className="x-date-prevday";H(this,C[Q])}for(;Q<G;Q++){intDay=Q-D+1;M[Q].innerHTML=(intDay);X.setDate(X.getDate()+1);C[Q].className="x-date-active";H(this,C[Q])}var b=0;for(;Q<42;Q++){M[Q].innerHTML=(++b);X.setDate(X.getDate()+1);C[Q].className="x-date-nextday";H(this,C[Q])}this.ybtn.setText(a.getFullYear());this.mbtn.setText(this.monthNames[a.getMonth()]);if(!this.internalRender){var F=this.el.dom.firstChild;var J=F.offsetWidth;this.el.setWidth(J+this.el.getBorderWidth("lr"));Ext.fly(F).setWidth(J);this.internalRender=true;if(Ext.isOpera&&!this.secondPass){F.rows[0].cells[1].style.width=(J-(F.rows[0].cells[0].offsetWidth+F.rows[0].cells[2].offsetWidth))+"px";this.secondPass=true;this.update.defer(10,this,[a])}}},beforeDestroy:function(){if(this.rendered){if(this.keyNav){this.keyNav.disable();this.keyNav=null}Ext.destroy(this.leftcr,this.rightcr,this.eventEl,this.mbtn,this.ybtn,this.todayBtn,this.okBtn,this.hourSpiner,this.minuteSpiner,this.secondSpiner,this.monthPicker,this.yearPicker);this.leftcr=null;this.rightcr=null;this.eventEl=null;this.mbtn=null;this.ybtn=null;this.todayBtn=null;this.okBtn=null;this.hourSpiner=null;this.minuteSpiner=null;this.secondSpiner=null;this.monthPicker=null;this.yearPicker=null}}});Artery.plugin.FaDateDate=Ext.extend(Ext.form.DateField,{allowDomMove:false,showTime:false,timeType:1,margin:true,format:"Y-m-d",formatError:"YYYY-mm-dd",altFormats:"Y-n-j|m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|Ymd|ymd|md|mdy|mdY|d|Y-m-d",defaultAutoCreate:{tag:"input",type:"text",size:"24",autocomplete:"off"},editable:true,getTrigger:Artery.plugin.TwinTriggerField.prototype.getTrigger,initTrigger:Artery.plugin.TwinTriggerField.prototype.initTrigger,initHTMLTrigger:Artery.plugin.TwinTriggerField.prototype.initHTMLTrigger,initComponentTigger:Artery.plugin.TwinTriggerField.prototype.initComponentTigger,hideTrg:Artery.plugin.TwinTriggerField.prototype.hideTrg,showTrg:Artery.plugin.TwinTriggerField.prototype.showTrg,setFieldEditable:Artery.plugin.TwinTriggerField.prototype.setFieldEditable,read:Artery.plugin.TwinTriggerField.prototype.read,edit:Artery.plugin.TwinTriggerField.prototype.edit,onTrigger1Click:Artery.plugin.TwinTriggerField.prototype.onTrigger1Click,afterRender:Artery.plugin.TwinTriggerField.prototype.afterRender,setTriggerState:Artery.plugin.TwinTriggerField.prototype.setTriggerState,onHide:Artery.plugin.TwinTriggerField.prototype.onHide,onShow:Artery.plugin.TwinTriggerField.prototype.onShow,initEvents:Artery.plugin.TwinTriggerField.prototype.initEvents,initClearValueTaskEvent:Artery.plugin.TwinTriggerField.prototype.initClearValueTaskEvent,getPositionEl:Artery.plugin.TwinTriggerField.prototype.getPositionEl,trigger1Class:"x-form-clear-trigger",reset:function(){if(!this.rendered){return }if(this.originalValue+""==this.getValueText()+""){return }this.clearInvalid();this.setValueNoValid(this.originalValue)},initComponent:function(){if(this.margin){this.defaultAutoCreate.style="margin:0;"}this.adjustFormat();this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger2Class}]};if(this.showTime){this.defaultAutoCreate={tag:"input",type:"text",size:"24",autocomplete:"off"};if(this.margin){this.defaultAutoCreate.style="margin:0;"}}Artery.plugin.FaDateDate.superclass.initComponent.call(this);this.initComponentTigger();Ext.EventManager.on(window,"beforeunload",function(){try{if(this.keyNav){try{this.keyNav.disable();this.keyNav=null}catch(A){}}if(this.menu){if(this.menu.destroy){try{this.menu.destroy()}catch(A){}}this.menu=null}}catch(A){}},this)},adjustFormat:function(){if(this.customFormat){this.format=this.customFormat;if(this.showTime){this.formatError="YYYY-mm-dd hh:MM:ss"}else{this.formatError="YYYY-mm-dd"}}else{if(this.showTime){this.format="Y-m-d H:i:s";this.formatError="YYYY-mm-dd hh:MM:ss"}}},getFormatError:function(){if(this.customFormatError){return this.customFormatError}if(this.formatError){return this.formatError}return this.format},validateValue:function(E){E=this.formatDate(E);if(!Ext.form.DateField.superclass.validateValue.call(this,E)){return false}if(E.length<1){return true}var C=E;E=this.parseDate(E);if(!E){this.markInvalid(String.format(this.invalidText,C,this.getFormatError()));return false}var F=E.getTime();if(this.minValue&&F<this.minValue.getTime()){this.markInvalid(String.format(this.minText,this.formatDate(this.minValue)));return false}if(this.maxValue&&F>this.maxValue.getTime()){this.markInvalid(String.format(this.maxText,this.formatDate(this.maxValue)));return false}if(this.disabledDays){var A=E.getDay();for(var B=0;B<this.disabledDays.length;B++){if(A===this.disabledDays[B]){this.markInvalid(this.disabledDaysText);return false}}}var D=this.formatDate(E);if(this.ddMatch&&this.ddMatch.test(D)){this.markInvalid(String.format(this.disabledDatesText,D));return false}return true},parseDate:function(D){if(!D||Ext.isDate(D)){return D}var B=Date.parseDate(D,this.format,true);if(!B&&this.altFormats){if(!this.altFormatsArray){this.altFormatsArray=this.altFormats.split("|")}for(var C=0,A=this.altFormatsArray.length;C<A&&!B;C++){B=Date.parseDate(D,this.altFormatsArray[C],true)}}return B},onBlur:function(){this.beforeBlur();if(!Ext.isOpera&&this.focusClass){this.el.removeClass(this.focusClass)}this.hasFocus=false;if(this.validationEvent!==false&&this.validateOnBlur&&this.validationEvent!="blur"){this.validate()}},onSelect:function(A,D){var C=this.getValue();Artery.plugin.FaDateDate.superclass.onSelect.call(this,A,D);var B=this.getValue();if(String(C)!==String(B)){this.startValue=this.getValue();this.fireEvent("change",this,B,C)}},onRender:function(B,A){Artery.plugin.TwinTriggerField.prototype.onRender.call(this,B,A);if(!this.readOnly){if(this.editable){this.el.dom.readOnly=false}else{this.el.dom.readOnly=true}}this.keyNav=new Ext.KeyNav(this.el,{down:function(C){this.onTriggerClick(C)},scope:this});this.mon(this.el,"keydown",this.onKeyDown,this)},onKeyDown:function(B){if(B.keyCode==B.ENTER){var A=this.parseDate(this.getRawValue());if(A){this.setValue(A)}}},initDefaultOnChange:function(C,B,A){if(this.data){if(Ext.isEmpty(B)){this.data.value=""}else{this.data.value=B.format(this.format)}}},setValue:function(A){var B;if(A){if(A.tdate!=null){A=A.tdate.clone()}if(Ext.isDate(A)){B=this.formatDate(A);A=this.formatValueDate(A)}else{B=this.formatDate(this.parseValueDate(A))}}Artery.plugin.FaDateDate.superclass.setValue.call(this,B);Artery.plugin.TwinTriggerField.prototype.setValue.call(this,A,B)},getValue:function(){return this.value||""},getDate:function(){return this.parseDate(Ext.form.DateField.superclass.getValue.call(this))||""},parseValueDate:function(B){var A=Date.parseDate(B,"Y-m-d");if(A){return A}A=Date.parseDate(B,"Y-m-d H:i:s");if(A){return A}return this.parseDate(B)},formatValueDate:function(B){var A;if(this.showTime){A=B.dateFormat("Y-m-d H:i:s")}else{A=B.dateFormat("Y-m-d")}if(A){return A}else{return this.formatDate(B)}},getFormateValue:function(A){return this.el.dom.value},createMenu:function(A){var B=new Ext.menu.DateMenu({shadow:false});return B},setPickerValue:function(A){var C=A.field.maxValue;var B=new Date();if(!Ext.isEmpty(C)&&C<B){B.setFullYear(C.getFullYear(),C.getMonth(),C.getDate())}A.field.menu.picker.setValue(A.field.getDate()||B,true)},onTrigger2Click:function(A){if(this.disabled||this.readOnly){return }if(this.menu==null){this.menu=Artery.pwin.Artery.plugin.FaDateDate.prototype.createMenu({field:this});this.menu.on("hide",function(){this.validate()},this)}Ext.apply(this.menu.picker,{showTime:this.showTime,timeType:this.timeType,minDate:this.minValue?this.minValue.clone():null,maxDate:this.maxValue?this.maxValue.clone():null,disabledDatesRE:this.ddMatch,disabledDatesText:this.disabledDatesText,disabledDays:this.disabledDays,disabledDaysText:this.disabledDaysText,format:this.format,minText:String.format(this.minText,this.formatDate(this.minValue)),maxText:String.format(this.maxText,this.formatDate(this.maxValue))});this.menu.on(Ext.apply({},this.menuListeners,{scope:this}));Artery.pwin.Artery.plugin.FaDateDate.prototype.setPickerValue({field:this});if(!this.menu.el){this.menu.render()}if(A){this.menu.showXY(Artery.getXY(A.browserEvent,this.menu.el))}this.menuEvents("on");(function(){this.menu.picker.eventEl.focus()}).defer(100,this)},onTriggerClick:function(A){this.onTrigger2Click(A)},beforeBlur:function(){var A=this.parseDate(this.getRawValue());if(A){this.setValue(A)}}});Ext.reg("apfadatedate",Artery.plugin.FaDateDate);Ext.override(Ext.menu.Menu,{showXY:function(B,C,A){this.parentMenu=A;if(!this.el){this.render()}this.showAt(B,A,false)}});Ext.apply(Date,{xf:function(B){var A=Array.prototype.slice.call(arguments,1);return B.replace(/\{(\d+)\}/g,function(C,D){return A[D]})},createParser:function(){var A=["var dt, y, m, d, h, i, s, ms, o, z, zz, u, v,","def = Date.defaults,","results = String(input).match(Date.parseRegexes[{0}]);","if(results){","{1}","if(u != null){","v = new Date(u * 1000);","}else{","dt = (new Date()).clearTime();","y = y !== undefined ? y : Ext.num(def.y, dt.getFullYear());","m = m !== undefined ? m : Ext.num(def.m - 1, dt.getMonth());","d = d !== undefined ? d : Ext.num(def.d, dt.getDate());","h  = h || Ext.num(def.h, dt.getHours());","i  = i || Ext.num(def.i, dt.getMinutes());","s  = s || Ext.num(def.s, dt.getSeconds());","ms = ms || Ext.num(def.ms, dt.getMilliseconds());","if(z >= 0 && y >= 0){","v = new Date(y, 0, 1, h, i, s, ms);","v = !strict? v : (strict === true && (z <= 364 || (v.isLeapYear() && z <= 365))? v.add(Date.DAY, z) : null);","}else if(strict === true && !Date.isValid(y, m + 1, d, h, i, s, ms)){","v = null;","}else{","v = new Date(y, m, d, h, i, s, ms);","}","}","}","if(v){","if(zz != null){","v = v.add(Date.SECOND, -v.getTimezoneOffset() * 60 - zz);","}else if(o){","v = v.add(Date.MINUTE, -v.getTimezoneOffset() + (sn == '+'? -1 : 1) * (hr * 60 + mn));","}","}","return v;"].join("\n");return function(I){var C=Date.parseRegexes.length,J=1,D=[],H=[],G=false,B="";for(var F=0;F<I.length;++F){B=I.charAt(F);if(!G&&B=="\\"){G=true}else{if(G){G=false;H.push(String.escape(B))}else{var E=Date.formatCodeToRegex(B,J);J+=E.g;H.push(E.s);if(E.g&&E.c){D.push(E.c)}}}}Date.parseRegexes[C]=new RegExp("^"+H.join("")+"$","i");Date.parseFunctions[I]=new Function("input","strict",this.xf(A,C,D.join("")))}}()});Artery.plugin.FaFieldSet=Ext.extend(Artery.plugin.BaseContainer,{layout:"atylayout",afterRender:function(){Artery.plugin.FaFieldSet.superclass.afterRender.call(this);if(!Ext.isEmpty(this.comment)){this.tipEl=Ext.get("comment_"+this.id);if(this.tipEl){this.tipEl.on("click",Artery.showComment,this)}}},readAllSub:function(A){this.items.each(function(){if(!Ext.isTrue(A)&&this.readAllSub){this.readAllSub()}else{if(this.read){this.read()}}})},editAllSub:function(A){this.items.each(function(){if(!Ext.isTrue(A)&&this.editAllSub){this.editAllSub()}else{if(this.edit){this.edit()}}})},disableAllSub:function(A){this.items.each(function(){if(!Ext.isTrue(A)&&this.disableAllSub){this.disableAllSub()}else{if(this.disable){this.disable()}}})},enableAllSub:function(A){this.items.each(function(){if(!Ext.isTrue(A)&&this.enableAllSub){this.enableAllSub()}else{if(this.enable){this.enable()}}})}});Ext.reg("apfafieldset",Artery.plugin.FaFieldSet);Artery.plugin.FaHidden=Ext.extend(Ext.form.Hidden,{onRender:function(B,A){Artery.plugin.FaStringInput.prototype.onRender.call(this,B,A)},onDisable:function(){Artery.plugin.FaStringInput.prototype.onDisable.call(this)},onEnable:function(){Artery.plugin.FaStringInput.prototype.onEnable.call(this)},onHide:function(){},onShow:function(){}});Ext.reg("apfahidden",Artery.plugin.FaHidden);Artery.plugin.FaIdentity=Ext.extend(Ext.form.TextField,{allowDomMove:false,onlyParam:true,onRender:function(B,A){Ext.form.Field.superclass.onRender.call(this,B,A);if(Ext.get(this.id)){this.el=Ext.get(this.id)}},getContanerEl:function(){if(this.onlyParam){return null}return Artery.plugin.FaIdentity.superclass.getContanerEl.call(this)},onDisable:function(){Artery.plugin.FaStringInput.prototype.onDisable.call(this)},onEnable:function(){Artery.plugin.FaStringInput.prototype.onEnable.call(this)}});Ext.reg("apFaIdentity",Artery.plugin.FaIdentity);Artery.plugin.FaKindEditor=Ext.extend(Ext.form.TextField,{initComponent:function(){Artery.plugin.FaKindEditor.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.FaKindEditor.superclass.onRender.call(this);if(this.items.length==0){if(this.editorStyle=="default"){this.items=getItems().split(",")}else{this.allowUpload=false;if(this.items.length<2){this.items=getSimpleItems().split(",")}}}else{this.items=this.items.split(",")}if(this.imageUploadJson.length<2){this.imageUploadJson=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=uploadImg&formid="+this.formId+"&itemid="+this.id+"&itemType=apkindeditor"}if(this.fileManagerJson.length<2){this.fileManagerJson=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getImgList&formid="+this.formId+"&itemid="+this.id+"&itemType=apkindeditor"}this.htmlTags=getHtmlTags();KE.show({comp:this,oldHtml:this.oldHtml,required:this.required,id:this.id,skinsPath:this.scriptPath+"skins/",pluginsPath:this.scriptPath+"plugins/",items:this.items,minWidth:this.minWidth,minHeight:this.minHeight,filterMode:this.filterMode,htmlTags:this.htmlTags,resizeMode:this.resizeMode,skinType:this.skinType,wyswygMode:this.wyswygMode,cssPath:this.cssPath.split(","),minChangeSize:this.minChangeSize,loadStyleMode:this.loadStyleMode,allowFileManager:this.allowFileManager,imageUploadJson:this.imageUploadJson,fileManagerJson:this.fileManagerJson,referMethod:this.referMethod,newlineTag:this.newlineTag,allowUpload:this.allowUpload,dialogAlignType:this.dialogAlignType,shadowMode:this.shadowMode,allowPreviewEmoticons:this.allowPreviewEmoticons,useContextmenu:this.useContextmenu,syncType:this.syncType,tabIndex:this.tabIndex,afterCreate:function(){if(Ext.get(this.id).prev()){Ext.get(this.id).prev().child("td.ke-textarea-outer").setStyle("height","100%");Ext.get(this.id).prev().child("table.ke-textarea-table").setStyle("height","100%");Ext.get(this.id).prev().child("iframe.ke-iframe").setStyle("height","100%");Ext.get(this.id).prev().child("textarea.ke-textarea").setStyle("height","100%")}Artery.regItemEvent(this.comp,"afterCreate","afterCreateServer");KE.scriptPath=this.skinsPath;this.comp.isCreateKE=true},afterChange:function(){Artery.regItemEvent(this.comp,"onKeyupEvent","onKeyupServer")},afterFocus:function(){this.comp.oldHtml=KE.html(this.comp.id)},afterBlur:function(){this.comp.validate();Artery.regItemEvent(this.comp,"onChangeEvent","onChangeServer",{oldValue:this.comp.oldHtml,newValue:KE.html(this.comp.id)})}})},onlyValidEvent:function(){return Artery.regItemEvent(this,"onValidEvent","onValidServer",{value:KE.html(this.id)})},validate:function(){if(!this.isCreateKE){return true}return this.validateValue()},validateValue:function(){if(this.onValidEvent){var A=this.onlyValidEvent();if(A!==true){this.markInvalid(A);return false}}if(this.allowBlankWhenRequired){if(KE.html(this.id).length==0){this.markInvalid(this.blankText);return false}}else{if(this.required&&KE.isEmpty(this.id)){this.markInvalid(this.blankText);return false}}if(this.maxLength&&KE.count(this.id,"html")>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));return false}if(this.minLength&&KE.count(this.id,"html")<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));return false}this.clearInvalid();return true},markInvalid:function(A){if(Ext.get(this.id).prev()){this.fireEvent("invalid",this.getActionEl(),A)}},getActionEl:function(){if(Ext.get(this.id).prev()){return Ext.get(this.id).prev()}return },getErrorTipEl:function(){return Ext.get(this.id).prev()},getHtml:function(){return KE.html(this.id)},setHtml:function(A){KE.html(this.id,A)},setValue:function(A){Artery.plugin.FaKindEditor.superclass.setValue.call(this,A);this.setHtml(A)},getText:function(){return KE.text(this.id)},setText:function(A){KE.text(this.id,A)},getSelectHtml:function(){return KE.selectedHtml(this.id)},getCount:function(A){return KE.count(this.id,A)},isEmpty:function(){return KE.isEmpty(this.id)},insertHtml:function(A){KE.insertHtml(this.id,A)},appendHtml:function(A){KE.appendHtml(this.id,A)},focus:function(){KE.focus(this.id)},blur:function(){KE.blur(this.id)},sync:function(){KE.sync(this.id)},getBrowser:function(){return KE.browser},getIframeDoc:function(){return KE.g[this.id].iframeDoc},getKeSel:function(){return KE.g[this.id].keSel},getSel:function(){return KE.g[this.id].sel},getKeRange:function(){return KE.g[this.id].keRange},getRange:function(){return KE.g[this.id].range}});Ext.reg("apkindeditor",Artery.plugin.FaKindEditor);function getItems(){var A;A="source,|,fullscreen,undo,redo,print,cut,copy,paste,";A+="plainpaste,wordpaste,|,justifyleft,justifycenter,justifyright,";A+="justifyfull,insertorderedlist,insertunorderedlist,indent,outdent,subscript,";A+="superscript,|,selectall,-,";A+="title,fontname,fontsize,|,textcolor,bgcolor,bold,";A+="italic,underline,strikethrough,removeformat,|,image,";A+="flash,media,advtable,hr,emoticons,link,unlink,|,about";return A}function getSimpleItems(){var A;A="fontname,fontsize,|,textcolor,bgcolor,bold,italic,underline,";A+="removeformat,|,justifyleft,justifycenter,justifyright,insertorderedlist,";A+="insertunorderedlist,|,emoticons,image,link";return A}function getHtmlTags(){res="{";res+="font : ['color', 'size', 'face', '.background-color'],";res+="span : ['style'],";res+="div : ['class', 'align', 'style'],";res+="table: ['class', 'border', 'cellspacing', 'cellpadding', 'width', 'height', 'align', 'style'],";res+="'td,th': ['class', 'align', 'valign', 'width', 'height', 'colspan', 'rowspan', 'bgcolor', 'style'],";res+="a : ['class', 'href', 'target', 'name', 'style'],";res+="embed : ['src', 'width', 'height', 'type', 'loop', 'autostart', 'quality',";res+="'style', 'align', 'allowscriptaccess', '/'],";res+="img : ['src', 'width', 'height', 'border', 'alt', 'title', 'align', 'style', '/'],";res+="hr : ['class', '/'],";res+="br : ['/'],";res+="'p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : ['align', 'style'],";res+="'tbody,tr,strong,b,sub,sup,em,i,u,strike' : []";res+="}";return res}Artery.plugin.FaKindEditorDisplay=Ext.extend(Artery.plugin.BaseContainer,{initComponent:function(){Artery.plugin.FaKindEditorDisplay.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.FaKindEditorDisplay.superclass.onRender.call(this,B,A);this.iframeEl=Ext.get(this.id+"_iframe");var C=this.getIframeDoc();C.open();C.write("<html>");C.write("<head>");C.write('<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>');C.write('<link href="'+sys.getContextPath()+'/artery/components/kindeditor-3.5.5/skins/common/editor.css" rel="stylesheet" type="text/css"/>');C.write("</head>");C.write("<body class='ke-content'>");C.write(this.value);C.write("</body>");C.write("</html>");C.close();Ext.EventManager.on(window,"load",function(){var D=this.getIframeDoc();if(D.body.scrollHeight>D.body.offsetHeight){this.el.setHeight(D.body.scrollHeight)}},this)},getIframeDoc:function(){return this.iframeEl.dom.contentDocument||this.iframeEl.dom.contentWindow.document}});Ext.reg("apkindeditordisplay",Artery.plugin.FaKindEditorDisplay);(function(c){if(window.KindEditor===c){var b={version:"3.5.5 (2011-05-22)"};b.scriptPath=function(){for(var a=document.getElementsByTagName("script"),d=0,b=a.length;d<b;d++){var k=a[d].src;if(k&&k.match(/kindeditor[\w\-\.]*\.js/)){return k.substring(0,k.lastIndexOf("/")+1)}}return""}();b.browser=function(){var a=navigator.userAgent.toLowerCase();return{VERSION:a.match(/(msie|firefox|webkit|opera)[\/:\s](\d+)/)?RegExp.$2:"0",IE:a.indexOf("msie")>-1&&a.indexOf("opera")==-1,GECKO:a.indexOf("gecko")>-1&&a.indexOf("khtml")==-1,WEBKIT:a.indexOf("applewebkit")>-1,OPERA:a.indexOf("opera")>-1}}();b.setting={wyswygMode:!0,loadStyleMode:!0,resizeMode:2,filterMode:!1,autoSetDataMode:!1,shadowMode:!0,useContextmenu:!0,urlType:"",skinType:"default",syncType:"form",newlineTag:"p",dialogAlignType:"page",cssPath:"",skinsPath:b.scriptPath+"skins/",pluginsPath:b.scriptPath+"plugins/",minWidth:200,minHeight:100,minChangeSize:5,toolbarLineHeight:24,statusbarHeight:11,items:["source","|","fullscreen","undo","redo","print","cut","copy","paste","plainpaste","wordpaste","|","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","|","selectall","-","title","fontname","fontsize","|","textcolor","bgcolor","bold","italic","underline","strikethrough","removeformat","|","image","flash","media","advtable","hr","emoticons","link","unlink","|","about"],colorTable:[["#E53333","#E56600","#FF9900","#64451D","#DFC5A4","#FFE500"],["#009900","#006600","#99BB00","#B8D100","#60D978","#00D5FF"],["#337FE5","#003399","#4C33E5","#9933E5","#CC33E5","#EE33EE"],["#FFFFFF","#CCCCCC","#999999","#666666","#333333","#000000"]],noEndTags:["br","hr","img","area","col","embed","input","param"],inlineTags:["b","del","em","font","i","span","strike","strong","sub","sup","u"],endlineTags:["br","hr","table","tbody","td","tr","th","div","p","ol","ul","li","blockquote","h1","h2","h3","h4","h5","h6","script","style","marquee"],htmlTags:{font:["color","size","face",".background-color"],span:[".color",".background-color",".font-size",".font-family",".background",".font-weight",".font-style",".text-decoration",".vertical-align"],div:["align",".border",".margin",".padding",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".background",".font-style",".text-decoration",".vertical-align",".margin-left"],table:["border","cellspacing","cellpadding","width","height","align","bordercolor",".padding",".margin",".border","bgcolor",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".font-style",".text-decoration",".background",".width",".height"],"td,th":["align","valign","width","height","colspan","rowspan","bgcolor",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".font-style",".text-decoration",".vertical-align",".background"],a:["href","target","name"],embed:["src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess","/"],img:["src","width","height","border","alt","title",".width",".height","/"],hr:["/"],br:["/"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["align",".text-align",".color",".background-color",".font-size",".font-family",".background",".font-weight",".font-style",".text-decoration",".vertical-align",".text-indent",".margin-left"],"tbody,tr,strong,b,sub,sup,em,i,u,strike":[]},mediaTypes:{rm:"audio/x-pn-realaudio-plugin",flash:"application/x-shockwave-flash",media:"video/x-ms-asf-plugin"},afterTab:function(a){b.util.setSelection(a);b.util.insertHtml(a,"&nbsp;&nbsp;&nbsp;&nbsp;")}};b.g={};b.plugin={};b.$=function(a,d){return(d||document).getElementById(a)};b.$$=function(a,d){return(d||document).createElement(a)};b.event={add:function(a,d,f,k){a.addEventListener?a.addEventListener(d,f,!1):a.attachEvent&&a.attachEvent("on"+d,f);k!==c&&b.g[k].eventStack.push({el:a,type:d,fn:f})},remove:function(a,d,f,k){a.removeEventListener?a.removeEventListener(d,f,!1):a.detachEvent&&a.detachEvent("on"+d,f);if(k!==c){for(var k=b.g[k].eventStack,h=0,e=k.length;h<e;h++){var i=k[h];i&&a===i.el&&d===i.type&&f===i.fn&&delete k[h]}}},stopPropagation:function(a){a.stopPropagation&&a.stopPropagation();if(a.cancelBubble!==c){a.cancelBubble=!0}},preventDefault:function(a){a.preventDefault&&a.preventDefault();if(a.returnValue!==c){a.returnValue=!1}},stop:function(a){this.stopPropagation(a);this.preventDefault(a)},bind:function(a,d,f,k){this.add(a,d,function(a){f(a);b.event.stop(a);return !1},k)},input:function(a,d,f){function k(a){window.setTimeout(function(){d(a)},1)}this.add(a,"keyup",function(a){if(!a.ctrlKey&&!a.altKey&&(a.keyCode<16||a.keyCode>18)&&a.keyCode!=116){return d(a),b.event.stop(a),!1}},f);a=a.nodeName=="#document"?a.body:a;this.add(a,"paste",k,f);this.add(a,"cut",k,f)},ctrl:function(a,d,f,k){d=d.toString().match(/^\d{2,}$/)?d:d.toUpperCase().charCodeAt(0);this.add(a,"keydown",function(a){if(a.ctrlKey&&a.keyCode==d&&!a.shiftKey&&!a.altKey){return f(a),b.event.stop(a),!1}},k)},ready:function(a,d,b,k){var d=d||window,b=b||document,c=!1,e=function(){c||(c=!0,a())};if(b.addEventListener){this.add(b,"DOMContentLoaded",e,k)}else{if(b.attachEvent&&(this.add(b,"readystatechange",function(){b.readyState=="complete"&&e()},k),b.documentElement.doScroll&&typeof d.frameElement==="undefined")){var i=function(){if(!c){try{b.documentElement.doScroll("left")}catch(a){window.setTimeout(i,0);return }e()}};i()}}this.add(d,"load",e,k)}};b.each=function(a,d){for(var b in a){a.hasOwnProperty(b)&&d(b,a[b])}};b.eachNode=function(a,d){var f=function(a){if(b.util.getNodeType(a)!=1){return !0}for(a=a.firstChild;a;){var c=a.nextSibling;if(!d(a)){return !1}if(!f(a)){return !1}a=c}return !0};f(a)};b.selection=function(a){this.keRange=this.range=this.sel=null;this.isControl=!1;var d=a.parentWindow||a.defaultView;this.init=function(){var f=a.selection?a.selection:d.getSelection(),c;try{c=f.rangeCount>0?f.getRangeAt(0):f.createRange()}catch(h){}c||(c=b.util.createRange(a));this.sel=f;this.range=c;var e,i,l;if(b.browser.IE){c.item?(this.isControl=!0,f=i=c.item(0),e=l=0):(this.isControl=!1,f=function(d){var f=c.duplicate();f.collapse(d);var h=f.parentElement(),e=h.childNodes;if(e.length==0){return{node:h,pos:0}}var g,i=0,l=!1,j=c.duplicate();b.util.moveToElementText(j,h);for(var p=0,v=e.length;p<v;p++){var d=e[p],t=j.compareEndPoints("StartToStart",f);if(t>0){l=!0}else{if(t==0){return d.nodeType==1?(f=new b.range(a),f.selectTextNode(d),{node:f.startNode,pos:0}):{node:d,pos:0}}}d.nodeType==1?(t=c.duplicate(),b.util.moveToElementText(t,d),j.setEndPoint("StartToEnd",t),l?i+=t.text.replace(/\r\n|\n|\r/g,"").length:i=0):d.nodeType==3&&typeof d.nodeValue==="string"&&(j.moveStart("character",d.nodeValue.length),i+=d.nodeValue.length);l||(g=d)}if(!l&&g.nodeType==1){return g=h.lastChild,{node:g,pos:g.nodeType==1?1:g.nodeValue.length}}j=c.duplicate();b.util.moveToElementText(j,h);j.setEndPoint("StartToEnd",f);i-=j.text.replace(/\r\n|\n|\r/g,"").length;return{node:g,pos:i}},e=f(!0),l=f(!1),f=e.node,e=e.pos,i=l.node,l=l.pos)}else{f=c.startContainer;e=c.startOffset;i=c.endContainer;l=c.endOffset;f.nodeType==1&&typeof f.childNodes[e]!="undefined"&&(f=f.childNodes[e],e=0);i.nodeType==1&&(l=l==0?1:l,typeof i.childNodes[l-1]!="undefined"&&(i=i.childNodes[l-1],l=i.nodeType==1?0:i.nodeValue.length));this.isControl=f.nodeType==1&&f===i&&c.startOffset+1==c.endOffset;if(f.nodeType==1&&i.nodeType==3&&l==0&&i.previousSibling){for(var j=i.previousSibling;j;){if(j===f){i=f;break}if(j.childNodes.length!=1){break}j=j.childNodes[0]}}if(c.collapsed){j=new b.range(a),j.setTextStart(f,e),i=j.startNode,l=j.startPos}}j=new b.range(a);j.setTextStart(f,e);j.setTextEnd(i,l);this.keRange=j};this.init();this.addRange=function(d){if(!(b.browser.GECKO&&b.browser.VERSION<3)){if(this.keRange=d,b.browser.IE){var c=function(c){var k=b.util.createRange(a),h=c?d.startNode:d.endNode;h.nodeType==1?(b.util.moveToElementText(k,h),k.collapse(c)):h.nodeType==3&&(k=b.util.getNodeStartRange(a,h),k.moveStart("character",c?d.startPos:d.endPos));return k};if(!this.range.item){var h=d.startNode;h==d.endNode&&b.util.getNodeType(h)==1&&b.util.getNodeTextLength(h)==0?(c=a.createTextNode(" "),h.appendChild(c),b.util.moveToElementText(this.range,h),this.range.collapse(!1),this.range.select(),h.removeChild(c)):(h.nodeType==3&&d.collapsed()?(this.range=c(!0),this.range.collapse(!0)):(this.range.setEndPoint("StartToStart",c(!0)),this.range.setEndPoint("EndToStart",c(!1))),this.range.select())}}else{h=function(a){for(var d=0;a;){a=a.previousSibling,d++}return --d};c=new b.range(a);c.setTextStart(d.startNode,d.startPos);c.setTextEnd(d.endNode,d.endPos);var e=c.startNode,i=c.endNode;b.util.getNodeType(e)==88?this.range.setStart(e.parentNode,h(c.startNode)):this.range.setStart(e,c.startPos);b.util.getNodeType(i)==88?this.range.setEnd(i.parentNode,h(c.endNode)+1):this.range.setEnd(i,c.endPos);this.sel.removeAllRanges();this.sel.addRange(this.range)}}};this.focus=function(){b.browser.IE&&this.range!=null&&this.range.select()}};b.range=function(a){this.endPos=this.endNode=this.startPos=this.startNode=null;this.getParentElement=function(){var d=function(a,d){for(;a&&(!a.tagName||a.tagName.toLowerCase()!="body");){if(a=a.parentNode,d(a)){break}}},f=[];d(this.startNode,function(a){f.push(a)});var c;d(this.endNode,function(a){if(b.util.inArray(a,f)){return c=a,!0}});return c?c:a.body};this.getNodeList=function(){var d=this,f=this.getParentElement(),c=[],h=!1;f==d.startNode&&(h=!0);h&&c.push(f);b.eachNode(f,function(f){f==d.startNode&&(h=!0);var e=new b.range(a);e.selectTextNode(f);var l=e.comparePoints("START_TO_END",d);if(l>0){return !1}else{if(l==0&&(e.startNode!==e.endNode||e.startPos!==e.endPos)){return !1}}h&&c.push(f);return !0});return c};this.comparePoints=function(d,f){var c=function(f,c,k,e){if(b.browser.IE){var j=function(d,f,c){var k=b.util.createRange(a),e=b.util.getNodeType(d);e==1?(b.util.moveToElementText(k,d),k.collapse(c)):e==3&&(k=b.util.getNodeStartRange(a,d),k.moveStart("character",f),k.collapse(!0));return k},m;m=d=="START_TO_START"||d=="START_TO_END"?j(f,c,!0):j(f,c,!1);f=d=="START_TO_START"||d=="END_TO_START"?j(k,e,!0):j(k,e,!1);return m.compareEndPoints("StartToStart",f)}else{m=b.util.createRange(a),m.selectNode(f),d=="START_TO_START"||d=="START_TO_END"?m.collapse(!0):m.collapse(!1),f=b.util.createRange(a),f.selectNode(k),d=="START_TO_START"||d=="END_TO_START"?f.collapse(!0):f.collapse(!1),c=m.compareBoundaryPoints(Range.START_TO_START,f)>0?1:m.compareBoundaryPoints(Range.START_TO_START,f)==0?c>e?1:c==e?0:-1:-1}return c};if(d=="START_TO_START"){return c(this.startNode,this.startPos,f.startNode,f.startPos)}if(d=="START_TO_END"){return c(this.startNode,this.startPos,f.endNode,f.endPos)}if(d=="END_TO_START"){return c(this.endNode,this.endPos,f.startNode,f.startPos)}if(d=="END_TO_END"){return c(this.endNode,this.endPos,f.endNode,f.endPos)}};this.collapsed=function(){return this.startNode===this.endNode&&this.startPos===this.endPos};this.collapse=function(a){a?this.setEnd(this.startNode,this.startPos):this.setStart(this.endNode,this.endPos)};this.setTextStart=function(a,f){var c=a;b.eachNode(a,function(a){if(b.util.getNodeType(a)==3&&a.nodeValue.length>0||b.util.getNodeType(a)==88){return c=a,f=0,!1}return !0});this.setStart(c,f)};this.setStart=function(a,b){this.startNode=a;this.startPos=b;if(this.endNode===null){this.endNode=a,this.endPos=b}};this.setTextEnd=function(a,f){var c=a;b.eachNode(a,function(a){if(b.util.getNodeType(a)==3&&a.nodeValue.length>0||b.util.getNodeType(a)==88){c=a,f=b.util.getNodeType(a)==3?a.nodeValue.length:0}return !0});this.setEnd(c,f)};this.setEnd=function(a,b){this.endNode=a;this.endPos=b;if(this.startNode===null){this.startNode=a,this.startPos=b}};this.selectNode=function(a){this.setStart(a,0);this.setEnd(a,a.nodeType==1?0:a.nodeValue.length)};this.selectTextNode=function(a){this.setTextStart(a,0);this.setTextEnd(a,a.nodeType==1?0:a.nodeValue.length)};this.extractContents=function(d){function f(a,b,f){var c=a.nodeValue.length,k=a.cloneNode(!0).splitText(b);k.splitText(f-b);if(d){var e=a;b>0&&(e=a.splitText(b));f<c&&e.splitText(f-b);m.push(e)}return k}function k(m,q){if(b.util.getNodeType(m)!=1){return !0}for(var p=m.firstChild;p;){p==g&&(n=!0);p==l&&(r=!0);var s=p.nextSibling,t=p.nodeType;if(t==1){if(t=new b.range(a),t.selectNode(p),t=t.comparePoints("END_TO_END",e),n&&(t<0||t==0&&o[p.nodeName.toLowerCase()]!==c)){t=p.cloneNode(!0),q.appendChild(t),d&&p.parentNode.removeChild(p)}else{if(t=p.cloneNode(!1),o[t.nodeName.toLowerCase()]===c&&(q.appendChild(t),!k(p,t))){return !1}}}else{if(t==3&&n){if(p==g&&p==l){return p=f(p,i,j),q.appendChild(p),!1}else{if(p==g){p=f(p,i,p.nodeValue.length),q.appendChild(p)}else{if(p==l){return p=f(p,0,j),q.appendChild(p),!1}else{p=f(p,0,p.nodeValue.length),q.appendChild(p)}}}}}p=s;if(r){return !1}}q.innerHTML.replace(/<.*?>/g,"")===""&&q.parentNode&&q.parentNode.removeChild(q);return !0}var d=d===c?!0:d,e=this,g=this.startNode,i=this.startPos,l=this.endNode,j=this.endPos,m=[],o=b.util.arrayToHash(b.setting.noEndTags),n=!1,r=!1,s=this.getParentElement(),q=s.cloneNode(!1);k(s,q);b.each(m,function(a,d){(d.nodeType!=3||d.nodeValue.length>0)&&d.parentNode.removeChild(d)});return q};this.cloneContents=function(){return this.extractContents(!1)};this.getText=function(){return this.cloneContents().innerHTML.replace(/<.*?>/g,"")}};b.cmd=function(a){this.doc=b.g[a].iframeDoc;this.keSel=b.g[a].keSel;this.keRange=b.g[a].keRange;this.mergeAttributes=function(a,f){for(var c=0,e=f.length;c<e;c++){b.each(f[c],function(f,c){if(f.charAt(0)=="."){var k=b.util.getJsKey(f.substr(1));a.style[k]=c}else{b.browser.IE&&b.browser.VERSION<8&&f=="class"&&(f="className"),a.setAttribute(f,c)}})}return a};this.wrapTextNode=function(a,f,c,e,g){var i=a.nodeValue.length,l=f==0&&c==i,j=new b.range(this.doc);j.selectTextNode(a.parentNode);return l&&a.parentNode.tagName==e.tagName&&j.comparePoints("END_TO_END",this.keRange)<=0&&j.comparePoints("START_TO_START",this.keRange)>=0?(this.mergeAttributes(a.parentNode,g),a):(e=e.cloneNode(!0),l?(f=a.cloneNode(!0),e.appendChild(f),a.parentNode.replaceChild(e,a),f):(l=a,f<c?(f>0&&(l=a.splitText(f)),c<i&&l.splitText(c-f),f=l.cloneNode(!0),e.appendChild(f),l.parentNode.replaceChild(e,l),f):(f<i?(l=a.splitText(f),l.parentNode.insertBefore(e,l)):l.nextSibling?l.parentNode.insertBefore(e,l.nextSibling):l.parentNode.appendChild(e),e)))};this.wrap=function(d,f){var f=f||[],c=this;this.keSel.focus();var e=b.$$(d,this.doc);this.mergeAttributes(e,f);var g=this.keRange,i=g.startNode,l=g.startPos,j=g.endNode,m=g.endPos,o=g.getParentElement();if(!b.util.inMarquee(o)){var n=!1;b.eachNode(o,function(d){d==i&&(n=!0);if(d.nodeType==1){if(d==i&&d==j){return b.util.inArray(d.tagName.toLowerCase(),b.g[a].noEndTags)?l>0?d.parentNode.appendChild(e):d.parentNode.insertBefore(e,d):d.appendChild(e),g.selectNode(e),!1}else{if(d==i){g.setStart(d,0)}else{if(d==j){return g.setEnd(d,0),!1}}}}else{if(d.nodeType==3&&n){if(d==i&&d==j){return d=c.wrapTextNode(d,l,m,e,f),g.selectNode(d),!1}else{if(d==i){d=c.wrapTextNode(d,l,d.nodeValue.length,e,f),g.setStart(d,0)}else{if(d==j){return d=c.wrapTextNode(d,0,m,e,f),g.setEnd(d,d.nodeType==1?0:d.nodeValue.length),!1}else{c.wrapTextNode(d,0,d.nodeValue.length,e,f)}}}}}return !0});this.keSel.addRange(g)}};this.getTopParent=function(a,f){for(var c=null;f;){if(f=f.parentNode,b.util.inArray(f.tagName.toLowerCase(),a)){c=f}else{break}}return c};this.splitNodeParent=function(a,f,c){var e=new b.range(this.doc);e.selectNode(a.firstChild);e.setEnd(f,c);f=e.extractContents();a.parentNode.insertBefore(f,a);return{left:f,right:a}};this.remove=function(a){var f=this.keRange,c=f.startNode,e=f.startPos,g=f.endNode,i=f.endPos;this.keSel.focus();if(!b.util.inMarquee(f.getParentElement())){var l=f.getText().replace(/\s+/g,"")==="";if(!l||b.browser.IE){var j=[];b.each(a,function(a){a!="*"&&j.push(a)});var m=this.getTopParent(j,c),o=this.getTopParent(j,g);if(m){var n=this.splitNodeParent(m,c,e);f.setStart(n.right,0);if(c==g&&b.util.getNodeTextLength(n.right)>0){f.selectNode(n.right),c=new b.range(this.doc),c.selectTextNode(n.left),e>0&&(i-=c.endNode.nodeValue.length),c.selectTextNode(n.right),g=c.startNode}}if(l){if(m=f.startNode,m.nodeType==1){if(m.nodeName.toLowerCase()=="br"){return }f.selectNode(m)}else{return }}else{o&&(e=this.splitNodeParent(o,g,i),f.setEnd(e.left,0),m==o&&f.setStart(e.left,0))}o=function(a,d){if(d.charAt(0)=="."){var f=b.util.getJsKey(d.substr(1));a.style[f]=""}else{b.browser.IE&&b.browser.VERSION<8&&d=="class"&&(d="className"),a.removeAttribute(d)}};e=f.getNodeList();f.setTextStart(f.startNode,f.startPos);f.setTextEnd(f.endNode,f.endPos);i=0;for(l=e.length;i<l;i++){if(m=e[i],m.nodeType==1){n=m.tagName.toLowerCase();if(a[n]){n=a[n];c=0;for(g=n.length;c<g;c++){if(n[c]=="*"){b.util.removeParent(m);break}else{o(m,n[c]);var r=[];m.outerHTML?(attrHash=b.util.getAttrList(m.outerHTML),b.each(attrHash,function(a,d){r.push({name:a,value:d})})):r=m.attributes;if(r.length==0){b.util.removeParent(m);break}else{if(r[0].name=="style"&&r[0].value===""){b.util.removeParent(m);break}}}}}if(a["*"]){n=a["*"];c=0;for(g=n.length;c<g;c++){o(m,n[c])}}}}try{this.keSel.addRange(f)}catch(s){}}}}};b.format={getUrl:function(a,d,f,e){if(!d){return a}d=d.toLowerCase();if(!b.util.inArray(d,["absolute","relative","domain"])){return a}f=f||location.protocol+"//"+location.host;if(e===c){var h=location.pathname.match(/^(\/.*)\//),e=h?h[1]:""}if(h=a.match(/^(\w+:\/\/[^\/]*)/)){if(h[1]!==f){return a}}else{if(a.match(/^\w+:/)){return a}}h=function(a){a=a.split("/");paths=[];for(var d=0,b=a.length;d<b;d++){var f=a[d];f==".."?paths.length>0&&paths.pop():f!==""&&f!="."&&paths.push(f)}return"/"+paths.join("/")};a.match(/^\//)?a=f+h(a.substr(1)):a.match(/^\w+:\/\//)||(a=f+h(e+"/"+a));if(d=="relative"){var g=function(d,b){if(a.substr(0,d.length)===d){for(var f=[],c=0;c<b;c++){f.push("..")}c=".";f.length>0&&(c+="/"+f.join("/"));e=="/"&&(c+="/");return c+a.substr(d.length)}else{if(f=d.match(/^(.*)\//)){return g(f[1],++b)}}},a=g(f+e,0).substr(2)}else{d=="absolute"&&a.substr(0,f.length)===f&&(a=a.substr(f.length))}return a},getHtml:function(a,d,f){var c=d?!0:!1,a=a.replace(/(<pre[^>]*>)([\s\S]*?)(<\/pre>)/ig,function(a,d,b,f){return d+b.replace(/<br[^>]*>/ig,"\n")+f}),e={},g=["xx-small","x-small","small","medium","large","x-large","xx-large"];c&&b.each(d,function(a,d){for(var f=a.split(","),c=0,k=f.length;c<k;c++){e[f[c]]=b.util.arrayToHash(d)}});var i=!1,l=b.util.arrayToHash(b.setting.noEndTags);b.util.arrayToHash(b.setting.inlineTags);var j=b.util.arrayToHash(b.setting.endlineTags),a=a.replace(/((?:\r\n|\n|\r)*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:]+="[^"]*")|(?:\s+[\w\-:]+='[^']*'))*)(\/)?>((?:\r\n|\n|\r)*)/g,function(a,d,m,o,u,w,p){var d=d||"",m=m||"",v=o.toLowerCase(),o=u||"",w=w?" "+w:"",p=p||"";v==="script"&&m!==""&&(i=!1);if(i){return a}v==="script"&&m===""&&(i=!0);if(c&&typeof e[v]=="undefined"){return""}w===""&&typeof l[v]!="undefined"&&(w=" /");if(v in j){if(m||w){p="\n"}}else{p&&(p=" ")}v!=="script"&&v!=="style"&&(d="");if(v==="font"){var t={},x="",o=o.replace(/\s*([\w\-:]+)=([^\s"'<>]+|"[^"]*"|'[^']*')/g,function(a,d,b){d=d.toLowerCase();b=(b||"").replace(/^["']|["']$/g,"");if(d==="color"){return t.color=b," "}if(d==="size"){return t["font-size"]=g[parseInt(b)-1]||""," "}if(d==="face"){return t["font-family"]=b," "}if(d==="style"){return x=b," "}return a});x&&!/;$/.test(x)&&(x+=";");b.each(t,function(a,d){d!==""&&(/\s/.test(d)&&(d="'"+d+"'"),x+=a+":"+d+";")});x&&(o+=' style="'+x+'"');v="span"}return o!==""?(o=o.replace(/\s*([\w\-:]+)=([^\s"'<>]+|"[^"]*"|'[^']*')/g,function(a,d,g){a=d.toLowerCase();g=g||"";if(c&&(a.charAt(0)==="."||a!=="style"&&typeof e[v][a]=="undefined")){return" "}if(g===""){g='""'}else{if(a==="style"){g=g.substr(1,g.length-2);g=g.replace(/\s*([^\s]+?)\s*:(.*?)(;|$)/g,function(a,d,f){a=d.toLowerCase();if(c&&typeof e[v].style=="undefined"&&typeof e[v]["."+a]=="undefined"){return""}f=b.util.trim(f);f=b.util.rgbToHex(f);return a+":"+f+";"});g=b.util.trim(g);if(g===""){return""}g='"'+g+'"'}b.util.inArray(a,["src","href"])&&(g.charAt(0)==='"'&&(g=g.substr(1,g.length-2)),g=b.format.getUrl(g,f));g.charAt(0)!=='"'&&(g='"'+g+'"')}return" "+a+"="+g+" "}),o=o.replace(/\s+(checked|selected|disabled|readonly)(\s+|$)/ig,function(a,d){var b=d.toLowerCase();if(c&&(b.charAt(0)==="."||typeof e[v][b]=="undefined")){return" "}return" "+b+'="'+b+'" '}),o=b.util.trim(o),(o=o.replace(/\s+/g," "))&&(o=" "+o),d+"<"+m+v+o+w+">"+p):d+"<"+m+v+w+">"+p});b.browser.IE||(a=a.replace(/<p><br\s+\/>\n<\/p>/ig,"<p>&nbsp;</p>"),a=a.replace(/<br\s+\/>\n<\/p>/ig,"</p>"));var a=a.replace(/\u200B/g,""),m=b.setting.inlineTags.join("|"),o=function(a){var d=a.replace(RegExp("<("+m+")[^>]*><\\/("+m+")>","ig"),function(a,d,b){return d==b?"":a});a!==d&&(d=o(d));return d};return b.util.trim(o(a))}};b.attr=function(a,d,f){b.browser.IE&&b.browser.VERSION<8&&d.toLowerCase()=="class"&&(d="className");f=""+f;a.setAttribute(d,f);f===""&&a.removeAttribute(d)};b.addClass=function(a,d){if(typeof a=="object"){var b=a.className;if(b){if((" "+b+" ").indexOf(" "+d+" ")<0){a.className=b+" "+d}}else{a.className=d}}else{typeof a=="string"&&(a=/\s+class\s*=/.test(a)?a.replace(/(\s+class=["']?)([^"']*)(["']?[\s>])/,function(a,b,f,c){return(" "+f+" ").indexOf(" "+d+" ")<0?f===""?b+d+c:b+f+" "+d+c:a}):a.substr(0,a.length-1)+' class="'+d+'">')}return a};b.removeClass=function(a,d){var f=a.className||"",f=" "+f+" ",d=" "+d+" ";if(f.indexOf(d)>=0){f=b.util.trim(f.replace(RegExp(d,"ig"),"")),f===""?(f=a.getAttribute("class")?"class":"className",a.removeAttribute(f)):a.className=f}return a};b.getComputedStyle=function(a,d){var f=a.ownerDocument,c=f.parentWindow||f.defaultView,f=b.util.getJsKey(d),e="";c.getComputedStyle?(c=c.getComputedStyle(a,null),e=c[f]||c.getPropertyValue(d)||a.style[f]):a.currentStyle&&(e=a.currentStyle[f]||a.style[f]);return e};b.getCommonAncestor=function(a,d){function f(a){for(;a;){if(a.nodeType==1&&a.tagName.toLowerCase()===d){return a}a=a.parentNode}return null}var c=a.range,e=a.keRange,g=e.startNode,e=e.endNode;if(b.util.inArray(d,["table","td","tr"])){b.browser.IE?c.item?c.item(0).nodeName.toLowerCase()===d&&(g=e=c.item(0)):(g=c.duplicate(),g.collapse(!0),c=c.duplicate(),c.collapse(!1),g=g.parentElement(),e=c.parentElement()):(g=c.cloneRange(),g.collapse(!0),c=c.cloneRange(),c.collapse(!1),g=g.startContainer,e=c.startContainer)}c=f(g);g=f(e);if(c&&g&&c===g){return c}return null};b.queryCommandValue=function(a,d){function f(){var b=a.queryCommandValue(d);typeof b!=="string"&&(b="");return b}var d=d.toLowerCase(),c="";if(d==="fontname"){c=f(),c=c.replace(/['"]/g,"")}else{if(d==="formatblock"){c=f();if(c===""){var e=new b.selection(a),g=b.getCommonAncestor(e,"h1");g||(g=b.getCommonAncestor(e,"h2"));g||(g=b.getCommonAncestor(e,"h3"));g||(g=b.getCommonAncestor(e,"h4"));g||(g=b.getCommonAncestor(e,"p"));if(g){c=g.nodeName}}c==="Normal"&&(c="p")}else{d==="fontsize"?(e=new b.selection(a),(g=b.getCommonAncestor(e,"span"))&&(c=b.getComputedStyle(g,"font-size"))):d==="textcolor"?(e=new b.selection(a),(g=b.getCommonAncestor(e,"span"))&&(c=b.getComputedStyle(g,"color")),c=b.util.rgbToHex(c),c===""&&(c="default")):d==="bgcolor"&&(e=new b.selection(a),(g=b.getCommonAncestor(e,"span"))&&(c=b.getComputedStyle(g,"background-color")),c=b.util.rgbToHex(c),c===""&&(c="default"))}}return c.toLowerCase()};b.util={getDocumentElement:function(a){a=a||document;return a.compatMode!="CSS1Compat"?a.body:a.documentElement},getDocumentHeight:function(a){a=this.getDocumentElement(a);return Math.max(a.scrollHeight,a.clientHeight)},getDocumentWidth:function(a){a=this.getDocumentElement(a);return Math.max(a.scrollWidth,a.clientWidth)},createTable:function(a){a=b.$$("table",a);a.cellPadding=0;a.cellSpacing=0;a.border=0;return{table:a,cell:a.insertRow(0).insertCell(0)}},loadStyle:function(a){var d=b.$$("link");d.setAttribute("type","text/css");d.setAttribute("rel","stylesheet");d.setAttribute("href",a);document.getElementsByTagName("head")[0].appendChild(d)},getAttrList:function(a){for(var d=/\s+(?:([\w\-:]+)|(?:([\w\-:]+)=([\w\-:]+))|(?:([\w\-:]+)="([^"]*)")|(?:([\w\-:]+)='([^']*)'))(?=(?:\s|\/|>)+)/g,b,c,e={};b=d.exec(a);){c=b[1]||b[2]||b[4]||b[6],b=b[1]||(b[2]?b[3]:b[4]?b[5]:b[7]),e[c]=b}return e},inArray:function(a,d){for(var b=0;b<d.length;b++){if(a==d[b]){return !0}}return !1},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},getJsKey:function(a){for(var d=a.split("-"),a="",b=0,c=d.length;b<c;b++){a+=b>0?d[b].charAt(0).toUpperCase()+d[b].substr(1):d[b]}return a},arrayToHash:function(a){for(var d={},b=0,c=a.length;b<c;b++){d[a[b]]=1}return d},escape:function(a){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a=a.replace(/"/g,"&quot;")},unescape:function(a){a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");a=a.replace(/&quot;/g,'"');return a=a.replace(/&amp;/g,"&")},getScrollPos:function(){var a,d;b.browser.IE||b.browser.OPERA?(d=this.getDocumentElement(),a=d.scrollLeft,d=d.scrollTop):(a=window.scrollX,d=window.scrollY);return{x:a,y:d}},getElementPos:function(a){var d=0,b=0;if(a.getBoundingClientRect){b=a.getBoundingClientRect(),a=this.getScrollPos(),d=b.left+a.x,b=b.top+a.y}else{d=a.offsetLeft;b=a.offsetTop;for(a=a.offsetParent;a;){d+=a.offsetLeft,b+=a.offsetTop,a=a.offsetParent}}return{x:d,y:b}},getCoords:function(a){a=a||window.event;return{x:a.clientX,y:a.clientY}},setOpacity:function(a,d){typeof a.style.opacity=="undefined"?a.style.filter=d==100?"":"alpha(opacity="+d+")":a.style.opacity=d==100?"":d/100},getIframeDoc:function(a){return a.contentDocument||a.contentWindow.document},rgbToHex:function(a){function d(a){a=parseInt(a).toString(16);return a.length>1?a:"0"+a}return a.replace(/rgb\s*?\(\s*?(\d+)\s*?,\s*?(\d+)\s*?,\s*?(\d+)\s*?\)/ig,function(a,b,c,e){return"#"+d(b)+d(c)+d(e)})},parseJson:function(a){var d;if(d=/\{[\s\S]*\}|\[[\s\S]*\]/.exec(a)){a=d[0]}d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+a+")")}throw"JSON parse error"},getParam:function(a,d){return a.match(RegExp("[?&]"+d+"=([^?&]+)","i"))?unescape(RegExp.$1):""},createRange:function(a){return a.body.createTextRange?a.body.createTextRange():a.createRange()},getNodeType:function(a){return a.nodeType==1&&b.util.inArray(a.tagName.toLowerCase(),b.setting.noEndTags)?88:a.nodeType},inMarquee:function(a){for(var d;a;){d=a.nodeName.toLowerCase();if(d=="marquee"||d=="select"){return !0}a=a.parentNode}return !1},moveToElementText:function(a,d){this.inMarquee(d)||a.moveToElementText(d)},getNodeTextLength:function(a){var d=b.util.getNodeType(a);if(d==1){return a.innerHTML.replace(/<.*?>/ig,"").length}else{if(d==3){return a.nodeValue.length}}},getNodeStartRange:function(a,d){var c=b.util.createRange(a),e=d.nodeType;if(e==1){return b.util.moveToElementText(c,d),c}else{if(e==3){for(var e=0,h=d.previousSibling;h;){if(h.nodeType==1){var g=b.util.createRange(a);b.util.moveToElementText(g,h);c.setEndPoint("StartToEnd",g);c.moveStart("character",e);return c}else{h.nodeType==3&&(e+=h.nodeValue.length)}h=h.previousSibling}b.util.moveToElementText(c,d.parentNode);c.moveStart("character",e);return c}}},removeParent:function(a){if(a.hasChildNodes){for(var d=a.firstChild;d;){var b=d.nextSibling;a.parentNode.insertBefore(d,a);d=b}}a.parentNode.removeChild(a)},pluginLang:function(a,d){b.each(b.lang.plugins[a],function(a,c){var e=b.$("lang."+a,d);e&&(e.parentNode.insertBefore(d.createTextNode(c),e),e.parentNode.removeChild(e))})},drag:function(a,d,c,e){var h=b.g[a];d.onmousedown=function(a){function d(a){if(t){var c=b.util.getCoords(a),f=b.util.getScrollPos(),a=parseInt(c.y-u-p+f.y),c=parseInt(c.x-w-v+f.x);e(n,r,s,q,a,c)}}function l(a){if(t){var d=b.util.getCoords(a,h.iframeDoc),a=parseInt(x.y+d.y-u-p),d=parseInt(x.x+d.x-w-v);e(n,r,s,q,a,d)}}function j(a){t=!1;m.releaseCapture&&m.releaseCapture();b.event.remove(document,"mousemove",d);b.event.remove(document,"mouseup",j);b.event.remove(h.iframeDoc,"mousemove",l);b.event.remove(h.iframeDoc,"mouseup",j);b.event.remove(document,"selectstart",z);b.event.stop(a);return !1}var m=this,a=a||window.event,o=b.util.getCoords(a),n=parseInt(c.style.top),r=parseInt(c.style.left),s=c.style.width,q=c.style.height;s.match(/%$/)&&(s=c.offsetWidth+"px");q.match(/%$/)&&(q=c.offsetHeight+"px");var s=parseInt(s),q=parseInt(q),u=o.y,w=o.x,o=b.util.getScrollPos(),p=o.y,v=o.x,t=!0,x=b.util.getElementPos(h.iframe),z=function(){return !1};b.event.add(document,"mousemove",d);b.event.add(document,"mouseup",j);b.event.add(h.iframeDoc,"mousemove",l);b.event.add(h.iframeDoc,"mouseup",j);b.event.add(document,"selectstart",z);m.setCapture&&m.setCapture();b.event.stop(a);return !1}},resize:function(a,d,c,e,h){h=typeof h=="undefined"?!0:h;a=b.g[a];if(a.container&&(!e||!(parseInt(d)<=a.minWidth||parseInt(c)<=a.minHeight))){if(h){a.container.style.width=d}a.container.style.height=c;d=parseInt(c)-a.toolbarHeight-a.statusbarHeight;if(d>=0){a.iframe.style.height=d+"px",a.newTextarea.style.height=((b.browser.IE&&b.browser.VERSION<8||document.compatMode!="CSS1Compat")&&d>=2?d-2:d)+"px"}}},hideLoadingPage:function(a){a=b.g[a].dialogStack;a=a[a.length-1];a.loading.style.display="none";a.iframe.style.display=""},showLoadingPage:function(a){a=b.g[a].dialogStack;a=a[a.length-1];a.loading.style.display="";a.iframe.style.display="none"},setDefaultPlugin:function(){for(var a=["selectall","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","bold","italic","underline","strikethrough"],d={bold:"B",italic:"I",underline:"U"},c=0;c<a.length;c++){var e=a[c],h={};if(e in d){h.init=function(a){return function(c){b.event.ctrl(b.g[c].iframeDoc,d[a],function(){b.plugin[a].click(c);b.util.focus(c)},c)}}(e)}h.click=function(a){return function(d){b.util.execCommand(d,a,null)}}(e);b.plugin[e]=h}},getFullHtml:function(a){var d="<html>";d+="<head>";d+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />';d+="<title>KindEditor</title>";d+='<link href="'+b.g[a].skinsPath+"common/editor.css?ver="+escape(b.version)+'" rel="stylesheet" type="text/css" />';a=b.g[a].cssPath;typeof a=="string"&&(a=[a]);for(var c=0,e=a.length;c<e;c++){a[c]!==""&&(d+='<link href="'+a[c]+'" rel="stylesheet" type="text/css" />')}d+="</head>";d+='<body class="ke-content"></body>';d+="</html>";return d},getMediaType:function(a){return a.match(/\.(rm|rmvb)(\?|$)/i)?"rm":a.match(/\.(swf|flv)(\?|$)/i)?"flash":"media"},getMediaImage:function(a,d,c){var e=c.width,h=c.height,d=d||this.getMediaType(c.src),c=this.getMediaEmbed(c),g="";e>0&&(g+="width:"+e+"px;");h>0&&(g+="height:"+h+"px;");a='<img class="ke-'+d+'" src="'+b.g[a].skinsPath+'common/blank.gif" ';g!==""&&(a+='style="'+g+'" ');a+='kesrctag="'+escape(c)+'" alt="" />';return a},getMediaEmbed:function(a){var d="<embed ";b.each(a,function(a,b){d+=a+'="'+b+'" '});d+="/>";return d},execGetHtmlHooks:function(a,d){for(var c=b.g[a].getHtmlHooks,e=0,h=c.length;e<h;e++){d=c[e](d)}return d},execSetHtmlHooks:function(a,d){for(var c=b.g[a].setHtmlHooks,e=0,h=c.length;e<h;e++){d=c[e](d)}return d},execOnchangeHandler:function(a){for(var a=b.g[a].onchangeHandlerStack,d=0,c=a.length;d<c;d++){a[d]()}},toData:function(a,d){var c=b.g[a],e=this.execGetHtmlHooks(a,d),e=e.replace(/^\s*<br[^>]*>\s*$/ig,""),e=e.replace(/^\s*<p>\s*&nbsp;\s*<\/p>\s*$/ig,"");return c.filterMode?b.format.getHtml(e,c.htmlTags,c.urlType):b.format.getHtml(e,null,c.urlType)},getData:function(a,d){var f=b.g[a];(d=d===c?f.wyswygMode:d)||this.innerHtml(f.iframeDoc.body,b.util.execSetHtmlHooks(a,f.newTextarea.value));return this.toData(a,f.iframeDoc.body.innerHTML)},getSrcData:function(a){var d=b.g[a];d.wyswygMode||this.innerHtml(d.iframeDoc.body,b.util.execSetHtmlHooks(a,d.newTextarea.value));return d.iframeDoc.body.innerHTML},getPureData:function(a){return this.extractText(this.getData(a))},extractText:function(a){a=a.replace(/<(?!img|embed).*?>/ig,"");return a=a.replace(/&nbsp;/ig," ")},isEmpty:function(a){return this.getPureData(a).replace(/\r\n|\n|\r/,"").replace(/^\s+|\s+$/,"")===""},setData:function(a){var d=b.g[a];if(d.srcTextarea){d.srcTextarea.value=this.getData(a)}},focus:function(a){a=b.g[a];a.wyswygMode?a.iframeWin.focus():a.newTextarea.focus()},click:function(a,d){this.focus(a);b.hideMenu(a);b.plugin[d].click(a)},selection:function(a){(!b.browser.IE||!b.g[a].keRange)&&this.setSelection(a)},setSelection:function(a){var a=b.g[a],d=new b.selection(a.iframeDoc);if(!b.browser.IE||d.range.item||d.range.parentElement().ownerDocument===a.iframeDoc){a.keSel=d,a.keRange=a.keSel.keRange,a.sel=a.keSel.sel,a.range=a.keSel.range}},select:function(a){b.browser.IE&&b.g[a].wyswygMode&&b.g[a].range&&b.g[a].range.select()},execCommand:function(a,d,c){b.util.focus(a);b.util.select(a);try{b.g[a].iframeDoc.execCommand(d,!1,c)}catch(e){}b.toolbar.updateState(a);b.util.execOnchangeHandler(a)},innerHtml:function(a,d){if(b.browser.IE){a.innerHTML='<img id="__ke_temp_tag__" width="0" height="0" />'+d;var c=b.$("__ke_temp_tag__",a.ownerDocument);c&&c.parentNode.removeChild(c)}else{a.innerHTML=d}},pasteHtml:function(a,d,c){a=b.g[a];c?d='<img id="__ke_temp_tag__" width="0" height="0" />'+d:d+='<img id="__ke_temp_tag__" width="0" height="0" />';b.browser.IE?a.range.item?a.range.item(0).outerHTML=d:a.range.pasteHTML(d):(a.range.deleteContents(),d=a.range.createContextualFragment(d),a.range.insertNode(d));d=b.$("__ke_temp_tag__",a.iframeDoc);c=a.iframeDoc.createTextNode("");d.parentNode.replaceChild(c,d);a.keRange.selectNode(c);a.keSel.addRange(a.keRange)},insertHtml:function(a,d){if(d!==""){var c=b.g[a];if(c.wyswygMode&&c.range){d=this.execSetHtmlHooks(a,d);if(b.browser.IE){if(this.select(a),c.range.item){try{c.range.item(0).outerHTML=d}catch(e){var c=c.range.item(0),h=c.parentNode;h.removeChild(c);if(h.nodeName.toLowerCase()!="body"){h=h.parentNode}this.innerHtml(h,d+h.innerHTML)}}else{c.range.pasteHTML('<span id="__ke_temp_tag__">\u200b</span>'+d),c=b.$("__ke_temp_tag__",c.iframeDoc),c.parentNode.removeChild(c)}}else{if(b.browser.GECKO){this.execCommand(a,"inserthtml",d);return }else{this.pasteHtml(a,d)}}b.util.execOnchangeHandler(a)}}},setFullHtml:function(a,d){var c=b.g[a];!b.browser.IE&&d===""&&(d="<br />");d=b.util.execSetHtmlHooks(a,d);this.innerHtml(c.iframeDoc.body,d);if(!c.wyswygMode){c.newTextarea.value=b.util.getData(a,!0)}b.util.execOnchangeHandler(a)},selectImageWebkit:function(a,d,c){if(b.browser.WEBKIT&&(d=d.srcElement||d.target,d.tagName.toLowerCase()=="img")){c&&b.util.selection(a),c=b.g[a].keRange,c.selectNode(d),b.g[a].keSel.addRange(c)}},addTabEvent:function(a){var d=b.g[a];b.event.add(d.iframeDoc,"keydown",function(c){if(c.keyCode==9){return d.afterTab&&d.afterTab(a),b.event.stop(c),!1}},a)},addContextmenuEvent:function(a){var d=b.g[a];d.contextmenuItems.length!=0&&d.useContextmenu&&b.event.add(d.iframeDoc,"contextmenu",function(c){b.hideMenu(a);b.util.setSelection(a);b.util.selectImageWebkit(a,c,!1);for(var e=0,h=[],g=0,i=d.contextmenuItems.length;g<i;g++){var l=d.contextmenuItems[g];if(l==="-"){h.push(l)}else{if(l.cond&&l.cond(a)&&(h.push(l),l.options)){var j=parseInt(l.options.width)||0;j>e&&(e=j)}}}for(;h.length>0&&h[0]==="-";){h.shift()}for(;h.length>0&&h[h.length-1]==="-";){h.pop()}l=null;g=0;for(i=h.length;g<i;g++){h[g]==="-"&&l==="-"&&delete h[g],l=h[g]||null}if(h.length>0){for(var m=new b.menu({id:a,event:c,type:"contextmenu",width:e}),g=0,i=h.length;g<i;g++){(l=h[g])&&(l==="-"?g<i-1&&m.addSeparator():m.add(l.text,function(d){return function(){d.click(a,m)}}(l),l.options))}m.show();b.event.stop(c);return !1}return !0},a)},addNewlineEvent:function(a){var d=b.g[a];if(!(b.browser.IE&&d.newlineTag.toLowerCase()!="br")&&(!b.browser.GECKO||!(b.browser.VERSION<3&&d.newlineTag.toLowerCase()!="p"))){b.browser.OPERA||b.event.add(d.iframeDoc,"keydown",function(c){if(c.keyCode!=13||c.shiftKey||c.ctrlKey||c.altKey){return !0}b.util.setSelection(a);var e=d.keRange.getParentElement();if(!b.util.inMarquee(e)){e=e.tagName.toLowerCase();if(d.newlineTag.toLowerCase()=="br"){if(!b.util.inArray(e,["h1","h2","h3","h4","h5","h6","li"])){b.util.pasteHtml(a,"<br />");e=d.keRange.startNode.nextSibling;if(b.browser.IE){e||b.util.pasteHtml(a,"<br />",!0)}else{if(b.browser.WEBKIT){if(e){var h=new b.range(d.iframeDoc);h.selectNode(e.parentNode);h.setStart(e,0);h.cloneContents().innerHTML.replace(/<(?!img|embed).*?>/ig,"")===""&&b.util.pasteHtml(a,"<br />",!0)}else{b.util.pasteHtml(a,"<br />",!0)}}}b.event.stop(c);return !1}}else{b.util.inArray(e,["p","h1","h2","h3","h4","h5","h6","pre","div","li"])||b.util.execCommand(a,"formatblock","<P>")}return !0}},a)}}};b.layout={hide:function(a){var d=b.g[a];b.hideMenu(a);for(a=d.dialogStack;a.length>0;){a[a.length-1].hide()}d.maskDiv.style.display="none"}};b.hideMenu=function(a){a=b.g[a];a.hideDiv.innerHTML="";a.hideDiv.style.display="none"};b.colorpicker=function(a){var d,c=a.x||0,e=a.y||0,h=a.z||0,g=a.colors||b.setting.colorTable,i=a.doc||document,l=a.onclick,j=(a.selectedColor||"").toLowerCase();d=b.$$("div");d.className="ke-colorpicker";d.style.top=e+"px";d.style.left=c+"px";d.style.zIndex=h;this.remove=function(){i.body.removeChild(d)};this.getElement=function(){function a(d,c,e){j===c.toLowerCase()&&(e+=" ke-colorpicker-cell-selected");d.className=e;d.title=c||b.lang.noColor;d.onmouseover=function(){this.className=e+" ke-colorpicker-cell-on"};d.onmouseout=function(){this.className=e};d.onclick=function(){l(c)};if(c){var f=b.$$("div");f.className="ke-colorpicker-cell-color";f.style.backgroundColor=c;d.appendChild(f)}else{d.innerHTML=b.lang.noColor}}var d=b.$$("table");d.className="ke-colorpicker-table";d.cellPadding=0;d.cellSpacing=0;d.border=0;var c=d.insertRow(0),e=c.insertCell(0);e.colSpan=g[0].length;a(e,"","ke-colorpicker-cell-top");for(var f=0;f<g.length;f++){for(var c=d.insertRow(f+1),h=0;h<g[f].length;h++){var k=g[f][h],e=c.insertCell(h);a(e,k,"ke-colorpicker-cell")}}return d};this.create=function(){d.appendChild(this.getElement());b.event.bind(d,"click",function(){});b.event.bind(d,"mousedown",function(){});i.body.appendChild(d)}};b.menu=function(a){function d(d,c){var e=a.id,g=0,i=0;this.type=="menu"?(e=b.g[e].toolbarIcon[a.cmd],i=b.util.getElementPos(e[0]),g=i.x,i=i.y+e[0].offsetHeight):(i=b.util.getCoords(a.event),e=b.util.getElementPos(b.g[e].iframe),g=i.x+e.x,i=i.y+e.y+5);if(d>0||c>0){var e=b.util.getScrollPos(),l=b.util.getDocumentElement(),e=e.x+l.clientWidth-d-2;g>e&&(g=e)}return{x:g,y:i}}(function(){var c=a.width;this.type=a.type&&a.type=="contextmenu"?a.type:"menu";var e=b.$$("div");e.className="ke-"+this.type;e.setAttribute("name",a.cmd);var h=d.call(this,0,0);e.style.top=h.y+"px";e.style.left=h.x+"px";if(a.width){e.style.width=/^\d+$/.test(c)?c+"px":c}b.event.bind(e,"click",function(){},a.id);b.event.bind(e,"mousedown",function(){},a.id);this.div=e}).call(this);this.add=function(a,d,e){var g,i,l=!1;if(e!==c){g=e.height,i=e.iconHtml,l=e.checked}var j=this,e=b.$$("div");e.className="ke-"+j.type+"-item";if(g){e.style.height=g}var m=b.$$("div");m.className="ke-"+this.type+"-left";var o=b.$$("div");o.className="ke-"+j.type+"-center";if(g){o.style.height=g}var n=b.$$("div");n.className="ke-"+this.type+"-right";if(g){n.style.lineHeight=g}e.onmouseover=function(){this.className="ke-"+j.type+"-item ke-"+j.type+"-item-on";o.className="ke-"+j.type+"-center ke-"+j.type+"-center-on"};e.onmouseout=function(){this.className="ke-"+j.type+"-item";o.className="ke-"+j.type+"-center"};e.onclick=d;e.appendChild(m);e.appendChild(o);e.appendChild(n);l?b.util.innerHtml(m,'<span class="ke-common-icon ke-common-icon-url ke-icon-checked"></span>'):i&&b.util.innerHtml(m,i);b.util.innerHtml(n,a);this.append(e)};this.addSeparator=function(){var a=b.$$("div");a.className="ke-"+this.type+"-separator";this.append(a)};this.append=function(a){this.div.appendChild(a)};this.insert=function(a){b.util.innerHtml(this.div,a)};this.hide=function(){b.hideMenu(a.id)};this.show=function(){this.hide();var c=a.id;b.g[c].hideDiv.style.display="";b.g[c].hideDiv.appendChild(this.div);c=d.call(this,this.div.clientWidth,this.div.clientHeight);this.div.style.top=c.y+"px";this.div.style.left=c.x+"px"};this.picker=function(d){this.append((new b.colorpicker({colors:b.g[a.id].colorTable,onclick:function(d){b.plugin[a.cmd].exec(a.id,d)},selectedColor:d})).getElement());this.show()}};b.button=function(a){a=a||{};doc=a.doc||document;var d=b.$$("span",doc);d.className="ke-button-common ke-button-outer "+(a.className||"");d.title=a.text;btn=b.$$("input",doc);btn.className="ke-button-common ke-button";btn.type="button";btn.value=a.text||"";if(a.clickFn){btn.onclick=a.clickFn}d.appendChild(btn);return{span:d,btn:btn}};b.dialog=function(a){function d(){b.util.getDocumentElement();var a=b.util.getScrollPos();k=a.y;h=a.x}function e(){var d=this.width+this.widthMargin,c=this.height+this.heightMargin,f=a.id,h=b.g[f],k=0,o=0;h.dialogAlignType=="page"?(h=b.util.getDocumentElement(),f=b.util.getScrollPos(),k=Math.round(f.x+(h.clientWidth-d)/2),o=Math.round(f.y+(h.clientHeight-c)/2)):(f=b.util.getElementPos(b.g[f].container),h=h.container,k=Math.round(h.clientWidth/2)-Math.round(d/2),c=Math.round(h.clientHeight/2)-Math.round(c/2),k=k<0?f.x:f.x+k,o=c<0?f.y:f.y+c);return{x:k<0?0:k,y:o<0?0:o}}this.widthMargin=30;this.heightMargin=100;this.zIndex=19811214;this.width=a.width;this.height=a.height;var k,h;this.beforeHide=a.beforeHide;this.afterHide=a.afterHide;this.beforeShow=a.beforeShow;this.afterShow=a.afterShow;this.ondrag=a.ondrag;this.resize=function(a,d){if(a){this.width=a}if(d){this.height=d}this.hide();this.show()};this.hide=function(){this.beforeHide&&this.beforeHide(c);var c=a.id,e=b.g[c].dialogStack;if(e[e.length-1]==this){var f=e.pop().iframe;f.src="javascript:false";f.parentNode.removeChild(f);document.body.removeChild(this.div);if(e.length<1){b.g[c].maskDiv.style.display="none"}b.event.remove(window,"resize",d);b.event.remove(window,"scroll",d);this.afterHide&&this.afterHide(c);b.util.focus(c)}};this.show=function(){this.beforeShow&&this.beforeShow(i);var g=this,i=a.id,l=b.$$("div");l.className="ke-dialog";b.event.bind(l,"click",function(){},i);var j=b.g[i].dialogStack;if(j.length>0){this.zIndex=j[j.length-1].zIndex+1}l.style.zIndex=this.zIndex;j=e.call(this);l.style.top=j.y+"px";l.style.left=j.x+"px";b.g[i].shadowMode?b.addClass(l,"ke-dialog-shadow"):b.addClass(l,"ke-dialog-no-shadow");j=b.$$("div");j.className="ke-dialog-title";j.innerHTML=a.title;var m=b.$$("span");m.className="ke-dialog-close";m.alt=b.lang.close;m.title=b.lang.close;m.onclick=function(){g.hide();b.util.select(i)};j.appendChild(m);d();b.event.add(window,"resize",d);b.event.add(window,"scroll",d);b.util.drag(i,j,l,function(a,c,b,e,f,j){if(g.ondrag){g.ondrag(i)}d();f=a+f;j=c+j;f<k&&(f=k);j<h&&(j=h);l.style.top=f+"px";l.style.left=j+"px"});l.appendChild(j);var o=b.$$("div");o.className="ke-dialog-body";j=b.util.createTable();j.table.className="ke-loading-table";j.table.style.width=this.width+"px";j.table.style.height=this.height+"px";m=b.$$("span");m.className="ke-loading-img";j.cell.appendChild(m);m=b.g[i].dialogStack.length==0&&b.g[i].dialog?b.g[i].dialog:b.$$("iframe");m.className=a.useFrameCSS?"ke-dialog-iframe ke-dialog-iframe-border":"ke-dialog-iframe";m.setAttribute("frameBorder","0");m.style.width=this.width+"px";m.style.height=this.height+"px";m.style.display="none";o.appendChild(m);o.appendChild(j.table);l.appendChild(o);var n=b.$$("div");n.className="ke-dialog-bottom";var r=o=null,s=null;if(a.previewButton){var q=b.button({className:"ke-dialog-preview",text:a.previewButton,clickFn:function(){var d=b.g[i].dialogStack;d[d.length-1]==g&&(a.previewClickFn?a.previewClickFn(i):b.plugin[a.cmd].preview(i))}}),s=q.btn;n.appendChild(q.span)}if(a.yesButton){q=b.button({className:"ke-dialog-yes",text:a.yesButton,clickFn:function(){var d=b.g[i].dialogStack;d[d.length-1]==g&&(a.yesClickFn?a.yesClickFn(i):b.plugin[a.cmd].exec(i))}}),r=q.btn,n.appendChild(q.span)}if(a.noButton){q=b.button({className:"ke-dialog-no",text:a.noButton,clickFn:function(){g.hide();b.util.select(i)}}),o=q.btn,n.appendChild(q.span)}(a.yesButton||a.noButton||a.previewButton)&&l.appendChild(n);document.body.appendChild(l);b.event.bind(l,"mousedown",function(){},i);window.focus();a.html!==c?(n=b.util.getIframeDoc(m),q=b.util.getFullHtml(i),n.open(),n.write(q),n.close(),b.util.innerHtml(n.body,a.html)):a.url!==c?m.src=a.url:(n="id="+escape(i)+"&ver="+escape(b.version),a.file===c?m.src=b.g[i].pluginsPath+a.cmd+".html?"+n:(n=(/\?/.test(a.file)?"&":"?")+n,m.src=b.g[i].pluginsPath+a.file+n));b.g[i].maskDiv.style.width=b.util.getDocumentWidth()+"px";b.g[i].maskDiv.style.height=b.util.getDocumentHeight()+"px";b.g[i].maskDiv.style.display="block";this.iframe=m;this.loading=j.table;this.noButton=o;this.yesButton=r;this.previewButton=s;this.div=l;b.g[i].dialogStack.push(this);b.g[i].dialog=m;b.g[i].yesButton=r;b.g[i].noButton=o;b.g[i].previewButton=s;a.loadingMode||b.util.hideLoadingPage(i);this.afterShow&&this.afterShow(i);b.g[i].afterDialogCreate&&b.g[i].afterDialogCreate(i)}};b.toolbar={updateState:function(a){for(var d=["justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","bold","italic","underline","strikethrough"],c=0;c<d.length;c++){var e=d[c],h=!1;try{h=b.g[a].iframeDoc.queryCommandState(e)}catch(g){}h?b.toolbar.select(a,e):b.toolbar.unselect(a,e)}},isSelected:function(a,d){return b.plugin[d]&&b.plugin[d].isSelected?!0:!1},select:function(a,d){if(b.g[a].toolbarIcon[d]){var c=b.g[a].toolbarIcon[d][0];c.className="ke-icon ke-icon-selected";c.onmouseover=null;c.onmouseout=null}},unselect:function(a,d){if(b.g[a].toolbarIcon[d]){var c=b.g[a].toolbarIcon[d][0];c.className="ke-icon";c.onmouseover=function(){this.className="ke-icon ke-icon-on"};c.onmouseout=function(){this.className="ke-icon"}}},_setAttr:function(a,d,e){d.className="ke-icon";d.href="javascript:;";d.onclick=function(d){var d=d||window.event,h=b.g[a].hideDiv.firstChild;h&&h.getAttribute("name")==e?b.hideMenu(a):b.util.click(a,e);d.preventDefault&&d.preventDefault();d.stopPropagation&&d.stopPropagation();if(d.cancelBubble!==c){d.cancelBubble=!0}return !1};d.onmouseover=function(){this.className="ke-icon ke-icon-on"};d.onmouseout=function(){this.className="ke-icon"};d.hidefocus=!0;d.title=b.lang[e]},able:function(a,d){var c=this;b.each(b.g[a].toolbarIcon,function(e,h){if(!b.util.inArray(e,d)){var g=h[1];c._setAttr(a,h[0],e);b.util.setOpacity(g,100)}})},disable:function(a,d){b.each(b.g[a].toolbarIcon,function(a,c){if(!b.util.inArray(a,d)){var e=c[0],g=c[1];e.className="ke-icon ke-icon-disabled";b.util.setOpacity(g,50);e.onclick=null;e.onmouseover=null;e.onmouseout=null}})},create:function(a){var d=b.util.arrayToHash(b.setting.items);b.g[a].toolbarIcon=[];var c=b.util.createTable(),e=c.table;e.className="ke-toolbar";e.oncontextmenu=function(){return !1};e.onmousedown=function(){return !1};e.onmousemove=function(){return !1};var c=c.cell,h=b.g[a].items.length,g=0,i;b.g[a].toolbarHeight=b.g[a].toolbarLineHeight;for(var l=0;l<h;l++){var j=b.g[a].items[l];if(l==0||j=="-"){var m=b.$$("table");m.cellPadding=0;m.cellSpacing=0;m.border=0;m.className="ke-toolbar-table";i=m.insertRow(0);g=0;c.appendChild(m);if(j=="-"){b.g[a].toolbarHeight+=b.g[a].toolbarLineHeight;continue}}m=i.insertCell(g);m.hideforcus=!0;g++;if(j=="|"){j=b.$$("div"),j.className="ke-toolbar-separator",m.appendChild(j)}else{var o=b.$$("a");o.tabIndex=-1;this._setAttr(a,o,j);var n=b.$$("span");n.className=typeof d[j]=="undefined"?"ke-common-icon ke-icon-"+j:"ke-common-icon ke-common-icon-url ke-icon-"+j;o.appendChild(n);m.appendChild(o);b.g[a].toolbarIcon[j]=[o,n];b.toolbar.isSelected(a,j)&&b.toolbar.select(a,j)}}return e}};b.history={addStackData:function(a,d){var c="";a.length>0&&(c=a[a.length-1]);(a.length==0||d!==c)&&a.push(d)},add:function(a,d){var c=b.g[a],e=b.util.getSrcData(a);c.undoStack.length>0&&Math.abs(e.length-c.undoStack[c.undoStack.length-1].length)<d||this.addStackData(c.undoStack,e)},undo:function(a){var d=b.g[a];if(d.undoStack.length!=0){var c=b.util.getSrcData(a);this.addStackData(d.redoStack,c);var e=d.undoStack.pop();c===e&&d.undoStack.length>0&&(e=d.undoStack.pop());e=b.util.toData(a,e);d.wyswygMode?b.util.innerHtml(d.iframeDoc.body,b.util.execSetHtmlHooks(a,e)):d.newTextarea.value=e}},redo:function(a){var d=b.g[a];if(d.redoStack.length!=0){var c=b.util.getSrcData(a);this.addStackData(d.undoStack,c);c=d.redoStack.pop();c=b.util.toData(a,c);d.wyswygMode?b.util.innerHtml(d.iframeDoc.body,b.util.execSetHtmlHooks(a,c)):d.newTextarea.value=c}}};b.readonly=function(a,d){var d=d==c?!0:d,e=b.g[a];b.browser.IE?e.iframeDoc.body.contentEditable=d?"false":"true":e.iframeDoc.designMode=d?"off":"on"};b.focus=function(a,d){d=(d||"").toLowerCase();if(b.g[a].container&&(b.util.focus(a),d==="end"&&(b.util.setSelection(a),b.g[a].sel))){var c=b.g[a].keSel,e=b.g[a].keRange;e.selectTextNode(b.g[a].iframeDoc.body);e.collapse(!1);c.addRange(e)}};b.blur=function(a){a=b.g[a];if(a.container){if(b.browser.IE){var d=b.$$("input");d.type="text";a.container.appendChild(d);d.focus();a.container.removeChild(d)}else{a.wyswygMode?a.iframeWin.blur():a.newTextarea.blur()}}};b.html=function(a,d){if(d===c){return b.util.getData(a)}else{b.g[a].container&&(b.util.setFullHtml(a,d),b.focus(a))}};b.text=function(a,d){if(d===c){return d=b.html(a),d=d.replace(/<.*?>/ig,""),d=d.replace(/&nbsp;/ig," "),d=b.util.trim(d)}else{b.html(a,b.util.escape(d))}};b.insertHtml=function(a,d){b.g[a].container&&(b.g[a].range?(b.focus(a),b.util.selection(a),b.util.insertHtml(a,d)):b.appendHtml(a,d))};b.appendHtml=function(a,d){b.html(a,b.html(a)+d)};b.isEmpty=function(a){return b.util.isEmpty(a)};b.selectedHtml=function(a){var d=b.g[a].range;if(!d){return""}var c="";b.browser.IE?c=d.item?d.item(0).outerHTML:d.htmlText:(c=b.$$("div",b.g[a].iframeDoc),c.appendChild(d.cloneContents()),c=c.innerHTML);return b.util.toData(a,c)};b.count=function(a,c){c=(c||"html").toLowerCase();if(c==="html"){return b.html(a).length}else{if(c==="text"){var e=b.util.getPureData(a),e=e.replace(/<(?:img|embed).*?>/ig,"K"),e=e.replace(/\r\n|\n|\r/g,""),e=b.util.trim(e);return e.length}}return 0};b.sync=function(a){return b.util.setData(a)};b.remove=function(a,c){var e=b.g[a];if(!e.container){return !1}c=typeof c=="undefined"?0:c;b.util.setData(a);for(var k=e.container,h=e.eventStack,g=0,i=h.length;g<i;g++){var l=h[g];l&&b.event.remove(l.el,l.type,l.fn,a)}e.iframeDoc.src="javascript:false";e.iframe.parentNode.removeChild(e.iframe);if(c==1){document.body.removeChild(k)}else{if(h=e.srcTextarea,h.parentNode.removeChild(k),c==0){h.style.display=""}}document.body.removeChild(e.hideDiv);document.body.removeChild(e.maskDiv);e.container=null;e.dialogStack=[];e.contextmenuItems=[];e.getHtmlHooks=[];e.setHtmlHooks=[];e.onchangeHandlerStack=[];e.eventStack=[]};b.create=function(a,c){function e(){b.hideMenu(a)}function k(){b.toolbar.updateState(a)}function h(){b.g[a].afterFocus&&b.g[a].afterFocus(a)}function g(){b.g[a].afterBlur&&b.g[a].afterBlur(a)}function i(){b.util.setSelection(a)}b.g[a].beforeCreate&&b.g[a].beforeCreate(a);if(b.browser.IE&&b.browser.VERSION<7){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(l){}}var j=b.$(a)||document.getElementsByName(a)[0],c=typeof c=="undefined"?0:c;if(!(c==0&&b.g[a].container)){var m=b.g[a].width||j.style.width||j.offsetWidth+"px",o=b.g[a].height||j.style.height||j.offsetHeight+"px",n=b.util.createTable(),r=n.table;r.className="ke-container";r.style.width=m;r.style.height=o;var s=n.cell;s.className="ke-toolbar-outer";var q=r.insertRow(1).insertCell(0);q.className="ke-textarea-outer";var n=b.util.createTable(),u=n.table;u.className="ke-textarea-table";var w=n.cell;q.appendChild(u);var p=r.insertRow(2).insertCell(0);p.className="ke-bottom-outer";j.style.display="none";c==1?document.body.appendChild(r):j.parentNode.insertBefore(r,j);q=b.toolbar.create(a);q.style.height=b.g[a].toolbarHeight+"px";s.appendChild(q);n=b.g[a].iframe||b.$$("iframe");n.tabIndex=b.g[a].tabIndex||j.tabIndex;n.className="ke-iframe";n.setAttribute("frameBorder","0");s=b.$$("textarea");s.tabIndex=n.tabIndex;s.className="ke-textarea";s.style.display="none";b.g[a].container=r;b.g[a].iframe=n;b.g[a].newTextarea=s;b.util.resize(a,m,o);w.appendChild(n);w.appendChild(s);w=b.$$("table");w.className="ke-bottom";w.cellPadding=0;w.cellSpacing=0;w.border=0;w.style.height=b.g[a].statusbarHeight+"px";var v=w.insertRow(0),t=v.insertCell(0);t.className="ke-bottom-left";var x=b.$$("span");x.className="ke-bottom-left-img";if(b.g[a].config.resizeMode==0||c==1){t.style.cursor="default",x.style.visibility="hidden"}t.appendChild(x);v=v.insertCell(1);v.className="ke-bottom-right";x=b.$$("span");x.className="ke-bottom-right-img";if(b.g[a].config.resizeMode==0||c==1){v.style.cursor="default",x.style.visibility="hidden"}else{if(b.g[a].config.resizeMode==1){v.style.cursor="s-resize",x.style.visibility="hidden"}}v.appendChild(x);p.appendChild(w);p=b.$$("div");p.className="ke-reset";p.style.display="none";x=b.$$("div");x.className="ke-mask";b.util.setOpacity(x,50);b.event.bind(x,"click",function(){},a);b.event.bind(x,"mousedown",function(){},a);document.body.appendChild(p);document.body.appendChild(x);b.util.setDefaultPlugin(a);var z=n.contentWindow,y=b.util.getIframeDoc(n);if(!b.browser.IE){y.designMode="on"}var A=b.util.getFullHtml(a);y.open();y.write(A);y.close();if(!b.g[a].wyswygMode){s.value=b.util.execSetHtmlHooks(a,j.value),s.style.display="block",n.style.display="none",b.toolbar.disable(a,["source","fullscreen"]),b.toolbar.select(a,"source")}if(b.g[a].syncType=="form"){for(n=j;n=n.parentNode;){if(n.nodeName.toLowerCase()=="form"){b.event.add(n,"submit",function(){b.sync(a)},a);break}}}b.browser.WEBKIT&&b.event.add(y,"click",function(c){b.util.selectImageWebkit(a,c,!0)},a);b.browser.IE&&b.event.add(y,"keydown",function(c){if(c.keyCode==8&&(c=b.g[a].range,c.item)){return c=c.item(0),c.parentNode.removeChild(c),b.util.execOnchangeHandler(a),b.event.stop(a),!1}},a);b.event.add(y,"mousedown",e,a);b.event.add(y,"click",k,a);b.event.input(y,k,a);b.event.bind(s,"click",e,a);b.event.add(document,"click",e,a);b.event.add(z,"focus",h);b.event.add(s,"focus",h);b.event.add(z,"blur",g);b.event.add(s,"blur",g);b.g[a].toolbarTable=q;b.g[a].textareaTable=u;b.g[a].srcTextarea=j;b.g[a].bottom=w;b.g[a].hideDiv=p;b.g[a].maskDiv=x;b.g[a].iframeWin=z;b.g[a].iframeDoc=y;b.g[a].width=m;b.g[a].height=o;b.util.drag(a,v,r,function(c,d,e,f,g,h){b.g[a].resizeMode==2?b.util.resize(a,e+h+"px",f+g+"px",!0):b.g[a].resizeMode==1&&b.util.resize(a,e+"px",f+g+"px",!0,!1)});b.util.drag(a,t,r,function(c,d,e,f,g){b.g[a].resizeMode>0&&b.util.resize(a,e+"px",f+g+"px",!0,!1)});b.each(b.plugin,function(c,d){d.init&&d.init(a)});b.g[a].getHtmlHooks.push(function(a){a=a.replace(/(<[^>]*)kesrc="([^"]+)"([^>]*>)/ig,function(a,c,d){a=a.replace(/(\s+(?:href|src)=")[^"]+(")/i,"$1"+d+"$2");return a=a.replace(/\s+kesrc="[^"]+"/i,"")});return a=a.replace(/(<[^>]+\s)ke-(on\w+="[^"]+"[^>]*>)/ig,function(a,c,d){return c+d})});b.g[a].setHtmlHooks.push(function(a){a=a.replace(/(<[^>]*)(href|src)="([^"]+)"([^>]*>)/ig,function(a,c,d,b,e){if(a.match(/\skesrc="[^"]+"/i)){return a}return c+d+'="'+b+'" kesrc="'+b+'"'+e});return a=a.replace(/(<[^>]+\s)(on\w+="[^"]+"[^>]*>)/ig,function(a,c,d){return c+"ke-"+d})});b.util.addContextmenuEvent(a);b.util.addNewlineEvent(a);b.util.addTabEvent(a);b.event.input(y,i,a);b.event.add(y,"mouseup",i,a);b.event.add(document,"mousedown",i,a);b.onchange(a,function(a){if(b.g[a].autoSetDataMode||b.g[a].syncType=="auto"){b.util.setData(a),b.g[a].afterSetData&&b.g[a].afterSetData(a)}b.g[a].afterChange&&b.g[a].afterChange(a);b.history.add(a,b.g[a].minChangeSize)});if(b.browser.IE){y.body.disabled=!0,b.readonly(a,!1),y.body.removeAttribute("disabled")}b.util.setFullHtml(a,j.value);b.history.add(a,0);c>0&&b.util.focus(a);b.g[a].afterCreate&&b.g[a].afterCreate(a)}};b.onchange=function(a,c){function e(){c(a)}var k=b.g[a];k.onchangeHandlerStack.push(e);b.event.input(k.iframeDoc,e,a);b.event.input(k.newTextarea,e,a);b.event.add(k.iframeDoc,"mouseup",function(){window.setTimeout(function(){c(a)},0)},a)};var e=!0;b.init=function(a){var c=b.g[a.id]=a;c.config={};c.undoStack=[];c.redoStack=[];c.dialogStack=[];c.contextmenuItems=[];c.getHtmlHooks=[];c.setHtmlHooks=[];c.onchangeHandlerStack=[];c.eventStack=[];b.each(b.setting,function(b,e){c[b]=typeof a[b]=="undefined"?e:a[b];c.config[b]=c[b]});c.loadStyleMode&&e&&(b.util.loadStyle(c.skinsPath+c.skinType+".css"),e=!1)};b.show=function(a){b.init(a);if(document.readyState=="complete"){b.create(a.id)}else{b.event.ready(function(){b.create(a.id)})}};if(window.KE===c){window.KE=b}window.KindEditor=b}})();(function(B){B.langType="zh_CN";B.lang={source:"HTML\u4ee3\u7801",undo:"\u540e\u9000(Ctrl+Z)",redo:"\u524d\u8fdb(Ctrl+Y)",cut:"\u526a\u5207(Ctrl+X)",copy:"\u590d\u5236(Ctrl+C)",paste:"\u7c98\u8d34(Ctrl+V)",plainpaste:"\u7c98\u8d34\u4e3a\u65e0\u683c\u5f0f\u6587\u672c",wordpaste:"\u4eceWord\u7c98\u8d34",selectall:"\u5168\u9009",justifyleft:"\u5de6\u5bf9\u9f50",justifycenter:"\u5c45\u4e2d",justifyright:"\u53f3\u5bf9\u9f50",justifyfull:"\u4e24\u7aef\u5bf9\u9f50",insertorderedlist:"\u7f16\u53f7",insertunorderedlist:"\u9879\u76ee\u7b26\u53f7",indent:"\u589e\u52a0\u7f29\u8fdb",outdent:"\u51cf\u5c11\u7f29\u8fdb",subscript:"\u4e0b\u6807",superscript:"\u4e0a\u6807",title:"\u6807\u9898",fontname:"\u5b57\u4f53",fontsize:"\u6587\u5b57\u5927\u5c0f",textcolor:"\u6587\u5b57\u989c\u8272",bgcolor:"\u6587\u5b57\u80cc\u666f",bold:"\u7c97\u4f53(Ctrl+B)",italic:"\u659c\u4f53(Ctrl+I)",underline:"\u4e0b\u5212\u7ebf(Ctrl+U)",strikethrough:"\u5220\u9664\u7ebf",removeformat:"\u5220\u9664\u683c\u5f0f",image:"\u56fe\u7247",flash:"\u63d2\u5165Flash",media:"\u63d2\u5165\u591a\u5a92\u4f53",table:"\u63d2\u5165\u8868\u683c",hr:"\u63d2\u5165\u6a2a\u7ebf",emoticons:"\u63d2\u5165\u8868\u60c5",link:"\u8d85\u7ea7\u94fe\u63a5",unlink:"\u53d6\u6d88\u8d85\u7ea7\u94fe\u63a5",fullscreen:"\u5168\u5c4f\u663e\u793a",about:"\u5173\u4e8e",print:"\u6253\u5370",fileManager:"\u6d4f\u89c8\u670d\u52a1\u5668",advtable:"\u8868\u683c",tablecell:"\u5355\u5143\u683c",yes:"\u786e\u5b9a",no:"\u53d6\u6d88",close:"\u5173\u95ed",editImage:"\u56fe\u7247\u5c5e\u6027",deleteImage:"\u5220\u9664\u56fe\u7247",editLink:"\u8d85\u7ea7\u94fe\u63a5\u5c5e\u6027",deleteLink:"\u53d6\u6d88\u8d85\u7ea7\u94fe\u63a5",tableprop:"\u8868\u683c\u5c5e\u6027",tablecellprop:"\u5355\u5143\u683c\u5c5e\u6027",tableinsert:"\u63d2\u5165\u8868\u683c",tabledelete:"\u5220\u9664\u8868\u683c",tablecolinsertleft:"\u5de6\u4fa7\u63d2\u5165\u5217",tablecolinsertright:"\u53f3\u4fa7\u63d2\u5165\u5217",tablerowinsertabove:"\u4e0a\u65b9\u63d2\u5165\u884c",tablerowinsertbelow:"\u4e0b\u65b9\u63d2\u5165\u884c",tablecoldelete:"\u5220\u9664\u5217",tablerowdelete:"\u5220\u9664\u884c",noColor:"\u65e0\u989c\u8272",invalidImg:"\u8bf7\u8f93\u5165\u6709\u6548\u7684URL\u5730\u5740\u3002\n\u53ea\u5141\u8bb8jpg,gif,bmp,png\u683c\u5f0f\u3002",invalidMedia:"\u8bf7\u8f93\u5165\u6709\u6548\u7684URL\u5730\u5740\u3002\n\u53ea\u5141\u8bb8swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb\u683c\u5f0f\u3002",invalidWidth:"\u5bbd\u5ea6\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",invalidHeight:"\u9ad8\u5ea6\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",invalidBorder:"\u8fb9\u6846\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",invalidUrl:"\u8bf7\u8f93\u5165\u6709\u6548\u7684URL\u5730\u5740\u3002",invalidRows:"\u884c\u6570\u4e3a\u5fc5\u9009\u9879\uff0c\u53ea\u5141\u8bb8\u8f93\u5165\u5927\u4e8e0\u7684\u6570\u5b57\u3002",invalidCols:"\u5217\u6570\u4e3a\u5fc5\u9009\u9879\uff0c\u53ea\u5141\u8bb8\u8f93\u5165\u5927\u4e8e0\u7684\u6570\u5b57\u3002",invalidPadding:"\u8fb9\u8ddd\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",invalidSpacing:"\u95f4\u8ddd\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",invalidBorder:"\u8fb9\u6846\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",pleaseInput:"\u8bf7\u8f93\u5165\u5185\u5bb9\u3002",invalidJson:"\u670d\u52a1\u5668\u53d1\u751f\u6545\u969c\u3002",cutError:"\u60a8\u7684\u6d4f\u89c8\u5668\u5b89\u5168\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u4f7f\u7528\u526a\u5207\u64cd\u4f5c\uff0c\u8bf7\u4f7f\u7528\u5feb\u6377\u952e(Ctrl+X)\u6765\u5b8c\u6210\u3002",copyError:"\u60a8\u7684\u6d4f\u89c8\u5668\u5b89\u5168\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u4f7f\u7528\u590d\u5236\u64cd\u4f5c\uff0c\u8bf7\u4f7f\u7528\u5feb\u6377\u952e(Ctrl+C)\u6765\u5b8c\u6210\u3002",pasteError:"\u60a8\u7684\u6d4f\u89c8\u5668\u5b89\u5168\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u4f7f\u7528\u7c98\u8d34\u64cd\u4f5c\uff0c\u8bf7\u4f7f\u7528\u5feb\u6377\u952e(Ctrl+V)\u6765\u5b8c\u6210\u3002"};var A=B.lang.plugins={};A.about={version:B.version,title:"HTML\u53ef\u89c6\u5316\u7f16\u8f91\u5668"};A.plainpaste={comment:"\u8bf7\u4f7f\u7528\u5feb\u6377\u952e(Ctrl+V)\u628a\u5185\u5bb9\u7c98\u8d34\u5230\u4e0b\u9762\u7684\u65b9\u6846\u91cc\u3002"};A.wordpaste={comment:"\u8bf7\u4f7f\u7528\u5feb\u6377\u952e(Ctrl+V)\u628a\u5185\u5bb9\u7c98\u8d34\u5230\u4e0b\u9762\u7684\u65b9\u6846\u91cc\u3002"};A.link={url:"URL\u5730\u5740",linkType:"\u6253\u5f00\u7c7b\u578b",newWindow:"\u65b0\u7a97\u53e3",selfWindow:"\u5f53\u524d\u7a97\u53e3"};A.flash={url:"Flash\u5730\u5740",width:"\u5bbd\u5ea6",height:"\u9ad8\u5ea6"};A.media={url:"\u5a92\u4f53\u6587\u4ef6\u5730\u5740",width:"\u5bbd\u5ea6",height:"\u9ad8\u5ea6",autostart:"\u81ea\u52a8\u64ad\u653e"};A.image={remoteImage:"\u8fdc\u7a0b\u56fe\u7247",localImage:"\u672c\u5730\u4e0a\u4f20",remoteUrl:"\u56fe\u7247\u5730\u5740",localUrl:"\u56fe\u7247\u5730\u5740",size:"\u56fe\u7247\u5927\u5c0f",width:"\u5bbd",height:"\u9ad8",resetSize:"\u91cd\u7f6e\u5927\u5c0f",align:"\u5bf9\u9f50\u65b9\u5f0f",defaultAlign:"\u9ed8\u8ba4\u65b9\u5f0f",leftAlign:"\u5de6\u5bf9\u9f50",rightAlign:"\u53f3\u5bf9\u9f50",imgTitle:"\u56fe\u7247\u8bf4\u660e",viewServer:"\u6d4f\u89c8..."};A.file_manager={emptyFolder:"\u7a7a\u6587\u4ef6\u5939",moveup:"\u79fb\u5230\u4e0a\u4e00\u7ea7\u6587\u4ef6\u5939",viewType:"\u663e\u793a\u65b9\u5f0f\uff1a",viewImage:"\u7f29\u7565\u56fe",listImage:"\u8be6\u7ec6\u4fe1\u606f",orderType:"\u6392\u5e8f\u65b9\u5f0f\uff1a",fileName:"\u540d\u79f0",fileSize:"\u5927\u5c0f",fileType:"\u7c7b\u578b"};A.advtable={cells:"\u5355\u5143\u683c\u6570",rows:"\u884c\u6570",cols:"\u5217\u6570",size:"\u5927\u5c0f",width:"\u5bbd\u5ea6",height:"\u9ad8\u5ea6",percent:"%",px:"px",space:"\u8fb9\u8ddd\u95f4\u8ddd",padding:"\u8fb9\u8ddd",spacing:"\u95f4\u8ddd",align:"\u5bf9\u9f50\u65b9\u5f0f",textAlign:"\u6c34\u5e73\u5bf9\u9f50",verticalAlign:"\u5782\u76f4\u5bf9\u9f50",alignDefault:"\u9ed8\u8ba4",alignLeft:"\u5de6\u5bf9\u9f50",alignCenter:"\u5c45\u4e2d",alignRight:"\u53f3\u5bf9\u9f50",alignTop:"\u9876\u90e8",alignMiddle:"\u4e2d\u90e8",alignBottom:"\u5e95\u90e8",alignBaseline:"\u57fa\u7ebf",border:"\u8fb9\u6846",borderWidth:"\u8fb9\u6846",borderColor:"\u989c\u8272",backgroundColor:"\u80cc\u666f\u989c\u8272"};A.title={h1:"\u6807\u9898 1",h2:"\u6807\u9898 2",h3:"\u6807\u9898 3",h4:"\u6807\u9898 4",p:"\u6b63 \u6587"};A.fontname={fontName:{SimSun:"\u5b8b\u4f53",NSimSun:"\u65b0\u5b8b\u4f53",FangSong_GB2312:"\u4eff\u5b8b_GB2312",KaiTi_GB2312:"\u6977\u4f53_GB2312",SimHei:"\u9ed1\u4f53","Microsoft YaHei":"\u5fae\u8f6f\u96c5\u9ed1",Arial:"Arial","Arial Black":"Arial Black","Times New Roman":"Times New Roman","Courier New":"Courier New",Tahoma:"Tahoma",Verdana:"Verdana"}}})(KindEditor);(function(B,A){B.plugin.about={click:function(C){B.util.selection(C);(new B.dialog({id:C,cmd:"about",file:"about.html",width:300,height:70,loadingMode:!0,title:B.lang.about,noButton:B.lang.close})).show()}};B.plugin.undo={init:function(C){B.event.ctrl(B.g[C].iframeDoc,"Z",function(){B.plugin.undo.click(C);B.util.focus(C)},C);B.event.ctrl(B.g[C].newTextarea,"Z",function(){B.plugin.undo.click(C);B.util.focus(C)},C)},click:function(C){B.history.undo(C);B.util.execOnchangeHandler(C)}};B.plugin.redo={init:function(C){B.event.ctrl(B.g[C].iframeDoc,"Y",function(){B.plugin.redo.click(C);B.util.focus(C)},C);B.event.ctrl(B.g[C].newTextarea,"Y",function(){B.plugin.redo.click(C);B.util.focus(C)},C)},click:function(C){B.history.redo(C);B.util.execOnchangeHandler(C)}};B.plugin.cut={click:function(C){try{if(!B.g[C].iframeDoc.queryCommandSupported("cut")){throw"e"}}catch(D){alert(B.lang.cutError);return }B.util.execCommand(C,"cut",null)}};B.plugin.copy={click:function(C){try{if(!B.g[C].iframeDoc.queryCommandSupported("copy")){throw"e"}}catch(D){alert(B.lang.copyError);return }B.util.execCommand(C,"copy",null)}};B.plugin.paste={click:function(C){try{if(!B.g[C].iframeDoc.queryCommandSupported("paste")){throw"e"}}catch(D){alert(B.lang.pasteError);return }B.util.execCommand(C,"paste",null)}};B.plugin.plainpaste={click:function(C){B.util.selection(C);this.dialog=new B.dialog({id:C,cmd:"plainpaste",file:"plainpaste.html",width:450,height:300,loadingMode:!0,title:B.lang.plainpaste,yesButton:B.lang.yes,noButton:B.lang.no});this.dialog.show()},exec:function(C){var D=B.util.getIframeDoc(this.dialog.iframe),D=B.$("textArea",D).value,D=B.util.escape(D),D=D.replace(/ /g,"&nbsp;"),D=B.g[C].newlineTag=="p"?D.replace(/^/,"<p>").replace(/$/,"</p>").replace(/\r\n|\n|\r/g,"</p><p>"):D.replace(/\r\n|\n|\r/g,"<br />$&");B.util.insertHtml(C,D);this.dialog.hide();B.util.focus(C)}};B.plugin.wordpaste={click:function(C){B.util.selection(C);this.dialog=new B.dialog({id:C,cmd:"wordpaste",file:"wordpaste.html",width:450,height:300,loadingMode:!0,title:B.lang.wordpaste,yesButton:B.lang.yes,noButton:B.lang.no});this.dialog.show()},exec:function(C){var D=B.util.getIframeDoc(this.dialog.iframe),D=B.$("wordIframe",D),D=B.util.getIframeDoc(D).body.innerHTML,D=D.replace(/<meta(\n|.)*?>/ig,""),D=D.replace(/<!(\n|.)*?>/ig,""),D=D.replace(/<style[^>]*>(\n|.)*?<\/style>/ig,""),D=D.replace(/<script[^>]*>(\n|.)*?<\/script>/ig,""),D=D.replace(/<w:[^>]+>(\n|.)*?<\/w:[^>]+>/ig,""),D=D.replace(/<xml>(\n|.)*?<\/xml>/ig,""),D=D.replace(/\r\n|\n|\r/ig,""),D=B.util.execGetHtmlHooks(C,D),D=B.format.getHtml(D,B.g[C].htmlTags,B.g[C].urlType);B.util.insertHtml(C,D);this.dialog.hide();B.util.focus(C)}};B.plugin.fullscreen={click:function(C){var D=B.g[C],J=this,I=function(){var K=B.util.getDocumentElement();D.width=K.clientWidth+"px";D.height=K.clientHeight+"px"},E="",G=function(){if(J.isSelected){var K=B.util.getDocumentElement(),K=[K.clientWidth,K.clientHeight].join("");E!=K&&(E=K,I(),B.util.resize(C,D.width,D.height))}};if(this.isSelected){this.isSelected=!1,B.util.setData(C),B.remove(C,1),D.width=this.width,D.height=this.height,B.create(C,2),document.body.parentNode.style.overflow="auto",B.event.remove(window,"resize",G),D.resizeMode=D.config.resizeMode,B.toolbar.unselect(C,"fullscreen")}else{this.isSelected=!0;this.width=D.container.style.width;this.height=D.container.style.height;B.util.setData(C);B.remove(C,2);document.body.parentNode.style.overflow="hidden";I();B.create(C,1);var H=B.util.getScrollPos(),F=D.container;F.style.position="absolute";F.style.left=H.x+"px";F.style.top=H.y+"px";F.style.zIndex=19811211;B.event.add(window,"resize",G);D.resizeMode=0;B.toolbar.select(C,"fullscreen")}}};B.plugin.bgcolor={click:function(C){B.util.selection(C);var D=B.queryCommandValue(B.g[C].iframeDoc,"bgcolor");this.menu=new B.menu({id:C,cmd:"bgcolor"});this.menu.picker(D)},exec:function(C,D){var E=new B.cmd(C);D==""?E.remove({span:[".background-color"]}):E.wrap("span",[{".background-color":D}]);B.util.execOnchangeHandler(C);this.menu.hide();B.util.focus(C)}};B.plugin.fontname={click:function(C){var D=B.lang.plugins.fontname.fontName;B.util.selection(C);var F=new B.menu({id:C,cmd:"fontname",width:150}),E=B.queryCommandValue(B.g[C].iframeDoc,"fontname");B.each(D,function(G,H){F.add('<span class="ke-reset" style="font-family: '+G+';">'+H+"</span>",function(){B.plugin.fontname.exec(C,G)},{checked:E===G.toLowerCase()||E===H.toLowerCase()})});F.show();this.menu=F},exec:function(C,D){(new B.cmd(C)).wrap("span",[{".font-family":D}]);B.util.execOnchangeHandler(C);this.menu.hide();B.util.focus(C)}};B.plugin.fontsize={click:function(C){var D=["9px","10px","12px","14px","16px","18px","24px","32px"];B.util.selection(C);for(var I=B.queryCommandValue(B.g[C].iframeDoc,"fontsize"),H=new B.menu({id:C,cmd:"fontsize",width:120}),E=0,F=D.length;E<F;E++){var G=D[E];H.add('<span class="ke-reset" style="font-size: '+G+';">'+G+"</span>",function(J){return function(){B.plugin.fontsize.exec(C,J)}}(G),{height:parseInt(G)+12+"px",checked:I===G})}H.show();this.menu=H},exec:function(C,D){(new B.cmd(C)).wrap("span",[{".font-size":D}]);B.util.execOnchangeHandler(C);this.menu.hide();B.util.focus(C)}};B.plugin.hr={click:function(C){B.util.selection(C);B.util.insertHtml(C,"<hr />");B.util.focus(C)}};B.plugin.print={click:function(C){B.util.selection(C);B.g[C].iframeWin.print()}};B.plugin.removeformat={click:function(C){B.util.selection(C);for(var D=new B.cmd(C),G={"*":["class","style"]},F=0,E=B.g[C].inlineTags.length;F<E;F++){G[B.g[C].inlineTags[F]]=["*"]}D.remove(G);B.util.execOnchangeHandler(C);B.toolbar.updateState(C);B.util.focus(C)}};B.plugin.source={click:function(C){var D=B.g[C];D.wyswygMode?(B.hideMenu(C),D.newTextarea.value=B.util.getData(C),D.iframe.style.display="none",D.newTextarea.style.display="block",B.toolbar.disable(C,["source","fullscreen"]),D.wyswygMode=!1,this.isSelected=!0,B.toolbar.select(C,"source")):(B.util.setFullHtml(C,D.newTextarea.value),D.iframe.style.display="block",D.newTextarea.style.display="none",B.toolbar.able(C,["source","fullscreen"]),D.wyswygMode=!0,this.isSelected=!1,B.toolbar.unselect(C,"source"));B.util.focus(C)}};B.plugin.textcolor={click:function(C){B.util.selection(C);var D=B.queryCommandValue(B.g[C].iframeDoc,"textcolor");this.menu=new B.menu({id:C,cmd:"textcolor"});this.menu.picker(D)},exec:function(C,D){var E=new B.cmd(C);D==""?E.remove({span:[".color"],font:["color"]}):E.wrap("span",[{".color":D}]);B.util.execOnchangeHandler(C);this.menu.hide();B.util.focus(C)}};B.plugin.title={click:function(C){var D=B.lang.plugins.title,D={H1:D.h1,H2:D.h2,H3:D.h3,H4:D.h4,P:D.p},G={H1:28,H2:24,H3:18,H4:14,P:12};B.util.selection(C);var F=B.queryCommandValue(B.g[C].iframeDoc,"formatblock"),E=new B.menu({id:C,cmd:"title",width:B.langType=="en"?200:150});B.each(D,function(H,J){var I="font-size:"+G[H]+"px;";H!=="P"&&(I+="font-weight:bold;");E.add('<span class="ke-reset" style="'+I+'">'+J+"</span>",function(){B.plugin.title.exec(C,"<"+H+">")},{height:G[H]+12+"px",checked:F===H.toLowerCase()||F===J.toLowerCase()})});E.show();this.menu=E},exec:function(C,D){B.util.select(C);B.util.execCommand(C,"formatblock",D);this.menu.hide();B.util.focus(C)}};B.plugin.emoticons={click:function(O){function Q(W){var U=B.$$("table");if(C){U.onmouseover=function(){C.style.display="block"},U.onmouseout=function(){C.style.display="none"}}U.className="ke-plugin-emoticons-table";U.cellPadding=0;U.cellSpacing=0;U.border=0;for(var W=(W-1)*K+M,Y=0;Y<I;Y++){for(var V=U.insertRow(Y),T=0;T<L;T++){var Z=V.insertCell(T);Z.className="ke-plugin-emoticons-cell";Z.onmouseover=C?function(e,d){return function(){e>J?(C.style.left=0,C.style.right=""):(C.style.left="",C.style.right=0);S.src=E+d+".gif";this.className="ke-plugin-emoticons-cell ke-plugin-emoticons-cell-on"}}(T,W):function(){this.className="ke-plugin-emoticons-cell ke-plugin-emoticons-cell-on"};Z.onmouseout=function(){this.className="ke-plugin-emoticons-cell"};Z.onclick=function(b){return function(){N.exec(O,b);return !1}}(W);var X=B.$$("span");X.className="ke-plugin-emoticons-img";X.style.backgroundPosition="-"+24*W+"px 0px";Z.appendChild(X);W++}}return U}function P(T){for(var V=1;V<=H;V++){if(T!==V){var U=B.$$("a");U.href="javascript:;";U.innerHTML="["+V+"]";U.onclick=function(W){return function(){F.removeChild(D);var X=Q(W);F.insertBefore(X,R);D=X;R.innerHTML="";P(W);return !1}}(V);R.appendChild(U)}else{R.appendChild(document.createTextNode("["+V+"]"))}R.appendChild(document.createTextNode(" "))}}var N=this,I=5,L=9,M=0,K=I*L,H=Math.ceil(135/K),J=Math.floor(L/2),G=B.g[O],E=G.pluginsPath+"emoticons/",G=G.allowPreviewEmoticons===A?!0:G.allowPreviewEmoticons;B.util.selection(O);var F=B.$$("div");F.className="ke-plugin-emoticons-wrapper";var C,S;if(G){C=B.$$("div"),C.className="ke-plugin-emoticons-preview",C.style.right=0,S=B.$$("img"),S.className="ke-reset",S.src=E+"0.gif",S.border=0,C.appendChild(S),F.appendChild(C)}var D=Q(1);F.appendChild(D);var R=B.$$("div");R.className="ke-plugin-emoticons-page";F.appendChild(R);P(1);G=new B.menu({id:O,cmd:"emoticons"});G.append(F);G.show();this.menu=G},exec:function(C,D){var E=B.g[C].pluginsPath+"emoticons/"+D+".gif";B.util.insertHtml(C,'<img src="'+E+'" kesrc="'+E+'" alt="" />');this.menu.hide();B.util.focus(C)}};B.plugin.flash={init:function(C){B.g[C].getHtmlHooks.push(function(D){return D.replace(/<img[^>]*class="?ke-flash"?[^>]*>/ig,function(F){var E=F.match(/style="[^"]*;?\s*width:\s*(\d+)/i)?RegExp.$1:0,G=F.match(/style="[^"]*;?\s*height:\s*(\d+)/i)?RegExp.$1:0,E=E||(F.match(/width="([^"]+)"/i)?RegExp.$1:0),G=G||(F.match(/height="([^"]+)"/i)?RegExp.$1:0);if(F.match(/kesrctag="([^"]+)"/i)){return F=B.util.getAttrList(unescape(RegExp.$1)),F.width=E||F.width||0,F.height=G||F.height||0,F.kesrc=F.src,B.util.getMediaEmbed(F)}})});B.g[C].setHtmlHooks.push(function(D){return D.replace(/<embed[^>]*type="application\/x-shockwave-flash"[^>]*>(?:<\/embed>)?/ig,function(E){var H=E.match(/\s+src="([^"]+)"/i)?RegExp.$1:"";if(E.match(/\s+kesrc="([^"]+)"/i)){H=RegExp.$1}var F=E.match(/\s+width="([^"]+)"/i)?RegExp.$1:0,G=E.match(/\s+height="([^"]+)"/i)?RegExp.$1:0,E=B.util.getAttrList(E);E.src=H;E.width=F;E.height=G;return B.util.getMediaImage(C,"flash",E)})})},click:function(C){B.util.selection(C);this.dialog=new B.dialog({id:C,cmd:"flash",file:"flash.html",width:400,height:140,loadingMode:!0,title:B.lang.flash,yesButton:B.lang.yes,noButton:B.lang.no});this.dialog.show()},check:function(C,D,F,E){C=B.util.getIframeDoc(this.dialog.iframe);if(!D.match(/^.{3,}$/)){return alert(B.lang.invalidUrl),B.$("url",C).focus(),!1}if(!F.match(/^\d*$/)){return alert(B.lang.invalidWidth),B.$("width",C).focus(),!1}if(!E.match(/^\d*$/)){return alert(B.lang.invalidHeight),B.$("height",C).focus(),!1}return !0},exec:function(C){var D=B.util.getIframeDoc(this.dialog.iframe),F=B.$("url",D).value,E=B.$("width",D).value,D=B.$("height",D).value;if(!this.check(C,F,E,D)){return !1}F=B.util.getMediaImage(C,"flash",{src:F,type:B.g[C].mediaTypes.flash,width:E,height:D,quality:"high"});B.util.insertHtml(C,F);this.dialog.hide();B.util.focus(C)}};B.plugin.image={getSelectedNode:function(C){var C=B.g[C],D=C.keRange.startNode,E=C.keRange.endNode;if((B.browser.WEBKIT||C.keSel.isControl)&&D.nodeType==1&&D.tagName.toLowerCase()=="img"&&D==E&&!D.className.match(/^ke-\w+/i)){return D}},init:function(C){var D=this,C=B.g[C];C.contextmenuItems.push({text:B.lang.editImage,click:function(E,F){B.util.select(E);F.hide();D.click(E)},cond:function(E){return D.getSelectedNode(E)},options:{width:"150px",iconHtml:'<span class="ke-common-icon ke-common-icon-url ke-icon-image"></span>'}});C.contextmenuItems.push({text:B.lang.deleteImage,click:function(E,G){B.util.select(E);G.hide();var F=D.getSelectedNode(E);F.parentNode.removeChild(F);B.util.execOnchangeHandler(E)},cond:function(E){return D.getSelectedNode(E)},options:{width:"150px"}});C.contextmenuItems.push("-")},click:function(C){B.util.selection(C);this.dialog=new B.dialog({id:C,cmd:"image",file:"image/image.html",width:400,height:220,loadingMode:!0,title:B.lang.image,yesButton:B.lang.yes,noButton:B.lang.no});this.dialog.show()},check:function(){var C=B.util.getIframeDoc(this.dialog.iframe),D=B.$("type",C).value,F=B.$("imgWidth",C).value,E=B.$("imgHeight",C).value;B.$("imgTitle",C);D=D==2?B.$("imgFile",C):B.$("url",C);if(!D.value.match(/\.(jpg|jpeg|gif|bmp|png)(\s|\?|$)/i)){return alert(B.lang.invalidImg),D.focus(),!1}if(!F.match(/^\d*$/)){return alert(B.lang.invalidWidth),B.$("imgWidth",C).focus(),!1}if(!E.match(/^\d*$/)){return alert(B.lang.invalidHeight),B.$("imgHeight",C).focus(),!1}return !0},exec:function(N){for(var O=this,M=B.util.getIframeDoc(this.dialog.iframe),L=B.$("type",M).value,G=B.$("imgWidth",M).value,J=B.$("imgHeight",M).value,K=B.$("imgTitle",M).value,I=M.getElementsByName("align"),F="",H=0,E=I.length;H<E;H++){if(I[H].checked){F=I[H].value;break}}if(!this.check(N)){return !1}if(L==2){B.$("editorId",M).value=N;var C=B.$("uploadIframe",M);B.util.showLoadingPage(N);var D=function(){B.event.remove(C,"load",D);B.util.hideLoadingPage(N);var R=B.util.getIframeDoc(C),Q="";try{Q=B.util.parseJson(R.body.innerHTML)}catch(P){alert(B.lang.invalidJson)}if(typeof Q==="object"&&"error" in Q){if(Q.error===0||Q.error==="0"){R=B.format.getUrl(Q.url,"absolute"),O.insert(N,R,K,G,J,0,F)}else{return alert(Q.message),!1}}};B.event.add(C,"load",D);M.uploadForm.submit()}else{M=B.$("url",M).value,this.insert(N,M,K,G,J,0,F)}},insert:function(C,D,I,H,E,F,G){D='<img src="'+D+'" kesrc="'+D+'" ';H>0&&(D+='width="'+H+'" ');E>0&&(D+='height="'+E+'" ');I&&(D+='title="'+I+'" ');G&&(D+='align="'+G+'" ');D+='alt="'+I+'" ';F&&(D+='border="'+F+'" ');D+="/>";B.util.insertHtml(C,D);this.dialog.hide();B.util.focus(C)}};B.plugin.link={getSelectedNode:function(C){return B.getCommonAncestor(B.g[C].keSel,"a")},init:function(C){var D=this;B.g[C].contextmenuItems.push({text:B.lang.editLink,click:function(E,F){B.util.select(E);F.hide();D.click(E)},cond:function(E){return D.getSelectedNode(E)},options:{width:"150px",iconHtml:'<span class="ke-common-icon ke-common-icon-url ke-icon-link"></span>'}})},click:function(C){B.util.selection(C);this.dialog=new B.dialog({id:C,cmd:"link",file:"link/link.html",width:400,height:90,loadingMode:!0,title:B.lang.link,yesButton:B.lang.yes,noButton:B.lang.no});this.dialog.show()},exec:function(L){var M=B.g[L];B.util.select(L);var K=M.keRange,J=K.startNode,E=K.endNode,H=M.iframeDoc,I=B.util.getIframeDoc(this.dialog.iframe),G=B.$("hyperLink",I).value,D=B.$("linkType",I).value;if(!G.match(/.+/)||G.match(/^\w+:\/\/\/?$/)){return alert(B.lang.invalidUrl),B.$("hyperLink",I).focus(),!1}for(I=K.getParentElement();I;){if(I.tagName.toLowerCase()=="a"||I.tagName.toLowerCase()=="body"){break}I=I.parentNode}var I=I.parentNode,E=B.browser.IE?!!M.range.item:J.nodeType==1&&J===E&&J.nodeName.toLowerCase()!="br",F=!E;E||(F=B.browser.IE?M.range.text==="":M.range.toString()==="");if(F||B.util.isEmpty(L)){M='<a href="'+G+'"',D&&(M+=' target="'+D+'"'),M+=">"+G+"</a>",B.util.insertHtml(L,M)}else{H.execCommand("createlink",!1,"__ke_temp_url__");for(var I=I.getElementsByTagName("a"),F=0,C=I.length;F<C;F++){if(I[F].href.match(/\/?__ke_temp_url__$/)){I[F].href=G,I[F].setAttribute("kesrc",G),D?I[F].target=D:I[F].removeAttribute("target")}}if(B.browser.WEBKIT&&E&&J.tagName.toLowerCase()=="img"){E=J.parentNode,E.tagName.toLowerCase()!="a"&&(H=B.$$("a",H),E.insertBefore(H,J),H.appendChild(J),E=H),E.href=G,E.setAttribute("kesrc",G),D?E.target=D:E.removeAttribute("target"),M.keSel.addRange(K)}}B.util.execOnchangeHandler(L);this.dialog.hide();B.util.focus(L)}};B.plugin.unlink={init:function(C){var D=this;B.g[C].contextmenuItems.push({text:B.lang.deleteLink,click:function(E,F){B.util.select(E);F.hide();D.click(E)},cond:function(E){return B.plugin.link.getSelectedNode(E)},options:{width:"150px",iconHtml:'<span class="ke-common-icon ke-common-icon-url ke-icon-unlink"></span>'}});B.g[C].contextmenuItems.push("-")},click:function(C){var D=B.g[C],H=D.iframeDoc;B.util.selection(C);var G=D.keRange,E=G.startNode,G=G.endNode,G=E.nodeType==1&&E===G,F=!G;G||(F=B.browser.IE?D.range.text==="":D.range.toString()==="");if(F){F=B.plugin.link.getSelectedNode(C);if(!F){return }G=D.keRange;G.selectTextNode(F);D.keSel.addRange(G);B.util.select(C);H.execCommand("unlink",!1,null);if(B.browser.WEBKIT&&E.tagName.toLowerCase()=="img"){H=E.parentNode,H.tagName.toLowerCase()=="a"&&(B.util.removeParent(H),D.keSel.addRange(G))}}else{H.execCommand("unlink",!1,null)}B.util.execOnchangeHandler(C);B.toolbar.updateState(C);B.util.focus(C)}};B.plugin.media={init:function(C){var D={};B.each(B.g[C].mediaTypes,function(E,F){D[F]=E});B.g[C].getHtmlHooks.push(function(E){return E.replace(/<img[^>]*class="?ke-\w+"?[^>]*>/ig,function(G){var F=G.match(/style="[^"]*;?\s*width:\s*(\d+)/i)?RegExp.$1:0,H=G.match(/style="[^"]*;?\s*height:\s*(\d+)/i)?RegExp.$1:0,F=F||(G.match(/width="([^"]+)"/i)?RegExp.$1:0),H=H||(G.match(/height="([^"]+)"/i)?RegExp.$1:0);if(G.match(/\s+kesrctag="([^"]+)"/i)){return G=B.util.getAttrList(unescape(RegExp.$1)),G.width=F||G.width||0,G.height=H||G.height||0,G.kesrc=G.src,B.util.getMediaEmbed(G)}})});B.g[C].setHtmlHooks.push(function(E){return E.replace(/<embed[^>]*type="([^"]+)"[^>]*>(?:<\/embed>)?/ig,function(K,G){if(typeof D[G]=="undefined"){return K}var I=K.match(/\s+src="([^"]+)"/i)?RegExp.$1:"";if(K.match(/\s+kesrc="([^"]+)"/i)){I=RegExp.$1}var J=K.match(/\s+width="([^"]+)"/i)?RegExp.$1:0,H=K.match(/\s+height="([^"]+)"/i)?RegExp.$1:0,F=B.util.getAttrList(K);F.src=I;F.width=J;F.height=H;return B.util.getMediaImage(C,"",F)})})},click:function(C){B.util.selection(C);this.dialog=new B.dialog({id:C,cmd:"media",file:"media.html",width:400,height:170,loadingMode:!0,title:B.lang.media,yesButton:B.lang.yes,noButton:B.lang.no});this.dialog.show()},check:function(C,D,F,E){C=B.util.getIframeDoc(this.dialog.iframe);if(!D.match(/^.{3,}\.(swf|flv|mp3|wav|wma|wmv|mid|avi|mpg|mpeg|asf|rm|rmvb)(\?|$)/i)){return alert(B.lang.invalidMedia),B.$("url",C).focus(),!1}if(!F.match(/^\d*$/)){return alert(B.lang.invalidWidth),B.$("width",C).focus(),!1}if(!E.match(/^\d*$/)){return alert(B.lang.invalidHeight),B.$("height",C).focus(),!1}return !0},exec:function(C){var D=B.util.getIframeDoc(this.dialog.iframe),G=B.$("url",D).value,F=B.$("width",D).value,E=B.$("height",D).value;if(!this.check(C,G,F,E)){return !1}D=B.$("autostart",D).checked?"true":"false";G=B.util.getMediaImage(C,"",{src:G,type:B.g[C].mediaTypes[B.util.getMediaType(G)],width:F,height:E,autostart:D,loop:"true"});B.util.insertHtml(C,G);this.dialog.hide();B.util.focus(C)}};B.plugin.advtable={getSelectedTable:function(C){return B.getCommonAncestor(B.g[C].keSel,"table")},getSelectedRow:function(C){return B.getCommonAncestor(B.g[C].keSel,"tr")},getSelectedCell:function(C){return B.getCommonAncestor(B.g[C].keSel,"td")},tableprop:function(C){this.click(C)},tablecellprop:function(C){var D=this;B.util.selection(C);var E=new B.dialog({id:C,cmd:"advtable",file:"advtable/cell.html",width:420,height:150,loadingMode:!0,title:B.lang.tablecell,yesButton:B.lang.yes,noButton:B.lang.no,yesClickFn:function(Q){var P=B.util.getIframeDoc(E.iframe),N=B.$("width",P),O=B.$("height",P),M=B.$("widthType",P),K=B.$("heightType",P),L=B.$("textAlign",P),J=B.$("verticalAlign",P),H=B.$("border",P),I=B.$("borderColor",P),F=B.$("backgroundColor",P),P=N.value,R=O.value,M=M.value,K=K.value,L=L.value,J=J.value,G=H.value,I=I.innerHTML,F=F.innerHTML;if(!P.match(/^\d*$/)){return alert(B.lang.invalidWidth),N.focus(),!1}if(!R.match(/^\d*$/)){return alert(B.lang.invalidHeight),O.focus(),!1}if(!G.match(/^\d*$/)){return alert(B.lang.invalidBorder),H.focus(),!1}N=D.getSelectedCell(Q);N.style.width=P!==""?P+M:"";N.style.height=R!==""?R+K:"";N.style.backgroundColor=F;N.style.textAlign=L;N.style.verticalAlign=J;N.style.borderWidth=G;N.style.borderStyle=G!==""?"solid":"";N.style.borderColor=I;B.util.execOnchangeHandler(Q);E.hide();B.util.focus(Q)}});E.show()},tableinsert:function(C){this.click(C,"insert")},tabledelete:function(C){C=this.getSelectedTable(C);C.parentNode.removeChild(C)},tablecolinsert:function(C,D){for(var H=this.getSelectedTable(C),G=this.getSelectedCell(C).cellIndex+D,E=0,F=H.rows.length;E<F;E++){H.rows[E].insertCell(G).innerHTML="&nbsp;"}},tablecolinsertleft:function(C){this.tablecolinsert(C,0)},tablecolinsertright:function(C){this.tablecolinsert(C,1)},tablerowinsert:function(C,D){for(var G=this.getSelectedTable(C),F=this.getSelectedRow(C),G=G.insertRow(F.rowIndex+D),E=0,F=F.cells.length;E<F;E++){G.insertCell(E).innerHTML="&nbsp;"}},tablerowinsertabove:function(C){this.tablerowinsert(C,0)},tablerowinsertbelow:function(C){this.tablerowinsert(C,1)},tablecoldelete:function(C){for(var D=this.getSelectedTable(C),C=this.getSelectedCell(C).cellIndex,F=0,E=D.rows.length;F<E;F++){D.rows[F].deleteCell(C)}},tablerowdelete:function(C){var D=this.getSelectedTable(C),C=this.getSelectedRow(C);D.deleteRow(C.rowIndex)},init:function(G){for(var C=this,H="prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,coldelete,rowdelete,insert,delete".split(","),F=0,D=H.length;F<D;F++){var E="table"+H[F];B.g[G].contextmenuItems.push({text:B.lang[E],click:function(I){return function(K,J){B.util.select(K);J.hide();if(C[I]!==A){C[I](K)}/prop/.test(I)||B.util.execOnchangeHandler(K)}}(E),cond:function(I){return B.util.inArray(I,["tableprop","tabledelete"])?function(J){return C.getSelectedTable(J)}:function(J){return C.getSelectedCell(J)}}(E),options:{width:"170px",iconHtml:'<span class="ke-common-icon ke-common-icon-url ke-icon-'+E+'"></span>'}})}B.g[G].contextmenuItems.push("-");B.g[G].setHtmlHooks.push(function(I){return I.replace(/<table([^>]*)>/ig,function(K,J){if(J.match(/\s+border=["']?(\d*)["']?/ig)){var L=RegExp.$1;return J.indexOf("ke-zeroborder")<0&&(L===""||L==="0")?B.addClass(K,"ke-zeroborder"):K}else{return B.addClass(K,"ke-zeroborder")}})})},click:function(C,D){D=D||"default";B.util.selection(C);this.dialog=new B.dialog({id:C,cmd:"advtable",file:"advtable/advtable.html?mode="+D,width:420,height:220,loadingMode:!0,title:B.lang.advtable,yesButton:B.lang.yes,noButton:B.lang.no});this.dialog.show()},exec:function(V){var W=B.util.getIframeDoc(this.dialog.iframe),U=B.$("mode",W),T=B.$("rows",W),O=B.$("cols",W),R=B.$("width",W),S=B.$("height",W),Q=B.$("widthType",W),N=B.$("heightType",W),P=B.$("padding",W),M=B.$("spacing",W),K=B.$("align",W),L=B.$("border",W),H=B.$("borderColor",W),G=B.$("backgroundColor",W),W=T.value,I=O.value,E=R.value,C=S.value,Q=Q.value,J=N.value,N=P.value,D=M.value,K=K.value,F=L.value,H=H.innerHTML,G=G.innerHTML;if(W==""||W==0||!W.match(/^\d*$/)){return alert(B.lang.invalidRows),T.focus(),!1}if(I==""||I==0||!I.match(/^\d*$/)){return alert(B.lang.invalidCols),O.focus(),!1}if(!E.match(/^\d*$/)){return alert(B.lang.invalidWidth),R.focus(),!1}if(!C.match(/^\d*$/)){return alert(B.lang.invalidHeight),S.focus(),!1}if(!N.match(/^\d*$/)){return alert(B.lang.invalidPadding),P.focus(),!1}if(!D.match(/^\d*$/)){return alert(B.lang.invalidSpacing),M.focus(),!1}if(!F.match(/^\d*$/)){return alert(B.lang.invalidBorder),L.focus(),!1}if(U.value==="update"){W=this.getSelectedTable(V),W.style.width=E!==""?E+Q:"",W.style.height=C!==""?C+J:"",W.style.backgroundColor=G,B.attr(W,"width",""),B.attr(W,"height",""),B.attr(W,"bgColor",""),B.attr(W,"cellPadding",N),B.attr(W,"cellSpacing",D),B.attr(W,"align",K),F===""||F==="0"?B.addClass(W,"ke-zeroborder"):B.removeClass(W,"ke-zeroborder"),B.attr(W,"border",F),B.attr(W,"borderColor",H),B.util.execOnchangeHandler(V)}else{U="";E!==""&&(U+="width:"+E+Q+";");C!==""&&(U+="height:"+C+J+";");G!==""&&(U+="background-color:"+G+";");E="<table";U!==""&&(E+=' style="'+U+'"');N!==""&&(E+=' cellpadding="'+N+'"');D!==""&&(E+=' cellspacing="'+D+'"');K!==""&&(E+=' align="'+K+'"');if(F===""||F==="0"){E+=' class="ke-zeroborder"'}F!==""&&(E+=' border="'+F+'"');H!==""&&(E+=' bordercolor="'+H+'"');E+=">";for(C=0;C<W;C++){E+="<tr>";for(U=0;U<I;U++){E+="<td>&nbsp;</td>"}E+="</tr>"}E+="</table>";B.util.insertHtml(V,E)}this.dialog.hide();B.util.focus(V)}}})(KindEditor);Artery.plugin.FaNumericInput=Ext.extend(Ext.form.NumberField,{allowDomMove:false,autoEl:null,decimalPrecision:-1,maxPLength:0,vu_wu:"无",vu_bai:"百",vu_qian:"千",vu_wan:"万",vu_shiwan:"十万",vu_i_wu:1,vu_i_bai:100,vu_i_qian:1000,vu_i_wan:10000,vu_i_shiwan:100000,hasValueUnit:false,hiddenEl:null,onRender:function(B,A){Artery.plugin.FaStringInput.prototype.onRender.call(this,B,A);this.hasValueUnit=(this.valueUnit=="无"||typeof (this.valueUnit)=="undefined")?false:true;if(this.hasValueUnit){this.el.on("keyup",this.onKeyUpSY,this);this.hiddenEl=this.el.next("input",true)}},_getNumberVal:function(A){if(A==null){return""}else{if((A+"")==""){return""}return parseFloat(A)}},getValue:function(){var A=this._getNumberVal(Artery.plugin.FaNumericInput.superclass.getValue.call(this));return this.getRealValue(A)},setValue:function(B,C){var D=B;var A=this.value;B=this.getShowValue(B);if(this.readOnly&&this.showType){Ext.form.NumberField.superclass.setValue.call(this,B)}else{B=this._getNumberVal(B);if(this.hasValueUnit&&this.maxPLength!=0&&Ext.isNumber(B)){B=B.toFixed(this.maxPLength)}Ext.form.NumberField.superclass.setValue.call(this,B)}this.value=D;Artery.setSubmitHiddenValue(this.id,this.getValue());if(C){this.fireEvent("change",this,this.value,A==null?"":A)}},beforeBlur:function(){},onBlur:function(){if(this.readOnly){return }Artery.plugin.FaNumericInput.superclass.onBlur.call(this)},onKeyUpSY:function(){this.hiddenEl.value=this.getValue();this.value=this.hiddenEl.value},getRealValue:function(A){if(!this.hasValueUnit||Ext.isEmpty(A)){return A}var B=A;switch(this.valueUnit){case this.vu_wu:B=A*this.vu_i_wu;break;case this.vu_bai:B=this.accMul(A,100);break;case this.vu_qian:B=this.accMul(A,1000);break;case this.vu_wan:B=this.accMul(A,10000);break;case this.vu_shiwan:B=this.accMul(A,100000);break;default:break}return B},accMul:function(D,B){var A=0,E=D.toString(),C=B.toString();try{A+=E.split(".")[1].length}catch(F){}try{A+=C.split(".")[1].length}catch(F){}return Number(E.replace(".",""))*Number(C.replace(".",""))/Math.pow(10,A)},getShowValue:function(B){if(!this.hasValueUnit||Ext.isEmpty(B)){return B}var A=B;switch(this.valueUnit){case this.vu_wu:A=B/this.vu_i_wu;break;case this.vu_bai:A=B/this.vu_i_bai;break;case this.vu_qian:A=B/this.vu_i_qian;break;case this.vu_wan:A=B/this.vu_i_wan;break;case this.vu_shiwan:A=B/this.vu_i_shiwan;break;default:break}return A},validateValue:function(E){if(typeof this.validator=="function"){var H=this.validator(E);if(H!==true){this.markInvalid(H);return false}}if(E.length<1||E===this.emptyText){if(this.allowBlank){this.clearInvalid();return true}else{this.markInvalid(this.blankText);return false}}if(E.length<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));return false}var C=E.length;var D=0;var A=E.indexOf(".");if(A!=-1){var G=E.split(".");C=G[0].length;D=G[1].length}if(C>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));return false}if(D>this.maxPLength){if(this.maxPLength==0){this.markInvalid(String.format(this.zeroPLengthText))}else{this.markInvalid(String.format(this.maxPLengthText,this.maxPLength))}return false}if(this.vtype){var F=Ext.form.VTypes;if(!F[this.vtype](E,this)){this.markInvalid(this.vtypeText||F[this.vtype+"Text"]);return false}}if(this.regex&&!this.regex.test(E)){this.markInvalid(this.regexText);return false}if(E.length<1){return true}E=String(E).replace(this.decimalSeparator,".");if(isNaN(E)){this.markInvalid(String.format(this.nanText,E));return false}var B=this.parseValue(E);if(B<this.minValue){this.markInvalid(String.format(this.minText,this.minValue));return false}if(B>this.maxValue){this.markInvalid(String.format(this.maxText,this.maxValue));return false}if(!Ext.isEmpty(E)&&(E.charAt(0)=="."||E.charAt(E.length-1)==".")){this.markInvalid(this.startEndText);return false}return true},onDisable:function(){this.getActionEl().addClass(this.disabledClass);this.el.dom.disabled=true;if(this.getLabelEl()!=null){this.getLabelEl().addClass("x-form-label-disabled")}if(Ext.isIE){this.el.dom.unselectable="on"}if(Ext.isTrue(this.submitDisabled)){if(!this.hiddenEl){if(!document.getElementById(this.id+"_hidden")){var B=this.el.dom.name;var A=Artery.createHiddenInput(this.id,B,this.getValue());this.el.dom.parentNode.appendChild(A)}}}else{if(this.hiddenEl){this.hiddenEl.disabled=true}}},onEnable:function(){Artery.plugin.FaStringInput.superclass.onEnable.call(this);if(Ext.isTrue(this.submitDisabled)){if(!this.hiddenEl){var A=document.getElementById(this.id+"_hidden");if(A){this.el.dom.parentNode.removeChild(A)}}}else{if(this.hiddenEl){this.hiddenEl.disabled=false}}}});Ext.reg("apfanumericinput",Artery.plugin.FaNumericInput);Artery.plugin.SOrganTree=Ext.extend(Artery.plugin.TwinTriggerField,{margin:true,enablePinyin:true,organTree:null,organWin:null,readOnly:false,organType:"user",rootCfg:null,valueText:"",valuePath:"",expandValue:"",expandValuePath:"",nodeType:null,searchCount:-1,searchFlag:1,selectList:true,itemType:"faOrgan",moreProp:"STree",initComponent:function(){this.originalType=this.organType;if(this.margin){this.defaultAutoCreate.style="margin:0;"}Artery.plugin.SOrganTree.superclass.initComponent.call(this);if(Ext.isTrue(this.selectList)){this.plugins=new Ext.tusc.plugins.Select()}Ext.EventManager.on(window,"unload",function(){try{if(this.organWin){this.organWin.destroy();this.organWin=null}}catch(A){}},this)},submitValue:function(){var A=this.getValue();if(this.valueTemp!==undefined&&this.valueTextTemp!==undefined){this.nodeType=this.nodeTypeTemp;this.setValue(this.valueTemp,this.valueTextTemp)}this.startValue=this.getValue();this.organWin.hide();this.fireEvent("change",this,this.value,A)},setValue:function(B,A,C){var D=this.getValue();if(this.hiddenField){this.hiddenField.value=Ext.isEmpty(B)?"":B}this.setTriggerState(B);if(Ext.isEmpty(B)){this.valueText="";Artery.plugin.TwinTriggerField.superclass.setValue.call(this,this.valueText);this.value=B}else{if(A===undefined&&this.upValueText){this.value=B;this.upValueText(B)}else{this.valueText=A;Artery.plugin.TwinTriggerField.superclass.setValue.call(this,this.valueText);this.value=B}}if(!Ext.isTrue(this.initSte)){this.validate()}if(C===true&&B!=D){this.fireEvent("change",this,B,D)}},reset:function(){if(!this.rendered){return }this.organType=this.originalType;this.nodeType=this.originalType;if(this.originalValue+""==this.value+""){return }this.setValueNoValid(this.originalValue);this.clearInvalid()},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.organWin==null){var A=Artery.getParams({organType:this.organType},this);if(!Artery.params){A.itemType=this.itemType;A.moreProp=this.moreProp}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseOrgan",success:function(B,C){if(Ext.isEmpty(B.responseText)){Artery.alertMsg("错误提示","根节点错误！");return }this.rootCfg=Ext.decode(B.responseText);this.initOrganWin();this.showOrganWin()},params:A,scope:this})}else{this.showOrganWin()}},reload:function(B){this.initSte=true;this.setValue("");this.initSte=false;if(B==null){B={}}if(B.params==null){B.params={}}var A=Artery.getParams({organType:this.organType},this);if(!Artery.params){A.itemType=this.itemType;A.moreProp=this.moreProp}if(Ext.isTrue(B.clearParam)){this.reloadParams=B.params}else{if(!this.reloadParams){this.reloadParams={}}Ext.apply(this.reloadParams,B.params)}Ext.apply(A,B.params);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseOrgan",success:function(C,D){if(Ext.isEmpty(C.responseText)){Artery.alertMsg("错误提示","根节点错误！");return }this.rootCfg=Ext.decode(C.responseText);if(this.organWin==null){this.initOrganWin()}else{this.initRootNode()}if(B.callback){B.callback.call(this)}},params:A,scope:this})},createRootNode:function(B){var A={draggable:false,expanded:true};Ext.apply(A,B);if(!B.multi){A.uiProvider=Ext.tree.TreeSingleNodeUI;A.uuid=B.uuid}return new Ext.tree.AsyncTreeNode(A)},initRootNode:function(){if(this.root){this.root.destroy()}var A={organType:this.organType,uuid:this.organTree.loader.baseAttrs.uuid};Ext.apply(A,this.rootCfg);this.root=Artery.pwin.Artery.plugin.SOrganTree.prototype.createRootNode(A);this.organTree.setRootNode(this.root)},showOrganWin:function(){this.organWin.show();if(this.geditor){this.geditor.allowBlur=true}if(Ext.isEmpty(this.value)){this.clearTree()}else{if(this.organTree){Artery.plugin.faTreeFunc.skinSelectedNode(this.organTree,this.getValue())}}this.expandNodePath()},getItemId:Artery.plugin.PopupTrigger.prototype.getItemId,initOrganWin:function(){this.organWin=Artery.pwin.Artery.plugin.SOrganTree.prototype.createOrganWin({field:this,windowHeight:this.windowHeight});this.organTree.on("checkchange",this.onCheckchange,this);this.organTree.on("beforeload",this.onBeforeload,this);if(Ext.isTrue(this.singleClickCheck)){this.organTree.on("click",this.singleClickCheckHandler,this)}if(Ext.isTrue(this.dblClickReturn)){this.organTree.on("dblclick",this.dblClickReturnHandler,this)}if(this.searchField){this.searchField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.searchFlag=1;this.searchUser()}else{this.searchCount=-1}},this)}if(this.searchBtn){this.searchBtn.on("click",function(){this.searchFlag=1;this.searchUser()},this)}this.okBtn.on("click",this.submitValue,this);this.closeBtn.on("click",function(){this.organWin.hide()},this);this.initRootNode();this.organWin.on("hide",this.onWinHide,this)},createOrganWin:function(A){var D=null;if(A.field.organType=="user"||A.field.organType=="all"){D=[A.field.searchField=new Ext.form.TextField({emptyText:"请输入人员姓名"+(A.field.enablePinyin?"或简拼":""),width:230,enableKeyEvents:true}),"-",A.field.searchBtn=new Ext.Button({text:"查找"})]}var B=Ext.id();A.field.organTree=new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,border:false,bbar:D,style:"background-color:#fff;",loader:new Ext.tree.TreeLoader({baseAttrs:A.multi?null:{uiProvider:Ext.tree.TreeSingleNodeUI,uuid:B},dataUrl:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadOrganTree"}),eventModel:A.multi?null:Ext.tusc.TreeRadioEvent});var C=new Ext.Window({layout:"fit",width:300,height:Ext.num(A.windowHeight,400),closeAction:"hide",modal:true,shadow:false,resizable:false,items:[A.field.organTree],buttons:[A.field.okBtn=new Ext.Button({text:"确定"}),A.field.closeBtn=new Ext.Button({text:"关闭"})]});return C},onWinHide:function(){this.clearTempValue();this.focus();this.validate();if(this.geditor){this.geditor.allowBlur=false;this.geditor.completeEdit()}},clearTempValue:function(){delete this.valueTemp;delete this.valueTextTemp;delete this.nodeTypeTemp;this.clearSearchInfo()},clearSearchInfo:function(){if(this.searchField!=null){this.searchField.setValue(null);this.searchCount=-1;this.searchFlag=1}},onCheckchange:function(C,B){var A=C.attributes;this.valueTextTemp=A.text;this.valueTemp=A.cid;this.nodeTypeTemp=A.type;C.select()},onBeforeload:function(B){var A=this.organTree.loader;A.baseParams.type=B.attributes.type;A.baseParams.id=B.attributes.cid;A.baseParams.organType=this.organType;A.baseParams.custParams=Ext.encode(this.custParams);Ext.apply(A.baseParams,this.reloadParams);Ext.applyIf(A.baseParams,Artery.getParams({},this));if(!Artery.params){A.baseParams.itemType=this.itemType;A.baseParams.moreProp=this.moreProp}},singleClickCheckHandler:Artery.plugin.faTreeFunc.singleClickCheckHandler,dblClickReturnHandler:Artery.plugin.faTreeFunc.dblClickReturnHandler,clearTree:function(){var A=this.organTree.getSelectionModel().getSelectedNode();if(A){A.unselect();if(A.ui.checkbox){A.ui.checkbox.checked=false;A.ui.checkbox.defaultChecked=false}}},expandNodePath:function(){if(!Ext.isEmpty(this.valuePath)&&!Ext.isEmpty(this.value)){this.expandNode(this.valuePath,true,true);this.valuePath=null;return }if(!Ext.isEmpty(this.expandValuePath)&&!Ext.isEmpty(this.expandValue)){this.expandNode(this.expandValuePath,false,true);return }},searchUser:function(){if(this.searchField==null){return }var B=this.searchField.getValue();if(!Ext.isEmpty(B)){var A=Artery.getParams({searchCount:this.searchCount,searchText:B,searchFlag:this.searchFlag},this);if(!Artery.params){A.itemType=this.itemType;A.moreProp=this.moreProp}if(this.organTree&&this.organTree.container){this.organTree.container.mask("正在加载数据...")}if(this.reloadParams){Ext.apply(A,this.reloadParams)}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=searchOrganTree",success:function(C,D){var E=Ext.decode(C.responseText);if(E.searchCount!=null){this.searchCount=E.searchCount}if(E.errorCode==1){if(this.organTree&&this.organTree.container){this.organTree.container.unmask()}return }this.expandNode(E.path);if(this.organTree&&this.organTree.container){this.organTree.container.unmask()}},scope:this,params:A})}},expandNode:function(J,G,F){var E=this;var C=this.valueWithType;var B=J.split(",");if(Ext.isTrue(C)){var I=this.rootCfg.cid}else{var I=this.rootCfg.type+"_"+this.rootCfg.cid}var D=false;while(B.length>0){var A=B.shift();if(I==A){D=true;break}}if(B.length==0){if(D){this.root.select();if(G==true){this.root.ui.checkbox.checked=true}if(F==true){this.root.expand(false,false)}if(this.searchField){this.searchField.focus()}}else{E.searchUser()}return }var H=function(K){var L=B.shift();var M=K.findChildBy(function(P){if(Ext.isTrue(C)){if(P.attributes.cid==L){return true}}else{var O=L.substring(0,4);var N=L.substr(5);if(P.attributes.type==O&&P.attributes.cid==N){return true}}});if(M==null){E.searchFlag=2;E.searchUser();return }if(B.length==0){M.select();if(G==true){M.ui.checkbox.checked=true}if(F==true){M.expand(false,false,function(N){if(N.hasChildNodes()&&N.lastChild){N.lastChild.ensureVisible();N.ensureVisible()}})}if(this.searchField){this.searchField.focus()}return }M.expand(false,false,H,this)};this.root.expand(false,false,H,this)},upValueText:function(){var A=Artery.getParams({id:this.getValue(),type:this.nodeType==null?this.organType:this.nodeType,valueWithType:this.valueWithType},this);if(!Artery.params){A.itemType=this.itemType;A.moreProp=this.moreProp}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getOrganNodeDetail",success:function(B,C){var E=Ext.decode(B.responseText);var D=E.valueText;if(Ext.isEmpty(D)){D=this.value}this.valuePath=E.valuePath;this.setValueText(D)},scope:this,syn:false,params:A})},validateRightValue:function(){if(Ext.isTrue(this.isCallByVRV)){return this.lastVRV_Result}var B=Artery.getParams({itemType:"faOrgan",organType:this.organType,valueText:this.getValueText(),value:this.getValue()},this);if(this.reloadParams){Ext.apply(B,this.reloadParams)}var A=true;Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=validateRightValue",success:function(C,D){var E=Ext.decode(C.responseText);this.isCallByVRV=true;if(Ext.isEmpty(E.value)){this.setValue();this.setValueText(E.valueText)}else{this.setValue(E.value,E.valueText)}delete this.isCallByVRV;if(!Ext.isTrue(E.success)){if(!(this.plugins&&this.plugins.isExpanded())){this.markInvalid(E.message)}A=false}},syn:false,params:B,scope:this});this.lastVRV_Result=A;return A},getEventElement:function(){return this.el},getWrap:function(){return this.wrap},getLoadSelectStoreParam:function(){var A={organType:this.organType,value:this.getRawValue()};return A},getEnableJP:function(){return this.enablePinyin},getMultiSelect:function(){return false},isShowSelectList:function(){return this.editable&&!this.readOnly}});Ext.reg("apSOrganTree",Artery.plugin.SOrganTree);Artery.plugin.MOrganTree=Ext.extend(Artery.plugin.TwinTriggerField,{margin:true,enablePinyin:true,organStore:null,organTree:null,organWin:null,readOnly:false,organType:"user",rootCfg:null,valueText:"",expandValue:"",expandValuePath:"",valuePinyin:"",searchCount:-1,searchFlag:1,enableFilter:false,selectList:true,itemType:"faOrgan",moreProp:"MTree",cascade:false,cascadeParent:"allchild",initComponent:function(){if(this.margin){this.defaultAutoCreate.style="margin:0;"}Artery.plugin.MOrganTree.superclass.initComponent.call(this);if(!this.organStore){this.organStore=new Ext.data.SimpleStore({fields:["id","name","pinyin"],data:this.getStoreData(),id:0});this.custStore=this.organStore}if(Ext.isTrue(this.selectList)){this.plugins=new Ext.tusc.plugins.Select()}Ext.EventManager.on(window,"beforeunload",function(){try{if(this.organWin){this.organWin.destroy();this.organWin=null}}catch(A){}},this)},onRender:function(B,A){Artery.plugin.MOrganTree.superclass.onRender.call(this,B,A);if(this.cascade||this.checkbox){this.cascadeField=this.el.insertSibling({tag:"input",type:"hidden",name:this.id+"Cascade"},"after",true)}},getStoreData:function(){var D=[];if(!Ext.isEmpty(this.value)){var E=Artery.getMultiSelectSeparator();var F=(this.value+"").split(E);var B=this.valueText.split(E);var A=null;if(!Ext.isEmpty(this.valuePinyin)){A=this.valuePinyin.split(E)}for(var C=0;C<F.length;C++){if(!Ext.isEmpty(F[C])){D[D.length]=[F[C],B[C],A==null?"":A[C]]}}}return D},setValue:function(A,D,B,E){var C=this.getValue();A=Artery.getSplitValue(A);D=Artery.getSplitValue(D);Artery.plugin.MOrganTree.superclass.setValue.call(this,A,D);this.organStore.loadData(this.getStoreData());this.sureSelectedNode(E!==false);if(this.cascade){if(Ext.isEmpty(A)){this.clearCascadeValue()}else{this.genCascadeValue()}}if(B===true&&A!=C){this.fireEvent("change",this,A,C)}},onTrigger1Click:function(){if(!this.disabled&&this.cascade){this.clearCascadeValue()}Artery.plugin.MOrganTree.superclass.onTrigger1Click.call(this)},onTrigger2Click:Artery.plugin.SOrganTree.prototype.onTrigger2Click,reload:Artery.plugin.SOrganTree.prototype.reload,initRootNode:function(){if(this.root){this.root.destroy()}var A={organType:this.organType,multi:true};Ext.apply(A,this.rootCfg);this.root=Artery.pwin.Artery.plugin.SOrganTree.prototype.createRootNode(A);this.organTree.setRootNode(this.root)},showOrganWin:function(){this.organWin.show();if(this.geditor){this.geditor.allowBlur=true}this.sureSelectedNode();this.expandNodePath()},expandNodePath:function(){if(!Ext.isEmpty(this.valuePath)){this.expandNode(this.valuePath,true,true);return }if(!Ext.isEmpty(this.expandValuePath)&&!Ext.isEmpty(this.expandValue)){this.expandNode(this.expandValuePath,false,true);return }},sureSelectedNode:function(){var B=this.organStore;var A=function(D){var C=false;if(B.getById(D.attributes.cid)!=null){C=true}if(D.ui.checkbox){D.ui.checkbox.checked=C}if(!D.isLeaf()&&D.isLoaded()){D.eachChild(A)}};A(this.organTree.root)},getItemId:Artery.plugin.PopupTrigger.prototype.getItemId,initOrganWin:function(){this.organWin=Artery.pwin.Artery.plugin.SOrganTree.prototype.createOrganWin({field:this,multi:true,windowHeight:this.windowHeight});this.custTree=this.organTree;this.organTree.on("expandnode",this.onExpandnode,this);this.organTree.on("checkchange",this.onCheckchange,this);this.organTree.on("append",this.onAppendNode,this);this.organTree.on("beforeload",this.onBeforeload,this);if(Ext.isTrue(this.singleClickCheck)){this.organTree.on("click",this.singleClickCheckHandler,this)}if(this.searchField){this.searchField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.searchFlag=1;this.searchUser()}else{this.searchCount=-1}},this)}if(this.searchBtn){this.searchBtn.on("click",function(){this.searchFlag=1;this.searchUser()},this)}this.okBtn.on("click",this.submitValue,this);this.closeBtn.on("click",function(){this.organWin.hide()},this);this.initRootNode();this.organWin.on("hide",this.onWinHide,this)},onWinHide:Artery.plugin.SOrganTree.prototype.onWinHide,onAppendNode:function(B,C,D,A){if(this.organStore.getById(D.attributes.cid)!=null){if(D.attributes.checked!==undefined){D.attributes.checked=true}}},onBeforeload:Artery.plugin.SOrganTree.prototype.onBeforeload,singleClickCheckHandler:Artery.plugin.faTreeFunc.singleClickCheckHandler,submitValue:function(){var E=[],A=[],B=[];this.organStore.each(function(F){E[E.length]=F.get("id");A[A.length]=F.get("name");if(F.get("pinyin")!=null){B[B.length]=F.get("pinyin")}},this);var C=this.getValue();var D=Artery.getMultiSelectSeparator();this.value=E.join(D);this.valueText=A.join(D);this.valuePinyin=B.join(D);this.setValue(this.value,this.valueText,false,false);this.startValue=this.getValue();this.organWin.hide();this.fireEvent("change",this,this.value,C)},clearTempValue:function(){this.organStore.loadData(this.getStoreData());this.clearSearchInfo()},addRecord:function(B){var A=B.attributes;if(this.organType.indexOf(A.type)<0&&this.organType!="all"){return }if(this.organStore.getById(A.cid)==null){var C=[];C.push([A.cid,B.text,A.pinyin==null?"":A.pinyin]);this.organStore.loadData(C,true)}},delRecord:function(A){var B=this.organStore.getById(A.attributes.cid);if(B){this.organStore.remove(B)}},clearSearchInfo:Artery.plugin.SOrganTree.prototype.clearSearchInfo,searchUser:function(){if(this.searchField==null){return }var B=this.searchField.getValue();if(!Ext.isEmpty(B)){var A=Artery.getParams({searchCount:this.searchCount,searchText:B,searchFlag:this.searchFlag},this);if(!Artery.params){A.itemType=this.itemType;A.moreProp=this.moreProp}if(this.organTree&&this.organTree.container){this.organTree.container.mask("正在加载数据...")}if(this.reloadParams){Ext.apply(A,this.reloadParams)}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=searchOrganTree",success:function(C,D){var E=Ext.decode(C.responseText);if(E.searchCount!=null){this.searchCount=E.searchCount}if(E.errorCode==1){if(this.organTree&&this.organTree.container){this.organTree.container.unmask()}return }this.expandNode(E.path);if(this.organTree&&this.organTree.container){this.organTree.container.unmask()}},scope:this,params:A})}},expandNode:function(J,G,F){var E=this;var C=this.valueWithType;var B=J.split(",");if(Ext.isTrue(C)){var I=this.rootCfg.cid}else{var I=this.rootCfg.type+"_"+this.rootCfg.cid}var D=false;while(B.length>0){var A=B.shift();if(I==A){D=true;break}}if(B.length==0){if(D){this.root.select();if(G==true){this.root.ui.checkbox.checked=true}if(F==true){this.root.expand(false,false)}if(this.searchField){this.searchField.focus()}}else{E.searchUser()}return }var H=function(K){var L=B.shift();var M=K.findChildBy(function(P){if(Ext.isTrue(C)){if(P.attributes.cid==L){return true}}else{var O=L.substring(0,4);var N=L.substr(5);if(P.attributes.type==O&&P.attributes.cid==N){return true}}});if(M==null){E.searchFlag=2;E.searchUser();return }if(B.length==0){M.select();if(G==true){M.ui.checkbox.checked=true}if(F==true){M.expand(false,false,function(N){if(N.hasChildNodes()&&N.lastChild){N.lastChild.ensureVisible();N.ensureVisible()}})}if(this.searchField){this.searchField.focus()}return }M.expand(false,false,H,this)};this.root.expand(false,false,H,this)},upValueText:function(){var A=Artery.getParams({id:this.getValue(),type:this.organType,valueWithType:this.valueWithType},this);if(!Artery.params){A.itemType=this.itemType;A.moreProp=this.moreProp}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getOrganNodeDetail",success:function(B,C){var E=Ext.decode(B.responseText);var D=E.valueText;if(Ext.isEmpty(D)){D=this.value}this.valuePinyin=E.valuePinyin;this.setValueText(D);this.organStore.loadData(this.getStoreData())},scope:this,syn:false,params:A})},validateRightValue:Artery.plugin.SOrganTree.prototype.validateRightValue,getEventElement:function(){return this.el},getWrap:function(){return this.wrap},getLoadSelectStoreParam:function(){var A=this.getRawValue();var B=A.lastIndexOf(Artery.getMultiSelectSeparator());if(B!=-1){A=A.substring(B+1)}var C={organType:this.organType,value:A};return C},getEnableJP:function(){return this.enablePinyin},getMultiSelect:function(){return true},isShowSelectList:function(){return this.editable&&!this.readOnly},setCascade:Artery.plugin.faTreeFunc.setCascade,getCascadeValue:Artery.plugin.faTreeFunc.getCascadeValue,sureSelectedNode:Artery.plugin.faTreeFunc.sureSelectedNode,sureNode:Artery.plugin.faTreeFunc.sureNode,onCascadeNode:Artery.plugin.faTreeFunc.onCascadeNode,genCascadeValue:Artery.plugin.faTreeFunc.genCascadeValue,clearCascadeValue:Artery.plugin.faTreeFunc.clearCascadeValue,onExpandnode:Artery.plugin.faTreeFunc.onExpandnode,onCheckchange:Artery.plugin.faTreeFunc.onCheckchange});Ext.reg("apMOrganTree",Artery.plugin.MOrganTree);Artery.plugin.MOrganList=Ext.extend(Artery.plugin.TwinTriggerField,{margin:true,enablePinyin:true,organStore:null,organGrid:null,organTree:null,organWin:null,readOnly:false,organType:"user",rootCfg:null,valueText:"",valuePinyin:"",searchCount:-1,searchFlag:1,enableFilter:false,selectList:true,itemType:"faOrgan",moreProp:"MList",initComponent:function(){this.upImgPath=sys.getContextPath()+"/artery/pub/images/icon/up.gif";this.downImgPath=sys.getContextPath()+"/artery/pub/images/icon/down.gif";if(this.margin){this.defaultAutoCreate.style="margin:0;"}Artery.plugin.MOrganList.superclass.initComponent.call(this);this.initOrganStore();if(Ext.isTrue(this.selectList)){this.plugins=new Ext.tusc.plugins.Select()}Ext.EventManager.on(window,"beforeunload",function(){try{if(this.organWin){this.searchField.destroy();this.filterField.destroy();this.organGrid.destroy();this.organTree.destroy();this.organWin.destroy();this.organStore=null;this.smtree=null;this.organTree=null;this.treeLoader=null;this.root=null;this.organGrid=null;this.dragSelector=null;this.filterField=null;this.organWin=null;this.searchField=null}}catch(A){}},this)},initOrganStore:function(){if(!this.organStore){this.organStore=new Artery.pwin.Ext.data.SimpleStore({fields:["id","name","pinyin"],data:this.getStoreData(),id:0})}},getStoreData:Artery.plugin.MOrganTree.prototype.getStoreData,setValue:function(A,D,B){var C=this.getValue();A=Artery.getSplitValue(A);D=Artery.getSplitValue(D);Artery.plugin.MOrganList.superclass.setValue.call(this,A,D);this.organStore.loadData(this.getStoreData());if(B===true&&A!=C){this.fireEvent("change",this,A,C)}},filterInterval:function(){if(!this.enableFilter){return }if(Ext.isEmpty(this.filterVal)){this.filterVal=""}var A=this.filterField.getValue();if(Ext.isEmpty(A)){A=""}if(this.filterVal!=A){this.filter(A);this.filterVal=A}this.filterInterval.defer(500,this)},filter:function(A){if(A==null){A=""}if(this.organType!="user"){this.organStore.filter("name",A,false,true)}else{this.organStore.filterBy(function(B,E){try{var C=new RegExp("("+A+")");if(C.test(B.get("pinyin"))){return true}else{if(C.test(B.get("name"))){return true}}}catch(D){return true}return false},this)}},onTrigger2Click:Artery.plugin.SOrganTree.prototype.onTrigger2Click,reload:Artery.plugin.SOrganTree.prototype.reload,initRootNode:function(){if(this.root){this.root.destroy()}var A={draggable:false,expanded:true};Ext.apply(A,this.rootCfg);this.root=new Artery.pwin.Ext.tree.AsyncTreeNode(A);this.organTree.setRootNode(this.root)},showOrganWin:function(){this.organStore.loadData(this.getStoreData());this.organWin.show();if(this.geditor){this.geditor.allowBlur=true}},getItemId:Artery.plugin.PopupTrigger.prototype.getItemId,initOrganTree:function(){this.smtree=new Artery.pwin.Ext.tusc.MultiSelectModel();this.treeLoader=new Artery.pwin.Ext.tree.TreeLoader({dataUrl:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadOrganTree"});this.organTree=new Artery.pwin.Ext.tree.TreePanel({region:"center",autoScroll:true,animate:false,enableDD:false,border:false,bbar:this.getWinBbar(),style:"background-color:#fff;",loader:this.treeLoader,selModel:this.smtree});this.organTree.on("beforeload",this.onBeforeload,this);this.organTree.on("dblclick",this.onOrganTree2Click,this);this.initRootNode()},onOrganTree2Click:function(B){var A=this.smtree.getSelectedNodes();if(A!=null&&A[0]!=null&&A[0].isLeaf()){this.addRecord()}},onBeforeload:Artery.plugin.SOrganTree.prototype.onBeforeload,initOrganGrid:function(){this.filterField=new Artery.pwin.Ext.form.TextField({emptyText:"请输入名称或者简拼查找。如：张三，zs。",width:230,listeners:{focus:{fn:function(){this.enableFilter=true;this.filterInterval()},scope:this},blur:{fn:function(){this.enableFilter=false},scope:this}}});var A=this;var B=function(G,E,C,F,H,D){return A.upAndDownRenderer(G,E,C,F,H,D)};this.organGrid=new Artery.pwin.Ext.grid.GridPanel({region:"center",store:this.organStore,columns:[{header:"名称",width:75,sortable:false,dataIndex:"name"},{header:"操作",width:30,dataIndex:"id",renderer:B}],viewConfig:{forceFit:true,scrollOffset:0},plugins:[this.dragSelector=new Artery.pwin.Ext.ux.grid.DragSelector()],stripeRows:true,border:false,bbar:[this.filterField]});this.smgrid=this.organGrid.getSelectionModel();this.organGrid.on("click",this.gridClickHandler,this)},upAndDownRenderer:function(E,C,A,D,G,B){var F='<img src="'+this.upImgPath+'" style="cursor:hand;" rowIdx="'+D+'">&nbsp;<img src="'+this.downImgPath+'" style="cursor:hand;" rowIdx="'+D+'">';return F},gridClickHandler:function(B){var D=B.getTarget();if(!D||D.nodeName.toLowerCase()!="img"){return }if(D.src.indexOf(this.upImgPath)!=-1){var A=parseInt(D.attributes.rowIdx.value);if(A>0){this.organStore.suspendEvents(false);var C=this.organStore.getAt(A);this.organStore.removeAt(A);this.organStore.insert(A-1,[C]);this.organStore.resumeEvents();this.organGrid.view.refresh()}}else{if(D.src.indexOf(this.downImgPath)!=-1){var A=parseInt(D.attributes.rowIdx.value);if(A<this.organStore.getCount()-1){this.organStore.suspendEvents(false);var C=this.organStore.getAt(A);this.organStore.removeAt(A);this.organStore.insert(A+1,[C]);this.organStore.resumeEvents();this.organGrid.view.refresh()}}}},initOrganWin:function(){var A=this;this.initOrganTree();this.initOrganStore();this.initOrganGrid();this.win_addButton=new Artery.pwin.Ext.Button({text:"添加->",handler:function(){A.addRecord()}});this.win_delButton=new Artery.pwin.Ext.Button({text:"删除<-",handler:function(){A.delRecord()}});this.win_delAllButton=new Artery.pwin.Ext.Button({text:"全删<-",handler:function(){A.delRecordAll()}});this.organWin=new Artery.pwin.Ext.Window({layout:"border",width:600,height:Ext.num(this.windowHeight,400),closeAction:"hide",plain:true,modal:true,shadow:false,items:[this.organTree,{region:"east",layout:"border",width:300,border:false,items:[{region:"west",width:65,border:false,style:"border-left:1px solid #99BBE8;border-right:1px solid #99BBE8;background-color:#fff;",bodyStyle:"background-color:#D2E0F1;",items:[{bodyStyle:"background-color:#D2E0F1;padding-top:50px;text-align:center;",border:false,items:[this.win_addButton]},{bodyStyle:"background-color:#D2E0F1;padding-top:15px;text-align:center;",border:false,items:[this.win_delButton]},{bodyStyle:"background-color:#D2E0F1;padding-top:15px;text-align:center;",border:false,items:[this.win_delAllButton]}]},this.organGrid]}],buttons:[{text:"确定",disabled:false,handler:this.submitValue,scope:this},{text:"关闭",handler:function(){this.organWin.hide()},scope:this}]});this.organWin.on("hide",function(B){this.clearSearchInfo();this.focus();this.validate();if(this.geditor){this.geditor.allowBlur=false;this.geditor.completeEdit()}},this);if(!Ext.isEmpty(this.valuePath)){this.expandNode(this.valuePath,true)}this.filterInterval()},submitValue:Artery.plugin.MOrganTree.prototype.submitValue,addRecord:function(){if(!Ext.isEmpty(this.filterField.getValue())){this.filterField.setValue("");this.filter()}var A=this.smtree.getSelectedNodes();var C=[];for(var B=0;B<A.length;B++){this.justRecord(A[B],C)}if(C.length!=0){this.organStore.loadData(C,true)}},justRecord:function(C,D){var A=C.attributes;if(this.organType.indexOf(A.type)>-1||this.organType=="all"){this.addData(C,D)}if(C.isLeaf()){return }if(!this.addAllSubNode&&C.isLoaded()){C.eachChild(function(E){if(this.organType.indexOf(E.attributes.type)>-1||this.organType=="all"){this.addData(E,D)}},this)}else{var B=this.getAjaxRecords(C);this.addDataArray(B,D)}},getAjaxRecords:function(C){var A=[];var B=Artery.getParams({id:C.attributes.cid,type:C.attributes.type,organType:this.organType,valueWithType:this.valueWithType},this);if(!Artery.params){B.itemType=this.itemType;B.moreProp=this.moreProp}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getOrganData",success:function(D,E){var F=Ext.decode(D.responseText);A=F.data},scope:this,syn:false,params:B});return A},addData:function(B,C){var A=B.attributes;if(this.organStore.getById(A.cid)==null){C.push([A.cid,B.text,A.pinyin==null?"":A.pinyin])}},addDataArray:function(C,B){for(var A=0;A<C.length;A++){if(this.organStore.getById(C[A][0])==null){B.push(C[A])}}},delRecord:function(){var A=this.smgrid.getSelections();Ext.each(A,function(D,C,B){this.organStore.remove(D)},this)},delRecordAll:function(){this.organStore.removeAll()},getWinBbar:function(){if(this.organType!="user"||!this.enablePinyin){return null}this.searchField=new Artery.pwin.Ext.form.TextField({emptyText:"请输入名称或者简拼查找。如：张三，zs。",width:230,enableKeyEvents:true,listeners:{keydown:{fn:function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.searchFlag=1;this.searchUser()}else{this.searchCount=-1}},scope:this}}});return[this.searchField,"-",{text:"查找",handler:function(){this.searchFlag=1;this.searchUser()},scope:this}]},clearSearchInfo:Artery.plugin.MOrganTree.prototype.clearSearchInfo,searchUser:function(){if(this.searchField==null){return }var B=this.searchField.getValue();if(!Ext.isEmpty(B)){var A=Artery.getParams({searchCount:this.searchCount,searchText:B,searchFlag:this.searchFlag},this);if(!Artery.params){A.itemType=this.itemType;A.moreProp=this.moreProp}if(this.organTree&&this.organTree.container){this.organTree.container.mask("正在加载数据...")}if(this.reloadParams){Ext.apply(A,this.reloadParams)}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=searchOrganTree",success:function(C,D){var E=Ext.decode(C.responseText);if(E.searchCount!=null){this.searchCount=E.searchCount}if(E.errorCode==1){if(this.organTree&&this.organTree.container){this.organTree.container.unmask()}return }this.expandNode(E.path);if(this.organTree&&this.organTree.container){this.organTree.container.unmask()}},scope:this,params:A})}},expandNode:function(I,F){var E=this;var C=this.valueWithType;var B=I.split(",");if(Ext.isTrue(C)){var H=this.rootCfg.cid}else{var H=this.rootCfg.type+"_"+this.rootCfg.cid}var D=false;while(B.length>0){var A=B.shift();if(H==A){D=true;break}}if(B.length==0){if(D){this.root.select();if(F==true){this.root.ui.checkbox.checked=true}if(this.searchField){this.searchField.focus()}}else{E.searchUser()}return }var G=function(J){var K=B.shift();var L=J.findChildBy(function(O){if(Ext.isTrue(C)){if(O.attributes.cid==K){return true}}else{var N=K.substring(0,4);var M=K.substr(5);if(O.attributes.type==N&&O.attributes.cid==M){return true}}});if(L==null){E.searchFlag=2;E.searchUser();return }if(B.length==0){L.select();if(F==true){L.ui.checkbox.checked=true}if(this.searchField){this.searchField.focus()}return }L.expand(false,false,G,this)};this.root.expand(false,false,G,this)},upValueText:Artery.plugin.MOrganTree.prototype.upValueText,validateRightValue:Artery.plugin.SOrganTree.prototype.validateRightValue,getEventElement:function(){return this.el},getWrap:function(){return this.wrap},getLoadSelectStoreParam:function(){var A=this.getRawValue();var B=A.lastIndexOf(Artery.getMultiSelectSeparator());if(B!=-1){A=A.substring(B+1)}var C={organType:this.organType,value:A};return C},getEnableJP:function(){return this.enablePinyin},getMultiSelect:function(){return true},isShowSelectList:function(){return this.editable&&!this.readOnly}});Ext.reg("apMOrganList",Artery.plugin.MOrganList);Artery.plugin.SOrganPopup=Ext.extend(Artery.plugin.PopupTrigger,{enablePinyin:true,organTree:null,readOnly:false,organType:"user",rootCfg:null,valueText:"",valuePath:"",expandValue:"",expandValuePath:"",nodeType:null,searchCount:-1,searchFlag:1,selectList:true,initComponent:function(){this.originalType=this.organType;Artery.plugin.SOrganPopup.superclass.initComponent.call(this);if(Ext.isTrue(this.selectList)){this.plugins=new Ext.tusc.plugins.Select()}Ext.EventManager.on(window,"beforeunload",function(){try{if(this.organTree){this.organTree.destroy();this.organTree=null}if(this.searchField){this.searchField.destroy();this.searchField=null}if(this.okBtn){this.okBtn.destroy();this.okBtn=null}if(this.searchBtn){this.searchBtn.destroy();this.searchBtn=null}this.root=null;this.layerEl=null}catch(A){}},this)},reset:function(){if(!this.rendered){return }this.organType=this.originalType;this.nodeType=this.originalType;if(this.originalValue+""==this.value+""){return }this.setValueNoValid(this.originalValue);this.clearInvalid()},setValue:function(B,A,C){var D=this.getValue();if(this.hiddenField){this.hiddenField.value=Ext.isEmpty(B)?"":B}this.setTriggerState(B);if(Ext.isEmpty(B)){this.valueText="";Artery.plugin.TwinTriggerField.superclass.setValue.call(this,this.valueText);this.value=B}else{if(A===undefined&&this.upValueText){this.value=B;this.upValueText(B)}else{this.valueText=A;Artery.plugin.TwinTriggerField.superclass.setValue.call(this,this.valueText);this.value=B}}if(!Ext.isTrue(this.initSte)){this.validate()}if(C===true&&B!=D){this.fireEvent("change",this,B,D)}},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.layerEl==null){var A=Artery.getParams({organType:this.organType},this);if(!Artery.params){A.itemType="faOrgan";A.moreProp="STree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseOrgan",success:function(B,C){if(Ext.isEmpty(B.responseText)){Artery.alertMsg("错误提示","根节点错误！");return }this.rootCfg=Ext.decode(B.responseText);this.initOrganLayer();this.showTreeLayer()},params:A,scope:this})}else{this.showTreeLayer()}},reload:function(B){this.initSte=true;this.setValue("");this.initSte=false;if(B==null){B={}}if(B.params==null){B.params={}}var A=Artery.getParams({organType:this.organType},this);if(!Artery.params){A.itemType="faOrgan";A.moreProp="STree"}if(Ext.isTrue(B.clearParam)){this.reloadParams=B.params}else{if(!this.reloadParams){this.reloadParams={}}Ext.apply(this.reloadParams,B.params)}Ext.apply(A,B.params);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseOrgan",success:function(C,D){if(Ext.isEmpty(C.responseText)){Artery.alertMsg("错误提示","根节点错误！");return }this.rootCfg=Ext.decode(C.responseText);if(this.layerEl==null){this.initOrganLayer()}else{this.initRootNode()}if(B.callback){B.callback.call(this)}},params:A,scope:this})},createRootNode:function(B){var A={draggable:false,expanded:true};Ext.apply(A,B);if(!B.multi){A.uiProvider=Ext.tree.TreeSingleNodeUI;A.uuid=B.uuid}return new Ext.tree.AsyncTreeNode(A)},initRootNode:function(){if(this.root){this.root.destroy()}var A={organType:this.organType,uuid:this.organTree.loader.baseAttrs.uuid};Ext.apply(A,this.rootCfg);this.root=Artery.pwin.Artery.plugin.SOrganPopup.prototype.createRootNode(A);this.organTree.setRootNode(this.root)},showTreeLayer:function(){if(this.isExpanded()){return }if(this.searchField){var A=Math.max(this.wrap.getWidth(),this.minLayerWidth);this.searchField.setWidth(A-85)}if(this.geditor){this.geditor.allowBlur=true}if(!this.organTree.rendered){this.organTree.render(this.layerEl.dom)}this.skinTree();this.restrictLayer(this.layerEl,this.organTree)},skinTree:function(){if(Ext.isEmpty(this.getValue())){this.clearTree()}else{Artery.plugin.faTreeFunc.skinSelectedNode(this.organTree,this.getValue())}this.expandNodePath()},onExpandnode:function(){if(this.layerEl.isVisible()){this.restrictLayer(this.layerEl,this.organTree)}},onCollapsenode:function(){if(this.layerEl.isVisible()){this.restrictLayer(this.layerEl,this.organTree)}},createTreePanel:function(A){var G=[];if(A.field.organType=="user"||A.field.organType=="all"){var F=new Ext.form.TextField({emptyText:"请输入人员姓名"+(A.field.enablePinyin?"或简拼":""),width:100,enableKeyEvents:true});A.field.searchField=F;G.push(F);G.push("-");var E=new Ext.Button({text:"查找"});A.field.searchBtn=E;G.push(E)}G.push("->");var B=new Ext.Button({text:"确定"});A.field.okBtn=B;G.push(B);var C=Ext.id();var D=new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,height:this.layerHeight,border:true,bbar:G,loader:new Ext.tree.TreeLoader({baseAttrs:A.multi?null:{uiProvider:Ext.tree.TreeSingleNodeUI,uuid:C},dataUrl:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadOrganTree"}),eventModel:A.multi?null:Ext.tusc.TreeRadioEvent});return D},initOrganLayer:function(){this.organTree=Artery.pwin.Artery.plugin.SOrganPopup.prototype.createTreePanel({field:this});this.organTree.on("expandnode",this.onExpandnode,this);this.organTree.on("collapsenode",this.onCollapsenode,this);this.organTree.on("checkchange",this.onCheckchange,this);this.organTree.on("beforeload",this.onBeforeload,this);if(Ext.isTrue(this.singleClickCheck)){this.organTree.on("click",this.singleClickCheckHandler,this)}if(Ext.isTrue(this.dblClickReturn)){this.organTree.on("dblclick",this.dblClickReturnHandler,this)}if(this.okBtn){this.okBtn.on("click",this.submitValue,this)}if(this.searchBtn){this.searchBtn.on("click",function(){this.searchFlag=1;this.searchUser()},this)}if(this.searchField){this.searchField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.searchFlag=1;this.searchUser()}else{this.searchCount=-1}},this)}this.initRootNode();this.layerEl=Artery.pwin.Artery.plugin.SOrganPopup.prototype.createOrganLayer({popupField:this})},createOrganLayer:function(A){return new Artery.plugin.PopupLayer({shadow:false,constrain:false,zindex:20000,popupField:A.popupField})},onCheckchange:function(C,B){var A=C.attributes;this.valueTextTemp=A.text;this.valueTemp=A.cid;this.nodeTypeTemp=A.type;C.select()},onBeforeload:function(B){var A=this.organTree.loader;A.baseParams.type=B.attributes.type;A.baseParams.id=B.attributes.cid;A.baseParams.organType=this.organType;A.baseParams.custParams=Ext.encode(this.custParams);Ext.apply(A.baseParams,this.reloadParams);Ext.applyIf(A.baseParams,Artery.getParams({},this));if(!Artery.params){A.baseParams.itemType="faOrgan";A.baseParams.moreProp="STree"}},singleClickCheckHandler:Artery.plugin.faTreeFunc.singleClickCheckHandler,dblClickReturnHandler:Artery.plugin.faTreeFunc.dblClickReturnHandler,clearTree:function(){var A=this.organTree.getSelectionModel().getSelectedNode();if(A){A.unselect();if(A.ui.checkbox){A.ui.checkbox.checked=false;A.ui.checkbox.defaultChecked=false}}},expandNodePath:function(){if(!Ext.isEmpty(this.valuePath)&&!Ext.isEmpty(this.value)){this.expandNode(this.valuePath,true,true);this.valuePath=null;return }if(!Ext.isEmpty(this.expandValuePath)&&!Ext.isEmpty(this.expandValue)){this.expandNode(this.expandValuePath,false,true);return }},submitValue:function(){var A=this.getValue();if(this.valueTemp!==undefined&&this.valueTextTemp!==undefined){this.nodeType=this.nodeTypeTemp;this.setValue(this.valueTemp,this.valueTextTemp)}this.startValue=this.getValue();this.collapse(true);this.fireEvent("change",this,this.value,A)},clearTempValue:function(){delete this.nodeTypeTemp;delete this.valueTemp;delete this.valueTextTemp;this.clearSearchInfo()},clearSearchInfo:function(){if(this.searchField!=null){this.searchField.setValue(null);this.searchCount=-1;this.searchFlag=1}},searchUser:function(){if(this.searchField==null){return }var B=this.searchField.getValue();if(!Ext.isEmpty(B)){var A=Artery.getParams({searchCount:this.searchCount,searchText:B,searchFlag:this.searchFlag},this);if(!Artery.params){A.itemType="faOrgan";A.moreProp="STree"}if(this.organTree&&this.organTree.container){this.organTree.container.mask("正在加载数据...")}if(this.reloadParams){Ext.apply(A,this.reloadParams)}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=searchOrganTree",success:function(C,D){var E=Ext.decode(C.responseText);if(E.searchCount!=null){this.searchCount=E.searchCount}if(E.errorCode==1){if(this.organTree&&this.organTree.container){this.organTree.container.unmask()}return }this.expandNode(E.path);if(this.organTree&&this.organTree.container){this.organTree.container.unmask()}},scope:this,params:A})}},expandNode:function(J,G,F){var E=this;var C=this.valueWithType;var B=J.split(",");if(Ext.isTrue(C)){var I=this.rootCfg.cid}else{var I=this.rootCfg.type+"_"+this.rootCfg.cid}var D=false;while(B.length>0){var A=B.shift();if(I==A){D=true;break}}if(B.length==0){if(D){this.root.select();if(G==true){this.root.ui.checkbox.checked=true}if(F==true){this.root.expand(false,false)}if(this.searchField){this.searchField.focus()}}else{E.searchUser()}return }var H=function(K){var L=B.shift();var M=K.findChildBy(function(P){if(Ext.isTrue(C)){if(P.attributes.cid==L){return true}}else{var O=L.substring(0,4);var N=L.substr(5);if(P.attributes.type==O&&P.attributes.cid==N){return true}}});if(M==null){E.searchFlag=2;E.searchUser();return }if(B.length==0){M.select();if(G==true){M.ui.checkbox.checked=true}if(F==true){M.expand(false,false,function(N){if(N.hasChildNodes()&&N.lastChild){N.lastChild.ensureVisible();N.ensureVisible()}})}if(this.searchField){this.searchField.focus()}return }M.expand(false,false,H,this)};this.root.expand(false,false,H,this)},upValueText:function(){var A=Artery.getParams({id:this.getValue(),type:this.nodeType==null?this.organType:this.nodeType,valueWithType:this.valueWithType},this);if(!Artery.params){A.itemType="faOrgan";A.moreProp="STree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getOrganNodeDetail",success:function(B,C){var E=Ext.decode(B.responseText);var D=E.valueText;if(Ext.isEmpty(D)){D=this.value}this.valuePath=E.valuePath;this.setValueText(D)},scope:this,syn:false,params:A})},validateRightValue:function(){if(Ext.isTrue(this.isCallByVRV)){return this.lastVRV_Result}var B=Artery.getParams({itemType:"faOrgan",organType:this.organType,valueText:this.getValueText(),value:this.getValue()},this);if(this.reloadParams){Ext.apply(B,this.reloadParams)}var A=true;Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=validateRightValue",success:function(C,D){var E=Ext.decode(C.responseText);this.isCallByVRV=true;if(Ext.isEmpty(E.value)){this.setValue();this.setValueText(E.valueText)}else{this.setValue(E.value,E.valueText)}delete this.isCallByVRV;if(!Ext.isTrue(E.success)){if(!(this.plugins&&this.plugins.isExpanded())){this.markInvalid(E.message)}A=false}},syn:false,params:B,scope:this});this.lastVRV_Result=A;return A},getEventElement:function(){return this.el},getWrap:function(){return this.wrap},getLoadSelectStoreParam:function(){var A={organType:this.organType,value:this.getRawValue()};return A},getEnableJP:function(){return this.enablePinyin},getMultiSelect:function(){return false},isShowSelectList:function(){return this.editable&&!this.readOnly}});Ext.reg("apSOrganPopup",Artery.plugin.SOrganPopup);Artery.plugin.MOrganPopup=Ext.extend(Artery.plugin.PopupTrigger,{enablePinyin:true,organTree:null,readOnly:false,organType:"user",rootCfg:null,valueText:"",valuePath:"",expandValue:"",expandValuePath:"",nodeType:null,searchCount:-1,searchFlag:1,selectList:true,cascade:false,cascadeParent:"allchild",initComponent:function(){this.originalType=this.organType;Artery.plugin.MOrganPopup.superclass.initComponent.call(this);if(!this.organStore){this.organStore=new Ext.data.SimpleStore({fields:["id","name","pinyin"],data:this.getStoreData(),id:0});this.custStore=this.organStore}if(Ext.isTrue(this.selectList)){this.plugins=new Ext.tusc.plugins.Select()}Ext.EventManager.on(window,"beforeunload",function(){try{if(this.organTree){this.organTree.destroy();this.organTree=null}if(this.searchField){this.searchField.destroy();this.searchField=null}if(this.okBtn){this.okBtn.destroy();this.okBtn=null}if(this.searchBtn){this.searchBtn.destroy();this.searchBtn=null}this.root=null;this.layerEl=null}catch(A){}},this)},onRender:function(B,A){Artery.plugin.MOrganPopup.superclass.onRender.call(this,B,A);if(this.cascade||this.checkbox){this.cascadeField=this.el.insertSibling({tag:"input",type:"hidden",name:this.id+"Cascade"},"after",true)}},getStoreData:function(){var D=[];if(!Ext.isEmpty(this.value)){var E=Artery.getMultiSelectSeparator();var F=(this.value+"").split(E);var B=this.valueText.split(E);var A=null;if(!Ext.isEmpty(this.valuePinyin)){A=this.valuePinyin.split(E)}for(var C=0;C<F.length;C++){if(!Ext.isEmpty(F[C])){D[D.length]=[F[C],B[C],A==null?"":A[C]]}}}return D},setValue:function(A,D,B,E){var C=this.getValue();A=Artery.getSplitValue(A);D=Artery.getSplitValue(D);Artery.plugin.MOrganPopup.superclass.setValue.call(this,A,D);this.organStore.loadData(this.getStoreData());this.sureSelectedNode(E!==false);if(this.cascade){if(Ext.isEmpty(A)){this.clearCascadeValue()}else{this.genCascadeValue()}}if(B===true&&A!=C){this.fireEvent("change",this,A,C)}},reset:function(){if(!this.rendered){return }this.organType=this.originalType;this.nodeType=this.originalType;if(this.originalValue+""==this.value+""){return }this.setValueNoValid(this.originalValue);this.clearInvalid()},onTrigger1Click:function(){if(!this.disabled&&this.cascade){this.clearCascadeValue()}Artery.plugin.MOrganPopup.superclass.onTrigger1Click.call(this)},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.layerEl==null){var A=Artery.getParams({organType:this.organType},this);if(!Artery.params){A.itemType="faOrgan";A.moreProp="MTree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseOrgan",success:function(B,C){if(Ext.isEmpty(B.responseText)){Artery.alertMsg("错误提示","根节点错误！");return }this.rootCfg=Ext.decode(B.responseText);this.initOrganLayer();this.showTreeLayer()},params:A,scope:this})}else{this.showTreeLayer()}},reload:function(B){this.initSte=true;this.setValue("");this.initSte=false;if(B==null){B={}}if(B.params==null){B.params={}}var A=Artery.getParams({organType:this.organType},this);if(!Artery.params){A.itemType="faOrgan";A.moreProp="MTree"}if(Ext.isTrue(B.clearParam)){this.reloadParams=B.params}else{if(!this.reloadParams){this.reloadParams={}}Ext.apply(this.reloadParams,B.params)}Ext.apply(A,B.params);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=parseOrgan",success:function(C,D){if(Ext.isEmpty(C.responseText)){Artery.alertMsg("错误提示","根节点错误！");return }this.rootCfg=Ext.decode(C.responseText);if(this.layerEl==null){this.initOrganLayer()}else{this.initRootNode()}if(B.callback){B.callback.call(this)}},params:A,scope:this})},initRootNode:function(){if(this.root){this.root.destroy()}var A={organType:this.organType,multi:true};Ext.apply(A,this.rootCfg);this.root=Artery.pwin.Artery.plugin.SOrganPopup.prototype.createRootNode(A);this.organTree.setRootNode(this.root)},showTreeLayer:function(){if(this.isExpanded()){return }if(this.searchField){var A=Math.max(this.wrap.getWidth(),this.minLayerWidth);this.searchField.setWidth(A-85)}if(this.geditor){this.geditor.allowBlur=true}if(!this.organTree.rendered){this.organTree.render(this.layerEl.dom)}this.skinTree();this.restrictLayer(this.layerEl,this.organTree)},skinTree:function(){var B=this.organStore;var A=function(D){var C=false;if(B.getById(D.attributes.cid)!=null){C=true}if(D.ui.checkbox){D.ui.checkbox.checked=C}if(!D.isLeaf()&&D.isLoaded()){D.eachChild(A)}};A(this.organTree.root);this.expandNodePath()},expandNodePath:function(){if(!Ext.isEmpty(this.expandValuePath)&&!Ext.isEmpty(this.expandValue)){this.expandNode(this.expandValuePath,false,true);return }},onAppendNode:function(B,C,D,A){if(this.organStore.getById(D.attributes.cid)!=null){if(D.attributes.checked!==undefined){D.attributes.checked=true}}},onBeforeload:function(B){var A=this.organTree.loader;A.baseParams.type=B.attributes.type;A.baseParams.id=B.attributes.cid;A.baseParams.organType=this.organType;A.baseParams.custParams=Ext.encode(this.custParams);Ext.apply(A.baseParams,this.reloadParams);Ext.applyIf(A.baseParams,Artery.getParams({},this));if(!Artery.params){A.baseParams.itemType="faOrgan";A.baseParams.moreProp="MTree"}},singleClickCheckHandler:Artery.plugin.faTreeFunc.singleClickCheckHandler,onExpandnodeMain:function(A){this.onExpandnode(A);if(this.layerEl.isVisible()){this.restrictLayer(this.layerEl,this.organTree)}},onCollapsenode:function(){if(this.layerEl.isVisible()){this.restrictLayer(this.layerEl,this.organTree)}},initOrganLayer:function(){this.organTree=Artery.pwin.Artery.plugin.SOrganPopup.prototype.createTreePanel({field:this,multi:true});this.custTree=this.organTree;this.organTree.on("expandnode",this.onExpandnodeMain,this);this.organTree.on("collapsenode",this.onCollapsenode,this);this.organTree.on("checkchange",this.onCheckchange,this);this.organTree.on("append",this.onAppendNode,this);this.organTree.on("beforeload",this.onBeforeload,this);if(Ext.isTrue(this.singleClickCheck)){this.organTree.on("click",this.singleClickCheckHandler,this)}if(this.okBtn){this.okBtn.on("click",this.submitValue,this)}if(this.searchBtn){this.searchBtn.on("click",function(){this.searchFlag=1;this.searchUser()},this)}if(this.searchField){this.searchField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.searchFlag=1;this.searchUser()}else{this.searchCount=-1}},this)}this.initRootNode();this.layerEl=Artery.pwin.Artery.plugin.SOrganPopup.prototype.createOrganLayer({popupField:this})},addRecord:function(B){var A=B.attributes;if(this.organType.indexOf(A.type)<0&&this.organType!="all"){return }if(this.organStore.getById(A.cid)==null){var C=[];C.push([A.cid,B.text,A.pinyin==null?"":A.pinyin]);this.organStore.loadData(C,true)}},delRecord:function(A){var B=this.organStore.getById(A.attributes.cid);if(B){this.organStore.remove(B)}},submitValue:function(){var D=[],A=[];this.organStore.each(function(E){D[D.length]=E.get("id");A[A.length]=E.get("name")},this);var B=this.getValue();var C=Artery.getMultiSelectSeparator();this.value=D.join(C);this.valueText=A.join(C);this.setValue(this.value,this.valueText,false,false);this.startValue=this.getValue();this.collapse(true);this.fireEvent("change",this,this.value,B)},clearTempValue:function(){this.organStore.loadData(this.getStoreData());this.clearSearchInfo()},clearSearchInfo:Artery.plugin.SOrganPopup.prototype.clearSearchInfo,searchUser:function(){if(this.searchField==null){return }var B=this.searchField.getValue();if(!Ext.isEmpty(B)){var A=Artery.getParams({searchCount:this.searchCount,searchText:B,searchFlag:this.searchFlag},this);if(!Artery.params){A.itemType="faOrgan";A.moreProp="MTree"}if(this.organTree&&this.organTree.container){this.organTree.container.mask("正在加载数据...")}if(this.reloadParams){Ext.apply(A,this.reloadParams)}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=searchOrganTree",success:function(C,D){var E=Ext.decode(C.responseText);if(E.searchCount!=null){this.searchCount=E.searchCount}if(E.errorCode==1){if(this.organTree&&this.organTree.container){this.organTree.container.unmask()}return }this.expandNode(E.path);if(this.organTree&&this.organTree.container){this.organTree.container.unmask()}},scope:this,params:A})}},expandNode:function(J,G,F){var E=this;var C=this.valueWithType;var B=J.split(",");if(Ext.isTrue(C)){var I=this.rootCfg.cid}else{var I=this.rootCfg.type+"_"+this.rootCfg.cid}var D=false;while(B.length>0){var A=B.shift();if(I==A){D=true;break}}if(B.length==0){if(D){this.root.select();if(G==true){this.root.ui.checkbox.checked=true}if(F==true){this.root.expand(false,false)}if(this.searchField){this.searchField.focus()}}else{E.searchUser()}return }var H=function(K){var L=B.shift();var M=K.findChildBy(function(P){if(Ext.isTrue(C)){if(P.attributes.cid==L){return true}}else{var O=L.substring(0,4);var N=L.substr(5);if(P.attributes.type==O&&P.attributes.cid==N){return true}}});if(M==null){E.searchFlag=2;E.searchUser();return }if(B.length==0){M.select();if(G==true){M.ui.checkbox.checked=true}if(F==true){M.expand(false,false,function(N){if(N.hasChildNodes()&&N.lastChild){N.lastChild.ensureVisible();N.ensureVisible()}})}if(this.searchField){this.searchField.focus()}return }M.expand(false,false,H,this)};this.root.expand(false,false,H,this)},upValueText:function(){var A=Artery.getParams({id:this.getValue(),type:this.organType,valueWithType:this.valueWithType},this);if(!Artery.params){A.itemType="faOrgan";A.moreProp="MTree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=getOrganNodeDetail",success:function(B,C){var E=Ext.decode(B.responseText);var D=E.valueText;if(Ext.isEmpty(D)){D=this.value}this.valuePinyin=E.valuePinyin;this.setValueText(D);this.organStore.loadData(this.getStoreData())},scope:this,syn:false,params:A})},validateRightValue:Artery.plugin.SOrganPopup.prototype.validateRightValue,getEventElement:function(){return this.el},getWrap:function(){return this.wrap},getLoadSelectStoreParam:function(){var A=this.getRawValue();var B=A.lastIndexOf(Artery.getMultiSelectSeparator());if(B!=-1){A=A.substring(B+1)}var C={organType:this.organType,value:A};return C},getEnableJP:function(){return this.enablePinyin},getMultiSelect:function(){return true},isShowSelectList:function(){return this.editable&&!this.readOnly},setCascade:Artery.plugin.faTreeFunc.setCascade,getCascadeValue:Artery.plugin.faTreeFunc.getCascadeValue,sureSelectedNode:Artery.plugin.faTreeFunc.sureSelectedNode,sureNode:Artery.plugin.faTreeFunc.sureNode,onCascadeNode:Artery.plugin.faTreeFunc.onCascadeNode,genCascadeValue:Artery.plugin.faTreeFunc.genCascadeValue,clearCascadeValue:Artery.plugin.faTreeFunc.clearCascadeValue,onExpandnode:Artery.plugin.faTreeFunc.onExpandnode,onCheckchange:Artery.plugin.faTreeFunc.onCheckchange});Ext.reg("apMOrganPopup",Artery.plugin.MOrganPopup);Artery.plugin.FaStringInput=Ext.extend(Ext.form.TextField,{allowBlankWhenRequired:false,allowDomMove:false,enableKeyEvents:true,onRender:function(C,A){var D=!!window.ActiveXObject;var F=D&&!window.XMLHttpRequest;var E=D&&!!document.documentMode;if(!E){this.emptyText=this.emptyText.replace(new RegExp("\r\n","gm"),"\n")}Ext.form.Field.superclass.onRender.call(this,C,A);if(Ext.get(this.id)){this.el=Ext.get(this.id)}else{if(!this.el){var B=this.getAutoCreate();if(!B.name){B.name=this.name||this.id}if(this.inputType){B.type=this.inputType}this.el=C.createChild(B,A)}}if(this.tabIndex!==undefined){this.el.dom.setAttribute("tabIndex",this.tabIndex)}},setValue:function(B,C){var D=this.getValue();Artery.plugin.FaStringInput.superclass.setValue.call(this,B);Artery.setSubmitHiddenValue(this.id,this.getValue());var A=this.getValue();if(C===true&&A!=D){this.fireEvent("change",this,A,D)}},onDisable:function(){this.getActionEl().addClass(this.disabledClass);this.el.dom.disabled=true;if(this.getLabelEl()!=null){this.getLabelEl().addClass("x-form-label-disabled")}if(Ext.isIE){this.el.dom.unselectable="on"}if(Ext.isTrue(this.submitDisabled)){if(!document.getElementById(this.id+"_hidden")){var B=this.el.dom.name;var A=Artery.createHiddenInput(this.id,B,this.getValue());this.el.dom.parentNode.appendChild(A)}}},onEnable:function(){Artery.plugin.FaStringInput.superclass.onEnable.call(this);if(Ext.isTrue(this.submitDisabled)){var A=document.getElementById(this.id+"_hidden");if(A){this.el.dom.parentNode.removeChild(A)}}}});Ext.reg("apfastringinput",Artery.plugin.FaStringInput);Artery.plugin.FaStringTextarea=Ext.extend(Ext.form.TextArea,{allowBlankWhenRequired:false,enableKeyEvents:true,initComponent:function(){Artery.plugin.FaStringTextarea.superclass.initComponent.call(this)},onRender:function(B,A){if(!this.el){this.defaultAutoCreate={tag:"textarea",style:"width:100px;height:60px;",autocomplete:"off"}}if(Ext.get(this.id)){Ext.get(this.id).removeClass("x-form-empty-field")}Artery.plugin.FaStringInput.prototype.onRender.call(this,B,A);if(this.grow){this.textSizeEl=Ext.DomHelper.append(document.body,{tag:"pre",cls:"x-form-grow-sizer"});if(this.preventScrollbars){this.el.setStyle("overflow","hidden")}this.el.setHeight(this.growMin)}},setValue:function(B,C){var D=this.getValue();Artery.plugin.FaStringTextarea.superclass.setValue.call(this,B);Artery.setSubmitHiddenValue(this.id,this.getValue());var A=this.getValue();if(C===true&&A!=D){this.fireEvent("change",this,A,D)}},onDisable:function(){Artery.plugin.FaStringTextarea.superclass.onDisable.call(this);this.el.dom.disabled=true;if(Ext.isIE){this.el.dom.unselectable="on"}if(Ext.isTrue(this.submitDisabled)){if(!document.getElementById(this.id+"_hidden")){var B=this.el.dom.name;var A=Artery.createHiddenInput(this.id,B,this.getValue());this.el.dom.parentNode.appendChild(A)}}},onEnable:function(){Artery.plugin.FaStringTextarea.superclass.onEnable.call(this);if(Ext.isTrue(this.submitDisabled)){var A=document.getElementById(this.id+"_hidden");if(A){this.el.dom.parentNode.removeChild(A)}}}});Ext.reg("apfastringtextarea",Artery.plugin.FaStringTextarea);if(Ext.form.HtmlEditor){Artery.plugin.FaStringRichedit=Ext.extend(Ext.form.HtmlEditor,{allowDomMove:true,onRender:function(B,A){if(this.isDisplayType()){return }B=Ext.get(this.renderToId);Artery.plugin.FaStringRichedit.superclass.onRender.call(this,B,A)}});Ext.reg("apfastringrichedit",Artery.plugin.FaStringRichedit)}Artery.plugin.TriggerTextarea=Ext.extend(Artery.plugin.TwinTriggerField,{win:null,winBody:null,onRender:function(B,A){Artery.plugin.TwinTriggerField.superclass.onRender.call(this,B,A);this.el.dom.readOnly=true},onTrigger2Click:function(){if(this.win==null){this.win=new Ext.Window({width:500,height:300,closable:true,plain:true,closeAction:"hide",modal:true,shadow:false,layout:"anchor",items:[this.winBody=new Ext.form.TextArea({anchor:"100% 100%",maxLength:this.maxLength,minLength:this.minLength,regex:this.regex,regexText:this.regexText})],buttons:[{text:"确定",handler:function(){if(this.winBody.isValid()){this.value=this.winBody.getValue();this.win.hide()}},scope:this},{text:"取消",handler:function(){this.winBody.clearInvalid();this.win.hide()},scope:this}]});this.win.on("hide",function(){this.focus();this.geditor.allowBlur=false;this.geditor.completeEdit()},this)}this.win.show();this.winBody.setValue(this.value);this.geditor.allowBlur=true},setValue:function(A){if(Ext.isEmpty(A)){A=""}if(this.hiddenField){this.hiddenField.value=Ext.isEmpty(A)?"":A}Artery.plugin.TwinTriggerField.superclass.setValue.call(this,A);this.value=A;this.updateValueTip();this.setTriggerState(A);return true},getValue:function(){return this.value},getValueText:function(){return this.value}});Ext.reg("aptriggertextarea",Artery.plugin.TriggerTextarea);Ext.ux.form.TimeSpinner=Ext.extend(Ext.ux.form.Spinner,{allowDomMove:false,onRender:function(C,A){this.wrap=Ext.get(this.renderTo).first();this.el=this.wrap.child("input");this.trigger=this.wrap.child("img");if(!this.el){var B=this.getAutoCreate();if(!B.name){B.name=this.name||this.id}if(this.inputType){B.type=this.inputType}this.el=C.createChild(B,A)}Ext.form.Field.superclass.onRender.call(this,C,A);if(this.readOnly){this.el.dom.readOnly=true}if(this.tabIndex!==undefined){this.el.dom.setAttribute("tabIndex",this.tabIndex)}if(this.hideTrigger){this.trigger.setDisplayed(false)}this.initTrigger();if(!this.editable){this.editable=true;this.setEditable(false)}this.initSpinner()},initSpinner:function(){this.keyNav=new Ext.KeyNav(this.el,{up:function(A){if(this.disabled||this.readOnly){return }A.preventDefault();this.onSpinUp();this.setValueOfTimePlugin()},down:function(A){if(this.disabled||this.readOnly){return }A.preventDefault();this.onSpinDown();this.setValueOfTimePlugin()},pageUp:function(A){A.preventDefault();this.onSpinUpAlternate()},pageDown:function(A){A.preventDefault();this.onSpinDownAlternate()},scope:this});this.trigger.un("click",this.onTriggerClick);this.repeater=new Ext.util.ClickRepeater(this.trigger);this.repeater.on("click",this.onTriggerClick,this,{preventDefault:true});this.trigger.on("mouseover",this.onMouseOver,this,{preventDefault:true});this.trigger.on("mouseout",this.onMouseOut,this,{preventDefault:true});this.trigger.on("mousemove",this.onMouseMove,this,{preventDefault:true});this.trigger.on("mousedown",this.onMouseDown,this,{preventDefault:true});this.trigger.on("mouseup",this.onMouseUp,this,{preventDefault:true});this.wrap.on("mousewheel",this.handleMouseWheel,this);if("object"==typeof this.strategy&&this.strategy.xtype){switch(this.strategy.xtype){case"number":this.strategy=new Ext.ux.form.Spinner.NumberStrategy(this.strategy);break;case"date":this.strategy=new Ext.ux.form.Spinner.DateStrategy(this.strategy);break;case"time":this.strategy=new Ext.ux.form.Spinner.TimeStrategy(this.strategy);break;default:delete (this.strategy);break}delete (this.strategy.xtype)}if(this.strategy==undefined){this.strategy=new Ext.ux.form.Spinner.NumberStrategy()}},onMouseUp:function(){Ext.ux.form.TimeSpinner.superclass.onMouseUp.call(this);this.setValueOfTimePlugin()},onTriggerClick:function(){if(this.disabled||this.readOnly){return }var B=this.getMiddle();var A=(Ext.EventObject.getPageY()<B)?"Up":"Down";this["onSpin"+A]()},setValueOfTimePlugin:function(){if(this.onMouseUpAction){this.onMouseUpAction.handler.call(this.onMouseUpAction.scope)}},onMouseUpAction:null});Artery.plugin.FaTime=Ext.extend(Ext.form.TextField,{allowDomMove:false,timeType:1,margin:true,fieldClass:null,format:"h:i:s",defaultAutoCreate:{tag:"input",type:"text",size:"24",autocomplete:"off"},editable:true,hiddenField:null,minText:"该输入项的时间必须在 {0}（包含） 之后",maxText:"该输入项的时间必须在 {0}（包含）之前",hourText:'"小时"的输入范围是：0-23',minuteText:'"分钟"的输入范围是：0-59',secondText:'"秒"的输入范围是：0-59',initComponent:function(){if(this.margin){this.defaultAutoCreate.style="margin:0;"}Artery.plugin.FaTime.superclass.initComponent.call(this)},validateValue:function(I){if(I==""||I=="::"){if(this.allowBlank){this.clearInvalid();return true}else{this.markInvalid(this.blankText);return false}}var H=I.toString().split(":",3);var E=H[0];if(isNaN(E)||E<0||E>23){this.markInvalid(this.hourText);return false}var B=H[1];if(isNaN(B)||B<0||B>59){this.markInvalid(this.minuteText);return false}var J=H[2];if(isNaN(J)||J<0||J>59){this.markInvalid(this.secondText);return false}if(!Artery.plugin.FaTime.superclass.validateValue.call(this,I)){return false}var D=new Date("1970/1/1 "+I).getTime();if(!Ext.isEmpty(this.minValue)){var C=this.dealTimeValue(this.minValue);var F=new Date("1970/1/1 "+C).getTime();if(D<F){this.markInvalid(String.format(this.minText,C));return false}}if(!Ext.isEmpty(this.maxValue)){var G=this.dealTimeValue(this.maxValue);var A=new Date("1970/1/1 "+G).getTime();if(D>A){this.markInvalid(String.format(this.maxText,G));return false}}return true},getErrorTipEl:function(){return this.el.child("table")},onRender:function(B,A){this.el=Ext.get(this.id+"_wrap");this.hiddenField=Ext.get(this.id).dom;Artery.plugin.FaTime.superclass.onRender.call(this,B,A);this.hourSpiner=new Ext.ux.form.TimeSpinner({renderTo:this.el.child("td.x-time-hourtd",true),disabled:this.disabled,readOnly:this.readOnly,strategy:new Ext.ux.form.Spinner.TimeStrategy({format:"H",incrementConstant:Date.HOUR,alternateIncrementValue:3,alternateIncrementConstant:Date.HOUR}),onMouseUpAction:{handler:this.syncValueText,scope:this}});this.minuteSpiner=new Ext.ux.form.TimeSpinner({renderTo:this.el.child("td.x-time-minutetd",true),disabled:this.disabled,readOnly:this.readOnly,strategy:new Ext.ux.form.Spinner.TimeStrategy({format:"i",incrementConstant:Date.MINUTE,alternateIncrementValue:5,alternateIncrementConstant:Date.MINUTE}),onMouseUpAction:{handler:this.syncValueText,scope:this}});this.secondSpiner=new Ext.ux.form.TimeSpinner({renderTo:this.el.child("td.x-time-secondtd",true),disabled:this.disabled,readOnly:this.readOnly,strategy:new Ext.ux.form.Spinner.TimeStrategy({format:"s",incrementConstant:Date.SECOND,alternateIncrementValue:5,alternateIncrementConstant:Date.SECOND}),onMouseUpAction:{handler:this.syncValueText,scope:this}});this.hourSpiner.el.on("keyup",this.syncValueText,this);this.hourSpiner.on("change",this.syncValueText,this);this.minuteSpiner.el.on("keyup",this.syncValueText,this);this.minuteSpiner.on("change",this.syncValueText,this);this.secondSpiner.el.on("keyup",this.syncValueText,this);this.secondSpiner.on("change",this.syncValueText,this)},syncValueText:function(){if(this.validate()){var B=this.hiddenField.value;var A=this.getRawValue();this.hiddenField.value=A;this.value=this.hiddenField.value;this.fireEvent("change",this,A,B)}},setValue:function(A){var C=this.dealTimeValue(A);if(C==null){return }var B=["00","00","00"];if(C!=""){B=C.split(":")}this.hourSpiner.setValue(B[0]);this.minuteSpiner.setValue(B[1]);this.secondSpiner.setValue(B[2]);this.hiddenField.value=C==""?"":B.join(":");this.value=this.hiddenField.value;if(!Ext.isTrue(this.initSte)){this.validate()}},dealTimeValue:function(D){var F="";if(!Ext.isEmpty(D)){F=D.toString()}var A=/[^0-9:]/;if(A.exec(F)){return null}if(F==""||F=="::"){return""}var E=F.split(":",3);for(var C=0;C<E.length;C++){E[C]=Ext.isEmpty(E[C])?"00":(E[C].length==1?("0"+E[C]):E[C])}for(var B=E.length;B<3;B++){E[B]="00"}return E.join(":")},getValue:function(){return this.value||""},getRawValue:function(){var A="";if(this.rendered){var B=[this.hourSpiner.getValue(),this.minuteSpiner.getValue(),this.secondSpiner.getValue()];A=B.join(":");if(A=="::"){A=""}}return A},reset:function(){if(!this.rendered){return }this.clearInvalid();this.setValueNoValid(this.originalValue)},setValueStyle:function(A){this.hourSpiner.el.applyStyles(A);this.minuteSpiner.el.applyStyles(A);this.secondSpiner.el.applyStyles(A)},read:function(){if(!this.rendered||this.isDisplayType()){return }this.readOnly=true;this.hourSpiner.readOnly=true;this.minuteSpiner.readOnly=true;this.secondSpiner.readOnly=true;this.hourSpiner.el.dom.readOnly=true;this.minuteSpiner.el.dom.readOnly=true;this.secondSpiner.el.dom.readOnly=true;if(!Ext.isEmpty(this.valueStyleRead)){this.getActionEl().applyStyles(this.valueStyleRead)}},edit:function(){if(!this.rendered||this.isDisplayType()){return }this.readOnly=false;if(this.editable===false){}else{this.hourSpiner.readOnly=false;this.minuteSpiner.readOnly=false;this.secondSpiner.readOnly=false;this.hourSpiner.el.dom.readOnly=false;this.minuteSpiner.el.dom.readOnly=false;this.secondSpiner.el.dom.readOnly=false}if(!Ext.isEmpty(this.valueStyle)){this.getActionEl().applyStyles(this.valueStyle)}},onDisable:function(){Ext.form.TextField.superclass.onDisable.call(this);this.disabled=true;this.hourSpiner.wrap.addClass(this.disabledClass);this.minuteSpiner.wrap.addClass(this.disabledClass);this.secondSpiner.wrap.addClass(this.disabledClass);this.hourSpiner.disabled=true;this.minuteSpiner.disabled=true;this.secondSpiner.disabled=true;this.hourSpiner.el.dom.readOnly=true;this.minuteSpiner.el.dom.readOnly=true;this.secondSpiner.el.dom.readOnly=true;if(Ext.isIE){this.hourSpiner.el.dom.unselectable="on";this.minuteSpiner.el.dom.unselectable="on";this.secondSpiner.el.dom.unselectable="on"}},onEnable:function(){Ext.form.TextField.superclass.onEnable.call(this);this.disabled=false;this.hourSpiner.wrap.removeClass(this.disabledClass);this.minuteSpiner.wrap.removeClass(this.disabledClass);this.secondSpiner.wrap.removeClass(this.disabledClass);this.hourSpiner.disabled=false;this.minuteSpiner.disabled=false;this.secondSpiner.disabled=false;this.hourSpiner.el.dom.readOnly=false;this.minuteSpiner.el.dom.readOnly=false;this.secondSpiner.el.dom.readOnly=false;if(Ext.isIE){this.hourSpiner.el.dom.unselectable="";this.minuteSpiner.el.dom.unselectable="";this.secondSpiner.el.dom.unselectable=""}}});Ext.reg("apfatime",Artery.plugin.FaTime);Artery.plugin.STree=Ext.extend(Artery.plugin.TwinTriggerField,{treeLoaderData:null,custTree:null,custWin:null,readOnly:false,valueText:"",valuePath:"",expandValue:"",expandValuePath:"",dynamicNodeId:null,expandTree:false,showFilter:false,filterEmptyText:"",openReload:false,layerHeight:300,minLayerWidth:150,editReload:false,initComponent:function(){if(this.margin){this.defaultAutoCreate.style="margin:0;"}Artery.plugin.STree.superclass.initComponent.call(this);Ext.EventManager.on(window,"beforeunload",function(){try{if(this.custTree){this.custTree.destroy();this.custTree=null}if(this.okButton){this.okButton.destroy();this.okButton=null}if(this.closeButton){this.closeButton.destroy();this.closeButton=null}if(this.filterField){this.filterField.destroy();this.filterField=null}if(this.searchButton){this.searchButton.destroy();this.searchButton=null}if(this.custWin){this.custWin.destroy();this.custWin=null}this.root=null}catch(A){}},this);this.plugins=new Ext.tusc.plugins.Select()},submitValue:function(){var A=this.getValue();if(this.valueTemp!==undefined&&this.valueTextTemp!==undefined){this.setValue(this.valueTemp,this.valueTextTemp)}this.startValue=this.getValue();this.custWin.hide();this.fireEvent("change",this,this.value,A)},clearTempValue:function(){delete this.valueTemp;delete this.valueTextTemp},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.custWin==null){this.initCustWin()}this.custWin.show();if(this.openReload){this.root.reload()}else{if(Ext.isEmpty(this.value)){this.clearTree()}else{Artery.plugin.faTreeFunc.skinSelectedNode(this.custTree,this.getValue())}}this.expandNodePath();if(this.geditor){this.geditor.allowBlur=true}},reload:function(B){if(B==null){B={}}if(Ext.isEmpty(B.clearValue)||Ext.isTrue(B.clearValue)){this.setValue("")}if(B.params!=null){this.reloadParams={};Ext.apply(this.reloadParams,B.params)}var A=this;this.root.reload(B.callback,this)},createTreePanel:function(A){var B=Ext.id();if(A.field.showFilter){A.field.filterField=new Ext.form.TextField({emptyText:"请输入过滤值",width:230,enableKeyEvents:true});A.field.searchButton=new Ext.Button({text:"查找"});var C=[A.field.filterField,"-",A.field.searchButton]}else{var C=null}var D={baseAttrs:{uiProvider:Ext.tree.TreeSingleNodeUI,uuid:B,cls:"x-btn-text-icon"}};if(A.field.treeLoaderData==null){D.dataUrl=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadCustTreeNode"}return new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,border:false,rootVisible:false,loader:new Ext.tree.TreeLoader(D),eventModel:Ext.tusc.TreeRadioEvent,tbar:C})},createRootNode:function(B){var A={text:"root",id:"root",type:"root",cid:"root",expanded:true,children:B.field.treeLoaderData};return new Ext.tree.AsyncTreeNode(A)},initCustWin:function(){this.custTree=Artery.pwin.Artery.plugin.STree.prototype.createTreePanel({field:this});if(this.showFilter){this.filterField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.filterSearch()}},this);this.searchButton.on("click",this.filterSearch,this)}if(this.treeLoaderData==null){this.custTree.on("beforeload",this.onBeforeload,this)}this.custTree.on("expandnode",this.onExpandnode,this);this.custTree.on("checkchange",this.onCheckchange,this);if(Ext.isTrue(this.singleClickCheck)){this.custTree.on("click",this.singleClickCheckHandler,this)}if(this.root){this.root.destroy()}this.root=Artery.pwin.Artery.plugin.STree.prototype.createRootNode({field:this});this.custTree.setRootNode(this.root);this.custWin=Artery.pwin.Artery.plugin.STree.prototype.initWindow({field:this});this.okButton.on("click",this.submitValue,this);this.closeButton.on("click",function(){this.custWin.hide()},this);this.custWin.on("hide",function(A){this.clearTempValue();this.focus();this.validate();if(this.geditor){this.geditor.allowBlur=false;this.geditor.completeEdit()}},this);if(this.treeLoaderData==null&&this.expandTree){this.root.expand(true,false)}},onBeforeload:function(B){var A=this.custTree.loader;A.baseParams.itemid=this.dynamicNodeId;A.baseParams.formid=Artery.getFormId(this);A.baseParams.node_type=B.attributes.type;A.baseParams.node_cid=B.attributes.cid;A.baseParams.node_name=B.text;A.baseParams.node_leaf=B.isLeaf()+"";if(B.attributes.cfg){A.baseParams.node_cfg=Ext.encode(B.attributes.cfg)}if(B.attributes.iconId){A.baseParams.node_iconId=B.attributes.iconId}if(this.filterField){var C=this.filterField.getValue();if(!Ext.isEmpty(C)){A.baseParams.filterValue=C}else{A.baseParams.filterValue=""}}else{A.baseParams.filterValue=""}Ext.applyIf(A.baseParams,Artery.getParams({},this));A.baseParams.custParams=Ext.encode(this.custParams);Ext.apply(A.baseParams,this.reloadParams);if(this.onBeforeLoadEvent){Artery.regItemEvent(this,"onBeforeLoadEvent",null,{loader:A,node:B})}},onExpandnode:function(A){A.eachChild(function(B){if(!Ext.isEmpty(this.value)&&B.attributes.cid==this.value){B.select();B.ui.checkbox.checked=true;B.ui.checkbox.defaultChecked=true}},this)},onCheckchange:function(B,A){this.valueTextTemp=B.text;this.valueTemp=B.attributes.cid;B.select()},singleClickCheckHandler:Artery.plugin.faTreeFunc.singleClickCheckHandler,clearTree:function(){var A=this.custTree.getSelectionModel().getSelectedNode();if(A){A.unselect();if(A.ui.checkbox){A.ui.checkbox.checked=false;A.ui.checkbox.defaultChecked=false}}},initWindow:function(A){A.field.okButton=new Ext.Button({text:"确定"});A.field.closeButton=new Ext.Button({text:"关闭"});return new Ext.Window({layout:"fit",width:300,height:400,closeAction:"hide",modal:true,shadow:false,resizable:false,items:[A.field.custTree],buttons:[A.field.okButton,A.field.closeButton]})},getFilterBar:function(){if(!this.showFilter){return null}return[this.filterField=new Artery.pwin.Ext.form.TextField({emptyText:"请输入过滤值",width:230,enableKeyEvents:true,listeners:{keydown:{fn:function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.filterSearch()}},scope:this}}}),"-",{text:"查找",handler:this.filterSearch,scope:this}]},filterSearch:function(){var B=this.filterField.getValue();if(Ext.isEmpty(B)){return }var C=null;var A=function(E){if(E.text.indexOf(B)>-1){E.select();C=E.attributes.cid}for(var D=0;D<E.childNodes.length;D++){var F=E.childNodes[D];if(C!=null){break}F.expand(false,false,A);if(C==null){F.collapse()}}};this.root.expand(false,false,A)},expandNodePath:function(){if(!Ext.isEmpty(this.valuePath)&&!Ext.isEmpty(this.value)){this.expandNode(this.valuePath,true,true);this.valuePath=null;return }if(!Ext.isEmpty(this.expandValuePath)&&!Ext.isEmpty(this.expandValue)){this.expandNode(this.expandValuePath,false,true);return }},expandNode:function(F,D,C){var A=this;var B=function(H){var I=H.split(",");return I};var E=function(H){if(G.length==1){var I=H.findChild("cid",G.shift());I.select();I.getUI().getEl().scrollIntoView();if(D==true){I.ui.checkbox.checked=true}if(C==true){I.expand(false,false,function(K){if(K.hasChildNodes()&&K.lastChild){K.lastChild.ensureVisible();K.ensureVisible()}})}return }var J=H.findChild("cid",G.shift());if(J==null){return }J.expand(false,false,E)};var G=B(F);this.root.expand(false,false,E)},upValueText:function(){if(this.treeLoaderData){var B=this.findValueText();this.setValueText(B)}else{var A=Artery.getParams({value:this.getValue(),itemid:this.dynamicNodeId},this);if(!Artery.params){A.itemType="faTree";A.moreProp="STree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=onNodeDetail",success:function(C,D){var F=Ext.decode(C.responseText);var E=F.valueText;if(Ext.isEmpty(E)){E=this.value}this.setValueText(E);this.valuePath=F.valuePath},scope:this,syn:false,params:A})}},findValueText:function(){var B=[];var A=function(E){var F=null;if(E.cid==this.value){F=E.text;B.push(E.cid);return F}if(E.children){for(var D=0;D<E.children.length;D++){F=A.call(this,E.children[D]);if(F){B.push(E.cid);return F}}}return null};var C=A.call(this,{children:this.treeLoaderData});if(Ext.isEmpty(C)){C=""}B.reverse();B.shift();this.valuePath=B.join(",");return C},getLoadSelectStoreParam:function(){var A={filterValue:this.getValueText()};return A},isShowSelectList:function(){return this.editable}});Ext.reg("apSTree",Artery.plugin.STree);Artery.plugin.MTree=Ext.extend(Artery.plugin.TwinTriggerField,{custStore:null,custTree:null,custWin:null,readOnly:false,valueText:"",expandValue:"",expandValuePath:"",valuePinyin:"",enableFilter:false,expandTree:false,showFilter:false,filterEmptyText:"",openReload:false,cascade:false,cascadeParent:"allchild",openReload:false,layerHeight:300,minLayerWidth:150,editReload:false,initComponent:function(){if(this.margin){this.defaultAutoCreate.style="margin:0;"}Artery.plugin.MTree.superclass.initComponent.call(this);if(!this.custStore){this.custStore=new Artery.pwin.Ext.data.SimpleStore({fields:["id","name","pinyin"],data:this.getStoreData(),id:0})}Ext.EventManager.on(window,"beforeunload",function(){try{if(this.custTree){this.custTree.destroy();this.custTree=null}if(this.okButton){this.okButton.destroy();this.okButton=null}if(this.closeButton){this.closeButton.destroy();this.closeButton=null}if(this.filterField){this.filterField.destroy();this.filterField=null}if(this.searchButton){this.searchButton.destroy();this.searchButton=null}if(this.custWin){this.custWin.destroy();this.custWin=null}this.root=null}catch(A){}},this);this.plugins=new Ext.tusc.plugins.Select()},onRender:function(B,A){Artery.plugin.MTreePopup.superclass.onRender.call(this,B,A);if(this.cascade){this.cascadeField=this.el.insertSibling({tag:"input",type:"hidden",name:this.id+"Cascade"},"after",true)}},getStoreData:function(){var D=[];if(!Ext.isEmpty(this.value)){var E=Artery.getMultiSelectSeparator();var F=(this.value+"").split(E);var B=this.valueText.split(E);var A=null;if(!Ext.isEmpty(this.valuePinyin)){A=this.valuePinyin.split(E)}for(var C=0;C<F.length;C++){if(!Ext.isEmpty(F[C])){D[D.length]=[F[C],B[C],A==null?"":A[C]]}}}return D},getValue:function(){return this.value},setValue:function(A,B,C){A=Artery.getSplitValue(A);B=Artery.getSplitValue(B);Artery.plugin.MTree.superclass.setValue.call(this,A,B);this.custStore.loadData(this.getStoreData());this.sureSelectedNode(C!==false);if(this.cascade){if(Ext.isEmpty(A)){this.clearCascadeValue()}else{this.genCascadeValue()}}},onTrigger1Click:function(){if(!this.disabled&&this.cascade){this.clearCascadeValue()}Artery.plugin.MTreePopup.superclass.onTrigger1Click.call(this)},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.custWin==null){this.initCustWin()}this.custWin.show();if(this.openReload){this.root.reload()}else{this.sureSelectedNode(false)}this.expandNodePath();if(this.geditor){this.geditor.allowBlur=true}},reload:Artery.plugin.STree.prototype.reload,createTreePanel:function(A){var B=Ext.id();if(A.field.showFilter){A.field.filterField=new Ext.form.TextField({emptyText:"请输入过滤值",width:230,enableKeyEvents:true});A.field.searchButton=new Ext.Button({text:"查找"});var C=[A.field.filterField,"-",A.field.searchButton]}else{var C=null}var D={baseAttrs:{cls:"x-btn-text-icon"}};if(A.field.treeLoaderData==null){D.dataUrl=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadCustTreeNode"}return new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,border:false,rootVisible:false,loader:new Ext.tree.TreeLoader(D),tbar:C})},createRootNode:function(B){var A={text:"root",id:"root",type:"root",cid:"root",expanded:true,children:B.field.treeLoaderData};return new Ext.tree.AsyncTreeNode(A)},initCustWin:function(){this.custTree=Artery.pwin.Artery.plugin.MTree.prototype.createTreePanel({field:this});if(this.showFilter){this.filterField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.filterSearch()}},this);this.searchButton.on("click",this.filterSearch,this)}if(this.treeLoaderData==null){this.custTree.on("beforeload",this.onBeforeload,this)}this.custTree.on("expandnode",this.onExpandnode,this);this.custTree.on("checkchange",this.onCheckchange,this);if(Ext.isTrue(this.singleClickCheck)){this.custTree.on("click",this.singleClickCheckHandler,this)}if(this.root){this.root.destroy()}this.root=Artery.pwin.Artery.plugin.MTree.prototype.createRootNode({field:this});this.custTree.setRootNode(this.root);this.custWin=Artery.pwin.Artery.plugin.MTree.prototype.initWindow({field:this});this.okButton.on("click",this.submitValue,this);this.closeButton.on("click",function(){this.custWin.hide()},this);this.custWin.on("hide",function(A){this.clearTempValue();this.focus();this.validate();if(this.geditor){this.geditor.allowBlur=false;this.geditor.completeEdit()}},this);this.custWin.on("beforeshow",function(A){if(this.value==null||this.value==""){this.delRecordAll()}},this);if(this.treeLoaderData==null&&this.expandTree){this.root.expand(true,false)}},initWindow:function(A){A.field.okButton=new Ext.Button({text:"确定"});A.field.closeButton=new Ext.Button({text:"关闭"});return new Ext.Window({layout:"fit",width:300,height:400,closeAction:"hide",modal:true,shadow:false,resizable:false,items:[A.field.custTree],buttons:[A.field.okButton,A.field.closeButton]})},onBeforeload:function(B){var A=this.custTree.loader;A.baseParams.itemid=this.dynamicNodeId;A.baseParams.formid=Artery.getFormId(this);A.baseParams.node_type=B.attributes.type;A.baseParams.node_cid=B.attributes.cid;A.baseParams.node_name=B.text;A.baseParams.node_leaf=B.isLeaf()+"";if(B.attributes.cfg){A.baseParams.node_cfg=Ext.encode(B.attributes.cfg)}if(B.attributes.iconId){A.baseParams.node_iconId=B.attributes.iconId}if(this.filterField){var C=this.filterField.getValue();if(!Ext.isEmpty(C)){A.baseParams.filterValue=C}else{A.baseParams.filterValue=""}}else{A.baseParams.filterValue=""}Ext.applyIf(A.baseParams,Artery.getParams({},this));A.baseParams.custParams=Ext.encode(this.custParams);Ext.apply(A.baseParams,this.reloadParams);if(this.onBeforeLoadEvent){Artery.regItemEvent(this,"onBeforeLoadEvent",null,{loader:A,node:B})}},getFilterBar:Artery.plugin.STree.prototype.getFilterBar,getCascadeValue:Artery.plugin.faTreeFunc.getCascadeValue,sureSelectedNode:Artery.plugin.faTreeFunc.sureSelectedNode,sureNode:Artery.plugin.faTreeFunc.sureNode,onExpandnode:Artery.plugin.faTreeFunc.onExpandnode,onCheckchange:Artery.plugin.faTreeFunc.onCheckchange,singleClickCheckHandler:Artery.plugin.faTreeFunc.singleClickCheckHandler,onCascadeNode:Artery.plugin.faTreeFunc.onCascadeNode,genCascadeValue:Artery.plugin.faTreeFunc.genCascadeValue,clearCascadeValue:Artery.plugin.faTreeFunc.clearCascadeValue,addRecord:Artery.plugin.faTreeFunc.addRecord,delRecord:Artery.plugin.faTreeFunc.delRecord,submitValue:function(){Artery.plugin.faTreeFunc.onSubmitValue.call(this);this.custWin.hide()},clearTempValue:function(){this.custStore.loadData(this.getStoreData())},filterSearch:function(){var B=this.filterField.getValue();if(Ext.isEmpty(B)){return }var C=null;var A=function(E){if(E.text.indexOf(B)>-1){E.select();C=E.attributes.cid}for(var D=0;D<E.childNodes.length;D++){var F=E.childNodes[D];if(C!=null){break}F.expand(false,false,A);if(C==null){F.collapse()}}};this.root.expand(false,false,A)},delRecordAll:function(){this.custStore.removeAll()},expandNodePath:function(){var B=function(D,E){if(D){E.select();if(E.hasChildNodes()&&E.lastChild){E.lastChild.ensureVisible();E.ensureVisible()}}};if(!Ext.isEmpty(this.valuePath)&&!Ext.isEmpty(this.value)&&this.custTree){var C=this.valuePath.split(";");for(var A=0;A<C.length;A++){if(A==0){this.custTree.expandPath("/root/"+C[A].replace(new RegExp(",","gm"),"/"),"cid",B)}else{this.custTree.expandPath("/root/"+C[A].replace(new RegExp(",","gm"),"/"),"cid")}}this.valuePath=null;return }if(!Ext.isEmpty(this.expandValuePath)&&!Ext.isEmpty(this.expandValue)){this.custTree.expandPath("/root/"+this.expandValuePath.replace(new RegExp(",","gm"),"/"),"cid",B);return }},upValueText:function(){if(this.treeLoaderData){var B=this.findValueText();this.setValueText(B)}else{var A=Artery.getParams({value:this.getValue(),itemid:this.dynamicNodeId},this);if(!Artery.params){A.itemType="faTree";A.moreProp="STree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=onNodeDetail",success:function(C,D){var F=Ext.decode(C.responseText);var E=F.valueText;if(Ext.isEmpty(E)){E=this.value}this.setValueText(E)},scope:this,syn:false,params:A})}this.custStore.loadData(this.getStoreData())},findValueText:function(){var G=Artery.getMultiSelectSeparator();var A={};var E={};var F=this.value.split(G);for(var C=0;C<F.length;C++){A[F[C]]=F[C];E[F[C]]=[]}var H=[];var D=function(J){var K=null;if(J.leaf&&A[J.cid]!=null){H.push(J.text);K=J.cid;E[K].push(J.cid)}if(J.children){for(var I=0;I<J.children.length;I++){K=D.call(this,J.children[I])}if(K&&J.cid){E[K].push(J.cid)}}return K};D.call(this,{children:this.treeLoaderData});for(var C=0;C<F.length;C++){E[F[C]].reverse();var B=E[F[C]].join(",");if(B){if(this.valuePath){this.valuePath+=";"+B}else{this.valuePath=B}}}return H.join(G)},getLoadSelectStoreParam:function(){var A={filterValue:this.getValueText()};return A},isShowSelectList:function(){return this.editable},getMultiSelect:function(){return true}});Ext.reg("apMTree",Artery.plugin.MTree);Artery.plugin.STreePopup=Ext.extend(Artery.plugin.PopupTrigger,{treeLoaderData:null,custTree:null,custLayer:null,readOnly:false,valueText:"",valuePath:"",expandValue:"",expandValuePath:"",dynamicNodeId:null,expandTree:false,showFilter:false,openReload:false,layerHeight:300,minLayerWidth:150,editReload:false,initComponent:function(){Artery.plugin.STreePopup.superclass.initComponent.call(this);Ext.EventManager.on(window,"beforeunload",function(){try{if(this.custTree){this.custTree.destroy();this.custTree=null}if(this.filterField){this.filterField.destroy();this.filterField=null}if(this.confirmButton){this.confirmButton.destroy();this.confirmButton=null}if(this.searchButton){this.searchButton.destroy();this.searchButton=null}if(this.custLayer){this.custLayer.destroy();this.custLayer=null}this.root=null;this.layerEl=null}catch(A){}},this);this.plugins=new Ext.tusc.plugins.Select()},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(this.custLayer==null){this.initCustLayer()}this.showTreeLayer()},showTreeLayer:function(){if(this.isExpanded()){return }if(this.geditor){this.geditor.allowBlur=true}if(this.filterField){var A=Math.max(this.wrap.getWidth(),this.minLayerWidth);this.filterField.setWidth(A-50)}if(!this.custTree.rendered){this.custTree.render(this.custLayer.dom);if(this.expandNodePath){this.expandNodePath()}}else{this.skinTree()}this.restrictLayer(this.custLayer,this.custTree)},initPopupItem:function(){if(this.disabled||this.readOnly){return }if(this.custLayer==null){this.initCustLayer()}if(this.isExpanded()){return }if(this.geditor){this.geditor.allowBlur=true}if(this.filterField){var A=Math.max(this.wrap.getWidth(),this.minLayerWidth);this.filterField.setWidth(A-50)}if(!this.custTree.rendered){this.custTree.render(this.custLayer.dom);if(this.expandNodePath){this.expandNodePath()}}else{this.skinTree()}},skinTree:function(){if(this.openReload){this.root.reload()}else{if(Ext.isEmpty(this.getValue())){this.clearTree()}else{Artery.plugin.faTreeFunc.skinSelectedNode(this.custTree,this.getValue())}}this.expandNodePath()},reload:function(B){if(B==null){B={}}if(Ext.isEmpty(B.clearValue)||Ext.isTrue(B.clearValue)){this.setValue("")}if(B.params!=null){this.reloadParams={};Ext.applyIf(this.reloadParams,B.params)}var A=this;if(this.root){this.root.reload(B.callback,this)}},createRootNode:function(B){var A={text:"root",id:"root",type:"root",cid:"root",expanded:true,children:B.field.treeLoaderData};return new Ext.tree.AsyncTreeNode(A)},createTreePanel:function(A){var B=Ext.id();if(A.field.showFilter){A.field.filterField=new Ext.form.TextField({emptyText:"请输入过滤值",width:230,enableKeyEvents:true});A.field.searchButton=new Ext.Button({text:"查找"});var C=[A.field.filterField,"-",A.field.searchButton]}else{var C=null}A.field.confirmButton=new Ext.Button({text:"确定"});var D={baseAttrs:{uiProvider:Ext.tree.TreeSingleNodeUI,uuid:B,cls:"x-btn-text-icon"}};if(A.field.treeLoaderData==null){D.dataUrl=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadCustTreeNode"}return new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,border:true,height:this.layerHeight,rootVisible:false,tbar:C,bbar:["->",A.field.confirmButton],loader:new Ext.tree.TreeLoader(D),eventModel:Ext.tusc.TreeRadioEvent})},createTreeLayer:function(A){return new Artery.plugin.PopupLayer({shadow:true,constrain:false,zindex:20000,popupField:A.field})},initCustLayer:function(){this.custTree=Artery.pwin.Artery.plugin.STreePopup.prototype.createTreePanel({field:this});if(this.showFilter){this.filterField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.filterSearch()}},this);this.searchButton.on("click",this.filterSearch,this)}this.confirmButton.on("click",this.submitValue,this);if(this.treeLoaderData==null){this.custTree.on("beforeload",this.onBeforeload,this)}this.custTree.on("expandnode",this.onExpandnode,this);this.custTree.on("collapsenode",this.onCollapsenode,this);this.custTree.on("checkchange",this.onCheckchange,this);if(Ext.isTrue(this.singleClickCheck)){this.custTree.on("click",this.singleClickCheckHandler,this)}if(this.root){this.root.destroy()}this.root=Artery.pwin.Artery.plugin.STreePopup.prototype.createRootNode({field:this});this.custTree.setRootNode(this.root);this.custLayer=Artery.pwin.Artery.plugin.STreePopup.prototype.createTreeLayer({field:this});this.layerEl=this.custLayer;if(this.treeLoaderData==null&&this.expandTree){this.root.expand(true,false)}},getFilterBar:function(){},onBeforeload:function(B){var A=this.custTree.loader;A.baseParams.itemid=this.dynamicNodeId;A.baseParams.formid=Artery.getFormId(this);A.baseParams.node_type=B.attributes.type;A.baseParams.node_cid=B.attributes.cid;A.baseParams.node_name=B.text;A.baseParams.node_leaf=B.isLeaf()+"";if(B.attributes.cfg){A.baseParams.node_cfg=Ext.encode(B.attributes.cfg)}if(B.attributes.iconId){A.baseParams.node_iconId=B.attributes.iconId}if(this.filterField){var C=this.filterField.getValue();if(!Ext.isEmpty(C)){A.baseParams.filterValue=C}else{A.baseParams.filterValue=""}}else{A.baseParams.filterValue=""}Ext.applyIf(A.baseParams,Artery.getParams({},this));A.baseParams.custParams=Ext.encode(this.custParams);Ext.apply(A.baseParams,this.reloadParams);if(this.onBeforeLoadEvent){Artery.regItemEvent(this,"onBeforeLoadEvent",null,{loader:A,node:B})}},filterSearch:function(){this.root.reload(function(){this.clearTempValue();if(!Ext.isEmpty(this.filterField.getValue())){this.root.expand(true,false)}},this)},submitValue:function(){var A=this.getValue();if(this.valueTemp!==undefined&&this.valueTextTemp!==undefined){this.setValue(this.valueTemp,this.valueTextTemp)}this.startValue=this.getValue();this.collapse(true);this.fireEvent("change",this,this.value,A)},clearTempValue:function(){delete this.valueTemp;delete this.valueTextTemp},onExpandnode:function(A){A.eachChild(function(B){if(B.attributes.cid==this.value){B.select();B.ui.checkbox.checked=true;B.ui.checkbox.defaultChecked=true}},this);if(this.custLayer.isVisible()){this.restrictLayer(this.custLayer,this.custTree)}},onCollapsenode:function(){if(this.custLayer.isVisible()){this.restrictLayer(this.custLayer,this.custTree)}},onCheckchange:function(B,A){if(A){this.valueTextTemp=B.text;this.valueTemp=B.attributes.cid}else{this.clearTempValue()}B.select()},singleClickCheckHandler:Artery.plugin.faTreeFunc.singleClickCheckHandler,clearTree:function(){var A=this.custTree.getSelectionModel().getSelectedNode();if(A){A.unselect();if(A.ui.checkbox){A.ui.checkbox.checked=false;A.ui.checkbox.defaultChecked=false}}},expandNodePath:function(){if(!Ext.isEmpty(this.valuePath)&&!Ext.isEmpty(this.value)){this.expandNode(this.valuePath,true,true);this.valuePath=null;return }if(!Ext.isEmpty(this.expandValuePath)&&!Ext.isEmpty(this.expandValue)){this.expandNode(this.expandValuePath,false,true);return }},expandNode:function(F,D,C){var A=this;var B=function(H){var I=H.split(",");return I};var E=function(H){if(G.length==1){var I=H.findChild("cid",G.shift());I.select();I.getUI().getEl().scrollIntoView();if(D==true){I.ui.checkbox.checked=true}if(C==true){I.expand(false,false,function(K){if(K.hasChildNodes()&&K.lastChild){K.lastChild.ensureVisible();K.ensureVisible()}})}return }var J=H.findChild("cid",G.shift());if(J==null){return }J.expand(false,false,E)};var G=B(F);this.root.expand(false,false,E)},upValueText:function(){if(this.treeLoaderData){var B=this.findValueText();this.setValueText(B)}else{var A=Artery.getParams({value:this.getValue(),itemid:this.dynamicNodeId},this);if(!Artery.params){A.itemType="faTree";A.moreProp="STree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=onNodeDetail",success:function(C,D){var F=Ext.decode(C.responseText);var E=F.valueText;if(Ext.isEmpty(E)){E=this.value}this.setValueText(E);this.valuePath=F.valuePath},scope:this,syn:false,params:A})}},findValueText:function(){var B=[];var A=function(E){var F=null;if(E.cid==this.value){F=E.text;B.push(E.cid);return F}if(E.children){for(var D=0;D<E.children.length;D++){F=A.call(this,E.children[D]);if(F){B.push(E.cid);return F}}}return null};var C=A.call(this,{children:this.treeLoaderData});if(Ext.isEmpty(C)){C=""}B.reverse();B.shift();this.valuePath=B.join(",");return C},getLoadSelectStoreParam:function(){var A={filterValue:this.getValueText()};return A},isShowSelectList:function(){return this.editable}});Ext.reg("apSTreePopup",Artery.plugin.STreePopup);Artery.plugin.MTreePopup=Ext.extend(Artery.plugin.PopupTrigger,{custStore:null,custTree:null,custLayer:null,readOnly:false,valueText:"",expandValue:"",expandValuePath:"",valuePinyin:"",showFilter:false,cascade:false,openReload:false,layerHeight:300,minLayerWidth:150,editReload:false,cascadeParent:"allchild",initComponent:function(){Artery.plugin.MTreePopup.superclass.initComponent.call(this);if(!this.custStore){this.custStore=new Ext.data.SimpleStore({fields:["id","name","pinyin"],data:this.getStoreData(),id:0})}Ext.EventManager.on(window,"beforeunload",function(){try{if(this.custTree){this.custTree.destroy();this.custTree=null}if(this.filterField){this.filterField.destroy();this.filterField=null}if(this.confirmButton){this.confirmButton.destroy();this.confirmButton=null}if(this.searchButton){this.searchButton.destroy();this.searchButton=null}if(this.custLayer){this.custLayer.destroy();this.custLayer=null}this.root=null;this.layerEl=null}catch(A){}},this);this.plugins=new Ext.tusc.plugins.Select()},onNodeClick:function(A){},onRender:function(B,A){Artery.plugin.MTreePopup.superclass.onRender.call(this,B,A);if(this.cascade){this.cascadeField=this.el.insertSibling({tag:"input",type:"hidden",name:this.id+"Cascade"},"after",true)}},getStoreData:function(){var D=[];if(!Ext.isEmpty(this.value)){var E=Artery.getMultiSelectSeparator();var F=(this.value+"").split(E);var B=this.valueText.split(E);var A=null;if(!Ext.isEmpty(this.valuePinyin)){A=this.valuePinyin.split(E)}for(var C=0;C<F.length;C++){if(!Ext.isEmpty(F[C])){D[D.length]=[F[C],B[C],A==null?"":A[C]]}}}return D},setValue:function(A,B,C){A=Artery.getSplitValue(A);B=Artery.getSplitValue(B);Artery.plugin.MTreePopup.superclass.setValue.call(this,A,B);this.custStore.loadData(this.getStoreData());this.sureSelectedNode(C!==false);if(this.cascade){if(Ext.isEmpty(A)){this.clearCascadeValue()}else{this.genCascadeValue()}}},onTrigger1Click:function(){if(!this.disabled&&this.cascade){this.clearCascadeValue()}Artery.plugin.MTreePopup.superclass.onTrigger1Click.call(this)},onTrigger2Click:Artery.plugin.STreePopup.prototype.onTrigger2Click,showTreeLayer:Artery.plugin.STreePopup.prototype.showTreeLayer,getFilterBar:Artery.plugin.STreePopup.prototype.getFilterBar,skinTree:function(){if(this.openReload){this.root.reload()}else{this.sureSelectedNode(false)}this.expandNodePath()},reload:Artery.plugin.STreePopup.prototype.reload,clearTempValue:function(){this.custStore.loadData(this.getStoreData())},createTreePanel:function(A){if(A.field.showFilter){A.field.filterField=new Ext.form.TextField({emptyText:"请输入过滤值",width:230,enableKeyEvents:true});A.field.searchButton=new Ext.Button({text:"查找"});var B=[A.field.filterField,"-",A.field.searchButton]}else{var B=null}A.field.confirmButton=new Ext.Button({text:"确定"});var C={cls:"x-btn-text-icon"};if(A.field.treeLoaderData==null){C.dataUrl=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadCustTreeNode"}return new Ext.tree.TreePanel({autoScroll:true,animate:false,enableDD:false,border:true,height:this.layerHeight,rootVisible:false,tbar:B,bbar:["->",A.field.confirmButton],loader:new Ext.tree.TreeLoader(C)})},createRootNode:function(B){var A={text:"root",id:"root",type:"root",cid:"root",expanded:true,children:B.field.treeLoaderData};return new Ext.tree.AsyncTreeNode(A)},createTreeLayer:function(A){return new Artery.plugin.PopupLayer({shadow:true,constrain:false,zindex:20000,popupField:A.field})},initCustLayer:function(){this.custTree=Artery.pwin.Artery.plugin.MTreePopup.prototype.createTreePanel({field:this});if(this.showFilter){this.filterField.on("keydown",function(B,A){if(A.getKey()==Ext.EventObject.ENTER){this.filterSearch()}},this);this.searchButton.on("click",this.filterSearch,this)}this.confirmButton.on("click",this.submitValue,this);if(this.treeLoaderData==null){this.custTree.on("beforeload",this.onBeforeload,this)}this.custTree.on("expandnode",this.onExpandnodeMain,this);this.custTree.on("collapsenode",this.onCollapsenode,this);this.custTree.on("checkchange",this.onCheckchange,this);this.custTree.on("click",this.onNodeClick,this);if(Ext.isTrue(this.singleClickCheck)){this.custTree.on("click",this.singleClickCheckHandler,this)}this.root=Artery.pwin.Artery.plugin.MTreePopup.prototype.createRootNode({field:this});this.custTree.setRootNode(this.root);this.custLayer=Artery.pwin.Artery.plugin.MTreePopup.prototype.createTreeLayer({field:this});this.layerEl=this.custLayer;if(this.treeLoaderData==null&&this.expandTree){this.root.expand(true,false)}},filterSearch:function(){this.root.reload(function(){this.custStore.removeAll();if(!Ext.isEmpty(this.filterField.getValue())){this.root.expand(true,false)}},this)},submitValue:function(){Artery.plugin.faTreeFunc.onSubmitValue.call(this);this.collapse()},getCascadeValue:Artery.plugin.faTreeFunc.getCascadeValue,sureSelectedNode:Artery.plugin.faTreeFunc.sureSelectedNode,sureNode:Artery.plugin.faTreeFunc.sureNode,onCollapsenode:function(A){if(this.custLayer.isVisible()){this.restrictLayer(this.custLayer,this.custTree)}},onExpandnodeMain:function(A){this.onExpandnode(A);if(this.custLayer.isVisible()){this.restrictLayer(this.custLayer,this.custTree)}},onExpandnode:Artery.plugin.faTreeFunc.onExpandnode,onCheckchange:Artery.plugin.faTreeFunc.onCheckchange,singleClickCheckHandler:Artery.plugin.faTreeFunc.singleClickCheckHandler,onCascadeNode:Artery.plugin.faTreeFunc.onCascadeNode,genCascadeValue:Artery.plugin.faTreeFunc.genCascadeValue,clearCascadeValue:Artery.plugin.faTreeFunc.clearCascadeValue,addRecord:Artery.plugin.faTreeFunc.addRecord,delRecord:Artery.plugin.faTreeFunc.delRecord,expandNodePath:function(){var B=function(D,E){if(D){E.select();if(E.hasChildNodes()&&E.lastChild){E.lastChild.ensureVisible();E.ensureVisible()}}};if(!Ext.isEmpty(this.valuePath)&&!Ext.isEmpty(this.value)&&this.custTree){var C=this.valuePath.split(";");for(var A=0;A<C.length;A++){if(A==0){this.custTree.expandPath("/root/"+C[A].replace(new RegExp(",","gm"),"/"),"cid",B)}else{this.custTree.expandPath("/root/"+C[A].replace(new RegExp(",","gm"),"/"),"cid")}}this.valuePath=null;return }if(!Ext.isEmpty(this.expandValuePath)&&!Ext.isEmpty(this.expandValue)){this.custTree.expandPath("/root/"+this.expandValuePath.replace(new RegExp(",","gm"),"/"),"cid",B);return }},upValueText:function(){if(this.treeLoaderData){var B=this.findValueText();this.setValueText(B)}else{var A=Artery.getParams({value:this.getValue(),itemid:this.dynamicNodeId},this);if(!Artery.params){A.itemType="faTree";A.moreProp="STree"}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=onNodeDetail",success:function(D,E){var G=Ext.decode(D.responseText);var F=G.valueText;var C=G.valuePath;if(Ext.isEmpty(F)){F=this.value}this.setValueText(F);this.valuePath=C},scope:this,syn:false,params:A});this.expandNodePath()}this.custStore.loadData(this.getStoreData())},onBeforeload:function(B){var A=this.custTree.loader;A.baseParams.itemid=this.dynamicNodeId;A.baseParams.formid=Artery.getFormId(this);A.baseParams.node_type=B.attributes.type;A.baseParams.node_cid=B.attributes.cid;A.baseParams.node_name=B.text;A.baseParams.node_leaf=B.isLeaf()+"";if(B.attributes.cfg){A.baseParams.node_cfg=Ext.encode(B.attributes.cfg)}if(B.attributes.iconId){A.baseParams.node_iconId=B.attributes.iconId}if(this.filterField){var C=this.filterField.getValue();if(!Ext.isEmpty(C)){A.baseParams.filterValue=C}else{A.baseParams.filterValue=""}}else{A.baseParams.filterValue=""}Ext.applyIf(A.baseParams,Artery.getParams({},this));A.baseParams.custParams=Ext.encode(this.custParams);Ext.apply(A.baseParams,this.reloadParams);if(this.onBeforeLoadEvent){Artery.regItemEvent(this,"onBeforeLoadEvent",null,{loader:A,node:B})}},findValueText:function(){var G=Artery.getMultiSelectSeparator();var A={};var E={};var F=this.value.split(G);for(var C=0;C<F.length;C++){A[F[C]]=F[C];E[F[C]]=[]}var H=[];var D=function(J){var K=null;if(J.leaf&&A[J.cid]!=null){H.push(J.text);K=J.cid;E[K].push(J.cid)}if(J.children){for(var I=0;I<J.children.length;I++){K=D.call(this,J.children[I])}if(K&&J.cid){E[K].push(J.cid)}}return K};D.call(this,{children:this.treeLoaderData});for(var C=0;C<F.length;C++){var B=null;E[F[C]].reverse();B=E[F[C]].join(",");if(B){if(this.valuePath){this.valuePath+=";"+B}else{this.valuePath=B}}}return H.join(G)},getLoadSelectStoreParam:function(){var A={filterValue:this.getValueText()};return A},isShowSelectList:function(){return this.editable},getMultiSelect:function(){return true}});Ext.reg("apMTreePopup",Artery.plugin.MTreePopup);Artery.plugin.FaTrigger=Ext.extend(Artery.plugin.TwinTriggerField,{setValue:function(A,C){var B=this.getValue();Artery.plugin.FaTrigger.superclass.setValue.call(this,A,C);this.validate();if(this.value+""!=B+""){this.fireEvent("change",this,this.value,B)}},initValue:function(){this.originalValue=this.getValue();this.previousValue=this.originalValue;this.originalValueText=this.getValueText()},reset:function(){if(!this.rendered){return }if(this.originalValue+""==this.value+""){return }this.setValueNoValid(this.originalValue);this.setValueText(this.originalValueText);this.clearInvalid()},setOriginalValue:function(A,B){this.originalValue=A;if(Ext.isEmpty(B)){this.originalValueText=A}else{this.originalValueText=B}},setOriginalValueText:function(A){this.originalValueText=A},upValueText:function(A){},setShowValue:function(A){this.setValueText(A);this.validate()},getShowValue:function(){return this.getValueText()},onTrigger2Click:function(){if(this.disabled||this.readOnly){return }if(Ext.isEmpty(this.onTriggerClickEvent)){return }Artery.regItemEvent(this,"onTriggerClickEvent","onTriggerClickServer")}});Ext.reg("apFaTrigger",Artery.plugin.FaTrigger);Artery.initEnterEvent=function(D,A){try{var C=new Ext.KeyMap(D,{key:13,fn:A})}catch(B){}};Artery.initMoreButton=function(D){var C=Ext.get(D+"_moreButton");if(C&&!C.rendered){var B=Ext.get(D+"_moreContainer");var A=Ext.get(D+"_moreDiv");function E(){if(B.isDisplayed()){B.setDisplayed(false);C.update(C.text?C.text:">>填写更多信息");C.dom.title="点击查看"}else{B.setDisplayed(true);C.text=C.dom.innerHTML;C.expandText=C.dom.expandText;C.update(C.expandText?C.expandText:">>收起更多信息");C.dom.title="点击收起"}}C.on("keydown",function(F){if(F.getKey()==32){E()}});C.on("click",function(){E()});C.rendered=true}};Artery.plugin.FormArea=Ext.extend(Ext.form.FormPanel,{onEnter:null,errors:null,errorsTip:null,layout:"atylayout",allowDomMove:false,submitAutoValid:true,onResize:Artery.plugin.BasePanel.prototype.onResize,tableEl:null,initComponent:function(){Artery.plugin.FormArea.superclass.initComponent.call(this);this.errors=[];this.errorsTip=new Ext.XTemplate("<table cellpadding=5 cellspacing=5>",'<tpl for="errors">','<tr><td style="color:red;">{name}</td><td>:</td><td>{error}</td></tr>',"</tpl>","</table>");this.errorsTip.compile()},createForm:function(){var A=Ext.applyIf({listeners:{}},this.initialConfig);return new Ext.form.BasicForm(Ext.get(this.id+"-atbody"),A)},lookupComponent:Artery.plugin.BaseContainer.prototype.lookupComponent,initValidEvent:function(){var A=this;this.form.items.each(function(D,B,C){D.on("invalid",function(G,I){if(A.beginValid!=true){return }var H=false;var E=A.errors.length;for(var F=0;F<E;F++){if(A.errors[F].name==G.fieldLabel){H=true}}if(!H){A.errors.push({name:G.fieldLabel,error:I})}})},this)},initShowHideEvent:function(){this.form.items.each(function(C,A,B){C.on("show",this.dealTrHidden,this);C.on("hide",this.dealTrHidden,this)},this)},onRender:function(B,A){this.initFields();this.initValidEvent();if(Ext.isTrue(this.autoHideTr)){this.initShowHideEvent()}Artery.plugin.BasePanel.prototype.onRender.call(this,B,A);this.form.initEl(this.id+"-atbody");this.tableEl=Ext.get((this.id+"Table"))},afterRender:function(){Artery.plugin.FormArea.superclass.afterRender.call(this);if(this.onLoadEvent){Artery.regItemEvent(this,"onLoadEvent",null,{})}},initFields:function(){var F=this.form;F.items.clear();var A=Ext.getDom(this.id+"-atbody").elements;if(typeof A=="undefined"){return }var D=A.length;var E=Artery.getFieldErrorCollTip();if(E.initErrorTip){E.reset()}var C=new Array();for(var B=0;B<D;B++){C[B]=A[B].id}for(var B=0;B<D;B++){var G=Artery.get(C[B]);if(G){F.add(G)}}},getValues:function(B){this.removeEmptyText();var A=this.form.getValues(B);this.recoverEmptyText();return A},submit:function(A,D){var B=Artery.getParams({buttonItemid:Artery.params.itemid,method:"parseFormSubmit"},this);if(this.submitAutoValid&&!this.isValid()){return }if(!this.submitAutoValid){var C=this.form.validRequired();if(!C){return }}if(Ext.isObject(D)){Ext.apply(B,D)}this.removeEmptyText();Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",scope:this,params:B,form:this.getForm().getEl().dom.id,isUpload:true,success:function(E,F){var I=E.responseText;if(!Ext.isEmpty(I)){if(/^arterycmd:.*\.jsp$/.test(I)){var H=I.replace(/arterycmd:/,"");alert(Artery.ajaxLoginTip);top.window.location.href=H;return }try{I=Ext.decode(I);I=I["return"]}catch(G){Artery.showError("出错啦，请检查！");return }}this.changePrevious();if(A!=null&&typeof A=="function"){A.call(this,I)}}});this.recoverEmptyText()},login:function(A,C){var B=Artery.getParams({buttonItemid:Artery.params.itemid,method:"parseFormLogin"},this);if(this.submitAutoValid&&!this.isValid()){return }if(Ext.isObject(C)){Ext.apply(B,C)}this.removeEmptyText();Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",scope:this,params:B,form:this.getForm().getEl().dom.id,success:function(D,E){var G=D.responseText;if(!Ext.isEmpty(G)){try{G=Ext.decode(G);G=G["return"]}catch(F){Artery.showError("出错啦，请检查！")}}if(A!=null&&typeof A=="function"){A.call(this,G)}}});this.recoverEmptyText()},removeEmptyText:function(){this.form.items.each(function(A){if(A.el&&A.el.dom){if(A.emptyText==A.el.dom.value){A.el.dom.value="";A.ret=true}}})},recoverEmptyText:function(){this.form.items.each(function(A){if(A.el&&A.el.dom){if(A.ret){if(!Ext.isEmpty(A.emptyText)&&Ext.isEmpty(A.el.dom.value)){A.el.dom.value=A.emptyText}A.ret=false}}})},clearInValid:function(){this.form.items.each(function(A){if(A.el&&A.el.dom){A.clearInvalid()}})},isValid:function(C){this.beginValid=true;var B=true;if(!this.form.isValid(C)){B=false}if(!Ext.isEmpty(this.onValidEvent)){var A=this.validClient(this.onValidEvent);if(A!=null){if(A.errorText){var D=Ext.getCmp(A.errorId);if(D!=null){D.markInvalid(A.errorText)}B=false}}}if(!B){}this.beginValid=false;return B},reload:function(A){if(A==null){A={params:{}}}else{if(A.params==null){A.params={}}}Ext.applyIf(A.params,Artery.getParams({method:"reload"},this));Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",success:function(C,D){var B=Ext.decode(C.responseText).values;Artery.recoverFormData(B);this.changePrevious();if(A.callback!=null&&typeof A.callback=="function"){A.callback.call(this)}this.clearInValid();if(this.onLoadEvent){Artery.regItemEvent(this,"onLoadEvent",null,{})}},params:A.params,scope:this})},getFormData:function(){var A={};this.form.items.each(function(B){A[B.id]=Artery.get(B.id).getValue()});return A},showValidErrors:function(){var A=this.errorsTip.apply({errors:this.errors});this.errors=[];return A},validClient:function(clientScript){var rc=Artery.createCaller(Artery.getEventId(this),"onValidServer",Artery.getFormId(this));rc.sync=true;if(clientScript.indexOf("return")==-1){eval("var script = function(){return "+clientScript+"};")}else{eval("var script = function(){"+clientScript+"};")}return script()},read:function(){this.readAllSub(false)},edit:function(){this.editAllSub(false)},reset:function(){this.form.items.each(function(){this.reset();this.changePrevious()})},changePrevious:function(){this.form.items.each(function(){this.changePrevious()})},isChange:function(){var A=false;this.form.items.each(function(){if(this.getValue()!=this.previousValue){A=true}});return A},readAllSub:function(A){var B=this.id;this.form.items.each(function(){if(Ext.isTrue(A)&&this.pid!=B){return }this.read()})},editAllSub:function(A){var B=this.id;this.form.items.each(function(){if(Ext.isTrue(A)&&this.pid!=B){return }this.edit()})},disableAllSub:function(A){var B=this.id;this.form.items.each(function(){if(Ext.isTrue(A)&&this.pid!=B){return }this.disable()})},enableAllSub:function(A){var B=this.id;this.form.items.each(function(){if(Ext.isTrue(A)&&this.pid!=B){return }this.enable()})},clearAllSub:function(){this.form.items.each(function(){this.setValue("")})},dealTrHidden:function(){var A=this.tableEl.child("tbody");var C=A.first();while(C){if(C.dom.tagName.toLowerCase()=="tr"){var B=true;var D=C.first();while(D){if(D.dom.tagName.toLowerCase()=="td"){if(!D.hasClass("x-hide-display")&&!D.hasClass("x-form-blank-td-cust")){B=false;break}}D=D.next()}if(B){C.addClass("x-hide-display")}else{C.removeClass("x-hide-display")}}C=C.next()}}});Ext.reg("apformarea",Artery.plugin.FormArea);Ext.ux.grid={};Ext.ux.grid.DragSelector=function(K){K=K||{};var N,L,O=[];var A,S,C,Z,I,U,d;var J,G,F=new Ext.lib.Region(0,0,0,0);var T=K.dragSafe===true;var P,V,Q=false;var X,B=0;this.init=function(g){A=g;S=A.getView();U=A.getSelectionModel();A.on("render",H);A.on("bodyscroll",b)};function b(h){E();var g=d.getScroll().top;B=g-X;if(Q){R(h,true)}}function W(){G=d.getRegion();J=d.getRegion();O=[];var g="div.x-grid3-row";var h=S.el.dom;Ext.each(Ext.query(g,h),function(i){O[O.length]=U.isSelected(O.length)});D();b()}function D(){N=[];L=[];var g="div.x-grid3-row";var h=S.el.dom;Ext.each(Ext.query(g,h),function(i){L[L.length]=Ext.get(i).getRegion();N[N.length]=Ext.get(i).getRegion()})}function E(){D()}function Y(h){P=h.ctrlKey;V=h.shiftKey;A.stopEditing();var g=h.getTarget();if(!P&&!V&&g.className==="x-grid3-body"){U.clearSelections()}return true}function e(g){if(g.button===2){return false}if(A.activeEditor&&A.activeEditor!==null){return false}if(g.getPageY()<=S.el.getY()+25){return false}if(g.getPageX()>S.el.getX()+S.el.dom.clientWidth-20){return false}Y(g);return !T||g.target==S.el.dom}function a(g){X=d.getScroll().top;W();if(!Z){Z=S.el.createChild({cls:"x-view-selector"})}else{Z.setDisplayed("block")}Q=true}function R(s,k){var u=I.startXY;var AC=I.getXY();if(AC[0]<u[0]&&!k){AC[0]+=2}if(B>=0){if((u[1]-B)<=AC[1]){var z=u[1]-B;var o=Math.abs(z-AC[1])}else{var z=AC[1];var o=Math.abs(u[1]-AC[1])-B}var AA=Math.min(u[0],AC[0]);var AB=Math.abs(u[0]-AC[0]);J.top-=B}else{if((u[1]-B)<AC[1]){var z=u[1]-B;var o=Math.abs(z-AC[1])}else{var z=AC[1];var o=Math.abs((u[1]-B)-AC[1])}var AA=Math.min(u[0],AC[0]);var AB=Math.abs(u[0]-AC[0]);J.bottom-=B}F.left=AA;F.top=z;F.right=AA+AB;F.bottom=z+o;F.constrainTo(J);Z.setRegion(F);for(var n=0,q=N.length;n<q;n++){var g=N[n],j=F.intersect(g);var m=U.isSelected(n);var t=O[n];if(P){if(t){if(j&&m){U.deselectRow(n)}else{if(!j&&!m){U.selectRow(n,true)}}}else{if(j&&!m){U.selectRow(n,true)}else{if(!j&&m){U.deselectRow(n)}}}}else{if(j&&!m){U.selectRow(n,true)}else{if(!j&&m){U.deselectRow(n)}}}}if(AC[1]+10>=G.bottom){if(Ext.isIE){setTimeout(function(){d.scrollTo("top",d.getScroll().top+40)},100)}else{d.scrollTo("top",d.getScroll().top+40)}}if(AC[1]-10<=G.top){if(Ext.isIE){setTimeout(function(){d.scrollTo("top",d.getScroll().top-40)},100)}else{d.scrollTo("top",d.getScroll().top-40)}}}function M(g){Q=false;if(Z){Z.setDisplayed(false)}}function H(g){I=new Ext.dd.DragTracker({onBeforeStart:e,onStart:a,onDrag:R,onEnd:M});I.initEl(g.el);d=Ext.get(A.getView().scroller)}};Ext.tusc.plugins.FilterGrid=function(A){Ext.tusc.plugins.FilterGrid.superclass.constructor.call(this,A);Ext.apply(this,A)};Ext.extend(Ext.tusc.plugins.FilterGrid,Ext.util.Observable,{pageCount:0,init:function(gridPanel){var gp=gridPanel;var fg=this;var viewConfig={filters:new Ext.util.MixedCollection(),templates:{header:new Ext.XTemplate('<table border="0" cellspacing="0" cellpadding="0" style="{tstyle}">','<tpl if="isFilter == true">','<tr class="x-grid3-hd-filter" style="{fstyle}">{fcells}</tr>',"</tpl>",'<tr class="x-grid3-hd-row">{cells}</tr>',"</table>"),fcell:new Ext.Template('<td class="x-grid3-td-{id} {css}" style="border-bottom:1px solid #DDDDDD;{style}"><div class="filter-input" style="padding:3px;{fstyle}">',"</div></td>")},renderHeaders:function(){var cm=this.cm,ts=this.templates;var ct=ts.hcell;var ft=ts.fcell;var cb=[],sb=[],p={},fb=[];for(var i=0,len=cm.getColumnCount();i<len;i++){p.id=cm.getColumnId(i);p.value=cm.getColumnHeader(i)||"";p.style=this.getColumnStyle(i,true);p.tooltip=this.getColumnTooltip(i);if(cm.config[i].align=="right"){p.istyle="padding-right:16px"}else{delete p.istyle}p.css=this.getColumnCss(i,false);cb[cb.length]=ct.apply(p);p.fstyle=this.getFColumnStyle(i);p.css=this.getColumnCss(i,true);fb[fb.length]=ft.apply(p)}return ts.header.apply({cells:cb.join(""),tstyle:"width:"+this.getTotalWidth()+";",fcells:fb.join(""),isFilter:this.isFilter()})},getColumnCss:function(col,fcol){if(!fcol&&Ext.isTrue(this.cm.config[col].isFix)){return"x-grid-hd-fix"}if(fcol&&Ext.isTrue(this.cm.config[col].isFix)){return"x-grid-fhd-fix"}return""},getFColumnStyle:function(col){var style="width:100%;";if(this.cm.isHidden(col)){style+="display:none;"}if(this.cm.config[col].isFix){style+="height:25;z-index:9999;background-color:#F9F9F9;"}return style},isFilter:function(){var cm=this.cm;for(var i=0,len=cm.getColumnCount();i<len;i++){if(typeof cm.config[i].filter!="undefined"&&cm.config[i].filter==true){return true}}return false},doFilter:function(){var o={};if(this.ds.lastOptions&&this.ds.lastOptions.params){Ext.apply(o,this.ds.lastOptions.params)}o.start=0;if(fg.pageCount!=0){o.limit=fg.pageCount}this.ds.load({params:o})},convert:function(item){var val=item.getValue();if(Ext.isEmpty(val)){return""}val=val.replace(/;/,"$sem").replace(/:/,"$col");if(item.store){return"~"+val+"##"+item.el.dom.value}else{return val}},initElements:function(){var gw=this;var E=Ext.Element;var el=this.grid.getGridEl().dom.firstChild;var cs=el.childNodes;this.el=new E(el);this.mainWrap=new E(cs[0]);this.mainHd=new E(this.mainWrap.dom.firstChild);if(this.grid.hideHeaders){this.mainHd.setDisplayed(false)}this.innerHd=this.mainHd.dom.firstChild;this.scroller=new E(this.mainWrap.dom.childNodes[1]);if(this.forceFit){this.scroller.setStyle("overflow-x","hidden")}this.mainBody=new E(this.scroller.dom.firstChild);this.focusEl=new E(this.scroller.dom.childNodes[1]);this.focusEl.swallowEvent("click",true);this.resizeMarker=new E(cs[1]);this.resizeProxy=new E(cs[2]);this.ds.on("beforeload",function(ds,options){var p=gw.getFilterParams();if(options.params==null){options.params={}}Ext.apply(options.params,{filter:p})});this.mainHd.select(".filter-input").each(function(el,cmp,idx){var field,cd;if(gp.cdata){cd=gp.cdata[gw.cm.config[idx].dataIndex]}if(cd&&cd.data){field=new Ext.tusc.FilterComboBox({store:new Ext.data.SimpleStore({fields:["name","code"],data:eval("gp.cdata."+gw.cm.config[idx].dataIndex+".data")}),displayField:"name",valueField:"code",mode:"local",triggerAction:"all"});field.on("select",function(field,record,idx){gw.doFilter()},this);field.onTrigger1Click=function(){this.clearValue();this.getTrigger(0).hide();gw.doFilter()}}else{field=new Ext.tusc.FilterTextField({emptyText:gw.cm.config[idx].filterEmptyText});field.on("specialkey",function(tfield,e){if(e.getKey()==Ext.EventObject.ENTER){gw.doFilter()}else{if(e.getKey()==Ext.EventObject.ESC){el.dom.value="";gw.doFilter()}}})}if(cd&&cd.filterDefault!==undefined){field.setValue(cd.filterDefault)}gw.filters.add(gw.getFColumnName(idx),field);field.render(el.dom);if(!el.isDisplayed()||!el.isVisible()||(typeof gw.cm.config[idx].filter=="undefined"||gw.cm.config[idx].filter==false)){field.hide()}})},cleanAllFilter:function(reloadList){this.filters.each(function(item,idx,length){item.setValue();if(item.getTrigger){item.getTrigger(0).hide()}});if(reloadList!==false){this.doFilter()}},cleanFilter:function(name){var item=this.filters.get(name);if(item!=null){item.onTriggerClick()}},getFilterParams:function(){var gw=this;var p="";this.filters.each(function(item,idx,length){var el=item.el;if(!Ext.isEmpty(el.dom.value)){if(el.dom.value!=gw.cm.config[idx].filterEmptyText){p+=this.getFColumnName(idx)+":"+this.convert(item)+";"}}},this);return p},getFColumnName:function(idx){var name=this.cm.getDataIndex(idx);return typeof name=="undefined"?this.ds.fields.get(idx).name:name},updateSortIcon:function(col,dir){var sc=this.sortClasses;var hds=this.mainHd.select("td.x-grid3-hd").removeClass(sc);hds.item(col).addClass(sc[dir=="DESC"?1:0])},updateColumnHidden:function(col,hidden){var tw=this.getTotalWidth();this.innerHd.firstChild.firstChild.style.width=tw;var display=hidden?"none":"";var hd=this.getHeaderCell(col);hd.style.display=display;var hds=this.getSecondHeaderCell(col);hds.style.display=display;var ns=this.getRows();for(var i=0,len=ns.length;i<len;i++){ns[i].style.width=tw;ns[i].firstChild.style.width=tw;ns[i].firstChild.rows[0].childNodes[col].style.display=display}this.onColumnHiddenUpdated(col,hidden,tw);delete this.lastViewWidth;this.layout()},getSecondHeaderCell:function(index){return this.mainHd.select("td.x-grid3-hd").item(index).dom},updateAllColumnWidths:function(){var tw=this.getTotalWidth();var clen=this.cm.getColumnCount();var ws=[];for(var i=0;i<clen;i++){ws[i]=this.getColumnWidth(i)}this.innerHd.firstChild.firstChild.style.width=tw;for(var i=0;i<clen;i++){var hd=this.getHeaderCell(i);hd.style.width=ws[i];var hds=this.getSecondHeaderCell(i);hds.style.width=ws[i]}var ns=this.getRows();for(var i=0,len=ns.length;i<len;i++){ns[i].style.width=tw;ns[i].firstChild.style.width=tw;var row=ns[i].firstChild.rows[0];for(var j=0;j<clen;j++){row.childNodes[j].style.width=ws[j]}}this.onAllColumnWidthsUpdated(ws,tw)},updateColumnWidth:function(col,width){var w=this.getColumnWidth(col);var tw=this.getTotalWidth();this.innerHd.firstChild.firstChild.style.width=tw;var hd=this.getHeaderCell(col);hd.style.width=w;var hds=this.getSecondHeaderCell(col);hds.style.width=w;var ns=this.getRows();for(var i=0,len=ns.length;i<len;i++){ns[i].style.width=tw;ns[i].firstChild.style.width=tw;ns[i].firstChild.rows[0].childNodes[col].style.width=w}this.onColumnWidthUpdated(col,w,tw)}};if(gp.viewConfig!=null){Ext.apply(viewConfig,gp.viewConfig)}Ext.apply(gp,{viewConfig:viewConfig})}});Ext.extend(Ext.grid.GridView.ColumnDragZone,Ext.grid.HeaderDragZone,{handleMouseDown:function(A){},callHandleMouseDown:function(A){}});Ext.tusc.FilterTextField=Ext.extend(Ext.form.TextField,{defaultAutoCreate:{tag:"input",type:"text",cls:"filter-input-field",style:"width:100%;margin:0px;",autocomplete:"off"},onRender:function(B,A){Ext.form.TextField.superclass.onRender.call(this,B,A)}});Ext.tusc.FilterComboBox=Ext.extend(Ext.form.ComboBox,{defaultAutoCreate:{tag:"input",type:"text",size:"24",style:"width:100%;margin:0px;",autocomplete:"off"},editable:false,hideTrigger1:true,trigger1Class:"x-form-clear-trigger",initComponent:function(){Ext.tusc.FilterComboBox.superclass.initComponent.call(this);this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",style:(Ext.isIE?"margin-bottom:1px;":"")+"height:100%;position:absolute;bottom:0px;right:0px;",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class,style:Ext.isIE?"":"height:auto;"},{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger2Class,style:Ext.isIE?"":"height:auto;"}]};this.on("select",function(){this.getTrigger(0).show()},this)},onRender:function(B,A){Ext.form.TriggerField.superclass.onRender.call(this,B,A);this.wrap=this.el.wrap({cls:"x-form-field-wrap",style:"position:relative;"});this.trigger=this.wrap.createChild(this.triggerConfig||{tag:"img",vspace:"1",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.triggerClass,style:(Ext.isIE?"":"height:auto;")+"position:absolute;bottom:0px;right:0px;"});if(this.hideTrigger){this.trigger.setDisplayed(false)}this.initTrigger();if(this.hiddenName){this.hiddenField=this.el.insertSibling({tag:"input",type:"hidden",name:this.hiddenName,id:(this.hiddenId||this.hiddenName)},"before",true);this.hiddenField.value=this.hiddenValue!==undefined?this.hiddenValue:this.value!==undefined?this.value:"";this.el.dom.removeAttribute("name")}if(Ext.isGecko){this.el.dom.setAttribute("autocomplete","off")}if(!this.lazyInit){this.initList()}else{this.on("focus",this.initList,this,{single:true})}if(!this.editable){this.editable=true;this.setEditable(false)}this.el.addClass("x-grid-filter-text")},getTrigger:function(A){return this.triggers[A]},initTrigger:function(){var A=this.trigger.select(".x-form-trigger",true);this.wrap.setStyle("overflow","hidden");var B=this;A.each(function(D,F,C){D.hide=function(){this.dom.style.display="none"};D.show=function(){this.dom.style.display=""};var E="Trigger"+(C+1);if(this["hide"+E]){D.dom.style.display="none"}D.on("click",this["on"+E+"Click"],this,{preventDefault:true});D.addClassOnOver("x-form-trigger-over");D.addClassOnClick("x-form-trigger-click")},this);this.triggers=A.elements},onTrigger2Click:function(){if(this.disabled){return }if(this.isExpanded()){this.collapse();this.el.focus()}else{this.onFocus({});if(this.triggerAction=="all"){this.doQuery(this.allQuery,true)}else{this.doQuery(this.getRawValue())}this.el.focus()}},onTrigger1Click:Ext.emptyFn});Artery.ListCollection=function(){var A=new Ext.util.MixedCollection();return{add:function(B,C){A.add(B,C)},resize:function(){A.each(function(C,B){if(C.autoHeight){C.gridElSize=C.getGridEl().getSize(true)}C.gridBody.setDisplayed(false)},this);A.each(function(C,B){C.onResize.defer(1,C)},this)}}}();Ext.EventManager.onWindowResize(function(){Artery.ListCollection.resize()},this);Ext.override(Ext.grid.GridView,{getEditorParent:function(){return document.body}});Artery.plugin.ListAreaView=Ext.extend(Ext.grid.GridView,{initTemplates:function(){var C=this.templates||{};if(!C.master){C.master=new Ext.Template('<div class="x-grid3" hidefocus="true">','<div class="x-grid3-viewport">','<div class="x-grid3-header"><div class="x-grid3-header-inner"><div class="x-grid3-header-offset">{header}</div></div><div class="x-clear"></div></div>','<div class="x-grid3-scroller"><div class="x-grid3-body">{body}</div><a href="#" class="x-grid3-focus" tabIndex="-1"></a></div>',"</div>",'<div class="x-grid3-resize-marker">&#160;</div>','<div class="x-grid3-resize-proxy">&#160;</div>',"</div>")}if(!C.header){C.header=new Ext.Template('<table border="0" cellspacing="0" cellpadding="0" style="{tstyle}">','<thead><tr class="x-grid3-hd-row">{cells}</tr></thead>',"</table>")}if(!C.hcell){C.hcell=new Ext.Template('<td class="x-grid3-hd x-grid3-cell x-grid3-td-{id} {css}" style="text-align:left;{style}"><div {tooltip} {attr} class="x-grid3-hd-inner x-grid3-hd-{id}" style="{istyle}">',this.grid.enableHdMenu?'<a class="x-grid3-hd-btn" href="#"></a>':"",'{value}<img class="x-grid3-sort-icon" src="',Ext.BLANK_IMAGE_URL,'" />',"</div></td>")}if(!C.body){C.body=new Ext.Template("{rows}")}if(!C.row){C.row=new Ext.Template('<div class="x-grid3-row {alt}" style="{tstyle}"><table class="x-grid3-row-table" border="0" cellspacing="0" cellpadding="0" style="{tstyle}">',"<tbody><tr>{cells}</tr>",(this.enableRowBody?'<tr class="x-grid3-row-body-tr" style="{bodyStyle}"><td colspan="{cols}" class="x-grid3-body-cell" tabIndex="0" hidefocus="on"><div class="x-grid3-row-body">{body}</div></td></tr>':""),"</tbody></table></div>")}if(!C.cell){C.cell=new Ext.Template('<td class="x-grid3-col x-grid3-cell x-grid3-td-{id} {css}" style="{style}" tabIndex="0" {cellAttr}>','<div class="x-grid3-cell-inner x-grid3-col-{id}" {attr}>{value}</div>',"</td>")}for(var A in C){var B=C[A];if(B&&typeof B.compile=="function"&&!B.compiled){B.disableFormats=true;B.compile()}}this.templates=C;this.tdClass="x-grid3-cell";this.cellSelector="td.x-grid3-cell";this.hdCls="x-grid3-hd";this.rowSelector="div.x-grid3-row";this.colRe=new RegExp("x-grid3-td-([^\\s]+)","")},doRender:function(cs,rs,ds,startRow,colCount,stripe){var ts=this.templates,ct=ts.cell,rt=ts.row,last=colCount-1;var tstyle="width:"+this.getTotalWidth()+";";var buf=[],cb,c,p={},rp={tstyle:tstyle},r;for(var j=0,len=rs.length;j<len;j++){r=rs[j];cb=[];var rowIndex=(j+startRow);for(var i=0;i<colCount;i++){c=cs[i];p.id=c.id;p.css=i==0?"x-grid3-cell-first ":(i==last?"x-grid3-cell-last ":"");p.attr=p.cellAttr="";if(this.grid.isSum){p.isSum=this.grid.isSum;p.isSumTop=this.grid.isSumTop}p.value=c.renderer(r.data[c.name],p,r,rowIndex,i,ds);p.style=c.style;if(p.value==undefined||p.value===""){p.value="&#160;"}if(r.dirty&&typeof r.modified[c.name]!=="undefined"){}cb[cb.length]=ct.apply(p)}var alt=[];if(stripe&&((rowIndex+1)%2==0)){alt[0]="x-grid3-row-alt"}if(r.dirty){alt[1]=" x-grid3-dirty-row"}rp.cols=colCount;if(this.getRowClass){alt[2]=this.getRowClass(r,rowIndex,rp,ds)}if(this.grid.isSum&&Ext.isTrue(this.grid.isSum)){if(Ext.isTrue(this.grid.isSumTop)&&j==0){alt.push("grid-title-fixed-top")}else{if(!Ext.isTrue(this.grid.isSumTop)&&j==len-1){alt.push("grid-title-fixed-bottom")}}}rp.alt=alt.join(" ");rp.cells=cb.join("");if(this.grid.tipTpl){var d={};var val;for(var i in r.data){val=r.data[i].value;if((typeof val)=="string"){val=val.replace(/(\r\n|\n)/g,"<br>")}eval("d."+i+"=val")}var tip=this.grid.tipTpl.apply(d);this.grid.setTip(rowIndex,tip)}buf[buf.length]=rt.apply(rp)}return buf.join("")},getColumnData:function(){var D=[],A=this.cm,E=A.getColumnCount();for(var C=0;C<E;C++){var B=A.getDataIndex(C);D[C]={name:(typeof B=="undefined"?this.ds.fields.get(C).name:B),renderer:A.getRenderer(C),id:A.getColumnId(C),style:this.getColumnStyle(C),columnStyle:this.getColumnStyle(C),grid:this.grid}}return D},onCellSelect:function(G,B){var D=this.grid.store.getAt(G);if(D==null){return }var F=this.grid.colModel.getDataIndex(B);if(F==null){return }var E=D.data[F];if(E==null){return }var C=E.opers;if(C==null||C.length==0){var A=this.getCell(G,B);if(A){this.fly(A).addClass("x-grid3-cell-selected");Ext.get(A).scrollIntoView(this.scroller)}}},layout:function(){if(!this.mainBody){return }var C=this.grid;C.gridBody.setDisplayed(false);var F=C.getGridEl();F.setStyle("width","");var A=F.getSize(true);if(C.gridElSize){A.height=C.gridElSize.height}A.width=A.width-1;A.height=A.height-1;var B=A.width;C.gridBody.setDisplayed(true);if(B<20||A.height<20){return }if(C.autoHeight){this.scroller.dom.style.overflow="visible"}else{var E=this.mainHd.getHeight();var D=A.height-(E);this.scroller.setSize(B,D);if(this.innerHd){this.innerHd.style.width=(B)+"px"}}if(this.forceFit){if(this.lastViewWidth!=B){this.fitColumns(false,false);this.lastViewWidth=B}}else{this.autoExpand();this.syncHeaderScroll()}this.onLayout(B,D)},focusRow:function(A){}});Ext.override(Ext.data.Record,{set:function(A,B){var D=this.data[A];if(typeof (D)=="object"){D=Ext.encode(D)}var C=B;if(typeof (C)=="object"){C=Ext.encode(C)}if(String(D)==String(C)){return }this.dirty=true;if(!this.modified){this.modified={}}if(typeof this.modified[A]=="undefined"){this.modified[A]=this.data[A]}this.data[A]=B;if(!this.editing&&this.store){this.store.afterEdit(this)}}});Artery.plugin.JsonReader=Ext.extend(Ext.data.JsonReader,{extractValues:function(G,D,A){var F,C={};for(var E=0;E<A;E++){F=D[E];var B=this.ef[E](G);C[F.name]=F.convert((B!==undefined)?B:F.defaultValue,G)}if(G.rowdbclick){C.rowdbclick=G.rowdbclick}if(G.rowdblinkto){C.rowdblinkto=G.rowdblinkto}if(G.rowclick){C.rowclick=G.rowclick}if(G.rowlinkto){C.rowlinkto=G.rowlinkto}return C}});Artery.plugin.ListAreaStore=Ext.extend(Ext.data.Store,{initData:null,load:function(C){if(this.initData!=null){var A=this.reader.readRecords(this.initData);this.loadRecords(A,C,true);this.initData=null;return true}C=C||{};if(this.fireEvent("beforeload",this,C)!==false){this.storeOptions(C);var D=Ext.apply(C.params||{},this.baseParams);if(this.sortInfo&&this.remoteSort){var B=this.paramNames;D[B.sort]=this.sortInfo.field;D[B.dir]=this.sortInfo.direction}this.proxy.doRequest("read",null,D,this.reader,this.loadRecords,this,C);return true}else{return false}},removeValuefromArray:function(D,C){var B=D;if(D&&D.length>0){B=[];for(var A=0;A<D.length;A++){if(D[A]!=C){B.push(D[A])}}}return B},removeCheckParamWhenDelete:function(A){for(var C in A.data){C=A.data[C];var B=Artery.get(this.gridId).cdata[C.id];if(B){if(B.checkbox||B.radio){Artery.get(this.gridId).cdata[C.id].cparam.params=this.removeValuefromArray(Artery.get(this.gridId).cdata[C.id].cparam.params,C.value);Artery.get(this.gridId).cdata[C.id].cparam.removeParams=this.removeValuefromArray(Artery.get(this.gridId).cdata[C.id].cparam.removeParams,C.value)}}}},remove:function(A){var B=this.data.indexOf(A);if(B>-1){this.data.removeAt(B);if(this.pruneModifiedRecords){this.modified.remove(A)}if(this.snapshot){this.snapshot.remove(A)}this.removeCheckParamWhenDelete(A);this.fireEvent("remove",this,A,B)}},sort:function(F,C){var D=this.fields.get(F);if(!D){return false}if(!C){if(this.sortInfo&&this.sortInfo.field==D.name){C=(this.sortToggle[D.name]||"ASC").toggle("ASC","DESC")}else{C=D.sortDir}}var B=(this.sortToggle)?this.sortToggle[D.name]:null;var A=(this.sortInfo)?this.sortInfo:null;this.sortToggle[D.name]=C;this.sortInfo={field:D.name,direction:C};if(!this.remoteSort){this.applySort();this.fireEvent("datachanged",this)}else{var E=this.lastOptions||{};if(this.pageCount!=0){if(!E.params){E.params={}}E.params.start=0;E.params.limit=this.pageCount}if(!this.load(E)){if(B){this.sortToggle[D.name]=B}if(A){this.sortInfo=A}}}}});Artery.plugin.ListAreaColumnModel=Ext.extend(Ext.grid.ColumnModel,{defaultType:"textfield",hasEditorEdit:function(){var B=this.config;for(var C=0,A=B.length;C<A;C++){var D=B[C];if(D.editor){if(D.editor.editing&&!D.editor.field.isValid()){return true}}}return false}});Artery.plugin.ListAreaColumn=function(A){Ext.apply(this,A);if(typeof this.renderer=="string"){this.renderer=Ext.util.Format[this.renderer]}else{if(Ext.isObject(this.renderer)){this.scope=this.renderer.scope;this.renderer=this.renderer.fn}}if(this.id===undefined){this.id=++Ext.grid.Column.AUTO_ID}if(this.editor){this.editor=Ext.create(this.editor,"textfield")}};Ext.extend(Artery.plugin.ListAreaColumn,Ext.grid.Column,{coltype:"arterycolumn",scope:this,getCellEditor:function(B){var A=this.getEditor(B);if(A){if(!A.startEdit){if(!A.gridEditor){A.gridEditor=new Artery.plugin.ListAreaGridEditor(A)}return A.gridEditor}else{if(A.startEdit){return A}}}return null}});Ext.grid.Column.types.arterycolumn=Artery.plugin.ListAreaColumn;Artery.plugin.ListAreaGridEditor=Ext.extend(Ext.grid.GridEditor,{updateEl:true,onRender:function(B,A){this.field.allowDomMove=true;Artery.plugin.ListAreaGridEditor.superclass.onRender.call(this,B,A);this.field.geditor=this},getValue:function(){if(this.field.getFormateValue){return this.field.getFormateValue()}return this.field.getValue()},onBlur:function(){if(this.allowBlur!==true&&this.editing){this.completeEdit()}},startEdit:function(el,value){var record=this.record;var grid=Artery.get(record.store.gridId);var colConf=grid.getColumnModel().getColumnById(value.id);if(colConf.beforeEditEvent){eval("var fn = function(){ return "+colConf.beforeEditEvent+"(record,value.value)\n}");if(!fn()){return }}if(this.editing){this.completeEdit()}this.boundEl=Ext.get(el);var v=value!==undefined?value:this.boundEl.dom.innerHTML;if(!this.rendered){this.render(this.parentEl||document.body)}if(this.fireEvent("beforestartedit",this,this.boundEl,v)===false){return }this.field.colitemid=null;this.field.initColVal=null;this.field.rowIdx=null;if(value&&value.id){this.colitemid=value.id;this.field.colitemid=value.id}if(value&&value.value){this.field.initColVal=value.value}if(value&&value.rowIdx){this.field.rowIdx=value.rowIdx}this.startValue=v.value;this.doAutoSize();this.el.alignTo(this.boundEl,this.alignment);this.editing=true;this.show();this.field.setValue(v.value);this.field.validate()},cancelEdit:function(A){if(this.editing){var B=this.getValue();this.setValue(this.startValue);this.hideEdit(A);this.field.clearInvalid();this.fireEvent("canceledit",this,B,this.startValue)}},completeEdit:function(remainVisible){if(!this.editing){return }var v=this.getValue();if(this.revertInvalid!==false&&!this.field.isValid()){v=this.startValue;this.cancelEdit(true)}if(String(v)===String(this.startValue)&&this.ignoreNoChange){this.editing=false;this.hide();return }var temp=v;v={};v.value=temp;if(this.field.valueText){v.valueText=this.field.getValueText()}else{v.valueText=null}if(this.fireEvent("beforecomplete",this,v.value,this.startValue)!==false){this.editing=false;if(this.updateEl&&this.boundEl){var sval=String(this.startValue).replace(/(\r\n|\n\r|\n|\r)/g,"*");var eval=String(v.value).replace(/(\r\n|\n\r|\n|\r)/g,"*");if(sval!=eval){var up=v.valueText==null?v.value:v.valueText;up=Ext.isEmpty(up)?"&nbsp;":Ext.HtmlEncode(up);var aTags=this.boundEl.dom.getElementsByTagName("a");if(aTags.length>0){aTags[0].innerHTML=up}else{this.boundEl.update(up)}}}if(remainVisible!==true){this.hide()}this.fireEvent("complete",this,v,this.startValue)}}});Ext.tusc.onClick=function(C,B){var A=Artery.get(C).getEventObj(B);if(A.eventName==null){A.eventName="onClickServer"}Ext.tusc.onClickCfg(A)};Ext.tusc.onClickCfg=function(cfg){if(cfg.rowIdx){Artery.listRowIdx=cfg.rowIdx}Artery.params.itemid=cfg.id;if(!Ext.isEmpty(cfg.onclick)){var rc=Artery.createCaller(cfg.id,cfg.eventName);var data=cfg;eval("var fn = function(){"+cfg.onclick+"\n}");fn()}if(!Ext.isEmpty(cfg.linkto)){var l=cfg.linkto;if(l.target=="_window"){Ext.getWindow(l)}else{Ext.getBlankWindow(l)}}};Artery.plugin.ListArea=Ext.extend(Ext.grid.EditorGridPanel,{forceFit:true,enableHdMenu:false,tip:"",initData:null,geditor:null,startEditColIdx:0,isEditor:false,clicksToEdit:1,rowClickEvent:null,showUpdate:true,disableResize:false,exportType:"stream",pagingbars:null,initComponent:function(){if(!this.isEditor){this.selModel=new Ext.grid.RowSelectionModel()}if(this.bodyStyle==null){this.bodyStyle="text-align:left;"}else{this.bodyStyle="text-align:left;"+this.bodyStyle}if(Ext.isArray(this.columns)){this.colModel=new Artery.plugin.ListAreaColumnModel(this.columns);delete this.columns}if(this.geditor==null){this.geditor=new Artery.plugin.ListAreaGEditor(this)}this.viewConfig={forceFit:this.forceFit};this.plugins=new Ext.tusc.plugins.FilterGrid({pageCount:parseInt(this.pageCount)});this.store=new Artery.plugin.ListAreaStore({initData:this.initData,proxy:new Ext.data.HttpProxy({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic"}),reader:new Artery.plugin.JsonReader(this.jreader),pageCount:parseInt(this.pageCount),autoLoad:false,remoteSort:true});this.initStoreDefaultSort();this.recordType=this.store.reader.recordType;this.store.proxy.on("loadexception",function(C,B,A){Artery.showSysError(Ext.decode(A.responseText))});this.clickEventMap=new Ext.util.MixedCollection();this.store.on("beforeload",this.onDataBeforeLoad,this);this.store.on("load",this.onDataLoad,this);if(this.pagingbars){this.store.on("load",this.refreshPagingbars,this)}this.store.on("beforeload",function(B,D){var C=this.getColumnModel().config;var A;for(var E=0,A=C.length;E<A;E++){if(Ext.isTrue(C[E].colHidden)){this.getColumnModel().setHidden(E,true)}}if(D.params==null){D.params={}}this.setColumnConf(D.params)},this,{single:true});if(this.bbar){this.bbar.store=this.store}Artery.plugin.ListArea.superclass.initComponent.call(this);this.on("rowdblclick",this.onRowdblClick,this);this.on("rowclick",this.onRowClick,this);if(!Ext.isEmpty(this.tip)){this.tipTpl=new Ext.XTemplate(this.tip);this.tipTpl.compile();this.rowTips=new Ext.util.MixedCollection();this.on("mouseover",function(C,A){var D;if((D=this.view.findRowIndex(A))!==false){var B=Artery.getTipPanel({key:"listTip"});B.update(this.getTip(D));B.showAt(C.getXY())}},this)}},initStoreDefaultSort:function(){var A=this.store.reader.meta.fields;for(var B=0;B<A.length;B++){var C=A[B];if(C.isOrderBy&&C.showOrderIcon){this.store.setDefaultSort(C.name,C.sortDir);return }}},refreshPagingbars:function(G,I,B){if(this.pagingbars==null){return }var A=this.store.paramNames;var H=parseInt((B.params&&B.params[A.start])?B.params[A.start]:0);var C=parseInt((B.params&&B.params[A.limit])?B.params[A.limit]:0);var E=1;if(C!=0){E=Math.floor((H+C)/C)}var F=this.store.getTotalCount();for(var D=0;D<this.pagingbars.length;D++){Artery.get(this.pagingbars[D]).refresh({rowCount:F,currPageNo:E})}},onDataLoad:function(B,A,C){if(this.clearStatus){this.clearDataStatus(false)}if(B.reader.jsonData.customData){C.params.customData=Ext.decode(B.reader.jsonData.customData)}if(B.reader.jsonData.keys){this.getGEditor().setKeys(B.reader.jsonData.keys)}if(B.reader.jsonData.defValues){this.getGEditor().setDefValues(B.reader.jsonData.defValues)}this.getGEditor().clearTransData();if(B.reader.jsonData.rowClickEvent){this.rowClickEvent=B.reader.jsonData.rowClickEvent}Ext.select(".x-checkbox-hd-checked",false,this.el.dom).each(function(D){D.removeClass("x-checkbox-hd-checked");D.addClass("x-checkbox-hd-unchecked")});if(B.reader.jsonData.totalCount){B.totalCount=B.reader.jsonData.totalCount}if(B.reader.jsonData.currPageNo){B.currPageNo=B.reader.jsonData.currPageNo}if(B.reader.jsonData.rowsPerPage){B.rowsPerPage=B.reader.jsonData.rowsPerPage}B.gridId=this.id;if(this.onLoadEvent){Artery.regItemEvent(this,"onLoadEvent",null,{store:B,records:A,options:C})}this.store.loadding=false},onDataBeforeLoad:function(A,B){this.clickEventMap.clear();if(this.store.loadding){return false}this.store.loadding=true;if(B.params==null){B.params={}}B.params.custParams=Ext.encode(this.custParams);Artery.applyIf(B.params,Artery.getParams({method:"parseListData"},this));if(this.clearStatus){this.clearDataStatus(false)}},onRowdblClick:function(D,E,G){var C=this.findRowRecord();var A=C.get("rowdbclick");var F=C.get("rowdblinkto");if(!Ext.isEmpty(A)||!Ext.isEmpty(F)){var B={id:this.id,rowIdx:E,onclick:A,linkto:F,eventName:"onClickDoubleServer"};Ext.tusc.onClickCfg(B)}},onRowClick:function(D,E,G){var B=this.findRowRecord();if(B==null){return }var F=B.get("rowclick");var C=B.get("rowlinkto");if(!Ext.isEmpty(F)||!Ext.isEmpty(C)){var A={id:this.id,rowIdx:E,onclick:F,linkto:C,eventName:"onClickSingleServer"};Ext.tusc.onClickCfg(A)}},addEventObj:function(A){var B=Ext.id();this.clickEventMap.add(B,A);return B},getEventObj:function(A){return this.clickEventMap.get(A)},onRender:function(E,A){Artery.plugin.BasePanel.prototype.onRender.call(this,E,A);var H=this.body;this.el.addClass("x-grid-panel");var B=this.getView();B.init(this);H.on("mousedown",this.onMouseDown,this);H.on("click",this.onClick,this);H.on("dblclick",this.onDblClick,this);H.on("contextmenu",this.onContextMenu,this);H.on("keydown",this.onKeyDown,this);this.relayEvents(H,["mousedown","mouseup","mouseover","mouseout","keypress"]);this.getSelectionModel().init(this);this.view.render();this.gridBody=this.getGridEl().child("div.x-grid3");Artery.ListCollection.add(this.id,this);var G=this;if(this.scrollPid){var F=this.scrollPid.split(";");for(var D=0;D<F.length;D++){scrollid=F[D];var C=Ext.get(scrollid);if(C&&C.parent()){Ext.get(C.parent().dom.id).on("scroll",function(){var I=G.getGEditor();for(p in I.defValues){var J=p+"Editor";if(Ext.get(J)){G.fireEvent("bodyscroll",0,0)}}})}}}},afterRender:function(){Artery.plugin.ListArea.superclass.afterRender.call(this);if(this.hidden){this.on("show",function(){this.store.load({params:{start:0,limit:this.pageCount}})},this,{single:true})}else{this.store.load({params:{start:0,limit:this.pageCount}})}var list=this;Ext.select(".x-checkbox-hd-unchecked",false,this.el.dom).each(function(item){item.on("click",function(){var cn=this.dom.colName;var ck=null;if(this.hasClass("x-checkbox-hd-unchecked")){this.removeClass("x-checkbox-hd-unchecked");this.addClass("x-checkbox-hd-checked");list.selectAllCheckbox(cn);ck=true}else{this.removeClass("x-checkbox-hd-checked");this.addClass("x-checkbox-hd-unchecked");list.deselectAllCheckbox(cn);ck=false}var he=null;var c=list.colModel.config;for(var i=0,len=c.length;i<len;i++){if(c[i].dataIndex==cn){he=c[i].onHeadSelectEvent;break}}if(he){var rc=Artery.createCaller(cn,"onHeadSelectServer");rc.sync=true;eval("var fn = function(checked){"+he+"\n}");fn.call(list,ck)}})});var cfg=this.colModel.config;var l=cfg.length;for(var i=0;i<l;i++){if(Ext.isTrue(cfg[i].isFix)){this.el.addClass("x-grid-fixed")}}if(!this.disableResize){this.el.on("resize",function(){this.doLayout()},this)}},getView:function(){if(!this.view){this.view=new Artery.plugin.ListAreaView(this.viewConfig)}if(this.autoHeight){this.view.scrollOffset=0}return this.view},getTip:function(A){return this.rowTips.get(A+"tip")},setTip:function(B,A){this.rowTips.add(B+"tip",A)},doLayout:function(A){Artery.plugin.ListArea.superclass.doLayout.call(this,A);if(this.rendered){this.onResize.call(this)}},exportExcel:function(C,B){var A=sys.getContextPath()+"/artery/form/dealParse.do";var D=Artery.getParams({},this);if(this.store.lastOptions&&this.store.lastOptions.params){Ext.apply(D,this.store.lastOptions.params)}Ext.tusc.encodeParam(D);Ext.apply(D,{itemid:this.id,formid:Artery.getFormId(this),method:"exportExcel",action:"runItemLogic",exportType:this.exportType});if(C==true){D.exportAll="true"}this.setColumnConf(D);if(!Ext.isEmpty(B)){D.exportName=B}else{D.exportName=this.exportName}D.isAjax=false;D.exportName=Artery.escape(D.exportName);A=A+"?"+Ext.urlEncode(D);if(A.length>1000){cfg={};delete D.action;cfg.params=D;cfg.url="/artery/form/dealParse.do?action=runItemLogic";if(this.exportNewPage){cfg.expName="newWindow"}Artery.autoSubmitForm(window,cfg)}else{if(this.exportNewPage){window.open(A)}else{window.location=A}}},exportPdf:function(C,B){var A=sys.getContextPath()+"/artery/form/dealParse.do";var D=Artery.getParams({},this);if(this.store.lastOptions&&this.store.lastOptions.params){Ext.apply(D,this.store.lastOptions.params)}Ext.tusc.encodeParam(D);Ext.apply(D,{itemid:this.id,formid:Artery.getFormId(this),method:"exportPdf",action:"runItemLogic",exportType:this.exportType});if(C==true){D.exportAll="true"}this.setColumnConf(D);if(!Ext.isEmpty(B)){D.exportName=B}else{D.exportName=this.exportName}D.isAjax=false;if(Ext.isEmpty(this.exportType)||this.exportType=="stream"){D.exportName=Artery.escape(D.exportName);A=A+"?"+Ext.urlEncode(D);if(A.length>1000){cfg={};delete D.action;cfg.params=D;cfg.url="/artery/form/dealParse.do?action=runItemLogic";if(this.exportNewPage){cfg.expName="newWindow"}Artery.autoSubmitForm(window,cfg)}else{if(this.exportNewPage){window.open(A)}else{window.location=A}}}else{this.container.mask("正在导出数据...");Artery.request({url:A,success:function(E,F){this.container.unmask();var G=Ext.decode(E.responseText);if(G.tempFile){window.location=A+"?action=download&nameencrypt=1&file="+G.tempFile+"&random="+Math.random()}else{alert("导出文件失败")}},params:D,scope:this})}},setColumnConf:function(E){var C=this.colModel.config;var A={};for(var B=0;B<C.length;B++){if(C[B].dataIndex){var D=C[B].dataIndex;A[D]=C[B].colHidden}}E.columnConf=Ext.encode(A)},reload:function(A){if(!this.rendered){return }var B={};if(A){B=Ext.decode(Ext.encode(A));if(A.callback){B.callback=A.callback}}if(B.clearStatus!==false){this.clearDataStatus(false)}if(B.clearFilter){this.view.cleanAllFilter(false)}if(Ext.isTrue(this.isPageSplit)&&B!=null){if(B.params==null){B.params={}}if(B.params.start!==undefined){B.params.start=parseInt(B.params.start)}if(B.params.limit!==undefined){B.params.limit=parseInt(B.params.limit)}Artery.applyIf(B.params,{start:this.getBottomToolbar().cursor,limit:this.getBottomToolbar().pageSize})}if(!B.clearParam&&this.store.lastOptions){Artery.applyIf(B.params,this.store.lastOptions.params)}this.store.reload(B)},getValue:function(B){var A=this.findRowRecordByDataIdx(Artery.listRowIdx);if(A){if(A.data[B]==null){Artery.showError("找不到指定的列名称："+B);return""}return A.data[B].value}return""},hasColumn:function(C){var B=this.colModel.config;for(var A=0;A<B.length;A++){if(B[A].dataIndex==C){return true}}return false},getRowJson:function(){var A=this.findRowRecordByDataIdx(Artery.listRowIdx);if(A){return this._getRowValue(A)}return""},getRowValue:function(){var A=this.getRowJson();if(A!=""){return Ext.encode(A)}return""},getValueText:function(D,F){var C=this.cdata;var A=C[D];if(!A){return F+""}if(A.data){var E=A.data;for(var B=0;B<E.length;B++){var G=E[B];if(G&&G.length==2){if(G[1]==F){return G[0]}}}}return F+""},setValue:function(B,C){var A=this.findRowRecordByDataIdx(Artery.listRowIdx);if(A){this.setRecordValue(A,B,{value:C+""})}},setRecordValue:function(B,D,A){if(B){if(B.get(D)==null){Artery.showError("找不到指定的列名称："+D);return }var F=Ext.decode(Ext.encode(B.get(D)));Ext.apply(F,A);B.set.defer(100,B,[D,F]);var G={};G[F.id]=F.value;var E=this.store.indexOf(B);var C=this.colModel.getIndexById(D);if(E>-1&&C>-1){this.getGEditor().put(F.rowIdx,G,[E,C])}else{this.getGEditor().put(F.rowIdx,G)}this.getGEditor().refreshChangedCells.defer(200,this.getGEditor())}},getValues:function(A){return this.getValuesArray(A).toString()},getValuesArray:function(D){var F=this.cdata[D];if(F==null){Artery.showError("找不到指定的列名称："+D);return[]}if(F.checkbox||F.radio){return this.cdata[D].cparam.params}else{var B=[];var E;var A=this.store.getRange();for(var C=0;C<A.length;C++){E=A[C].data[D];if(E==null){Artery.showError("列:"+D+"不存在！");return false}else{if(typeof E.value=="string"){B.push(E.value.trim())}else{B.push(E.value)}}}return B}},getDeselectValues:function(A){var B=this.cdata[A];if(B==null){Artery.showError("找不到指定的列名称："+A);return""}if(B.checkbox||B.radio){return this.cdata[A].cparam.removeParams.toString()}return""},getDeselectValuesQuote:function(C){var A=this.getDeselectValues(C);if(A==null||A==""){return A}var E=A.split(",");var D=[];for(var B=0;B<E.length;B++){D.push("'"+E[B]+"'")}return D.join(",")},getValuesQuote:function(C){var A=this.getValues(C);if(A==null||A==""){return A}var E=A.split(",");var D=[];for(var B=0;B<E.length;B++){D.push("'"+E[B]+"'")}return D.join(",")},getSelectedCellValue:function(){var A=this.getSelectionModel().getSelectedCell();if(A==null){return""}var B=this.store.getAt(A[0]);var C=this.colModel.getDataIndex(A[1]);var D=B.data[C];return D.value},getSelectedRowValue:function(){var A=this.getSelectedRowJson();if(A==null||A==""){return""}return Ext.encode(A)},getSelectedRowJson:function(){var A=this.findRowRecord();if(A==null){return""}return this._getRowValue(A)},_getRowValue:function(A){var C={};for(var B in A.data){if(A.data[B].id){if(A.data[B].valueText){C[A.data[B].id]={value:A.data[B].value,valueText:A.data[B].valueText}}else{C[A.data[B].id]=A.data[B].value}}}return C},getCheckedRowValue:function(A){var B=this.getCheckedRowJson(A);if(Ext.isEmpty(B)){return B}return Ext.encode(B)},getCheckedRowJson:function(D){var F=this.cdata[D];if(F==null){return undefined}if(F.checkbox||F.radio){var A=this.cdata[D].cparam.params;if(A==null||A.length==0){return""}var E={};for(var C=0;C<A.length;C++){E["key"+A[C]]=true}var B=[];this.store.each(function(G){if(E["key"+G.get(D).value]){B.push(this._getRowValue(G))}},this);return B}return undefined},changeCheck:function(E,C,B){var G=this.cdata[E];if(G==null||Ext.isEmpty(C)){return undefined}var F=[];if(!Ext.isArray(C)){F[C]=true}else{for(var D=0;D<C.length;D++){F[C[D]]=true}}var A=Ext.query("[ci="+E+"-check-item]",this.el.dom);var H=function(I){if(I.type=="radio"){return I.checked}else{return Ext.fly(I).hasClass("x-checkbox-checked")}};if(G.checkbox||G.radio){this.store.each(function(J,I){if(F[J.get(E).value]){var K=A[I];if(!H(K)){if(B){K.click()}}else{if(!B){K.click()}}}},this)}},getAllValues:function(){return Ext.encode(this.getAllValuesJson())},getAllValuesJson:function(){var A=[];this.store.each(function(B){A.push(this._getRowValue(B))},this);return A},clearDataStatus:function(C){for(var A in this.cdata){if(this.cdata[A]&&this.cdata[A].cparam){this.cdata[A].cparam.cleanParams();var D=this.colModel.findColumnIndex(A);var B=this.colModel.getColumnAt(D);if(B!=null&&B.coltype=="checkbox"&&C!==false){this.deselectAllCheckbox(A)}}}},sureHeadCheckboxStatus:function(C){var D=null;if(this.showTitle){Ext.select(".x-checkbox-hd-unchecked",false,this.el.dom).each(function(F){if(F.dom.colName==C){D=F.dom}});Ext.select(".x-checkbox-hd-checked",false,this.el.dom).each(function(F){if(F.dom.colName==C){D=F.dom}})}if(!D){return }var E=Ext.query("span[ci="+C+"-check-item]");var B=0;for(var A=0;A<E.length;A++){if(E[A].className=="x-checkbox-checked"){B++}}if(E.length!=0){if(E.length==B){D.className="x-checkbox-hd-checked"}else{D.className="x-checkbox-hd-unchecked"}}},getGEditor:function(){return this.geditor},onEditComplete:function(ed,v,startValue){this.editing=false;this.activeEditor=null;ed.un("specialkey",this.selModel.onEditorKey,this.selModel);var r=ed.record;var field=this.colModel.getDataIndex(ed.col);v.value=this.postEditValue(v.value,startValue,r,field);var sval=String(startValue).replace(/(\r\n|\n\r|\n|\r)/g,"*");var eval=String(v.value).replace(/(\r\n|\n\r|\n|\r)/g,"*");if(sval!==eval){var data=r.data[field];data.value=v.value;if(v.valueText){data.valueText=v.valueText}var e={grid:this,record:r,field:field,originalValue:startValue,value:data,row:ed.row,column:ed.col,cancel:false};if(this.fireEvent("validateedit",e)!==false&&!e.cancel){r.set(field,e.value);delete e.cancel;this.fireEvent("afteredit",e)}var o={};o[data.id]=data.value;this.getGEditor().put(data.rowIdx,o,[ed.row,ed.col])}},submit:function(A,E,D){if(this.colModel.hasEditorEdit()){return }if(!this.getGEditor().hasTransValues()){return }var F=this.getGEditor().getTransData();if(E){Ext.apply(F,E)}var B=F.insert!=null||F["delete"]!=null;var C=Ext.encode(F);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",scope:this,params:Artery.getParams({buttonItemid:Artery.params.itemid,data:C,method:"parseSubmit"},this),success:function(H,I){var G=H.responseText;if(!Ext.isEmpty(G)){G=Ext.decode(G)}if(!Ext.isEmpty(G)&&G.success==false){Artery.showError("出错啦，请检查！<br>"+G.error)}else{if(A!=null&&typeof A=="function"){if(B){if(D==undefined||D){this.reload();this.getGEditor().updateCells={}}}else{this.getGEditor().clearUpdateCells()}A.call(this,G)}}}})},insertRecord:function(B){if(B&&B.length){for(var A=0;A<B.length;A++){this._insertRecord(B[A])}}else{this._insertRecord(B)}if(Artery.get(this.id+"_pagingBar")){Artery.get(this.id+"_pagingBar").updatePageNumber(1)}},_insertRecord:function(G){var F=this.getGEditor().getDefValues();if(G){for(var B in G){if(F[B]){if(typeof (G[B])!="object"){F[B].value=G[B]}else{Ext.apply(F[B],G[B])}}}}if(this.isCheckEmpty){var A=this.colModel.config;for(var B=0;B<A.length;B++){var C=A[B];if(C.editor&&!C.editor.allowBlank){if(Ext.isEmpty(F[C.dataIndex].value)){Artery.alertMsg("提示",'"'+C.header+'"列不能为空！');return }}}}this.initInsRowIdx(F);var E=new this.recordType(F);this.stopEditing();var D=this.store.getCount();this.store.insert(D,E);if(Ext.isTrue(this.isAutoEditor)){this.startEditing(D,this.startEditColIdx)}this.getGEditor().insertData(E.data)},initInsRowIdx:function(C){var B=this.store.getCount();for(var A in C){if(C[A].rowIdx==null){C[A].rowIdx="insRowIdx"+B}}},deleteRecord:function(){if(this.editing){this.stopEditing(true)}var A=this.findRowIdx();if(A==null){return }if(A.indexOf("insRowIdx")!=-1){this.getGEditor().deleteInsertData(A)}else{this.getGEditor().putDelete(A)}this.store.remove(this.findRowRecord());if(Artery.get(this.id+"_pagingBar")){Artery.get(this.id+"_pagingBar").updatePageNumber(-1)}},findRowIdx:function(){var A=this.findRowRecord();if(A==null){return null}var B=this._findDataRowIdx(A);return B},_findDataRowIdx:function(A){for(var B in A.data){if(A.data[B].rowIdx){return A.data[B].rowIdx}}},findRowRecord:function(){if(this.isEditor){var A=this.getSelectionModel().getSelectedCell();if(A==null){return null}var B=this.store.getAt(A[0]);return B}else{return this.getSelectionModel().getSelected()}},findRowRecordByDataIdx:function(B){var A=null;this.store.each(function(C){for(var D in C.data){if(C.data[D].rowIdx!=null&&C.data[D].rowIdx==B){A=C;return false}}},this);return A},selectAllCheckbox:function(E){var A=Ext.select(".x-checkbox-hd-unchecked",this.el);if(A.elements.length>0&&A.elements[0].getAttribute("colName")==E){A.removeClass("x-checkbox-hd-unchecked");A.addClass("x-checkbox-hd-checked")}var C=Ext.query("span[ci="+E+"-check-item]");var B=C.length;for(var D=0;D<B;D++){if(C[D].className=="x-checkbox-unchecked"&&!C[D].disabled){C[D].className="x-checkbox-checked";this.dealCheckbox(C[D])}}},deselectAllCheckbox:function(E){var A=Ext.select(".x-checkbox-hd-checked",this.el);if(A.elements.length>0&&A.elements[0].getAttribute("colName")==E){A.removeClass("x-checkbox-hd-checked");A.addClass("x-checkbox-hd-unchecked")}var C=Ext.query("span[ci="+E+"-check-item]");var B=C.length;for(var D=0;D<B;D++){if(C[D].className=="x-checkbox-checked"){C[D].className="x-checkbox-unchecked";this.dealCheckbox(C[D])}}},dealCheckbox:function(A){var D=Ext.decode(A.gridparams);var B=(A.className=="x-checkbox-checked");var C=Ext.getCmp(D.id).cdata[D.name];if(B){C.cparam.addParam(D.param)}else{C.cparam.removeParam(D.param)}C.value=C.cparam.getParams();C.removeValue=C.cparam.getRemoveParams()}});Ext.reg("aplistarea",Artery.plugin.ListArea);Artery.plugin.ListAreaGEditor=function(A){this.grid=A;this.keys=null;this.hasTrans=false;this.transData={};this.defValues=null;this.updateCells={}};Ext.override(Artery.plugin.ListAreaGEditor,{hasKeys:function(){return this.keys!=null},setKeys:function(A){this.keys=A},put:function(C,B,A){if(C.indexOf("insRowIdx")!=-1){this.putInsert(C,B)}else{this.putUpdate(C,B);if(this.grid.showUpdate&&A){this.putUpdateCells(A)}}},putUpdate:function(C,B){if(!this.hasKeys()){return }if(this.transData.update==null){this.transData.update={rows:{}}}var D=this.transData.update.rows[C];if(D==null){D=this.transData.update.rows[C]={values:{}};var A=this.keys[C];if(A!=null){D.keys={};Ext.apply(D.keys,A)}}Ext.apply(D.values,B);this.hasTrans=true},putUpdateCells:function(A){var B=A.join("sep");var C=this.grid.view.getCell(A[0],A[1]).firstChild;var D=C.innerText;var E="<span style='color:red'>"+D+"</span>";if(C.getElementsByTagName("a").length>0){C.getElementsByTagName("a")[0].innerHTML=E}else{C.innerHTML=E}this.updateCells[B]={idx:A,value:D}},clearUpdateCells:function(){for(var A in this.updateCells){var C=this.updateCells[A];var B=this.grid.view.getCell(C.idx[0],C.idx[1]).firstChild;if(B.getElementsByTagName("a").length>0){B.getElementsByTagName("a")[0].innerHTML=C.value}else{B.innerHTML=C.value}}this.updateCells={}},refreshChangedCells:function(){for(var A in this.updateCells){var E=this.updateCells[A];var B=this.grid.view.getCell(E.idx[0],E.idx[1]).firstChild;var C=B.innerText;var D="<span style='color:red'>"+C+"</span>";if(B.getElementsByTagName("a").length>0){B.getElementsByTagName("a")[0].innerHTML=D}else{B.innerHTML=D}}},putInsert:function(B,A){var C=this.transData.insert.rows[B];Ext.apply(C.values,A);this.hasTrans=true},hasTransValues:function(){return this.hasTrans},getTransData:function(){return this.transData},clearTransData:function(){this.transData={};this.hasTrans=false},setDefValues:function(A){this.defValues=A},getDefValues:function(){var A=Ext.encode(this.defValues);return Ext.decode(A)},insertData:function(D){if(this.transData.insert==null){this.transData.insert={rows:{}}}var B=null;var C={};for(var A in D){if(B==null&&D[A].rowIdx){B=D[A].rowIdx}C[A]=D[A].value}if(B==null){Artery.showError("rowIdx为null!");return }this.transData.insert.rows[B]={values:C};this.hasTrans=true},deleteInsertData:function(A){this.transData.insert.rows[A]=null;this.deleteTransData()},deleteTransData:function(){if(this.transData.insert){var C=this.transData.insert.rows;var A=true;for(var B in C){if(C[B]!=null){A=false}}if(A){delete this.transData.insert}}},putDelete:function(A){if(!this.hasKeys()){return }if(this.transData["delete"]==null){this.transData["delete"]={rows:{}}}this.transData["delete"].rows[A]={keys:this.keys[A]};this.hasTrans=true}});Artery.plugin.ListAreaRowNumberer=function(A){Ext.apply(this,A);this.dataIndex=this.startnew;if(this.rowspan){this.renderer=this.renderer.createDelegate(this)}};Artery.plugin.ListAreaRowNumberer.prototype={header:"",width:23,sortable:false,startnew:true,isColumn:true,fixed:true,menuDisabled:true,dataIndex:"",id:"numberer",rowspan:undefined,renderer:function(D,E,B,G,F,C){if(this.rowspan){E.cellAttr='rowspan="'+this.rowspan+'"'}var A=0;if(!Ext.isTrue(this.name)&&C.lastOptions!=null){A+=Ext.num(C.lastOptions.params.start,0)}if(G==0){this.initStyle=this.style||""}this.style=this.initStyle+";position:relative;left:expression(this.offsetParent.scrollLeft);border-right:0px solid red;";if(Ext.isTrue(E.isSum)){if(Ext.isTrue(E.isSumTop)){if(G==0){this.style=this.initStyle+";position:relative;left:expression(this.offsetParent.offsetParent.scrollLeft);";return""}else{return A+=G}}else{if(!Ext.isTrue(E.isSumTop)){if(G==C.getCount()-1){this.style=this.initStyle+";position:relative;left:expression(this.offsetParent.offsetParent.scrollLeft);";return""}else{return A+=G+1}}}}return A+=G+1}};Ext.getCheckbox=function(B){var A="";var D="";if(B.disable){A=" disabled=true ";D="filter:progid:DXImageTransform.Microsoft.Alpha(opacity=50);"}var C="x-checkbox-unchecked";if(B.checked==true||B.checked=="true"){C="x-checkbox-checked"}var E="<span {0} style='width:16px;height:16px;{1}' ci='"+B.params.name+"-check-item' class='{2}' gridparams='{3}' onclick='Ext.tusc.checkboxClick(this);'></span> ";return String.format(E,A,D,C,Ext.encode(B.params))};Ext.getRadio=function(C){var B="";if(C.disable){B=" disabled=true "}var A="";if(C.checked==true||C.checked=="true"){A="checked"}var D="<input type='radio' {0} name='pradio'  ci='"+C.params.name+"-check-item'  {1} onclick='this.checked=true;Ext.tusc.radioClick({2});'> ";return String.format(D,B,A,Ext.encode(C.params))};Ext.tusc.operTextTpl=new Ext.XTemplate('<span class="x-oper-link" title="{tip}"><a onmouseover="if(this.clickflag == null){this.style.color=\'red\'}" onmouseout="if(this.clickflag == null){this.style.color=\'#587fa7\'}" onclick=\'this.style.color="#A0522D";this.clickflag=true;{onclick}\'>{text}</a></span>');Ext.tusc.operImgTpl=new Ext.XTemplate('<span class="x-oper-link" title="{tip}"><a onclick=\'{onclick}\'><img align=middle src="{imgurl}"></a></span>');Ext.tusc.DataRender=function(F,H,G,A,E,I){var D=this.grid.getColumnModel().getColumnById(F.id);if(this.grid.cdata[this.name].onRenderEvent){this.grid.cdata[this.name].onRenderEvent.call(this,F,H,G,A,E,I)}var B=F.valueText!=null?F.valueText:(F.value==null?"":F.value);if(D.htmlEncode){B=Ext.HtmlEncode(B)}if(F.foreColor!=null){B=String.format("<span style='color:{0}'>{1}</span>",F.foreColor,B)}this.style="vertical-align:middle;";if(F.backColor!=null){this.style+="background-color:"+F.backColor+";"}else{this.style="vertical-align:middle;"}this.style+="text-align:"+D.contentAlign+";";this.style+=this.columnStyle;if(F.hintText!==undefined){B='<div title="'+F.hintText.replace(/"/g,"&quot;")+'">'+B+"</div>"}if(Ext.isTrue(D.isFix)){H.css+=" x-grid-cell-fix "}if(F.editor&&this.grid.startEditColIdx==0){this.grid.startEditColIdx=E}if(Ext.isTrue(D.autoRowHeight)){H.attr='style="white-space:normal;word-break:break-all;"'}if(F.sumCell==true){if(F.backColor==null){this.style+="background-color:#fff;"}if(Ext.isTrue(D.isFix)){this.style+="left:expression(this.offsetParent.offsetParent.scrollLeft);"}if(F.foreColor==null){B="<span style='font-weight:900;'>"+B+"</span>"}return B}if(!Ext.isEmpty(F.onclick)||!Ext.isEmpty(F.linkto)||!Ext.isEmpty(F.onCellClick)){var J=this.grid.addEventObj(F);var C={onclick:'Ext.tusc.onClick("'+this.grid.id+'","'+J+'")',text:B};B=Ext.tusc.operTextTpl.applyTemplate(C)}return Ext.tusc.getOpers(F,this.grid)+B};Ext.tusc.CheckboxRender=function(data,metadata,record,rowIdx,colIdx,store){var colConf=this.grid.getColumnModel().getColumnById(data.id);var cparam=eval("this.grid.cdata."+this.name+".cparam");if(data.checked){cparam.addParam(data.value)}if(cparam.containParam(data.value)){data.checked=true}this.style="vertical-align:middle;";if(data.backColor!=null){this.style+="background-color:"+data.backColor+";"}else{this.style="vertical-align:middle;"}this.style+="text-align:"+colConf.contentAlign+";";this.style+=this.columnStyle;if(Ext.isTrue(colConf.isFix)){metadata.css+=" x-grid-cell-fix "}if(Ext.isTrue(this.grid.autoRowHeight)){metadata.attr='style="white-space:normal;word-break:break-all;"'}if(data.sumCell==true){if(data.foreColor==null){return"<span style='font-weight:900;'>"+data.value+"</span>"}if(Ext.isTrue(colConf.isFix)){this.style+="left:expression(this.offsetParent.offsetParent.scrollLeft);"}return data.value}var eventid=null;if(!Ext.isEmpty(data.onclick)||!Ext.isEmpty(data.linkto)){eventid=this.grid.addEventObj(data)}return Ext.tusc.getOpers(data,this.grid)+Ext.getCheckbox({disable:data.disable,checked:data.checked,params:{param:data.value,id:this.grid.id,name:this.name,eventid:eventid}})};Ext.tusc.checkboxClick=function(A){if(A.className=="x-checkbox-checked"){A.className="x-checkbox-unchecked"}else{A.className="x-checkbox-checked"}var B=Ext.decode(A.gridparams);var C=Ext.getCmp(B.id);C.dealCheckbox(A);C.sureHeadCheckboxStatus(B.name);if(B.eventid){Ext.tusc.onClick(B.id,B.eventid)}};Ext.tusc.RadioRender=function(data,metadata,record,rowIdx,colIdx,store){var colConf=this.grid.getColumnModel().getColumnById(data.id);var cparam=eval("this.grid.cdata."+this.name+".cparam");if(data.checked){cparam.cleanParams();cparam.addParam(data.value)}if(cparam.containParam(data.value)&&!Ext.isEmpty(data.value)){data.checked=true}this.style="vertical-align:middle;";if(data.backColor!=null){this.style+="background-color:"+data.backColor+";"}else{this.style="vertical-align:middle;"}this.style+="text-align:"+colConf.contentAlign+";";this.style+=this.columnStyle;if(Ext.isTrue(colConf.isFix)){metadata.css+=" x-grid-cell-fix "}if(Ext.isTrue(this.grid.autoRowHeight)){metadata.attr='style="white-space:normal;word-break:break-all;"'}if(data.sumCell==true){if(data.foreColor==null){return"<span style='font-weight:900;'>"+data.value+"</span>"}if(Ext.isTrue(colConf.isFix)){this.style+="left:expression(this.offsetParent.offsetParent.scrollLeft);"}return data.value}var eventid=null;if(!Ext.isEmpty(data.onclick)||!Ext.isEmpty(data.linkto)){eventid=this.grid.addEventObj(data)}return Ext.tusc.getOpers(data,this.grid)+Ext.getRadio({disable:data.disable,checked:data.checked,params:{param:data.value,id:this.grid.id,name:this.name,eventid:eventid}})};Ext.tusc.radioClick=function(B){var A=Ext.getCmp(B.id).cdata[B.name];A.cparam.cleanParams();A.cparam.addParam(B.param);A.value=A.cparam.getParams();if(B.eventid){Ext.tusc.onClick(B.id,B.eventid)}};Ext.tusc.getOpers=function(C,A){if(C.sumCell==true){return""}var B=C.opers;if(B==null||B.length==0){return""}var D=new StringBuffer();Ext.each(B,function(G,E,F){D.append(Ext.tusc.parseOper(G,A))});return D.toString()};Ext.tusc.parseOper=function(E,C){var B=C.addEventObj(E);var A=null;var D={onclick:'Ext.tusc.onClick("'+C.id+'","'+B+'")',text:E.text,imgurl:E.imgurl,tip:E.tip};if(E.type=="text"){A=Ext.tusc.operTextTpl}else{A=Ext.tusc.operImgTpl}return A.applyTemplate(D)};Artery.initListScroll=function(D,B){var C=Ext.getDom(D+"-atslheader").childNodes;for(var A=0;A<C.length;A++){Ext.fly(C[A]).addClass("sl-header-scroll")}B.onscroll=null};Artery.plugin.SampleListStore=function(A){this.addEvents("beforeload","load","loadexception");Ext.apply(this,A)};Ext.extend(Artery.plugin.SampleListStore,Ext.util.Observable,{list:null,paramNames:{start:"start",limit:"limit",sort:"sort",dir:"dir"},baseParams:{},load:function(B){B=B||{};if(this.fireEvent("beforeload",this,B)===false){return false}if(B.params==null){B.params={}}var C=Ext.apply(B.params,this.baseParams);if(B.highlightValue){C.highlightValue=B.highlightValue}if(this.sortInfo){var A=this.paramNames;C[A.sort]=this.sortInfo.field;C[A.dir]=this.sortInfo.direction}this.storeOptions(B);this.loadFromServer(C,B);return true},reload:function(A){this.load(Artery.applyIf(A||{},this.lastOptions))},loadRecords:function(A,B,D){if(!A||D===false){if(D!==false){this.fireEvent("load",this,[],B)}return }if(A!=null){A=Ext.decode(A)}this.list.renderHtml(A);var C=[];this.fireEvent("load",this,C,B)},loadFromServer:function(A,B){Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",success:function(C,D){var G=C.responseText;if(G){var F=Ext.decode(G);if(F.customData){D.params.customData=Ext.decode(F.customData)}}if(B.callback){D.callback=B.callback}this.loadRecords(G,D,true);if(B.highlightValue){var E=this.list.el.child(".x-list-highlight-row");if(E){E.scrollIntoView(this.list.body);E.dom.click()}}},params:B.params,scope:this})},storeOptions:function(A){A=Ext.decode(Ext.encode(A));delete A.callback;delete A.scope;delete A.highlightValue;this.lastOptions=A},applyLastOptionsParams:function(A){if(!this.lastOptions){this.lastOptions={}}if(!this.lastOptions.params){this.lastOptions.params={}}if(A.itemid){delete A.itemid}Ext.apply(this.lastOptions.params,A)},getTotalCount:function(){return this.totalLength||0},getCount:function(){return this.dataLength||0},getCurrPageNo:function(){return this.currPageNo||1},getRowsPerPage:function(){return this.rowsPerPage},getSortState:function(){return this.sortInfo}});Artery.plugin.SampleList=Ext.extend(Artery.plugin.BasePanel,{containerEl:null,colGroupEl:null,colGroup:null,headEl:null,headComp:null,cm:null,filterCompEl:null,tbodyEl:null,selectedRow:null,selectedCell:null,domFindLevel:5,exportType:"stream",onLoadEvent:null,pagingbars:null,rowClickSelect:true,showTitle:true,isShowRowNumber:true,hiddenFilter:false,initComponent:function(){this.store=new Artery.plugin.SampleListStore({list:this});this.store.on("beforeload",this.onBeforeLoad,this);if(this.pagingbars){this.store.on("load",this.refreshPagingbars,this)}this.store.on("load",this.onAfterLoad,this);if(this.bbar){this.bbar.store=this.store}if(!this.autoRowHeight){this.domFindLevel=9}Artery.plugin.SampleList.superclass.initComponent.call(this)},exportExcel:function(C,B){var A=sys.getContextPath()+"/artery/form/dealParse.do";var D=Artery.getParams({},this);if(this.store.lastOptions&&this.store.lastOptions.params){Ext.apply(D,this.store.lastOptions.params)}else{Ext.apply(D,{start:0,limit:this.store.rowsPerPage})}Ext.tusc.encodeParam(D);Ext.apply(D,{itemid:Artery.getEventId(this),formid:Artery.getFormId(this),method:"exportExcel",action:"runItemLogic",exportType:this.exportType});if(C==true){D.exportAll="true"}this.setColumnConf(D);if(!Ext.isEmpty(B)){D.exportName=B}else{D.exportName=this.exportName}D.isAjax=false;D.exportName=Artery.escape(D.exportName);A=A+"?"+Ext.urlEncode(D);if(A.length>1000){cfg={};delete D.action;cfg.params=D;cfg.url="/artery/form/dealParse.do?action=runItemLogic";if(this.exportNewPage){cfg.expName="newWindow"}Artery.autoSubmitForm(window,cfg)}else{if(this.exportNewPage){window.open(A)}else{window.location=A}}},exportPdf:function(C,B){var A=sys.getContextPath()+"/artery/form/dealParse.do";var D=Artery.getParams({},this);if(this.store.lastOptions&&this.store.lastOptions.params){Ext.apply(D,this.store.lastOptions.params)}else{Ext.apply(D,{start:0,limit:this.store.rowsPerPage})}Ext.tusc.encodeParam(D);Ext.apply(D,{itemid:Artery.getEventId(this),formid:Artery.getFormId(this),method:"exportPdf",action:"runItemLogic",exportType:this.exportType});if(C==true){D.exportAll="true"}this.setColumnConf(D);if(!Ext.isEmpty(B)){D.exportName=B}else{D.exportName=this.exportName}D.isAjax=false;if(Ext.isEmpty(this.exportType)||this.exportType=="stream"){D.exportName=Artery.escape(D.exportName);A=A+"?"+Ext.urlEncode(D);if(A.length>1000){cfg={};delete D.action;cfg.params=D;cfg.url="/artery/form/dealParse.do?action=runItemLogic";if(this.exportNewPage){cfg.expName="newWindow"}Artery.autoSubmitForm(window,cfg)}else{if(this.exportNewPage){window.open(A)}else{window.location=A}}}else{this.container.mask("正在导出数据...");Artery.request({url:A,success:function(E,F){this.container.unmask();var G=Ext.decode(E.responseText);if(G.tempFile){window.location=A+"?action=download&nameencrypt=1&file="+G.tempFile+"&random="+Math.random()}else{alert("导出文件失败")}},params:D,scope:this})}},onBeforeLoad:function(A,B){if(this.store.loadding){return false}this.store.loadding=true;if(this.loadMask){this.bwrap.mask("正在加载数据...")}if(B.params==null){B.params={}}this.setFilterParams(B.params);this.setColumnConf(B.params);Artery.applyIf(B.params,Artery.getParams({method:"parseListData",listAreaId:this.id},this));var E=[];var D=this.colGroup.length;for(var C=0;C<D;C++){if(this.colGroup[C].hidden){E.push(this.colGroup[C].id)}}if(E.length!=0){B.params.hiddenCols=E.join(",")}else{B.params.hiddenCols=""}},setColumnConf:function(D){var A={};for(var B=0;B<this.columns.length;B++){var C=this.columns[B].dataIndex;A[C]=this.columns[B].colHidden}D.columnConf=Ext.encode(A)},setFilterParams:function(F){if(this.filterCompEl==null||this.filterCompEl.elements.length<1){return }var D="";var E=this.filterCompEl.elements;for(var A=0;A<E.length;A++){var C=E[A].value.trim();if(!Ext.isEmpty(C)){if(C==E[A].getAttribute("filterEmptyText")){continue}var B=E[A].getAttribute("colId");C=C.replace(/;/g,"$sem").replace(/:/g,"$col");D+=B+":"+C+";"}}if(Ext.isEmpty(D)){delete F.filter}else{F.filter=D}},refreshPagingbars:function(H,I,B){if(this.pagingbars==null||this.pagingbars.length==0){return }var A=this.store.paramNames;var C=parseInt((B.params&&B.params[A.limit])?B.params[A.limit]:0);if(C==0){var G=Artery.get(this.pagingbars[0]);if(!G){return }C=G.pageCount}if(C==0){return }var F=this.store.getTotalCount();var E=this.store.getCurrPageNo();for(var D=0;D<this.pagingbars.length;D++){var J=Artery.get(this.pagingbars[D]);if(J&&J.refresh){J.refresh({rowCount:F,currPageNo:E,rowsPerPage:this.store.getRowsPerPage()})}}},onAfterLoad:function(B,A,C){this.selectedRow=null;this.selectedCell=null;this.store.loadding=false;if(this.loadMask){this.bwrap.unmask()}if(this.isPageSplit&&this.isOnePageHideBar){if(this.pageCount==0||this.store.getTotalCount()==0||this.pageCount>=this.store.getTotalCount()){this.getBottomToolbar().hide()}else{this.getBottomToolbar().show()}}if(this.onLoadEvent){Artery.regItemEvent(this,"onLoadEvent",null,{store:B,records:A,options:C})}},onRender:function(B,A){Artery.plugin.SampleList.superclass.onRender.call(this,B,A);this.containerEl=Ext.get(this.id+"-atslcontainer");this.colGroupEl=Ext.get(this.id+"_colgroup");this.initColGroup();if(this.showTitle){this.headEl=Ext.get(this.id+"-atslheader");this.headerFilterRowEl=this.headEl.child(".sl-header-filter-row");this.filterCompEl=this.headEl.select(".sl-header-finput");this.initHeadEvent()}this.tbodyEl=Ext.get(this.id+"-atslbody")},collapseFilter:function(){if(this.headerFilterRowEl){this.headerFilterRowEl.setDisplayed(false);this.hiddenFilter=true}},expandFilter:function(){if(this.headerFilterRowEl){this.headerFilterRowEl.setDisplayed(true);this.hiddenFilter=false}},toggleFilter:function(){if(this.hiddenFilter){this.expandFilter()}else{this.collapseFilter()}return this.hiddenFilter},initColGroup:function(){this.colGroup=Ext.query("col",this.colGroupEl.dom)},afterRender:function(){Artery.plugin.SampleList.superclass.afterRender.call(this);if(!this.isInitData){this.store.load({params:{start:0,limit:this.pageCount}})}else{this.doMoreWork();this.store.fireEvent("load",this.store,[],{})}},renderHtml:function(response){if(!this.tempTableEl){this.tempTableEl=document.createElement("div");this.tempTableEl.style.display="none";Ext.getBody().appendChild(this.tempTableEl)}this.tempTableEl.innerHTML=response.html;this.containerEl.dom.replaceChild(this.tempTableEl.firstChild.firstChild,this.tbodyEl.dom);Ext.destroy(this.tbodyEl);this.tbodyEl=this.containerEl.child(".sl-body");this.doMoreWork();if(!Ext.isEmpty(response.script)){eval(response.script)}},initHeadEvent:function(){this.headComp=this.headEl.select(".sl-header-title");this.headComp.on("click",this.handleHeadClick,this);if(this.filterCompEl.elements.length>0){var C=this.filterCompEl.elements;for(var B=0;B<C.length;B++){var A=C[B].tagName.toLowerCase();if(A=="input"){Ext.fly(C[B]).on("keypress",this.handleFilterInput,this);Ext.fly(C[B]).on("focus",this.focusFilterInput,this);Ext.fly(C[B]).on("blur",this.blurFilterInput,this)}else{if(A=="select"){Ext.fly(C[B]).on("change",this.handleFilterSelect,this)}}}}},focusFilterInput:function(C){var A=C.getTarget();if(!A){return }var B=A.getAttribute("filterEmptyText");if(!Ext.isEmpty(B)&&A.value==B){Ext.fly(A).removeClass("sl-header-empty-finput");A.value=""}},blurFilterInput:function(C){var A=C.getTarget();var B=A.getAttribute("filterEmptyText");if(!Ext.isEmpty(B)){if(Ext.isEmpty(A.value)){A.value=B;Ext.fly(A).addClass("sl-header-empty-finput")}else{if(A.value==B){Ext.fly(A).addClass("sl-header-empty-finput")}}}},handleHeadOver:function(C){var A=C.getTarget();var B=this.findParentDom(A,"td");Ext.fly(B).addClass("sl-header-over")},handleHeadOut:function(C){var A=C.getTarget();var B=this.findParentDom(A,"td");Ext.fly(B).removeClass("sl-header-over")},handleHeadClick:function(E){var F=E.getTarget();var A=F.tagName;var D=F.getAttribute("type");if(A.toLowerCase()=="input"&&D=="checkbox"){this.handleHeadSelect(E);return }var B=this.findParentDom(F,".sl-header-title");var C=B.getAttribute("isOrderBy");if(C=="true"){this.handleOrder(B)}},handleHeadSelect:function(e){var d=e.getTarget();var tdom=this.findParentDom(d,".sl-header-title");var colId=tdom.getAttribute("colId");var cf=this.getColConf(colId);if(cf.coltype=="checkbox"){if(d.checked){this.selectAllCheckbox(colId,false)}else{this.deselectAllCheckbox(colId,false)}if(cf.onHeadSelectEvent){var rc=Artery.createCaller(cf.dataIndex,"onHeadSelectServer",Artery.getFormId(this));rc.sync=true;eval("var fn = function(checked){"+cf.onHeadSelectEvent+"\n}");fn.call(this,d.checked)}}},handleOrder:function(G){var D=G.getAttribute("colId");this.headComp.each(function(H){var J=H.dom.getAttribute("colId");if(D!=J){var I=H.dom.getAttribute("orderStatus");if(I=="ASC"||I=="DESC"){H.dom.innerHTML=H.dom.getAttribute("colTitle")}}});var E=G.getAttribute("sortDir");var A=G.getAttribute("showOrderIcon");if(A=="true"){E=(E=="ASC")?"DESC":"ASC";G.setAttribute("showOrderIcon","false")}if(this.store.sortInfo){var C=this.store.sortInfo.field;var B=this.store.sortInfo.direction;if(C==D){if(B=="ASC"){this.setHeadDir(G,"DESC")}else{this.setHeadDir(G,"ASC")}}else{this.setHeadDir(G,E)}}else{this.setHeadDir(G,E)}var F=this.getLoadParams();this.store.load({params:F})},setHeadDir:function(D,A){if(A==null){D.innerHTML=D.getAttribute("colTitle");this.store.sortInfo=null}else{var C=D.getAttribute("colTitle");if(A=="ASC"){C=C+"<img src='"+sys.getContextPath()+"/artery/arteryTheme/theme/default/images/sampleList/sort_asc.gif'>"}else{C=C+"<img src='"+sys.getContextPath()+"/artery/arteryTheme/theme/default/images/sampleList/sort_desc.gif'>"}D.innerHTML=C;var B=D.getAttribute("colId");this.store.sortInfo={field:B,direction:A};D.setAttribute("orderStatus",A)}},setSortInfo:function(A){this.store.sortInfo=A},handleFilterInput:function(B){var A=B.getKey();if(A==Ext.EventObject.ENTER||A==Ext.EventObject.ESC){var C=this.getLoadParams();this.store.load({params:C})}},handleFilterSelect:function(A){var B=this.getLoadParams();this.store.load({params:B})},getLoadParams:function(){var A={};if(this.store.lastOptions&&this.store.lastOptions.params){Ext.apply(A,this.store.lastOptions.params)}if(this.pageCount!=0){A.start=0;A.limit=this.pageCount}return A},findParentDom:function(B,A,C){if(C===undefined){C=5}return Ext.fly(B).findParent(A,C,false)},changeSelectedRow:function(A){if(A==this.selectedRow){return }if(!A){return }if(this.rowClickSelect){Ext.fly(A).addClass("sl-data-row-select");if(this.selectedRow){Ext.fly(this.selectedRow).removeClass("sl-data-row-select")}}this.selectedRow=A},doMoreWork:function(){this.store.totalLength=parseInt(this.tbodyEl.dom.getAttribute("totalCount"));this.store.dataLength=parseInt(this.tbodyEl.dom.getAttribute("dataCount"));this.store.currPageNo=parseInt(this.tbodyEl.dom.getAttribute("currPageNo"));this.store.rowsPerPage=parseInt(this.tbodyEl.dom.getAttribute("rowsPerPage"));this.scanData();if(this.clearStatus){this.clearDataStatus(false)}if(Ext.isTrue(this.tbodyEl.dom.empty)){this.containerEl.addClass("sl-container-empty-data")}else{this.containerEl.removeClass("sl-container-empty-data")}},dealCheckbox:function(C,F,A){var E=Ext.fly(F).child("input",true);var B=Ext.fly(F).child(".f_value",true);if(!E||!B){return }var D=B.innerHTML;if(E.checked){if(C.select.containsKey(D)){}else{if(A=="scan"){if(C.sersel.containsKey(D)){E.checked=false}else{C.select.add(D,"selected");C.sersel.add(D,"selected")}}else{if(A=="click"){C.select.add(D,"selected")}}}}else{if(C.select.containsKey(D)){if(A=="scan"){if(this.clearStatus){}else{E.checked=true}}else{if(A=="click"){C.select.removeKey(D)}}}else{}}},reload:function(A){if(!this.rendered){return }var B={};if(A){B=Ext.decode(Ext.encode(A));if(A.callback){B.callback=A.callback}}if(B.clearStatus==undefined){if(this.clearStatus){this.clearDataStatus(false)}}else{if(B.clearStatus){this.clearDataStatus(false)}}if(B.clearFilter){this.clearHeadFilter()}if(Ext.isTrue(this.isPageSplit)&&B!=null){if(B.params==null){B.params={}}if(B.params.start!==undefined){B.params.start=parseInt(B.params.start)}if(B.params.limit!==undefined){B.params.limit=parseInt(B.params.limit);this.getBottomToolbar().pageSize=B.params.limit}Artery.applyIf(B.params,{start:this.getBottomToolbar().cursor,limit:this.getBottomToolbar().pageSize})}if(!B.clearParam&&this.store.lastOptions){Artery.applyIf(B.params,this.store.lastOptions.params)}this.store.reload(B)},clearDataStatus:function(C){for(var A=0;A<this.columns.length;A++){var B=this.columns[A];if(B.select&&(B.coltype=="checkbox"||B.coltype=="radio")){if(B.select.clear){B.select.clear();B.sersel.clear()}else{delete B.select}if(C!==false){this.deselectAllCheckbox(B.dataIndex,true)}}}},clearHeadFilter:function(){if(this.filterCompEl==null||this.filterCompEl.elements.length<1){return }var D=this.filterCompEl.elements;for(var B=0;B<D.length;B++){var C=D[B].value;var A=D[B].getAttribute("filterEmptyText");if(Ext.isEmpty(C)){if(!Ext.isEmpty(A)){D[B].value=A;Ext.fly(D[B]).addClass("sl-header-empty-finput")}}else{if(Ext.isEmpty(A)){D[B].value=""}else{D[B].value=A;Ext.fly(D[B]).addClass("sl-header-empty-finput")}}}},sureHeadCheckboxStatus:function(E){if(E.coltype!="checkbox"){return }var F=null;if(this.showTitle){this.headComp.each(function(K){var J=K.dom.getAttribute("colId");if(J==E.dataIndex){var I=K.child("input",true);if(I){F=I}}})}if(!F){return }var A=this.getDataRows();var H=0;var D=0;for(var C=0;C<A.length;C++){var G=A[C].children[E.index];if(!G){continue}var B=Ext.fly(G).child("input",true);if(!B){continue}H++;if(B.checked){D++}}if(H!=0){F.checked=(D==H)}},dealRadio:function(B,E){var D=Ext.fly(E).child("input",true);var A=Ext.fly(E).child(".f_value",true);if(!D||!A){return }var C=A.innerHTML;if(D.checked){B.select=C}else{if(B.select==C){D.checked=true}}},scanData:function(){var A=[];for(var D=0;D<this.columns.length;D++){var F=this.columns[D];if(F.coltype=="checkbox"||F.coltype=="radio"){A.push(F)}}if(A.length==0){return }if(this.showTitle){this.headComp.each(function(I){var H=I.child("input",true);if(H){H.checked=false}})}var B=this.getDataRows();for(var D=0;D<B.length;D++){var E=B[D];for(var C=0;C<A.length;C++){var F=A[C];var G=E.children[F.index];if(!G){continue}if(F.coltype=="checkbox"){this.dealCheckbox(F,G,"scan")}else{if(F.coltype=="radio"){this.dealRadio(F,G)}}}}},getValues:function(A){var B=this.getValuesArray(A);return B.join(",")},getValue:function(A){var B=this.getSelectedRowJson();if(B==null){return null}return Ext.encode(B[A])},getRowValue:function(){var A=this.getSelectedRowJson();if(A==null){return null}return Ext.encode(A)},hasColumn:function(A){var B=this.getColConf(A);return B?true:false},getValuesArray:function(A){var B=this.getColConf(A);if(!B){Artery.showError("找不到指定的列名称："+A);return[]}A=B.dataIndex;if(B.coltype=="data"){return this.getPageValues(A,"array")}else{if(B.coltype=="checkbox"){return B.select.keys.concat()}else{if(B.coltype=="radio"){return B.select?[B.select]:[]}else{if(B.coltype=="onlydata"){return this.getPageValues(A,"array")}}}}},getValuesQuote:function(B){var C=this.getValuesArray(B);var D=[];for(var A=0;A<C.length;A++){D.push("'"+C[A]+"'")}return D.join(",")},getCellByValue:function(C,D){var A=this.getCells(C);for(var B=0;B<A.length;B++){if(this.isValidCell(A[B],D)){return A[B]}}},isValidCell:function(A,C){var B=Ext.fly(A).child(".f_value",true);if(B&&B.innerHTML){if(B.innerHTML==C){return true}}var A=Ext.fly(A).child(".sl-data-cell",true);if(!A){return false}var D=A.childNodes[0];if(D.nodeType==3){if(D.data==C){return true}}else{if(D.nodeType==1){if(D.innerHTML==C){return true}}}return false},getCells:function(C){var E=this.getColConf(C);if(!E){return null}C=E.id;var A=this.getDataRows();var D=[];for(var B=0;B<A.length;B++){var F=A[B].children[E.index];D.push(F)}return D},getTrByColValue:function(D,F){var E=this.getColConf(D);if(!E){return null}D=E.id;var B=this.getDataRows();for(var C=0;C<B.length;C++){if(E.coltype=="onlydata"){var A=Ext.fly(B[C]).child("span[colId="+D+"]",true);if(A&&A.innerHTML==F){return B[C]}}else{var A=B[C].children[E.index];if(this.isValidCell(A,F)){return B[C]}}}},getFirstTr:function(){var A=this.getDataRows();if(A==null||A.length==0){return null}return A[0]},getLastTr:function(){var A=this.getDataRows();if(A==null||A.length==0){return null}return A[A.length-1]},getPageValues:function(L,J){var C=this.getColConf(L);if(!C){Artery.showError("找不到指定的列名称："+L);if(J==="array"){return[]}else{return""}}L=C.dataIndex;var G=this.getDataRows();var K=[];for(var I=0;I<G.length;I++){if(C.coltype=="onlydata"){var H=Ext.fly(G[I]).child(".sl-data-onlydata",true);if(H){for(var B=0;B<H.children.length;B++){var E=H.children[B].getAttribute("colId");if(E==L){K.push(H.children[B].innerHTML)}}}}else{var F=G[I].children[C.index];if(F!=undefined){var D=Ext.fly(F).child(".f_value",true);if(D&&D.innerHTML){K.push(D.innerHTML)}else{var M=Ext.fly(F).child(".sl-data-cell",true);if(!M){continue}var A=M.childNodes[0];if(A.nodeType==3){if(A.data==String.fromCharCode(160)){K.push("")}else{K.push(A.data)}}else{if(A.nodeType==1){K.push(A.innerHTML)}}}}}}if(J==="array"){return K}else{return K.join(",")}},setTitle:function(B,C){var A=this.headEl.child("[colId="+B+"]");if(A){A.update(C)}},changeCheck:function(D,B,A){var E=this.getColConf(D);if(E.coltype!="checkbox"&&E.coltype!="radio"){return }var F=[];if(!Ext.isArray(B)){F[B]="true"}else{for(var C in B){F[B[C]]="true"}}Ext.select("span[colId="+D+"]",true,this.el.dom).each(function(I){var H=I.child(".f_value");var G=I.child("input");if(H&&F[H.dom.innerHTML]=="true"){if((A&&!G.dom.checked)||(!A&&G.dom.checked)){I.child("input").dom.click()}}},this)},setValue:function(C,E,B){if(this.selectedRow){var D=this.getColConf(C);if(!D){Artery.showError("找不到指定的列名称："+C);return }C=D.id;var H=this.selectedRow.children[D.index];var A=Ext.fly(H).child(".sl-data-cell",true);var G=Ext.fly(H).child(".f_value",true);if(D.coltype=="checkbox"){if(G){G.innerHTML=E}}else{if(D.coltype=="radio"){if(G){G.innerHTML=E}}else{if(G){G.innerHTML=E;if(B!==undefined){var F=A.childNodes[0];if(F.nodeType==3){F.data=B}else{F.innerHTML=B}}}else{var F=A.childNodes[0];if(F.nodeType==3){F.data=E}else{F.innerHTML=E}}}}}},getDeselectValues:function(A){var B=this.getDeselectValuesArray(A);return B.join(",")},getDeselectValuesQuote:function(B){var C=this.getDeselectValuesArray(B);var D=[];for(var A=0;A<C.length;A++){D.push("'"+C[A]+"'")}return D.join(",")},getDeselectValuesArray:function(D){var F=this.getColConf(D);if(F==null){return undefined}if(F.coltype!="checkbox"&&F.coltype!="radio"){return undefined}var B=[];var A=this.getDataRows();for(var C=0;C<A.length;C++){var E=A[C];var H=E.children[F.index];var G=Ext.fly(H).child(".f_value",true).innerHTML;if(F.coltype=="checkbox"){if(!F.select.containsKey(G)){B.push(G)}}else{if(F.coltype=="radio"){if(!F.select==G){B.push(G)}}}}return B},getColConf:function(B){for(var A=0;A<this.columns.length;A++){if(this.columns[A].dataIndex==B||Artery.getEventId(this.columns[A].dataIndex)==B){return this.columns[A]}}return null},getColIndex:function(A){var B=this.getColConf(A);if(B){return B.index}else{return -1}},selectAllCheckbox:function(E,D){var F=this.getColConf(E);if(F.coltype!="checkbox"){return }E=F.id;var A=this.getDataRows();for(var C=0;C<A.length;C++){var G=A[C].children[F.index];if(!G){continue}var B=Ext.fly(G).child("input",true);if(!B){continue}if(!B.checked&&!B.disabled){B.checked=true;this.dealCheckbox(F,G,"click")}}if(D!==false&&this.showTitle){this.headComp.each(function(J){var I=J.dom.getAttribute("colId");if(I==F.dataIndex){var H=J.child("input",true);if(H){H.checked=true}}})}},deselectAllCheckbox:function(E,D){var F=this.getColConf(E);if(F.coltype!="checkbox"&&F.coltype!="radio"){return }E=F.id;var A=this.getDataRows();for(var C=0;C<A.length;C++){var G=A[C].children[F.index];if(!G){continue}var B=Ext.fly(G).child("input",true);if(!B){continue}if(B.checked){B.checked=false;this.dealCheckbox(F,G,"click")}}if(D!==false&&this.showTitle){this.headComp.each(function(J){var I=J.dom.getAttribute("colId");if(I==F.dataIndex){var H=J.child("input",true);if(H){H.checked=false}}})}},getSelectedCellValue:function(){if(!this.selectedCell){return null}var B=Ext.fly(this.selectedCell).child(".f_value",true);if(B){return B.innerHTML}else{var A=Ext.fly(this.selectedCell).child(".sl-data-cell",true);if(A){var C=A.childNodes[0];if(!C){return null}else{if(C.nodeType==3){return C.data}else{if(C.nodeType==1){return C.innerHTML}}}}}return null},getSelectedRowValue:function(){var A=this.getSelectedRowJson();if(A==null){return null}return Ext.encode(A)},getSelectedRowJson:function(){if(!this.selectedRow){return null}return this.getRowValueInner(this.selectedRow)},getRowValueInner:function(N){var C={};var G=Ext.query(".sl-data-cell",N);for(var K=0;K<G.length;K++){var D=G[K].getAttribute("colId");var F=Ext.fly(G[K]).child(".f_value",true);var A=G[K].childNodes[0];if(F){if(A.nodeType==3){var E=this.trimNBSP(F.innerHTML);var J=this.trimNBSP(A.data);C[D]={value:E,valueText:J}}else{C[D]=this.trimNBSP(F.innerHTML)}}else{if(this.hasOnClickSubNode(G[K])){var M=G[K].children;var L="";for(var H=0;H<M.length;H++){L+=this.trimNBSP(this.getNodeValue(M[H]))}C[D]=L}else{C[D]=this.trimNBSP(G[K].innerText)}}}var I=Ext.fly(N).child(".sl-data-onlydata",true);if(I){for(var B=0;B<I.children.length;B++){var D=I.children[B].getAttribute("colId");C[D]=this.trimNBSP(I.children[B].innerHTML)}}return C},hasOnClickSubNode:function(C){var B=C.innerHTML;var A=B.indexOf("sl-onclick");if(A!=-1){return true}return false},getNodeValue:function(A){if(!A){return""}else{if(A.nodeType==3){return A.data}else{if(A.nodeType==1){if(Ext.fly(A).hasClass("sl-onclick")){return""}return A.innerText}}}},trimNBSP:function(A){if(A==" "){A=""}return A},getCheckedRowValue:function(A){var B=this.getCheckedRowJson(A);if(Ext.isEmpty(B)){return B}return Ext.encode(B)},getCheckedRowJson:function(E){var G=this.getColConf(E);if(G==null){return undefined}if(G.coltype!="checkbox"&&G.coltype!="radio"){return undefined}var C=[];var A=this.getDataRows();for(var D=0;D<A.length;D++){var F=A[D];var H=F.children[G.index];var B=Ext.fly(H).child("input",true);if(G.coltype=="checkbox"||G.coltype=="radio"){if(B.checked){C.push(this.getRowValueInner(F))}}}return C},getDataRows:function(){var B=this.tbodyEl.dom.rows;if(B==null||B.length==0){return[]}var A=[];var D=B.length;for(var C=0;C<D;C++){if(Ext.fly(B[C]).hasClass("sl-data-row")){A.push(B[C])}}return A},getAllValues:function(){return Ext.encode(this.getAllValuesJson())},getAllValuesJson:function(){var B=[];var A=this.getDataRows();for(var C=0;C<A.length;C++){B.push(this.getRowValueInner(A[C]))}return B},getRowTpl:function(A){if(this.rowTpl==null){this.createRowTpl(A)}return this.rowTpl},createRowTpl:function(A){Artery.runLogic({params:{itemid:Artery.getEventId(this),method:"parseRowTpl",listId:this.id,formid:Artery.getFormId(this)},callback:function(B){this.rowTpl=B},syn:false,scope:this})},insertRecord:function(F){var B=Ext.select(".sl-container-empty-data-text",this.el);if(B.first()!=null){B.first().parent(".sl-container").removeClass("sl-container-empty-data");B.first().parent().remove()}var G=this.id;var C=this.tbodyEl.dom;var E=this.getRowTpl(F);Ext.DomHelper.insertHtml("beforeEnd",C,E);var D=C.rows[C.rows.length-1];Ext.select(".sl-data-cell",false,D).each(function(K,I,H){var L=K.getAttribute("colId");if(L&&F[L]){var J=K.dom;var M=F[L];if(Ext.isObject(M)){var N=document.createTextNode(M.valueText);J.appendChild(N);var O=document.createElement("div");O.className="f_value";O.innerHTML=M.value;J.appendChild(O)}else{J.innerHTML=M}}},this);this.refreshNumber();this.refreshStripeColor();var A=Artery.get(this.id+"_pagingBar");if(A&&A.updatePageNumber){A.updatePageNumber(1)}},deleteRecord:function(F,E){if(F==null){if(!this.selectedRow){return }var H=this.containerEl.dom;var I=H.rows;var C=I.length;for(var B=0;B<C;B++){if(I[B]==this.selectedRow){H.deleteRow(B);this.selectedRow==null;this.refreshNumber();this.refreshStripeColor();var A=Artery.get(this.id+"_pagingBar");if(A&&A.updatePageNumber){A.updatePageNumber(-1)}this.checkEmptyTip();return }}}else{var G=this.getValuesArray(F);var C=G.length;var D=-1;for(var B=0;B<C;B++){if(G[B]==E){D=B}}if(D!=-1){var H=this.containerEl.dom;H.deleteRow(D);this.refreshNumber();this.refreshStripeColor();if(Artery.get(this.id+"_pagingBar")){Artery.get(this.id+"_pagingBar").updatePageNumber(-1)}}}},refreshNumber:function(){if(!this.isShowRowNumber){return }var C=this.getDataRows();var B=C.length;for(var A=0;A<B;A++){C[A].cells[0].innerText=A+1}},refreshStripeColor:function(){if(!this.stripeRows){return }var D=this.getDataRows();var C=D.length;for(var A=0;A<C;A++){var B="sl-data-row";if(A==0){B+=" sl-data-row-first"}else{if(A==C-1){B+=" sl-data-row-last"}}if(A%2==1){B+=" sl-data-row-stripe"}D[A].className=B}},checkEmptyTip:function(){var C=this.tbodyEl.dom;var A=C.rows.length;if(A==0){this.containerEl.addClass("sl-container-empty-data");var B={tag:"tr",children:{tag:"td",cls:"sl-container-empty-data-text",colSpan:100,html:this.emptyDataTip}};Ext.DomHelper.createDom(B,C)}},clear:function(){var C=this.tbodyEl.dom;var A=C.rows.length;for(var B=0;B<A;B++){C.deleteRow()}this.checkEmptyTip()},setColHidden:function(B,D){var C=this.colGroup.length;var A=0;while(A<C){if(this.colGroup[A].id==B){break}A++}if(this.colGroup[A].id==B){this.hiddenColByIdx(A,Ext.isTrue(D)?"none":"");this.colGroup[A].hidden=Ext.isTrue(D);this.refreshColGroup()}},hiddenColByIdx:function(A,F){this.headEl.dom.rows[0].cells[A].style.display=F;var E=this.getDataRows();var B=E.length;for(var D=0;D<B;D++){var C=E[D].cells;C[A].style.display=F}},refreshColGroup:function(){var B=this.colGroup.length;for(var A=0;A<B;A++){Ext.fly(this.colGroup[A]).remove();if(!this.colGroup[A].hidden){this.colGroupEl.appendChild(this.colGroup[A])}}},hideCol:function(B,A){Ext.get(B).setStyle("display","none");Ext.get("td_header_"+B).setStyle("z-index","-1");if(A==undefined||A){this.repaint()}},showCol:function(B,A){Ext.get(B).setStyle("display","block");Ext.get("td_header_"+B).setStyle("z-index","0");if(A==undefined||A){this.repaint()}},repaint:function(){if(this.tbodyEl){var C=this.tbodyEl;var B=Ext.get(C);var A=B.dom;B.clean(true);B.appendChild(A)}}});Ext.reg("apSampleList",Artery.plugin.SampleList);function ddd(){}Artery.operClick=function(G,C){G=G.parentNode;Artery.plugin.SampleList.setSelectObj(G,C);var D=G.getAttribute("operId");var F=G.getAttribute("colId");var E=Artery.get(C).getColConf(F);var B=null;if(E.operMap){Ext.each(E.operMap,function(H){for(name in H){if(name==D||Artery.getEventId(name)==D){B=H[name];break}}})}G.listId=C;var A=Artery.plugin.SampleList.onDomClick(G,B,"onClickServer");if(A&&event){Ext.lib.Event.stopPropagation(event)}};Artery.cellTdClick=function(B,A){Artery.get(A).selectedCell=B};Artery.cellClick=function(C,B){Artery.plugin.SampleList.setSelectObj(C,B);var D=C.getAttribute("colId");C.listId=B;var E=Artery.get(B).getColConf(D);var A=Artery.plugin.SampleList.onDomClick(C,E,"onClickServer");if(A&&event){Ext.lib.Event.stopPropagation(event)}};Artery.checkClick=function(E,B,C){var A=Artery.get(B);var D=A.getColConf(E.getAttribute("colId"));if(C=="checkbox"){A.sureHeadCheckboxStatus(D);A.dealCheckbox(D,E,"click")}else{if(C=="radio"){A.dealRadio(D,E)}}Artery.cellClick(E,B);Ext.lib.Event.stopPropagation(event)};Artery.rowClick=function(E,A,D){var C=Artery.get(A).selectedRow;Artery.get(A).changeSelectedRow(E);if(D){var B=Ext.fly(E).down(".sl-data-rowEvent",true);if(B){B.listId=A;Artery.plugin.SampleList.onDomClick(B,Artery.get(A),"onClickSingleServer")}}Artery.rowSelect(E,A,C)};Artery.rowSelect=function(d,listId,selectedRow){var tdDom=Ext.fly(d).down(".sl-data-rowEvent",true);if(!tdDom){return }var clickDom=Ext.fly(tdDom).down(".sl-rowSelect",true);if(clickDom!=null){var listItem=Artery.get(listId);var rc=Artery.createCaller(listItem,"onSelectServer",Artery.getFormId(listItem));eval("var fn = function(){"+clickDom.innerHTML+"\n}");fn.call(Artery.get(listId))}if(selectedRow){Artery.rowDeselect(selectedRow,listId)}};Artery.rowDeselect=function(d,listId){var tdDom=Ext.fly(d).down(".sl-data-rowEvent",true);if(!tdDom){return }var clickDom=Ext.fly(tdDom).down(".sl-rowDeselect",true);if(clickDom!=null){var listItem=Artery.get(listId);var rc=Artery.createCaller(listItem,"onDeselectServer",Artery.getFormId(listItem));eval("var fn = function(){"+clickDom.innerHTML+"\n}");fn.call(Artery.get(listId))}};Artery.rowDblClick=function(d,listId){var tdDom=Ext.fly(d).down(".sl-data-rowEvent",true);if(!tdDom){return }var linktoDom=Ext.fly(tdDom).down(".sl-dblinkto",true);if(linktoDom!=null){var linktoObj=Ext.decode(linktoDom.innerHTML);Artery.openForm(linktoObj)}var clickDom=Ext.fly(tdDom).down(".sl-dbclick",true);if(clickDom!=null){var listItem=Artery.get(listId);var rc=Artery.createCaller(listItem,"onClickDoubleServer",Artery.getFormId(listItem));eval("var fn = function(){"+clickDom.innerHTML+"\n}");fn.call(Artery.get(listId))}};Artery.rowMouseOver=function(d,listId){var tdDom=Ext.fly(d).down(".sl-data-rowEvent",true);if(!tdDom){return }var mouseOverDom=Ext.fly(tdDom).down(".sl-mouseOver",true);if(mouseOverDom!=null){var listItem=Artery.get(listId);var rc=Artery.createCaller(listItem,"onMouseOverServer",Artery.getFormId(listItem));eval("var fn = function(){"+mouseOverDom.innerHTML+"\n}");fn.call(Artery.get(listId))}};Artery.rowMouseOut=function(d,listId){var tdDom=Ext.fly(d).down(".sl-data-rowEvent",true);if(!tdDom){return }var mouseOutDom=Ext.fly(tdDom).down(".sl-mouseOut",true);if(mouseOutDom!=null){var listItem=Artery.get(listId);var rc=Artery.createCaller(listItem,"onMouseOutServer",Artery.getFormId(listItem));eval("var fn = function(){"+mouseOutDom.innerHTML+"\n}");fn.call(Artery.get(listId))}};Artery.showListHeaderMenu=function(E,B,A){var C=Artery.get(A).getColConf(B);if(C.menuCfg&&!C.menu){C.menuCfg.minWidth=10;var D=new Ext.menu.Menu(C.menuCfg);C.menu=D}C.menu.show(Ext.get(E),"tl-bl?")};Artery.plugin.SampleList.onDomClick=function(dom,itemConf,eventName){var existEvent=false;var linktoDom=Ext.fly(dom).down(".sl-linkto",true);if(linktoDom!=null){existEvent=true;var linktoObj=Ext.decode(linktoDom.innerHTML);Artery.openForm(linktoObj)}var clickDom=Ext.fly(dom).down(".sl-onclick",true);if(clickDom!=null){existEvent=true;var formId=Artery.getFormId(Artery.get(dom.listId));var rc=Artery.createCaller(itemConf,eventName,formId);Artery.params.itemid=Artery.getEventId(itemConf);var tmpId=Artery.params.formid;Artery.params.formid=formId;eval("var fn = function(){"+clickDom.innerHTML+"\n}");fn.call(Artery.get(dom.listId));Artery.params.formid=tmpId}return existEvent};Artery.plugin.SampleList.setSelectObj=function(D,A){var C=Ext.fly(D).findParent(".sl-data-row-td",9,false);if(C){Artery.get(A).selectedCell=C;var B=Ext.fly(D).findParent(".sl-data-row",9,false);if(B){Artery.get(A).changeSelectedRow(B)}}};Artery.colSplits=[];Artery.initListDragSplit=function(A,B){if(Artery.colSplits[B]!=null){return }Artery.colSplits[B]=new Artery.plugin.ListSplitBar({split:A,resizeId:B})};Artery.plugin.ListSplitBar=function(A){Ext.apply(this,A);this.initComponent()};Ext.override(Artery.plugin.ListSplitBar,{split:null,resizeId:null,initComponent:function(){this.splitEl=Ext.get(this.split);this.regionEl=Ext.get(this.resizeId);if(this.splitEl){this.splitBar=new Ext.SplitBar(this.splitEl.dom,this.regionEl,Ext.SplitBar.HORIZONTAL);this.splitBar.on("beforeapply",function(B,C){var D=Ext.fly(this.getPrevCol(B.resizingEl));var A=B.resizingEl.getWidth();B.resizingEl.setWidth(C);D.setWidth(D.getWidth()-(C-A));return false},this)}this.containerEl=this.splitEl.parent(".sl-container");this.cols=this.containerEl.query("col")},getPrevCol:function(A){for(var B=0;B<this.cols.length;B++){if(this.cols[B].id==A.id){return this.cols[B-1]}}},resetColWidth:function(){for(var A=0;A<this.cols.length;A++){this.cols[A].width=this.convertColWidth(Ext.fly(this.cols[A]).getWidth())}},convertColWidth:function(A){return parseInt((A/this.containerEl.getWidth()*100))+"%"}});Artery.getListTrByKeyWord=function(F){var A=Ext.query(".sl-container");if(A==null||A.length==0){return null}for(var C=0;C<A.length;C++){var E=A[C].rows;var D=E.length;for(var B=0;B<D;B++){if(E[B].innerHTML.indexOf(F)!=-1){return E[B]}}}return null};Artery.plugin.CollapseBtn=Ext.extend(Artery.plugin.BaseComponent,{panelId:null,onRender:function(C,A){Artery.plugin.CollapseBtn.superclass.onRender.call(this,C,A);this.panelCmp=Artery.get(this.panelId);var B=this.panelCmp.el.dom;this.panelHeight=B.xheight?B.xheight:B.style.height;this.el.on("click",function(){this.panelCmp.toggleCollapse(false);if(this.panelCmp.collapsed){this.panelCmp.el.dom.style.height="";this.panelCmp.bwrap.setDisplayed(false)}else{this.panelCmp.el.dom.style.height=this.panelHeight;this.panelCmp.bwrap.setDisplayed(true)}},this)},change:function(){this.panelCmp.toggleCollapse(false)},collapse:function(){if(!this.panelCmp.collapsed){this.panelCmp.toggleCollapse(false)}},expand:function(){if(this.panelCmp.collapsed){this.panelCmp.toggleCollapse(false)}}});Ext.reg("apCollapseBtn",Artery.plugin.CollapseBtn);if(typeof infosoftglobal=="undefined"){var infosoftglobal=new Object()}if(typeof infosoftglobal.FusionChartsUtil=="undefined"){infosoftglobal.FusionChartsUtil=new Object()}infosoftglobal.FusionCharts=function(C,A,I,F,K,D,G,J,B,E,H){if(!document.getElementById){return }this.initialDataSet=false;this.params=new Object();this.variables=new Object();this.attributes=new Array();if(C){this.setAttribute("swf",C)}if(A){this.setAttribute("id",A)}K=K?K:0;this.addVariable("debugMode",K);I=I.toString().replace(/\%$/,"%25");if(I){this.setAttribute("width",I)}F=F.toString().replace(/\%$/,"%25");if(F){this.setAttribute("height",F)}if(G){this.addParam("bgcolor",G)}this.addParam("quality","high");this.addParam("allowScriptAccess","always");this.addVariable("chartWidth",I);this.addVariable("chartHeight",F);this.addVariable("DOMId",A);D=D?D:0;this.addVariable("registerWithJS",D);J=J?J:"noScale";this.addVariable("scaleMode",J);B=B?B:"EN";this.addVariable("lang",B);this.detectFlashVersion=E?E:1;this.autoInstallRedirect=H?H:1;this.installedVer=infosoftglobal.FusionChartsUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){infosoftglobal.FusionCharts.doPrepUnload=true}};infosoftglobal.FusionCharts.prototype={setAttribute:function(A,B){this.attributes[A]=B},getAttribute:function(A){return this.attributes[A]},addParam:function(A,B){this.params[A]=B},getParams:function(){return this.params},addVariable:function(A,B){this.variables[A]=B},getVariable:function(A){return this.variables[A]},getVariables:function(){return this.variables},getVariablePairs:function(){var A=new Array();var B;var C=this.getVariables();for(B in C){A.push(B+"="+C[B])}return A},getSWFHTML:function(){var D="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){D='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"  ';D+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var C=this.getParams();for(var A in C){D+=[A]+'="'+C[A]+'" '}var B=this.getVariablePairs().join("&");if(B.length>0){D+='flashvars="'+B+'"'}D+="/>"}else{D='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase='+sys.getContextPath()+'"/artery/arteryConsole/ocx/Flash32_12_0_0_77.ocx#version=12.0.0.77"  class="FusionCharts" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">';D+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var C=this.getParams();for(var A in C){D+='<param name="'+A+'" value="'+C[A]+'" />'}var B=this.getVariablePairs().join("&");if(B.length>0){D+='<param name="flashvars" value="'+B+'" />'}D+="</object>"}return D},setDataURL:function(A){if(this.initialDataSet==false){this.addVariable("dataURL",A);this.initialDataSet=true}else{var B=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));if(!B.setDataURL){__flash__addCallback(B,"setDataURL")}B.setDataURL(A)}},encodeDataXML:function(D){var G=["\\$","\\+"];var C=D.match(/=\s*\".*?\"/g);if(C){for(var E=0;E<C.length;E++){var H=C[E].replace(/^=\s*\"|\"$/g,"");H=H.replace(/\'/g,"%26apos;");var F=D.indexOf(C[E]);var A="='"+H+"'";var B=D.substring(0,F);var I=D.substring(F+C[E].length);var D=B+A+I}}D=D.replace(/\"/g,"%26quot;");D=D.replace(/%(?![\da-f]{2}|[\da-f]{4})/ig,"%25");D=D.replace(/\&/g,"%26");return D},setDataXML:function(A){if(this.initialDataSet==false){this.addVariable("dataXML",this.encodeDataXML(A));this.initialDataSet=true}else{var B=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));B.setDataXML(A)}},setTransparent:function(A){if(typeof A=="undefined"){A=true}if(A){this.addParam("WMode","transparent")}else{this.addParam("WMode","Opaque")}},render:function(A){if((this.detectFlashVersion==1)&&(this.installedVer.major<8)){if(this.autoInstallRedirect==1){var B=window.confirm("You need Adobe Flash Player 8 (or above) to view the charts. It is a free and lightweight installation from Adobe.com. Please click on Ok to install the same.");if(B){window.location="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash"}else{return false}}else{return false}}else{var D=(typeof A=="string")?document.getElementById(A):A;if(this.getVariable("scaleMode").search(/noscale/i)>=0&&(this.getAttribute("width").search("%")>0||this.getAttribute("height").search("%")>0)){var C=this;if(document.readyState=="complete"){D.innerHTML=this.getSWFHTML()}else{if(window.addEventListener){window.addEventListener("load",function(){D.innerHTML=C.getSWFHTML()},false)}else{if(window.attachEvent){window.attachEvent("onload",function(){D.innerHTML=C.getSWFHTML()})}else{D.innerHTML=this.getSWFHTML()}}}}else{D.innerHTML=this.getSWFHTML()}if(!document.embeds[this.getAttribute("id")]&&!window[this.getAttribute("id")]){window[this.getAttribute("id")]=document.getElementById(this.getAttribute("id"))}return true}}};infosoftglobal.FusionChartsUtil.getPlayerVersion=function(){var C=new infosoftglobal.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var A=navigator.plugins["Shockwave Flash"];if(A&&A.description){C=new infosoftglobal.PlayerVersion(A.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var D=1;var B=3;while(D){try{B++;D=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+B);C=new infosoftglobal.PlayerVersion([B,0,0])}catch(E){D=null}}}else{try{var D=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(E){try{var D=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");C=new infosoftglobal.PlayerVersion([6,0,21]);D.AllowScriptAccess="always"}catch(E){if(C.major==6){return C}}try{D=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(E){}}if(D!=null){C=new infosoftglobal.PlayerVersion(D.GetVariable("$version").split(" ")[1].split(","))}}}return C};infosoftglobal.PlayerVersion=function(A){this.major=A[0]!=null?parseInt(A[0]):0;this.minor=A[1]!=null?parseInt(A[1]):0;this.rev=A[2]!=null?parseInt(A[2]):0};infosoftglobal.FusionChartsUtil.cleanupSWFs=function(){var C=document.getElementsByTagName("OBJECT");for(var B=C.length-1;B>=0;B--){C[B].style.display="none";for(var A in C[B]){if(typeof C[B][A]=="function"){C[B][A]=function(){}}}}};if(infosoftglobal.FusionCharts.doPrepUnload){if(!infosoftglobal.unloadSet){infosoftglobal.FusionChartsUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",infosoftglobal.FusionChartsUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",infosoftglobal.FusionChartsUtil.prepUnload);infosoftglobal.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(A){return document.all[A]}}if(Array.prototype.push==null){Array.prototype.push=function(A){this[this.length]=A;return this.length}}infosoftglobal.FusionChartsUtil.getChartObject=function(B){var A=null;if(navigator.appName.indexOf("Microsoft Internet")==-1){if(document.embeds&&document.embeds[B]){A=document.embeds[B]}else{A=window.document[B]}}else{A=window[B]}if(!A){A=document.getElementById(B)}return A};var getChartFromId=infosoftglobal.FusionChartsUtil.getChartObject;var FusionCharts=infosoftglobal.FusionCharts;
/*
 * FusionCharts Export Component JavaScript Library
 * Copyright FusionCharts Technologies LLP
 * @license License Information at <http://www.fusioncharts.com/license>
 *
 * @author FusionCharts Technologies LLP
 * @version: 1.0.3-release
 */
if(typeof FusionCharts==="undefined"){alert("FusionChartsExport: object::FusionCharts was not found. Verify script inclusions.",10901271400);throw"FusionChartsExportComponentFatalError::10901271400"}var _FCEO=function(){_FCEO.initializeComponent(this,arguments)};var FusionChartsExportObject=_FCEO;if(FusionCharts.version&&FusionCharts.version[0]>=3){_FCEO.__global=FusionCharts(["private","LegacyExportComponent"])}_FCEO.version=[1,0,3,"release",362];_FCEO.defaultParameters={id:undefined,swfLocation:undefined,componentAttributes:{width:"120",height:"40",bgColor:"",strictTrigger:"0"},exportAttributes:{},sourceCharts:[],debugMode:false,outerHTML:""};_FCEO.checkFlashVersion=false;_FCEO.debugMode=false;var FC_ExportComponentReady=function(A){setTimeout(function(){_FCEO.flushRack(A)},0);return true};var FC_ExportDataReady=function(A){setTimeout(function(){return _FCEO.relayStream(A)},0)};_FCEO.prototype.Render=function(A){return this.render(A)};_FCEO.prototype.BeginExport=function(){return _FCEO.batchExport(this,this.sourceCharts)};_FCEO.prototype.BeginExportAll=function(){return _FCEO.batchExport(this,_FCEO.probeCharts())};_FCEO.prototype.GetOuterHTML=function(){this.update();return this.outerHTML};_FCEO.prototype.render=function(B){var A=_FCEO.L.get(B);if(!A||!_FCEO.L.isObj(A.innerHTML,"string")){this.trace(_FCEO.R.errContainer,10902091233);return false}this.update();try{this.srcObj.render(A)}catch(C){this.trace(_FCEO.R.errFusion+"\n"+C,10902101448)}return true};_FCEO.prototype.update=function(){_FCEO.updateComponent(this)};_FCEO.prototype.trace=function(B,A){_FCEO.trace(B,A,this.debugMode)};_FCEO.prototype.toString=function(){return"[object "+_FCEO.R.resSig+" #"+this.id+" ]"};_FCEO.streamRack={};_FCEO.flags={c:0};_FCEO.playerVersion={major:0,minor:0,rev:0};try{if(typeof _FCEO.__global==="undefined"){_FCEO.playerVersion=infosoftglobal.FusionChartsUtil.getPlayerVersion()}else{_FCEO.playerVersion=_FCEO.__global.swfobject.getFlashPlayerVersion()}}catch(err){_FCEO.trace("FusionChartsExport: object::Flash Player DetectionError.\n"+err,10902182119)}_FCEO.relayStream=function(B){var A=_FCEO.probeHandler(B);if(A==null){_FCEO.trace(_FCEO.R.errStream,10902041759)}if(!_FCEO.L.isObj(B.parameters.exportParameters)){B.parameters.exportParameters={}}if(!_FCEO.L.isObj(B.parameters.exportParameters.triggerOrdinal,"number")){B.parameters.exportParameters.triggerOrdinal=_FCEO.flags.c++}setTimeout(function(){if(typeof window.FC_ExportReady==="function"){FC_ExportReady(B.meta.DOMId)}},0);if(_FCEO.probeComponent(A)){_FCEO.pushStream(A,[B]);return true}if(!_FCEO.streamRack[A]){_FCEO.streamRack[A]=[]}_FCEO.streamRack[A].push(B);return true};_FCEO.flushRack=function(A){A=_FCEO.probeHandler(A);if(A==null){_FCEO.trace(_FCEO.R.errComponent,10902041939)}if(!_FCEO.probeComponent(A)){_FCEO.trace(_FCEO.R.errComponent,10902041917)}if(!_FCEO.streamRack[A]){return }_FCEO.pushStream(A,_FCEO.streamRack[A]);_FCEO.streamRack[A]=[]};_FCEO.pushStream=function(B,A){return _FCEO.L.get(B).pushData(A)};_FCEO.probeComponent=function(B){if(!B){return false}var A=_FCEO.L.get(B);return A?A.isReady!=null&&A.isReady()==true:false};_FCEO.probeHandler=function(A){if(!A){return null}return _FCEO.L.isString(A)?A:(A.parameters!=null&&_FCEO.L.isString(A.parameters.exportHandler))?A.parameters.exportHandler:null};_FCEO.probeCharts=function(){var A,D,C=[];D=_FCEO.L.tags("object");for(var B=0;B<D.length;B++){A=D[B];if(_FCEO.probeChart(A)){C.push(A)}}D=_FCEO.L.tags("embed");for(B=0;B<D.length;B++){A=D[B];if(A.parentNode!=undefined&&A.parentNode.tagName=="object"){continue}if(_FCEO.probeChart(A)){C.push(A)}}return C};_FCEO.probeChart=function(B){if(B.signature==undefined){return false}var A=B.signature();return(_FCEO.L.isString(A)&&A.indexOf(_FCEO.R.resChartSig)==0)};_FCEO.initializeComponent=function(B,A){if(!A||!A.length||A.length<1){_FCEO.trace(_FCEO.R.errArgs,10902061902)}var E=!_FCEO.L.isString(A[0])&&A.length==1;if(!E&&A.length<2){_FCEO.trace(_FCEO.R.errArgs,10902091732)}var C=0;for(var D in _FCEO.defaultParameters){B[D]=(E?A[0][D]:A[C++])||_FCEO.defaultParameters[D]}if(!_FCEO.L.isString(B.id)||!_FCEO.L.isString(B.swfLocation)){B.trace(_FCEO.R.errArgs,10902091820)}if(_FCEO.playerVersion.major<10){if(_FCEO.checkFlashVersion&&!(B.debugMode||_FCEO.debugMode)){alert(_FCEO.R.msgNoPlayer)}B.trace(_FCEO.R.errPlayer,10902182131)}B.srcObj=new FusionCharts(B.swfLocation,B.id,0,0,B.debugMode)};_FCEO.updateComponent=function(A){if(!A.srcObj){A.trace(_FCEO.R.errFusion,10902220400)}_FCEO.L.sync(A.componentAttributes,A.srcObj.variables||A.srcObj.flashVars);var D;var C=function(E){return !_FCEO.L.isObj((A.srcObj.variables||A.srcObj.flashVars)[E],"undefined")?(A.srcObj.variables||A.srcObj.flashVars)[E]:_FCEO.defaultParameters.componentAttributes[E]};try{(A.srcObj.variables||A.srcObj.flashVars)["generator"]=_FCEO.R.resSig;D=C("width");if(D!=undefined){if(_FCEO.__global){A.srcObj.width=D.toString();A.srcObj.flashVars.width=D.toString()}else{A.srcObj.setAttribute("width",D);A.srcObj.addVariable("width",D)}}D=C("height");if(D!=undefined){if(_FCEO.__global){A.srcObj.height=D.toString();A.srcObj.flashVars.height=D.toString()}else{A.srcObj.setAttribute("height",D);A.srcObj.addVariable("height",D)}}D=C("bgColor");if(D!=undefined){if(A.srcObj.params){A.srcObj.params.bgColor=D}else{A.srcObj.addParam("bgColor",D)}}A.outerHTML=A.srcObj.getSWFHTML()}catch(B){this.trace(_FCEO.R.errFusion+""+B,10902091318)}};_FCEO.batchExport=function(A,G){if(!(G instanceof Array)){A.trace(_FCEO.R.errArgs,10902091853);return[]}var F=[],C=_FCEO.flags.c;_FCEO.flags.c+=G.length;var E=parseInt(A.componentAttributes.strictTrigger||0)==0?function(H){return H}:function(H){H.handlerId=A.id;return H};for(var B=0;B<G.length;B++){var D=_FCEO.L.get(G[B]);if(D==null){A.trace(_FCEO.R.errFusion,10902092026);continue}if(!_FCEO.L.isObj(A.exportAttributes.exportParameters)){A.exportAttributes.exportParameters={}}A.exportAttributes.exportParameters.triggerOrdinal=C++;A.exportAttributes=E(A.exportAttributes);if(D&&D.exportChart){D.exportChart(A.exportAttributes);F.push(D.id)}else{A.trace(_FCEO.R.errFusion+"\nRef: "+D.id,10902092036)}}return F};_FCEO.toString=function(){return"[object "+_FCEO.R.resSig+"]"};_FCEO.trace=function(B,A,C){if(C||_FCEO.debugMode){_FCEO.L.raise(B,A)}};_FCEO.R={errStream:"Inbound stream missing or stream integrity failure.",errComponent:"Export component missing or authentication failure.",errArgs:"Invalid arguments or parameters out of bounds exception.",errContainer:"Invalid container id or HTMLNode missing from DOM.",errFusion:"Error with internal FusionCharts object. Review parameters.",errPlayer:"Incompatible Flash player or Flash player not installed. Flash Player 10 (or above) is needed for Export Component.",msgNoPlayer:"This page contains elements that require the latest version of Flash Player plugin.",resSig:"FusionChartsExportComponent",resChartSig:"FusionCharts/"};_FCEO.L={isIE:navigator.appName=="Microsoft Internet Explorer",isFF:document.getElementById&&!document.all,tags:function(B,A){if(!_FCEO.L.isString(B)){return[]}return(A||document).getElementsByTagName(B)},get:function(B,A){if(!_FCEO.L.isString(B)){return B}return(A||document).getElementById(B)},getNew:function(C){var B=document.createElement(C),A;for(var D=1;c<arguments.length;D++){A=arguments[D].split("=");B.setAttribute(A[0],A[1])}return B},sync:function(B,A){for(var C in B){A[C]=B[C]}},isString:function(A){return typeof (A)=="string"},isObj:function(B,A){return typeof (B)==(A?A:"object")},raise:function(B,A,C){C=C?("# "+C):"";B="[object "+_FCEO.R.resSig+C+"]\n\nError "+A+".\n"+B+"\n\nRefer to documentation.";alert(B);throw B}};Artery.plugin.ChartArea=Ext.extend(Ext.BoxComponent,{initData:null,language:"CH",chartId:undefined,chartType:undefined,debugMode:0,registerWithJS:1,backgroundColor:"#ffffff",scaleMode:"noScale",transparent:true,loadType:"once",getChartId:function(){return this.chartId||(this.chartId="extswf"+(++Ext.Component.AUTO_ID))},getChartType:function(){return this.chartType||"Column3D"},getChartSrc:function(){var C=sys.getContextPath()+"/artery/arteryPlugin/image/chartArea/Charts/";C+=this.getChartType()+".swf";var A=Ext.util.JSON.decode(this.chartCfg);if(A){C+="?"}for(var B in A){C+=B+"="+A[B]+"&"}if(C.indexOf("&")>-1){C=C.substring(0,C.length-1)}return encodeURI(C)},getConfWidth:function(){return this.width||"400px"},getConfHeight:function(){return this.height||"300px"},onRender:function(D,B){this.el=Ext.get(this.id);var A=this.getChartSrc();var F=this.getChartId();var C=new FusionCharts(A,F,this.getConfWidth(),this.getConfHeight(),this.debugMode,this.registerWithJS);C.params.bgColor=this.backgroundColor;C.params.debugMode=this.debugMode;C.params.lang=this.language;C.setTransparent(this.transparent);if((this.loadType==="once")||(this.loadType==="")){this.onDataReady(C,this.initData)}else{if(this.loadType==="ajax"){var E=this;E.reload({},function(G){E.onDataReady(C,G.responseText)})}}},afterRender:function(){var A=Ext.fly(this.getChartId());if(!A){return }A.setWidth(this.el.getComputedWidth());A.setHeight(this.el.getComputedHeight());A.setWidth(this.getConfWidth());A.setHeight(this.getConfHeight())},onDataReady:function(A,B){if(B.length==0&&this.noDataImg){this.el.dom.innerHTML="<img src='"+sys.getContextPath()+this.noDataImg+"' width="+this.getConfWidth()+" height="+this.getConfHeight()+"></img>";return }A.setDataXML(B);A.render(this.el.dom);this.chart=A;this.initAutoUpdate()},initAutoUpdate:function(){if(this.updateTime&&this.updateTime>0&&this.autoUpdater==null){var A=this;this.autoUpdater=setInterval(function(){A.reload()},this.updateTime*1000)}},reload:function(D,A){var B=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadData";var D=Artery.getParams(D||{},this);var C=this;Artery.request({url:B,success:function(E){if(A){A(E)}else{var F=C.chart;F.setDataXML(E.responseText)}},failure:function(){},params:D})},exportChart:function(){var A=document.getElementById(this.chartId);if(A.hasRendered()){A.exportChart()}else{alert("flash尚未生成完毕，请稍后导出")}},stopAutoUpdate:function(){if(this.autoUpdater){clearInterval(this.autoUpdater);this.autoUpdater=null}},setSize:function(A,B){}});Ext.reg("apChartArea",Artery.plugin.ChartArea);Artery.plugin.ImageArea=Ext.extend(Artery.plugin.BaseContainer,{value:null,layout:"auto",icon:null,iconOver:null,onClickEvent:null,initComponent:function(){Artery.plugin.ImageArea.superclass.initComponent.call(this);if(this.items){this.items.each(function(B,A,C){if(B.value==this.value){B.selected=true}},this)}},onRender:function(B,A){Artery.plugin.ImageArea.superclass.onRender.call(this,B,A);if(this.onClickEvent||this.linktoEvent){this.el.on("click",function(C){this.fireEvent("click",this,C)},this);this.el.setStyle("cursor","pointer")}if(this.iconOver){this.el.on("mouseover",function(){this.el.child("img").dom.src=sys.getContextPath()+this.iconOver},this);this.el.on("mouseout",function(){this.el.child("img").dom.src=sys.getContextPath()+this.icon},this)}},click:function(){this.fireEvent("click")},update:function(A){this.items.each(function(C,B,D){if(A.id==C.id){C.select();this.value=C.getValue()}else{C.unselect()}},this)},getValue:function(){return this.value==null?"":this.value},setValue:function(A){this.value=A},changeImage:function(A){this.icon=A;this.el.child("img").dom.src=sys.getContextPath()+A},setTip:function(A){this.el.child("img").dom.title=A},getImageEl:function(){return this.el.child("img")}});Ext.reg("apimagearea",Artery.plugin.ImageArea);Artery.plugin.ImageItem=Ext.extend(Artery.plugin.BaseComponent,{value:null,onClickEvent:null,onRender:function(B,A){Artery.plugin.ImageItem.superclass.onRender.call(this,B,A);this.el.addClassOnOver("imageItem-img-over-cust");this.pitem=Artery.get(this.pItemId);this.initImageEvent();if(this.selected){this.pitem.update(this)}},initImageEvent:function(){this.el.on("click",function(A){this.pitem.update(this);this.fireEvent("click",this)},this)},select:function(){if(this.el){this.el.addClass("imageItem-img-click-cust");this.el.removeClass("imageItem-img-over-cust")}},unselect:function(){if(this.el){this.el.removeClass("imageItem-img-click-cust")}},getValue:function(){return this.value}});Ext.reg("apimageitem",Artery.plugin.ImageItem);Artery.AtyRegionList=[];Artery.initRegion=function(C,A,B){if(Artery.AtyRegionList[C]){return }Artery.AtyRegionList[C]=new Artery.plugin.AtyRegion({regionId:C,position:A,arrowStyle:B})};Artery.plugin.AtyRegion=function(A){Ext.apply(this,A);this.initComponent()};Ext.override(Artery.plugin.AtyRegion,{regionId:null,position:null,el:null,splitEl:null,regionEl:null,miniSplitEl:null,arrowStyle:"",initComponent:function(){this.el=Ext.get(this.regionId);this.splitEl=Ext.get(this.regionId+"-Split");this.regionEl=Ext.get(this.regionId+"-Region");if(this.splitEl){this.splitBar=new Ext.SplitBar(this.splitEl.dom,this.regionEl,this.getSplitPosition());this.miniSplitEl=this.splitEl.child(".x-layout-mini-cust");this.initMiniSplit(this.miniSplitEl,this.regionEl,this.position)}},getSplitPosition:function(){if(this.position=="up"||this.position=="down"){return Ext.SplitBar.VERTICAL}else{Ext.SplitBar.HORIZONTAL}},initMiniSplit:function(B,C,A){if(B==null){return }B.on("click",function(){var D="";if(this.arrowStyle){D="-"+this.arrowStyle}if(C.isDisplayed()){C.setDisplayed(false);if(A=="up"){B.replaceClass("x-layout-mini-top-cust"+D,"x-layout-mini-bottom-cust"+D)}else{if(A=="down"){B.replaceClass("x-layout-mini-bottom-cust"+D,"x-layout-mini-top-cust"+D)}else{if(A=="left"){B.replaceClass("x-layout-mini-left-cust"+D,"x-layout-mini-right-cust"+D)}else{if(A=="right"){B.replaceClass("x-layout-mini-right-cust"+D,"x-layout-mini-left-cust"+D)}}}}}else{C.setDisplayed(true);if(A=="up"){B.replaceClass("x-layout-mini-bottom-cust"+D,"x-layout-mini-top-cust"+D)}else{if(A=="down"){B.replaceClass("x-layout-mini-top-cust"+D,"x-layout-mini-bottom-cust"+D)}else{if(A=="left"){B.replaceClass("x-layout-mini-right-cust"+D,"x-layout-mini-left-cust"+D)}else{if(A=="right"){B.replaceClass("x-layout-mini-left-cust"+D,"x-layout-mini-right-cust"+D)}}}}}},this)}});Artery.plugin.BaseRegion=Ext.extend(Artery.plugin.BasePanel,{regionEl:null,initComponent:function(){Artery.plugin.BaseRegion.superclass.initComponent.call(this);this.regionEl=Ext.get(this.id+"-Region")},expand:function(){this.regionEl.setDisplayed(true)},collapse:function(){this.regionEl.setDisplayed(false)}});Ext.reg("apBaseRegion",Artery.plugin.BaseRegion);Artery.plugin.BaseRegionContainer=Ext.extend(Artery.plugin.BaseContainer,{regionEl:null,initComponent:function(){Artery.plugin.BaseRegionContainer.superclass.initComponent.call(this);this.regionEl=Ext.get(this.id+"-Region")},expand:function(){this.regionEl.setDisplayed(true)},collapse:function(){this.regionEl.setDisplayed(false)}});Ext.reg("apBaseRegionContainer",Artery.plugin.BaseRegionContainer);Ext.override(Ext.layout.BorderLayout.Region,{getCollapsedEl:function(){if(!this.collapsedEl){if(!this.toolTemplate){var B=new Ext.Template('<div class="x-tool x-tool-{id}">&#160;</div>');B.disableFormats=true;B.compile();Ext.layout.BorderLayout.Region.prototype.toolTemplate=B}this.collapsedEl=this.targetEl.createChild({cls:"x-layout-collapsed x-layout-collapsed-"+this.position,id:this.panel.id+"-xcollapsed"});this.collapsedEl.enableDisplayMode("block");if(this.arteryMode&&!this.collapsible){}else{if(this.collapseMode=="mini"){this.collapsedEl.addClass("x-layout-cmini-"+this.position);this.miniCollapsedEl=this.collapsedEl.createChild({cls:"x-layout-mini x-layout-mini-"+this.position,html:"&#160;"});this.miniCollapsedEl.addClassOnOver("x-layout-mini-over");this.collapsedEl.addClassOnOver("x-layout-collapsed-over");this.collapsedEl.on("click",this.onExpandClick,this,{stopEvent:true})}else{if(this.collapsible!==false&&!this.hideCollapseTool){var A=this.toolTemplate.append(this.collapsedEl.dom,{id:"expand-"+this.position},true);A.addClassOnOver("x-tool-expand-"+this.position+"-over");A.on("click",this.onExpandClick,this,{stopEvent:true})}if(this.floatable!==false||this.titleCollapse){this.collapsedEl.addClassOnOver("x-layout-collapsed-over");this.collapsedEl.on("click",this[this.floatable?"collapseClick":"onExpandClick"],this)}}}}return this.collapsedEl},beforeCollapse:function(B,A){this.lastAnim=A;if(this.splitEl){this.splitEl.hide()}if(this.arteryMode&&!this.collapsible){this.getCollapsedEl().hide()}else{this.getCollapsedEl().show()}this.panel.el.setStyle("z-index",100);this.isCollapsed=true;this.layout.layout()},onCollapse:function(A){this.panel.el.setStyle("z-index",1);if(!this.arteryMode||this.collapsible){if(this.lastAnim===false||this.panel.animCollapse===false){this.getCollapsedEl().dom.style.visibility="visible"}else{this.getCollapsedEl().slideIn(this.panel.slideAnchor,{duration:0.2})}}this.state.collapsed=true;this.panel.saveState()},onShow:function(){if(this.isCollapsed){if(!this.arteryMode||this.collapsible){this.getCollapsedEl().show()}}else{if(this.splitEl){this.splitEl.show()}}}});Ext.override(Ext.layout.BorderLayout.SplitRegion,{render:function(A,C){Ext.layout.BorderLayout.SplitRegion.superclass.render.call(this,A,C);var D=this.position;this.splitEl=A.createChild({cls:"x-layout-split x-layout-split-"+D,html:"&#160;",id:this.panel.id+"-xsplit"});if(this.arteryMode&&!this.collapsible){}else{if(this.collapseMode=="mini"){this.miniSplitEl=this.splitEl.createChild({cls:"x-layout-mini x-layout-mini-"+D,html:"&#160;"});this.miniSplitEl.addClassOnOver("x-layout-mini-over");this.miniSplitEl.on("click",this.onCollapseClick,this,{stopEvent:true})}}var B=this.splitSettings[D];this.split=new Ext.SplitBar(this.splitEl.dom,C.el,B.orientation);this.split.tickSize=this.tickSize;this.split.placement=B.placement;this.split.getMaximumSize=this[B.maxFn].createDelegate(this);this.split.minSize=this.minSize||this[B.minProp];this.split.on("beforeapply",this.onSplitMove,this);this.split.useShim=this.useShim===true;this.maxSize=this.maxSize||this[B.maxProp];if(C.hidden){this.splitEl.hide()}if(this.useSplitTips){this.splitEl.dom.title=this.collapsible?this.collapsibleSplitTip:this.splitTip}if(this.collapsible){this.splitEl.on("dblclick",this.onCollapseClick,this)}}});Artery.plugin.FieldSet=Ext.extend(Artery.plugin.BaseContainer,{});Ext.reg("apFieldSet",Artery.plugin.FieldSet);Artery.plugin.TableLayout=Ext.extend(Ext.Container,{initComponent:function(){Artery.plugin.TableLayout.superclass.initComponent.call(this)},onRender:function(B,A){if(!this.el){this.el=Ext.get(this.id);B.appendChild(this.el)}Artery.plugin.TableLayout.superclass.onRender.call(this,B,A)}});Ext.reg("aptablelayout",Artery.plugin.TableLayout);Artery.plugin.DynamicTree=Ext.extend(Ext.tree.TreePanel,{autoScroll:false,border:false,rootVisible:false,allowDomMove:false,data:null,initComponent:function(){this.loader=new Ext.tree.TreeLoader({itemId:this.id,dataUrl:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadTreeNode"});this.loader.on("beforeload",this.onBeforeLoad,this);this.loader.on("load",this.onLoadHandler,this);this.on("click",this.onNodeClickHandler);this.root={text:"根",cid:"root",type:"root"};Artery.plugin.DynamicTree.superclass.initComponent.call(this)},convertData:function(C){if(C.href){C.link=C.href;delete C.href}if(C.name){C.text=C.name}if(C.children){var B=C.children.length;for(var A=0;A<B;A++){this.convertData(C.children[A])}}},onRender:function(B,A){Artery.plugin.BasePanel.prototype.onRender.call(this,B,A);this.el.addClass("x-tree");this.innerCt=this.body.createChild({tag:"ul",cls:"x-tree-root-ct "+(this.useArrows?"x-tree-arrows":this.lines?"x-tree-lines":"x-tree-no-lines")})},afterRender:function(){Ext.tree.TreePanel.superclass.afterRender.call(this);this.root.render();if(!this.rootVisible){this.root.renderChildren();if(this.expandTree){this.doExpandTree()}}},onBeforeLoad:function(A,B){A.baseParams.formType=Artery.params.formType;A.baseParams.node_type=B.attributes.type;A.baseParams.node_cid=B.attributes.cid;A.baseParams.node_name=B.text;A.baseParams.node_leaf=B.isLeaf()+"";A.baseParams.node_iconId=B.attributes.iconId;if(B.attributes.link){A.baseParams.node_link=B.attributes.link}var C=B;var D="";while(C){if(C.parentNode){D="/"+C.text+D}C=C.parentNode}A.baseParams.node_path=D;Ext.applyIf(A.baseParams,Artery.getParams({},this));A.baseParams.custParams=Ext.encode(this.custParams);Ext.apply(A.baseParams,this.reloadParams);if(this.onBeforeLoadEvent){Artery.regItemEvent(this,"onBeforeLoadEvent",null,{loader:A,node:B})}},onNodeClickHandler:function(B){if(B.disabled===true){return }this.lastClickNode=B;if(B.attributes.link&&this.operAreaId){var A={url:B.attributes.link,target:this.operAreaId};Ext.getBlankWindow(A)}else{if(this.onNodeClick){this.onNodeClick(B)}}},onLoadHandler:function(H,C){var A=C.childNodes;if(A==null||A.length==0){return }var I=null;for(var E=0;E<A.length;E++){if(A[E].attributes.selected){A[E].fireEvent("click",A[E])}if(I==null&&!A[E].leaf&&A[E].attributes.children!=null){var G=A[E].attributes.children;var B=G.length;for(var D=0;D<B;D++){I=this.findSelectedNodePath(G[D]);if(I!=null){var F=A[E].attributes.cid;if(!F){F=Ext.id();A[E].attributes.cid=F}I.push(F);break}}}}if(I!=null){this.expandNode(I.reverse().join(","))}},findSelectedNodePath:function(C){var F=C.cid;if(!F){F=Ext.id();C.cid=F}if(C.selected){var D=[];D.push(F);return D}var D;if(!C.leaf&&C.children){var E=C.children;var B=E.length;for(var A=0;A<B;A++){D=this.findSelectedNodePath(E[A]);if(D!=null){D.push(F);return D}}}},reloadCallBack:null,reloadPath:null,reload:function(B,A){if(B){if(B.params){this.reloadParams=B.params;if(B.callback){this.reloadCallBack=B.callback}}else{if(B.callback){this.reloadCallBack=B.callback}else{this.reloadCallBack=B}}}this.reloadParams=this.reloadParams||{};var C=this.getSelectionModel().getSelectedNode();if(C&&C.attributes&&C.attributes.selected){this.reloadPath=C.getPath("cid");if(A){delete C.attributes.selected}}this.getLoader().load(this.root,this.loadComplete,this)},loadComplete:function(){if(this.reloadPath){this.selectPath(this.reloadPath,"cid")}if(this.reloadCallBack){this.reloadCallBack.call(this);this.reloadCallBack=null}if(this.reloadPath){this.reloadPath=null}},doExpandTree:function(A){if(!A){A=this.root}if(this.expandLevel==null||this.expandLevel<=0){A.expand(true)}else{function B(C){if(C.level>0&&!C.isLeaf()){C.expand(false,false,function(){C.eachChild(function(D){D.level=C.level-1;B(D)})})}}A.level=this.expandLevel+1;B(A)}},getClickNode:function(){return this.lastClickNode},clearClickNode:function(){if(this.lastClickNode){try{this.lastClickNode.unselect()}catch(A){}delete this.lastClickNode}},search:function(B){if(Ext.isEmpty(B)){return }var A=Artery.getParams({searchText:B},this);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=searchNode",success:function(C,D){var E=Ext.decode(C.responseText);if(E.find){this.expandNode(E.nodePath)}},scope:this,params:A})},expandNode:function(C,E){var A=this;var D=C.split(",");var B=function(G){if(D.length==1){var H=G.findChild("cid",D.shift());var F=false;if(H){F=true;H.fireEvent("click",H)}if(E){E.call(this,F)}return }var I=G.findChild("cid",D.shift());if(I==null){return }I.expand(false,false,B)};if(this.loader.baseParams.filter){delete this.loader.baseParams.filter;this.root.reload(function(){A.root.expand(false,false,B)})}else{this.root.expand(false,false,B)}},filter:function(A){if(Ext.isEmpty(A)){delete this.loader.baseParams.filter}else{this.loader.baseParams.filter=A;this.root.reload()}}});Ext.reg("apDynamictree",Artery.plugin.DynamicTree);Artery.plugin.ListNav=Ext.extend(Artery.plugin.BasePanel,{autoScroll:true,border:false,layout:"aplistnavlayout",navTableEl:null,expandMode:null,initComponent:function(){this.layoutConfig={expandNode:this.expandNode,expandMode:this.expandMode,expandTree:this.expandList};Artery.plugin.ListNav.superclass.initComponent.call(this)},onRender:function(A,B){Artery.plugin.ListNav.superclass.onRender.call(this,A,B);this.navTableEl=this.el.child(".nav-table")},getActiveItem:function(){return this.layout.activeItem},deselect:function(){var A=this.getActiveItem();if(A){A.deselect()}},select:function(A){Artery.plugin.ListItemMgr.toggle(Artery.get(A))},expand:function(C){var B=Artery.get(C);var A=new Array();while("apListCatalog"==B.xtype||"apListItem"==B.xtype){A.push(B);B=B.ownerCt}if(B!==this){return }B=A.pop();while(B!==undefined){if("apListCatalog"==B.xtype){B.header.dom.click()}if("apListItem"==B.xtype){B.el.dom.click()}B=A.pop()}}});Ext.reg("apListNav",Artery.plugin.ListNav);Artery.plugin.ListItem=Ext.extend(Ext.Component,{listItem:true,onDeselectEvent:null,navGroup:null,onRender:function(A,B){this.el=Ext.get(this.id);this.el.on("click",this.onClick,this);Artery.plugin.ListItemMgr.register(this);this.el.addClassOnOver("nav-item-over")},getSelectEl:function(){return this.el},onClick:function(){Artery.plugin.ListItemMgr.toggle(this);if(this.linktoEvent){Artery.openForm(this.linktoEvent)}if(this.clickEvent){this.clickEvent()}},deselect:function(){this.getSelectEl().removeClass("nav-item-selected");this.hideSep();if(this.onDeselectEvent){Artery.regItemEvent(this,"onDeselectEvent","onDeselectServer")}},hideSep:function(){if(this.tipSupport){var A=Ext.get(this.navGroup+"_sep");A.hide()}},select:function(){this.getSelectEl().addClass("nav-item-selected");this.showSep()},showSep:function(){if(this.tipSupport){var A=Ext.get(this.navGroup+"_sep");A.show();A.alignTo(this.el,"tl-tr",[-1,0])}},hide:function(){this.el.parent("tr").setDisplayed(false)},show:function(){this.el.parent("tr").setDisplayed(true)}});Ext.reg("apListItem",Artery.plugin.ListItem);Artery.plugin.ListCatalog=Ext.extend(Artery.plugin.BasePanel,{collapsible:true,titleCollapse:false,layout:"atylayout",onlyGroup:false,animCollapse:false,pItemId:null,navGroup:null,initComponent:function(){if(this.onlyGroup){this.collapsible=false}else{if(!this.navGroup){this.titleCollapse=true}}Artery.plugin.ListCatalog.superclass.initComponent.call(this)},afterExpand:function(){Artery.plugin.ListCatalog.superclass.afterExpand.call(this);var A=Artery.get(this.pItemId);if(A!=null&&A.expandMode=="fillExpand"){this.el.parent().dom.style.height="100%";A.navTableEl.dom.style.height="100%"}},afterCollapse:function(){this[this.collapseEl].setStyle("display","none");Artery.plugin.ListCatalog.superclass.afterCollapse.call(this);var A=Artery.get(this.pItemId);if(A!=null&&A.expandMode=="fillExpand"){this.el.parent().dom.style.height="";A.navTableEl.dom.style.height=""}},render:function(){Ext.Container.superclass.render.apply(this,arguments);if(this.layout){if(Ext.isObject(this.layout)&&!this.layout.layout){this.layoutConfig=this.layout;this.layout=this.layoutConfig.type}if(typeof this.layout=="string"){this.layout=new Ext.Container.LAYOUTS[this.layout.toLowerCase()](this.layoutConfig)}this.setLayout(this.layout);if(this.activeItem!==undefined){var A=this.activeItem;delete this.activeItem;this.layout.setActiveItem(A)}}this.doLayout(false,true);if(this.monitorResize===true){Ext.EventManager.onWindowResize(this.doLayout,this,[false])}},afterRender:function(){Artery.plugin.ListCatalog.superclass.afterRender.call(this);if(this.onlyGroup){return }if(this.navGroup){Artery.plugin.ListItemMgr.register(this);if(this.header){this.header.on("click",function(){Artery.plugin.ListItemMgr.toggle(this)},this);this.header.addClassOnOver("nav-item-over");this.header.addClassOnOver("nav-item-head-over")}}if(this.onClickClient){this.el.on("click",this.onClick,this)}},getSelectEl:function(){return this.header},onClick:function(){Artery.regItemEvent(this,"onClickClient","onClickServer",null)},deselect:function(){if(this.getSelectEl()){if(this.getSelectEl().hasClass("nav-item-selected")){this.getSelectEl().removeClass("nav-item-selected");this.getSelectEl().removeClass("nav-item-head-selected");if(this.onDeselectEvent){Artery.regItemEvent(this,"onDeselectEvent","onDeselectServer")}}}var A=Artery.get(this.navGroup).getLayout();var B=A.activeItem;if(B&&!this.isChild(this,B)){if(A.expandMode=="multeExpand"){}else{this.collapse()}}},select:function(){if(this.getSelectEl()){this.getSelectEl().addClass("nav-item-selected");this.getSelectEl().addClass("nav-item-head-selected");if(this.collapsed){this.expand()}else{this.collapse()}}else{this.expand()}},isChild:function(C,D){var B=false;if(D&&C){if(C.items){for(var A=0;A<C.items.length;A++){B=this.isChild(C.items.get(A),D);if(B){break}}}else{if(C.listItem){if(C.id==D.id){B=true}}}}return B}});Ext.reg("apListCatalog",Artery.plugin.ListCatalog);Artery.plugin.ListNavLayout=Ext.extend(Ext.layout.ContainerLayout,{expandNode:null,expandMode:"singleExpand",expandTree:true,renderAll:function(E,G){var J=null;var A=null;if(this.expandNode){var H=E.items.items;for(var D=0,F=H.length;D<F;D++){var I=H[D];if(I.getId()==this.expandNode){A=I;break}if(I.xtype=="apListCatalog"&&I.items&&I.items.items){var C=I.items.items;for(var B=0;B<C.length;B++){if(C[B].getId()==this.expandNode){A=C[B];J=I;break}}if(A){break}}}}Artery.plugin.ListNavLayout.superclass.renderAll.apply(this,arguments);if(J){J.expand()}if(A||this.activeItem){Artery.plugin.ListItemMgr.toggle(A||this.activeItem)}},renderItem:function(B){if(this.expandTree){if(this.expandMode=="singleExpand"||this.expandMode=="fillExpand"){if(!this.activeItem&&!B.listItem){B.collapsed=true;this.activeItem=B}else{if(this.activeItem&&this.activeItem!=B){B.collapsed=true}}}}else{B.collapsed=true}if(B.onlyGroup||!B.items){B.collapsible=false;B.collapsed=false}var A=Ext.getDom(B.id).parentNode;Artery.plugin.ListNavLayout.superclass.renderItem.apply(this,[B,null,A])}});Ext.Container.LAYOUTS.aplistnavlayout=Artery.plugin.ListNavLayout;Artery.plugin.ListItemMgr=function(){var A={};function B(F){if((!Artery.get(F.navGroup).onlyItem&&"apListCatalog"==F.xtype)||"apListItem"==F.xtype||F==Artery.get(F.navGroup).getLayout().activeItem){Artery.get(F.navGroup).getLayout().activeItem=F;var E=A[F.navGroup];if(!(E&&E.length)){return }for(var D=0,C=E.length;D<C;D++){E[D].deselect()}}F.select()}return{register:function(D){if(!D.navGroup){return }var C=A[D.navGroup];if(!C){C=A[D.navGroup]=[]}C.push(D)},unregister:function(D){if(!D.navGroup){return }var C=A[D.navGroup];if(C){C.remove(D)}},toggle:function(C){B(C)}}}();Artery.plugin.TreeNav=Ext.extend(Ext.tree.TreePanel,{expandTree:false,rootVisible:false,autoScroll:false,border:false,allowDomMove:false,loader:new Ext.tree.TreeLoader({}),afterRender:function(){Ext.tree.TreePanel.superclass.afterRender.call(this);this.root.render();if(this.expandTree){var A=this;var B=function(){A.doExpandTree(A.root)};B.defer(100)}else{if(!this.rootVisible){this.root.renderChildren()}}},doExpandTree:function(A){if(this.expandLevel==null||this.expandLevel<=0){A.expand(true)}else{function B(C){if(C.level>0&&!C.isLeaf()){C.expand(false,false,function(){C.eachChild(function(D){D.level=C.level-1;B(D)})})}}A.level=this.expandLevel+1;B(A)}},resetNodeText:function(A){var C=this.root;var B=function(D){if(D.id&&A[D.id]){D.setText(A[D.id])}D.eachChild(B)};C.eachChild(B)},reloadAllCount:function(){var A=this.getParams();Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=reloadCount",success:function(B,C){var D=Ext.decode(B.responseText);this.resetNodeText(D)},params:A,scope:this})},reloadCount:function(A){if(Ext.isEmpty(A)){A=[]}var B=this.getParams();B.nodes=Ext.encode(A);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=reloadCount",success:function(C,D){var E=Ext.decode(C.responseText);this.resetNodeText(E)},params:B,scope:this})},getParams:function(){var A=Artery.getParams({},this);return A},onNodeClick:function(C){var A=C.attributes.linktoEvent;var B=C.attributes.clickEvent;if(A){A=Ext.decode(A);Artery.openForm(A)}else{if(B){B.call(C,C)}}},onRender:function(B,A){this.on("click",this.onNodeClick);Artery.plugin.BasePanel.prototype.onRender.call(this,B,A);this.innerCt=this.body.createChild({tag:"ul",cls:"x-tree-root-ct "+(this.useArrows?"x-tree-arrows":this.lines?"x-tree-lines":"x-tree-no-lines")})}});Ext.reg("apTreeNav",Artery.plugin.TreeNav);Artery.plugin.Paingbar1=Ext.extend(Artery.plugin.BasePagingbar,{rowCount:null,rowsPerPage:null,currPageNo:null,totalPageNo:null,pagePerNext:10,onSearchEvent:null,splitPage:true,isShowPageInfo:false,isShowFirstLast:false,pageInfoAlign:"right",initComponent:function(){Artery.plugin.Paingbar1.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.Paingbar1.superclass.onRender.call(this,B,A);this.renderPage()},getCurrentPageNo:function(){return this.currPageNo},getRowsPerPage:function(){return this.rowsPerPage},getRowCount:function(){return this.rowCount},isSplitPage:function(){return this.splitPage},getPageInfo:function(){return{rowCount:this.rowCount,rowsPerPage:this.rowsPerPage,currPageNo:this.currPageNo,pagePerNext:this.pagePerNext,splitPage:this.splitPage}},renderPage:function(){var B=this;this.el.update("");var H=(this.isPageSplit==false||this.rowCount==0||this.rowsPerPage==0)?1:Math.ceil(this.rowCount/this.rowsPerPage);this.totalPageNo=H;if(this.isOnePageHideBar&&this.totalPageNo==1){this.el.addClass("x-hide-display")}else{if(this.el.hasClass("x-hide-display")){this.el.removeClass("x-hide-display")}}if(this.isPageSplit==false||this.currPageNo==null){this.currPageNo=1}this.pagePerNext=parseInt(this.pagePerNext);var G;var E=this.currPageNo%this.pagePerNext;var F=this.currPageNo/this.pagePerNext;F=Math.floor(E==0?F-1:F)*this.pagePerNext;if(this.isShowPageInfo&&this.pageInfoAlign=="left"){this.renderPageInfo()}if(this.isShowFirstLast){G=this.el.createChild({tag:"span",cls:"x-pagingbar1-firstPage x-pagingbar-button x-theme-button-cookie",html:'<TABLE style="WIDTH: auto" class="x-btn" cellSpacing=0 cellPadding=0><TR><TD class=x-btn-left><I class="x-btn-left-text">&nbsp;</I></TD><TD class=x-btn-center><button class="x-btn-button x-btn-text" style="width:40px;PADDING-TOP: 2px">首页</button></TD><TD class=x-btn-right><I class="x-btn-right-text">&nbsp;</I></TD></TR></TABLE>'});G.child("table").addClassOnOver("x-btn-over");if(this.currPageNo!=1&&this.splitPage){G.on("click",function(){this.search({currPageNo:1})},this)}else{G.addClass("x-pagingbar-disable");G.child("table").dom.disabled="disabled"}}G=this.el.createChild({tag:"span",cls:"x-pagingbar1-prePage x-pagingbar-button x-theme-button-cookie",html:'<TABLE style="WIDTH: auto" class="x-btn" cellSpacing=0 cellPadding=0><TR><TD class=x-btn-left><I class="x-btn-left-text">&nbsp;</I></TD><TD class=x-btn-center><button class="x-btn-button x-btn-text" style="width:40px;PADDING-TOP: 2px">前一页</button></TD><TD class=x-btn-right><I class="x-btn-right-text">&nbsp;</I></TD></TR></TABLE>'});G.child("table").addClassOnOver("x-btn-over");if(this.currPageNo!=1&&this.splitPage){G.on("click",function(){this.search({currPageNo:parseInt(this.currPageNo)-1})},this)}else{G.addClass("x-pagingbar-disable");G.child("table").dom.disabled="disabled"}G=this.el.createChild({tag:"span",cls:"x-pagingbar1-num",html:"<<"});if(this.currPageNo!=1&&this.currPageNo>this.pagePerNext&&this.splitPage){G.on("click",function(){this.search({currPageNo:F-this.pagePerNext+1})},this)}else{G.addClass("x-hidden")}var D=F+1;var A=F;if(A+this.pagePerNext>H){A+=H%this.pagePerNext}else{A+=this.pagePerNext}if(!this.splitPage){D=1;A=1;this.currPageNo=1}for(var C=D;C<=A;C++){if(this.currPageNo==C){G=this.el.createChild({tag:"span",cls:"x-pagingbar1-num x-pagingbar1-num-current",html:C})}else{G=this.el.createChild({tag:"span",cls:"x-pagingbar1-num",html:C});G.page=C;G.on("click",function(){B.search({currPageNo:this.page})})}}G=this.el.createChild({tag:"span",cls:"x-pagingbar1-num",html:">>"});if(F+this.pagePerNext<H&&this.splitPage){G.on("click",function(){this.search({currPageNo:F+parseInt(this.pagePerNext)+1})},this)}else{G.addClass("x-hidden")}G=this.el.createChild({tag:"span",cls:"x-pagingbar1-nextPage x-pagingbar-button x-theme-button-cookie",html:'<TABLE style="WIDTH: auto" class="x-btn" cellSpacing=0 cellPadding=0><TR><TD class=x-btn-left><I class="x-btn-left-text">&nbsp;</I></TD><TD class=x-btn-center><button class="x-btn-button x-btn-text" style="width:40px;PADDING-TOP: 2px">后一页</button></TD><TD class=x-btn-right><I class="x-btn-right-text">&nbsp;</I></TD></TR></TABLE>'});G.child("table").addClassOnOver("x-btn-over");if(this.currPageNo<H&&this.splitPage){G.on("click",function(){this.search({currPageNo:parseInt(this.currPageNo)+1})},this)}else{G.addClass("x-pagingbar-disable");G.child("table").dom.disabled="disabled"}if(this.isShowFirstLast){G=this.el.createChild({tag:"span",cls:"x-pagingbar1-lastPage x-pagingbar-button x-theme-button-cookie",html:'<TABLE style="WIDTH: auto" class="x-btn" cellSpacing=0 cellPadding=0><TR><TD class=x-btn-left><I class="x-btn-left-text">&nbsp;</I></TD><TD class=x-btn-center><button class="x-btn-button x-btn-text" style="width:40px;PADDING-TOP: 2px">尾页</button></TD><TD class=x-btn-right><I class="x-btn-right-text">&nbsp;</I></TD></TR></TABLE>'});G.child("table").addClassOnOver("x-btn-over");if(this.currPageNo<this.totalPageNo&&this.splitPage){G.on("click",function(){this.search({currPageNo:parseInt(this.totalPageNo)})},this)}else{G.addClass("x-pagingbar-disable");G.child("table").dom.disabled="disabled"}}if(this.isShowPageInfo&&this.pageInfoAlign=="right"){this.renderPageInfo()}},renderPageInfo:function(){var C={};if(Ext.isEmpty(this.rowCount)||this.rowCount==0){C.rowCount=0;C.currentRowCount=0;C.totalPageNo=0}else{C.rowCount=this.rowCount;var B=(this.currPageNo-1)*this.rowsPerPage+1;var A=this.currPageNo*this.rowsPerPage;if(A>this.rowCount){A=this.rowCount}C.currentRowCount=B+"-"+A;C.totalPageNo=this.totalPageNo}this.pageInfoTpl.append(this.el,C)},search:function(A){this.refresh(A);this.doSearch(A)},doSearch:function(A){if(A==null){A={}}var C={};var B=A.currPageNo;if(B==null){B=this.currPageNo}C.start=(B-1)*this.rowsPerPage;C.limit=this.rowsPerPage;C.isPageSplit=this.isPageSplit;Ext.apply(C,A);Artery.regItemEvent(this,"onSearchEvent",null,{params:C})},refresh:function(A){if(A){Ext.apply(this,A)}this.renderPage()}});Ext.reg("apPagingbar1",Artery.plugin.Paingbar1);Artery.plugin.Pagingbar2=Ext.extend(Artery.plugin.BasePagingbar,{rowCount:null,rowsPerPage:null,currPageNo:null,totalPageNo:null,pagePerNext:5,onSearchEvent:null,splitPage:true,isShowPageInfo:false,pageInfoAlign:"right",initComponent:function(){Artery.plugin.Pagingbar2.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.Pagingbar2.superclass.onRender.call(this,B,A);this.renderPage()},getCurrentPageNo:function(){return this.currPageNo},getRowsPerPage:function(){return this.rowsPerPage},getRowCount:function(){return this.rowCount},isSplitPage:function(){return this.splitPage},getPageInfo:function(){return{rowCount:this.rowCount,rowsPerPage:this.rowsPerPage,currPageNo:this.currPageNo,pagePerNext:this.pagePerNext,splitPage:this.splitPage}},renderPage:function(){this.el.update("");var D=(this.isPageSplit==false||this.rowCount==0||this.rowsPerPage==0)?1:Math.ceil(this.rowCount/this.rowsPerPage);this.totalPageNo=D;if(this.isOnePageHideBar&&this.totalPageNo==1){this.el.addClass("x-hide-display")}else{if(this.el.hasClass("x-hide-display")){this.el.removeClass("x-hide-display")}}if(this.isPageSplit==false||this.currPageNo==null){this.currPageNo=1}this.pagePerNext=parseInt(this.pagePerNext);if(typeof (this.currPageNo)=="string"){this.currPageNo=parseInt(this.currPageNo)}var C;if(this.isShowPageInfo&&this.pageInfoAlign=="left"){this.renderPageInfo()}C=this.el.createChild({tag:"span",cls:"x-pagingbar2-btn",html:"<上一页"});if(this.currPageNo!=1&&this.splitPage){C.on("click",function(){this.search({currPageNo:parseInt(this.currPageNo)-1})},this)}else{C.addClass("x-pagingbar2-btnDisabled")}if(this.pagePerNext%2!=0){if(D<=this.pagePerNext+1){this.addPageNumbers(1,D)}else{if(this.currPageNo<=(this.pagePerNext-1)/2+1){this.addPageNumbers(1,this.pagePerNext);this.addEllipsis();this.addPageNumbers(D,D)}else{if(this.currPageNo>=D-(this.pagePerNext-1)/2){this.addPageNumbers(1,1);this.addEllipsis();this.addPageNumbers(D-this.pagePerNext+1,D)}else{var B=this.currPageNo-(this.pagePerNext-1)/2;var A=this.currPageNo+(this.pagePerNext-1)/2;this.addPageNumbers(1,1);if(B>2){this.addEllipsis()}this.addPageNumbers(B,A);if(A<D-1){this.addEllipsis()}this.addPageNumbers(D,D)}}}}else{if(D<=this.pagePerNext+1){this.addPageNumbers(1,D)}else{if(this.currPageNo<=this.pagePerNext/2){this.addPageNumbers(1,this.pagePerNext);this.addEllipsis();this.addPageNumbers(D,D)}else{if(this.currPageNo>=D-this.pagePerNext/2){this.addPageNumbers(1,1);this.addEllipsis();this.addPageNumbers(D-this.pagePerNext+1,D)}else{var B=this.currPageNo-this.pagePerNext/2+1;var A=this.currPageNo+this.pagePerNext/2;this.addPageNumbers(1,1);if(B>2){this.addEllipsis()}this.addPageNumbers(B,A);if(A<D-1){this.addEllipsis()}this.addPageNumbers(D,D)}}}}C=this.el.createChild({tag:"span",cls:"x-pagingbar2-btn",html:"下一页>"});if(this.currPageNo<D&&this.splitPage){C.on("click",function(){this.search({currPageNo:parseInt(this.currPageNo)+1})},this)}else{C.addClass("x-pagingbar2-btnDisabled")}if(this.isShowPageInfo&&this.pageInfoAlign=="right"){this.renderPageInfo()}},addPageNumbers:function(D,A){var B=this;var E=null;for(var C=D;C<=A;C++){if(this.currPageNo==C){E=this.el.createChild({tag:"span",cls:"x-pagingbar2-num x-pagingbar2-num-current",html:C})}else{E=this.el.createChild({tag:"span",cls:"x-pagingbar2-num",html:C});E.page=C;E.on("click",function(){B.search({currPageNo:this.page})})}}},addEllipsis:function(){var A=this.el.createChild({tag:"span",cls:"x-pagingbar2-ellipsis",html:"..."})},renderPageInfo:function(){var C={};if(Ext.isEmpty(this.rowCount)||this.rowCount==0){C.rowCount=0;C.currentRowCount=0;C.totalPageNo=0}else{C.rowCount=this.rowCount;var B=(this.currPageNo-1)*this.rowsPerPage+1;var A=this.currPageNo*this.rowsPerPage;if(A>this.rowCount){A=this.rowCount}C.currentRowCount=B+"-"+A;C.totalPageNo=this.totalPageNo}C.pageInfoClass="x-pagingbar2-pageInfo";C.pageInfoTextClass="x-pagingbar2-pageInfo-text";this.pageInfoTpl.append(this.el,C)},search:function(A){this.refresh(A);this.doSearch(A)},doSearch:function(A){if(A==null){A={}}var C={};var B=A.currPageNo;if(B==null){B=this.currPageNo}C.start=(B-1)*this.rowsPerPage;C.limit=this.rowsPerPage;C.isPageSplit=this.isPageSplit;Ext.apply(C,A);Artery.regItemEvent(this,"onSearchEvent",null,{params:C})},refresh:function(A){if(A){Ext.apply(this,A)}this.renderPage()}});Ext.reg("apPagingbar2",Artery.plugin.Pagingbar2);Artery.plugin.RptArea=Ext.extend(Artery.plugin.BasePanel,{reportId:null,extParams:null,exportExcelTypte:null,outerParams:null,conditionContainer:null,resultContainer:null,pagingbarMaxPage:3000,initComponent:function(){Artery.plugin.RptArea.superclass.initComponent.call(this);this.extParams={};this.outerParams={}},onRender:function(B,A){Artery.plugin.RptArea.superclass.onRender.call(this,B,A);this.conditionContainer=Ext.get(this.id+"_condition_area");this.resultContainer=Ext.get(this.id+"_result_area");this.updateReport(this.reportData);if(this.reportData.timeRefresh!=0){this.runner=new Ext.util.TaskRunner();this.runner.start({run:this.run,interval:parseInt(this.reportData.timeRefresh+"000"),scope:this})}},toggleCondition:function(){if(this.conditionContainer.isDisplayed()){this.conditionContainer.setDisplayed(false)}else{this.conditionContainer.setDisplayed(true)}},updateReport:function(reportData){if(reportData.css){try{var css=document.getElementById("reportStyle");css.innerHTML=reportData.css}catch(e){}}this.cacheFileId=reportData.cacheFileId;if(reportData.tableHtml!=null){this.resultContainer.update(this.getBodyContent(reportData));Ext.select(".rpt-script").each(function(el,cmp,idx){eval(el.dom.text)})}},getBodyContent:function(A){if(A.paramReady){return A.tableHtml+A.pageHtml}else{return""}},run:function(cfg){if(cfg==null||cfg.showTip!==false){Artery.loading()}Artery.request({url:sys.getContextPath()+"/artery/report/dealParse.do?action=parse",scope:this,params:this.getParams(),success:function(response,options){var reportData=response.responseText;if(reportData!=null){reportData=Ext.decode(reportData)}if(reportData.params){this.exportExcelTypte=reportData.params.exportType;Artery.params.totalCount=reportData.params.totalCount}this.updateReport(reportData);if(cfg==null||cfg.showTip!==false){Artery.loadTrue("操作成功，请继续！");Ext.select(".rpt-script").each(function(el,cmp,idx){window.eval(el.dom.innerHTML)})}if(cfg!=null&&cfg.callback){cfg.callback.call(cfg.scope?cfg.scope:this)}},failure:function(response,options){Artery.loadFalse("操作失败，请检查！")}})},getParams:function(){var A={};if(this.page){A.page=this.page}if(this.pageCount){A.pageCount=this.pageCount}if(this.orderName){A.orderName=this.orderName}if(this.orderSort){A.orderSort=this.orderSort}if(this.autoJust){A.autoJust=this.autoJust}var C=this.conditionArea;Ext.apply(A,C!=null?C.getForm().getValues():{});Ext.apply(A,this.outerParams);var B=Artery.getParams(A,this);B.resultFormId=B.formid;B.formid=this.reportId;B.resultId=this.id;Ext.apply(B,this.extParams);this.extParams={};return B},setExtParams:function(A){Ext.apply(this.extParams,A)},search:function(A){if(A){this.outerParams=A}this.page=1;this.run(A)},searchPage:function(D,B,C,A){if(!this.isValidData(D)||!this.isValidData(B)){return }if(parseInt(D)>parseInt(A)){alert("最大可输入的页数为"+A+"页，请重新输入！");return }if(parseInt(B)>this.pagingbarMaxPage){alert("最大可输入的记录数为"+this.pagingbarMaxPage+"，请重新输入！");return }this.page=D;this.pageCount=parseInt(B);this.run()},searchOrder:function(A){this.orderName=A;if(this.orderSort==null){this.orderSort="desc"}else{this.orderSort=this.orderSort.toggle("asc","desc")}this.run()},linkto:function(A){Artery.parseWinCfg(A);if(!A.target){A.target="_blank"}Artery.openForm(A)},reload:function(){this.run()},autoRow:function(A){this.autoJust="row";this.setExtParams({loadFromCache:true});this.run(A)},autoCol:function(A){this.autoJust="col";this.setExtParams({loadFromCache:true});this.run(A)},autoRecover:function(A){this.autoJust="no";this.setExtParams({loadFromCache:true});this.run(A)},exportExcelWin:function(){this.exportExcel({exportExcelOcx:true})},exportAllExcelWin:function(){this.exportAllExcel({exportExcelOcx:true})},prepareExportExcelParams:function(A){var B=this.getTableScales();B.exportType=EXPORT_EXCEL;B.exportAction="exportExcel";B.loadFromCache=true;if(A&&A.exportName!=null){B.exportName=A.exportName}else{B.exportName=this.exportName}if(Ext.isTrue(Artery.params.exportExcelOcx)){B.exportExcelOcx=true}if(A){Ext.apply(B,A)}this.setExtParams(B)},exportExcel:function(A){this.prepareExportExcelParams(A);var E=[];if(A&&A.multi){var C=A.multi.length;for(var B=0;B<C;B++){Artery.get(A.multi[B]).prepareExportExcelParams();var D=Artery.get(A.multi[B]).getParams();E.push(D)}this.extParams.multiExport=Artery.escape(Ext.encode(E))}this._export(A)},exportAllExcel:function(A){var B=this.getTableScales();B.page=1;B.pageCount=0;B.exportAll=true;B.exportAction="exportExcel";if(A&&A.exportName!=null){B.exportName=A.exportName}else{B.exportName=this.exportName}if(Ext.isTrue(Artery.params.exportExcelOcx)){B.exportExcelOcx=true}if(A){Ext.apply(B,A)}this.setExtParams(B);this._export(A)},exportPdf:function(A){var B=this.getTableScales();B.exportType=EXPORT_PDF;B.exportAction="exportPdf";B.loadFromCache=true;if(A&&A.exportName!=null){B.exportName=A.exportName}else{B.exportName=this.exportName}this.setExtParams(B);this._export(A)},exportAllPdf:function(A){var B=this.getTableScales();B.exportType=EXPORT_PDF;B.page=1;B.pageCount=0;B.exportAll=true;B.exportAction="exportPdf";if(A&&A.exportName!=null){B.exportName=A.exportName}else{B.exportName=this.exportName}this.setExtParams(B);this._export(A)},exportFusImg:function(A){Ext.select(".FusionCharts",false,this.el.dom).each(function(G,H,E){var F=document.getElementById(G.dom.id);if(F){if(F.hasRendered()){F.exportChart()}}});if(A&&A.multi){var D=A.multi.length;for(var B=0;B<D;B++){var C=Artery.get(A.multi[B]);Ext.select(".FusionCharts",false,C.el.dom).each(function(G,H,E){var F=document.getElementById(G.dom.id);if(F){if(F.hasRendered()){F.exportChart()}}})}}},_export:function(A){this.exportFusImg();if(!this.isConditionValid()){return }var E=this.getParams();Ext.apply(E,this.param);if(Ext.isEmpty(E.tdScales)){return }Artery.loading();var C=Ext.getDom("arteryCommForm");C.innerHTML="";C.action=sys.getContextPath()+"/artery/report/dealParse.do?action="+E.exportAction;if(E.exportNormal){C.action=C.action+"&dataType="+E.exportNormal}var B=function(){function F(){return(((1+Math.random())*65536)|0).toString(16).substring(1)}return(F()+F()+"_"+F()+"_"+F()+"_"+F()+"_"+F()+F()+F())};E.taskid=B();var D=0;if(this.exportExcelTypte){E.exportType=this.exportExcelTypte}Artery.request({url:C.action,params:E,scope:this,form:C,success:function(F,G){Artery.loadTrue("生成导出文件完毕，准备下载");var H=Ext.decode(F.responseText);if(H.tempFile){window.location=sys.getContextPath()+"/artery/form/dealParse.do?action=download&nameencrypt=1&file="+H.tempFile+"&folder="+H.folder+"&random="+Math.random();clearInterval(D)}else{alert("导出文件失败")}}});if(E.exportType==EXPORT_CSV||E.exportType==EXPORT_XLS){D=setInterval(function(){E.state="downloadstate";Artery.request({url:C.action,params:E,scope:this,form:C,success:function(F,G){var H=Ext.decode(F.responseText);if(H.taskid){Artery.loadTrue("正在生成导出文件，已完成"+H.per)}}})},2000)}},getTableScales:function(){var G=Ext.select(".reportTabLastTr",true,this.body.dom).first().dom;if(G==null){return{}}var E=new StringBuffer();var C=G.cells;for(var D=0;D<C.length;D++){if(D!=0){E.append(",")}E.append(C[D].clientWidth)}var F=Ext.select(".reportTable",true,this.body.dom).first().dom;var B=new StringBuffer();var A=F.rows;for(var D=0;D<A.length-1;D++){if(D!=0){B.append(",")}B.append(A[D].clientHeight)}return{tdScales:E.toString(),trScales:B.toString(),tableWidth:F.clientWidth,tableHeight:F.clientHeight}},_print:function(){window.resultId=this.id;var A=sys.getContextPath()+"/artery/report/parse/print.jsp";var B=Artery.open({name:"print"});B.location.href=A;B.focus()},print:function(A){window.printType="print";window.multi=null;if(A&&A.multi){window.multi=A.multi}this._print()},printAll:function(){window.printType="printAll";this.setExtParams({page:1,pageCount:0});this._print()},printAllPage:function(){window.printType="printAllPage";this.setExtParams({page:1,printAllPage:true});this._print()},showComment:function(){var A=Artery.open({name:"commentWin",feature:{height:400,width:500}});var B=A.document;B.open();B.write(this.reportData.comment);A.focus()},isValidData:function(A){if(isNaN(A)){alert("请输入数字！");return false}if(A%1!=0){alert("请输入整数！");return false}if(A<1){alert("您输入的数字不能小于1，请重新输入！");return false}return true}});Ext.reg("aprptarea",Artery.plugin.RptArea);Artery.plugin.RptLayout=Ext.extend(Artery.plugin.BasePanel,{});Ext.reg("aprptlayout",Artery.plugin.RptLayout);Artery.plugin.RptResult=Ext.extend(Artery.plugin.BaseContainer,{extParams:{},exportExcelTypte:null,param:null,onCallBackClient:null,pagingbarMaxPage:3000,initComponent:function(){Artery.plugin.RptResult.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.RptResult.superclass.onRender.call(this,B,A);this.updateReport(Artery.reportData);if(Artery.reportData.timeRefresh!=0){this.runner=new Ext.util.TaskRunner();this.runner.start({run:this.run,interval:parseInt(Artery.reportData.timeRefresh+"000"),scope:this})}},toggleCondition:function(){var A=Artery.get("conditionArea");if(A==null||A.el==null){return }if(A.isVisible()){A.hide()}else{A.show()}},updateReport:function(reportData){if(reportData.css){try{var css=document.getElementById("reportStyle");css.innerHTML=reportData.css}catch(e){}}Artery.params.cacheFileId=reportData.cacheFileId;if(reportData.tableHtml!=null){this.el.update(this.getBodyContent(reportData));Ext.select(".rpt-script").each(function(el,cmp,idx){eval(el.dom.text)})}},getBodyContent:function(A){if(A.paramReady){return A.tableHtml+A.pageHtml}else{return""}},isConditionValid:function(){var A=Artery.get("conditionArea");if(A&&!A.getForm().isValid()){return false}return true},execCallBack:function(A){if(this.onCallBackEvent){Artery.regItemEvent(this,"onCallBackEvent","onCallBackServer",{reportData:A})}},run:function(A){if(!this.isConditionValid()){return }if(A==null||A.showTip!==false){Artery.loading()}var B=this.getParams();Ext.apply(B,this.param);Artery.request({url:sys.getContextPath()+"/artery/report/dealParse.do?action=parse",scope:this,params:B,success:function(C,E){var D=C.responseText;if(D!=null){D=Ext.decode(D)}if(D.params){this.exportExcelTypte=D.params.exportType;Artery.params.totalCount=D.params.totalCount}this.updateReport(D);this.execCallBack(D);if(A==null||A.showTip!==false){if(Ext.isTrue(Artery.params.messageSuccess)){Artery.loadTrue("操作成功，请继续！")}else{top.Ext.getTipMessage().hideMessage();top.Ext.getTipMessage().hideSmallMessageBtn()}}if(A!=null&&A.callback){A.callback.call(A.scope?A.scope:this)}},failure:function(C,D){Artery.loadFalse("操作失败，请检查！")}})},getParams:function(){var B=Artery.getCmp("conditionArea");var A=Artery.getParams(B!=null?B.getValues():{},this);Ext.apply(A,this.extParams);this.extParams={};return A},setExtParams:function(A){Ext.apply(this.extParams,A)},search:function(A){Artery.params.page=1;var C=Artery.getCmp("conditionArea");var B=Artery.getParams(C!=null?C.getValues():{},this);this.param=C!=null?C.getValues():{};this.run(A)},searchPage:function(D,B,C,A){if(!this.isValidData(D)||!this.isValidData(B)){return }if(parseInt(D)>parseInt(A)){alert("最大可输入的页数为"+A+"页，请重新输入！");return }if(parseInt(B)>this.pagingbarMaxPage){alert("最大可输入的记录数为"+this.pagingbarMaxPage+"，请重新输入！");return }Artery.params.page=D;Artery.params.pageCount=parseInt(B);this.run()},searchOrder:function(A){Artery.params.orderName=A;if(Artery.params.orderSort==null){Artery.params.orderSort="desc"}else{Artery.params.orderSort=Artery.params.orderSort.toggle("asc","desc")}this.run()},linkto:function(A){Artery.parseWinCfg(A);if(!A.target){A.target="_blank"}Artery.openForm(A)},reload:function(){this.run()},autoRow:function(A){Artery.params.autoJust="row";this.setExtParams({loadFromCache:true});this.run(A)},autoCol:function(A){Artery.params.autoJust="col";this.setExtParams({loadFromCache:true});this.run(A)},autoRecover:function(A){Artery.params.autoJust="no";this.setExtParams({loadFromCache:true});this.run(A)},exportExcelWin:function(){this.exportExcel({exportExcelOcx:true})},exportAllExcelWin:function(){this.exportAllExcel({exportExcelOcx:true})},exportExcel:function(A){var B=this.getTableScales();B.exportType=EXPORT_EXCEL;B.exportAction="exportExcel";B.loadFromCache=true;if(A!=null&&A.exportName!=null){B.exportName=A.exportName}else{B.exportName=this.exportName}if(A!=null&&A.exportNormal!=null){B.exportNormal=A.exportNormal}if(Ext.isTrue(Artery.params.exportExcelOcx)){B.exportExcelOcx=true}if(A){Ext.apply(B,A)}this.setExtParams(B);this._export()},exportAllExcel:function(A){var B=this.getTableScales();B.page=1;B.pageCount=0;B.exportAll=true;B.exportAction="exportExcel";if(A!=null&&A.exportName!=null){B.exportName=A.exportName}else{B.exportName=this.exportName}if(A!=null&&A.exportNormal!=null){B.exportNormal=A.exportNormal}if(Ext.isTrue(Artery.params.exportExcelOcx)){B.exportExcelOcx=true}if(A){Ext.apply(B,A)}this.setExtParams(B);this._export()},exportPdf:function(A){var B=this.getTableScales();B.exportType=EXPORT_PDF;B.exportAction="exportPdf";B.loadFromCache=true;if(A!=null&&A.exportName!=null){B.exportName=A.exportName}else{B.exportName=this.exportName}if(A!=null&&A.exportNormal!=null){B.exportNormal=A.exportNormal}this.setExtParams(B);this._export()},exportAllPdf:function(A){var B=this.getTableScales();B.exportType=EXPORT_PDF;B.page=1;B.pageCount=0;B.exportAll=true;B.exportAction="exportPdf";if(A!=null&&A.exportName!=null){B.exportName=A.exportName}else{B.exportName=this.exportName}if(A!=null&&A.exportNormal!=null){B.exportNormal=A.exportNormal}this.setExtParams(B);this._export()},_export:function(){this.exportFusImg();if(!this.isConditionValid()){return }var D=this.getParams();Ext.apply(D,this.param);if(Ext.isEmpty(D.tdScales)){return }Artery.loading();var B=Ext.getDom("arteryCommForm");B.innerHTML="";B.action=sys.getContextPath()+"/artery/report/dealParse.do?action="+D.exportAction;if(D.exportNormal){B.action=B.action+"&dataType="+D.exportNormal}var A=function(){function E(){return(((1+Math.random())*65536)|0).toString(16).substring(1)}return(E()+E()+"_"+E()+"_"+E()+"_"+E()+"_"+E()+E()+E())};D.taskid=A();var C=0;if(this.exportExcelTypte){D.exportType=this.exportExcelTypte}Artery.request({url:B.action,params:D,scope:this,form:B,success:function(E,F){Artery.loadTrue("生成导出文件完毕，准备下载");var G=Ext.decode(E.responseText);if(G.tempFile){window.location=sys.getContextPath()+"/artery/form/dealParse.do?action=download&nameencrypt=1&file="+G.tempFile+"&folder="+G.folder+"&random="+Math.random();clearInterval(C)}else{alert("导出文件失败")}}});if(D.exportType==EXPORT_CSV||D.exportType==EXPORT_XLS){C=setInterval(function(){D.state="downloadstate";Artery.request({url:B.action,params:D,scope:this,form:B,success:function(E,F){var G=Ext.decode(E.responseText);if(G.taskid){Artery.loadTrue("正在生成导出文件，已完成"+G.per)}}})},2000)}},exportFusImg:function(){if(!this.exporttype||this.exporttype!="fusioncharts"){return }Ext.select(".FusionCharts").each(function(C,D,A){var B=document.getElementById(C.dom.id);if(B){if(B.hasRendered()){B.exportChart()}}})},getTableScales:function(){var G=Ext.getDom("reportTabLastTr");if(G==null){return{}}var E=new StringBuffer();var C=G.cells;for(var D=0;D<C.length;D++){if(D!=0){E.append(",")}E.append(C[D].clientWidth)}var F=Ext.getDom("reportTable");var B=new StringBuffer();var A=F.rows;for(var D=0;D<A.length-1;D++){if(D!=0){B.append(",")}B.append(A[D].clientHeight)}return{tdScales:E.toString(),trScales:B.toString(),tableWidth:F.clientWidth,tableHeight:F.clientHeight}},_print:function(){window.resultId=this.id;var A=sys.getContextPath()+"/artery/report/parse/print.jsp";var B=Artery.open({name:"print"});B.location.href=A;B.focus()},print:function(){if(Ext.isTrue(Artery.params.printExcelOcx)){this.exportExcel({exportExcelOcx:true})}else{window.printType="print";this._print()}},printAll:function(){if(Ext.isTrue(Artery.params.printExcelOcx)){this.exportAllExcel({exportExcelOcx:true})}else{window.printType="printAll";this.setExtParams({page:1,pageCount:0,printAll:true});this._print()}},printAllPage:function(){window.printType="printAllPage";this.setExtParams({page:1,printAllPage:true});this._print()},showComment:function(){var A=Artery.open({name:"commentWin",feature:{height:400,width:500}});var B=A.document;B.open();B.write(Artery.reportData.comment);A.focus()},isValidData:function(A){if(isNaN(A)){alert("请输入数字！");return false}if(A%1!=0){alert("请输入整数！");return false}if(A<1){alert("您输入的数字不能小于1，请重新输入！");return false}return true}});Ext.reg("aprptresult",Artery.plugin.RptResult);var Plugin={};Plugin.MyAreaButton=function(A){var B={id:A.id,text:A.text};this.panelConf={width:200,height:150,items:A.items};if(A.width!=0){this.panelConf.width=A.width}if(A.height!=0){this.panelConf.height=A.height}Plugin.MyAreaButton.superclass.constructor.call(this,B);this.panelConf.contentEl=this.id+"_popup"};Ext.extend(Plugin.MyAreaButton,Artery.plugin.BaseButton,{onRender:function(B,A){this.menu=this.createEl();var D=new Ext.Panel(this.panelConf);D.render(this.menu);var C=Ext.getDom(this.id+"_popup");Ext.fly(C).removeClass("x-hide-display");D.el.on("click",function(E){E.stopPropagation()});Ext.getDoc().on("click",this.hideMenu,this);Plugin.MyAreaButton.superclass.onRender.call(this,B,A)},showMenu:function(){if(this.menu){var A=this.menu.getAlignToXY(this.el,this.menuAlign);this.menu.setXY(A);this.menu.show();this.menu.hidden=false;this.menu.focus()}return this},onClick:function(A){if(A){A.preventDefault()}if(A.button!=0){return }if(!this.disabled){if(this.enableToggle&&(this.allowDepress!==false||!this.pressed)){this.toggle()}if(this.menu&&!this.menu.isVisible()&&!this.ignoreNextClick){this.showMenu()}this.fireEvent("click",this,A);if(this.handler){this.handler.call(this.scope||this,this,A)}}A.stopPropagation()},hideMenu:function(){if(this.menu){if(this.menu.isVisible()){this.menu.hide();this.menu.hidden=true}}return this},createEl:function(){return new Ext.Layer({cls:"x-menu",shadow:this.shadow,constrain:false,parentEl:this.parentEl||document.body,zindex:15000})}});Ext.reg("myAreaButton",Plugin.MyAreaButton);Artery.plugin.News=Ext.extend(Ext.Component,{title:"",isShowMore:true,initComponent:function(){Artery.plugin.News.superclass.initComponent.call(this)},onRender:function(B,A){this.el=Ext.get(this.id);B.appendChild(this.el);Artery.plugin.News.superclass.onRender.call(this,B,A);this.titleTextEl=this.el.child(".title_text");this.titleTextEl.update(this.title);this.titleMoreEl=this.el.child(".title_more");if(!this.isShowMore){this.titleMoreEl.setDisplayed(false)}else{if(!Ext.isEmpty(this.onClickMore)){this.titleMoreEl.on("click",function(C,D){Artery.regItemEvent(this,"onClickMore","onClickServer")},this)}if(!Ext.isEmpty(this.linktoMore)){this.titleMoreEl.on("click",function(C,D){Artery.regLinktoEvent(this,"linktoMore",D)},this)}}}});Ext.reg("apnews",Artery.plugin.News);Artery.plugin.Notice=Ext.extend(Ext.Component,{title:"",isShowMore:true,initComponent:function(){Artery.plugin.Notice.superclass.initComponent.call(this)},onRender:function(B,A){this.el=Ext.get(this.id);B.appendChild(this.el);Artery.plugin.Notice.superclass.onRender.call(this,B,A)}});Ext.reg("apnotice",Artery.plugin.Notice);Artery.plugin.SearchResult=Ext.extend(Artery.plugin.BaseContainer,{data:null,tpl:null,extParams:null,initComponent:function(){Artery.plugin.SearchResult.superclass.initComponent.call(this);this.tpl=new Ext.XTemplate("<div>",'<tpl for="rows">','<div style="padding:10px;">','<div class="x-searchresult-title"><a href="{url}" target="_blank">{title}</a></div>','<div class="x-searchresult-content">{content}</div>','<div class="x-searchresult-footer">{footer}</div>',"</div>","</tpl>","</div>");this.tpl.compile()},onRender:function(B,A){Artery.plugin.SearchResult.superclass.onRender.call(this,B,A);this.contentEl=this.el.down(".searchResult-content-div");this.pageEl=this.el.down(".searchResult-page-div");this.update(this.data)},update:function(E){var A=this;this.pageEl.update("");this.tpl.overwrite(this.contentEl,E);var F=Math.ceil(E.totalCount/this.pageCount);if(E.page==null){E.page=1}var I;var H=E.page%10;var B=E.page/10;B=Math.floor(H==0?B-1:B)*10;if(E.page!=1&&E.page>10){I=this.pageEl.createChild({tag:"a",cls:"searchResult-prev-page",href:"javascript:void(0)",html:"上一页"});I.on("click",function(){this.search({page:B-9})},this)}var C=B+1;var G=B;if(G+10>F){G+=F%10}else{G+=10}for(var D=C;D<=G;D++){if(E.page==D){I=this.pageEl.createChild({tag:"span",cls:"searchResult-page-span",html:D})}else{I=this.pageEl.createChild({tag:"a",cls:"searchResult-page-span",href:"javascript:void(0)",html:"["+D+"]"});I.page=D;I.on("click",function(){A.search({page:this.page})})}}if(B+10<F){I=this.pageEl.createChild({tag:"a",cls:"searchResult-next-page",href:"javascript:void(0)",html:"下一页"});I.on("click",function(){this.search({page:B+11})},this)}},search:function(B){var A={itemid:this.id,method:"search",formid:Artery.getFormId(this)};if(this.extParams){Ext.apply(A,Ext.decode(this.extParams))}Ext.apply(A,B);Artery.runLogic({params:A,scope:this,callback:function(C){if(C.success){this.update(Ext.decode(C.data))}}})}});Ext.reg("apSearchResult",Artery.plugin.SearchResult);Artery.plugin.Test=Ext.extend(Ext.Component,{name:null,initComponent:function(){Artery.plugin.Test.superclass.initComponent.call(this);if(this.name&&this.name=="king"){this.hidden=true}},onRender:function(B,A){this.el=Ext.get(this.id);Artery.plugin.Test.superclass.onRender.call(this,B,A);this.slider=new Ext.Slider({renderTo:this.el.dom,width:314,minValue:0,maxValue:100})}});Ext.reg("aptest",Artery.plugin.Test);Artery.plugin.NavTabArea=Ext.extend(Artery.plugin.BaseContainer,{layout:"atylayout",activePanel:null,activeTabItem:false,initComponent:function(){this.addEvents("active");Artery.plugin.NavTabArea.superclass.initComponent.call(this)},onRender:function(B,A){this.el=Ext.get(this.id);Artery.plugin.NavTabArea.superclass.onRender.call(this,B,A);this.initEvents()},initEvents:function(){this.on("active",function(B){var A=this.getActivePanel();if(A){A.deselect()}this.activePanel=B;B.select()},this)},getActivePanel:function(){if(!this.activePanel){this.activePanel=this.items.find(function(B,A){if(B.active){return true}},this)}return this.activePanel},getActiveValue:function(){return this.getActivePanel().getValue()}});Ext.reg("apNavTabArea",Artery.plugin.NavTabArea);Artery.plugin.NavTabGroup=Ext.extend(Artery.plugin.BasePanel,{layout:"auto",activePanel:null,activeTabItem:false,collapsible:true,collapsed:null,initComponent:function(){this.addEvents("active");Artery.plugin.NavTabGroup.superclass.initComponent.call(this)},onRender:function(B,A){this.el=Ext.get(this.id);Artery.plugin.NavTabGroup.superclass.onRender.call(this,B,A);this.initEvents()},initEvents:function(){this.on("active",function(A){if(this.getActivePanel()){this.getActivePanel().deselect()}this.activePanel=A;A.select()},this)},getActivePanel:function(){if(!this.activePanel){this.activePanel=this.items.find(function(B,A){if(B.active){return true}},this)}return this.activePanel},getActiveValue:function(){return this.getActivePanel().getValue()},afterCollapse:function(){this[this.collapseEl].setStyle("display","none");Artery.plugin.NavTabGroup.superclass.afterCollapse.call(this)},afterExpand:function(){this.collapsed=false;this.afterEffect();this.fireEvent("expand",this)}});Ext.reg("apNavTabGroup",Artery.plugin.NavTabGroup);Artery.plugin.NavTabItem=Ext.extend(Artery.plugin.BaseComponent,{pItemId:null,active:false,formUrl:null,operAreaId:null,value:null,bodyEl:null,textEl:null,first:null,last:null,title:null,initComponent:function(){Artery.plugin.NavTabItem.superclass.initComponent.call(this);this.operAreaId=Artery.get(this.pItemId).operAreaId},onRender:function(B,A){this.el=Ext.get(this.id);this.bodyEl=Ext.get(this.id+"_body");this.textEl=this.el.child(".x-grouptabs-text-inner");Artery.plugin.NavTabItem.superclass.onRender.call(this,B,A);this.el.on("click",function(C){Artery.get(this.pItemId).fireEvent("active",this);this.fireEvent("click",this);if(this.formUrl){if(!Ext.isEmpty(this.operAreaId)){Ext.getDom(this.operAreaId+"_iframe").src=this.formUrl}}else{Artery.initSubItems(this)}},this);if(this.active&&Artery.get(this.pItemId).activeTabItem){this.el.dom.click()}},click:function(){this.el.dom.click()},getValue:function(){return this.value},setValue:function(A){this.value=A},select:function(){this.el.addClass("x-grouptabs-strip-active");if(this.first){this.el.addClass("x-grouptabs-strip-active-first")}else{this.el.removeClass("x-grouptabs-strip-active-first")}if(this.last){this.el.addClass("x-grouptabs-strip-active-last")}else{this.el.removeClass("x-grouptabs-strip-active-last")}this.active=true;if(this.bodyEl){this.bodyEl.setDisplayed(true)}},deselect:function(){this.el.removeClass("x-grouptabs-strip-active");if(this.first){this.el.removeClass("x-grouptabs-strip-active-first")}if(this.last){this.el.removeClass("x-grouptabs-strip-active-last")}this.active=false;if(this.bodyEl){this.bodyEl.setDisplayed(false)}},setTitle:function(A){this.title=A;this.textEl.update(A)},getTitle:function(){return this.title}});Ext.reg("apNavTabItem",Artery.plugin.NavTabItem);Artery.plugin.RibbonArea=Ext.extend(Artery.plugin.BaseContainer,{layout:"auto",activePanel:null,activeCell:null,ribbonBody:null,ribbonCollapsebar:null,expanded:true,themeName:null,initComponent:function(){this.addEvents("active");Artery.plugin.RibbonArea.superclass.initComponent.call(this)},onRender:function(B,A){this.el=Ext.get(this.id);Artery.plugin.RibbonArea.superclass.onRender.call(this,B,A);this.ribbonBody=this.el.child(".x-ribbon-body");this.ribbonCollapsebar=this.el.child(".x-ribbon-collapsebar");if(this.ribbonCollapsebar){this.ribbonCollapsebar.addClassOnOver("x-ribbon-collapsebar-over")}this.initEvents()},initEvents:function(){this.on("active",function(A){if(this.getActivePanel().id!=A.id){this.getActivePanel().deselect();this.activePanel=A;A.select()}},this);if(this.ribbonCollapsebar){this.ribbonCollapsebar.on("click",function(){this.toggle()},this)}},activeRibbon:function(A){this.fireEvent("active",Artery.get(A))},getActivePanel:function(){if(!this.activePanel){this.activePanel=this.items.find(function(B,A){if(B.active){return true}},this)}return this.activePanel},toggle:function(){if(this.expanded){this.collpase()}else{this.expand()}},collpase:function(){if(this.ribbonCollapsebar){var A=this.ribbonCollapsebar.child(".x-ribbon-collapsebar-arrow");A.addClass("x-ribbon-collapsebar-arrow-expand")}this.ribbonBody.addClass("x-hidden");this.expanded=false;Ext.EventManager.fireResize()},expand:function(){if(this.ribbonCollapsebar){var A=this.ribbonCollapsebar.child(".x-ribbon-collapsebar-arrow");A.removeClass("x-ribbon-collapsebar-arrow-expand")}this.ribbonBody.removeClass("x-hidden");this.expanded=true;Ext.EventManager.fireResize()},getActiveCell:function(){return this.activeCell}});Ext.reg("apRibbonArea",Artery.plugin.RibbonArea);Artery.plugin.RibbonCell=Ext.extend(Artery.plugin.BaseComponent,{active:false,ribbonAreaId:null,ribbonGroupId:null,ribbonItemId:null,cellTipEl:null,ribbonTextEl:null,ribbonCellBodyEl:null,onReloadEvent:null,moreCell:false,onDeselectEvent:null,initComponent:function(){Artery.plugin.RibbonCell.superclass.initComponent.call(this);if(this.id==this.ribbonItemId+"MoreMenuCell"){this.moreCell=true}if(!Ext.isEmpty(this.linktoEvent)){if(this.linktoEvent.target=="_blank"){this.linktoEvent.target=Artery.get(this.ribbonAreaId).operAreaId}}},onRender:function(B,A){this.el=Ext.get(this.id);this.ribbonTextEl=this.el.child(".x-ribbon-cell-text");this.ribbonCellBodyEl=this.el.child(".x-ribbon-cell-body");this.cellTipEl=this.el.child(".x-ribbon-cell-tip");Artery.plugin.RibbonCell.superclass.onRender.call(this,B,A);this.el.addClassOnOver("x-ribbon-cell-over");this.el.on("click",function(C){this.onClick();Ext.menu.MenuMgr.hideAll()},this);if(this.active){Artery.get(this.ribbonAreaId).activeCell=this;this.onClick()}},click:function(){Artery.get(this.ribbonAreaId).activeRibbon(this.ribbonItemId);this.onClick();Ext.menu.MenuMgr.hideAll()},onClick:function(){if(Artery.get(this.ribbonAreaId).activeCell&&!this.moreCell){Artery.get(this.ribbonAreaId).activeCell.deselect()}this.select();this.updateMore();this.fireEvent("click",this)},updateMore:function(){if(!this.moreCell){Artery.get(this.ribbonItemId).updateMore(this)}},reload:function(A){Artery.regItemEvent(this,"onReloadEvent","onReloadServer",A)},select:function(){this.el.addClass("x-ribbon-cell-active");if(this.moreCell){return }this.active=true;Artery.get(this.ribbonAreaId).activeCell=this},deselect:function(){this.el.removeClass("x-ribbon-cell-active");this.active=false;Artery.get(this.ribbonAreaId).activeCell=null;if(this.onDeselectEvent){Artery.regItemEvent(this,"onDeselectEvent","onDeselectServer")}},showTip:function(){var A=Ext.get(this.id+"_tip");if(A){A.removeClass("x-hidden")}},hideTip:function(){var A=Ext.get(this.id+"_tip");if(A){A.addClass("x-hidden")}},setTip:function(A,B){if(!this.cellTipEl){return }if(A&&A!=""){this.showTip()}else{this.hideTip();return }this.cellTipEl.removeClass("x-ribbon-cell-tip-ok");this.cellTipEl.removeClass("x-ribbon-cell-tip-warn");this.cellTipEl.removeClass("x-ribbon-cell-tip-sys");if(B===false){this.cellTipEl.addClass("x-ribbon-cell-tip-norequired")}else{this.cellTipEl.removeClass("x-ribbon-cell-tip-norequired")}if(A=="ok"){this.cellTipEl.addClass("x-ribbon-cell-tip-ok");this.cellTipEl.addClass("x-ribbon-cell-tip-sys")}else{if(A=="warn"){this.cellTipEl.addClass("x-ribbon-cell-tip-warn");this.cellTipEl.addClass("x-ribbon-cell-tip-sys")}else{this.cellTipEl.child(".x-ribbon-cell-tip-body").update(A)}}},setTipInfo:function(A){if(!this.cellTipEl){return }this.cellTipEl.dom.title=A}});Ext.reg("apRibbonCell",Artery.plugin.RibbonCell);Artery.plugin.RibbonGroup=Ext.extend(Artery.plugin.BaseComponent,{initComponent:function(){Artery.plugin.RibbonGroup.superclass.initComponent.call(this)},onRender:function(B,A){this.el=Ext.get(this.id);Artery.plugin.RibbonGroup.superclass.onRender.call(this,B,A)}});Ext.reg("apRibbonGroup",Artery.plugin.RibbonGroup);Artery.plugin.RibbonItem=Ext.extend(Artery.plugin.BaseComponent,{pItemId:null,active:false,themeName:null,ribbonBody:null,ribbonMore:null,ribbonMoreCellEl:null,ribbonMoreCellBodyEl:null,ribbonMoreTextEl:null,ribbonMoreBody:null,onClickEvent:null,initComponent:function(){Artery.plugin.RibbonItem.superclass.initComponent.call(this)},onRender:function(C,A){this.el=Ext.get(this.id);this.ribbonBody=Ext.get(this.id+"_ribbonBody");this.ribbonMore=Ext.get(this.id+"MoreMenuGroup");this.ribbonMoreCellEl=this.ribbonMore.child(".x-ribbon-cell");this.ribbonMoreTextEl=this.ribbonMore.child(".x-ribbon-cell-text");this.ribbonMoreTextEl.update("更多");this.ribbonMoreCellBodyEl=this.ribbonMore.child(".x-ribbon-cell-body");if(this.themeName){this.ribbonMore.addClass("x-group-more-"+this.themeName)}else{this.ribbonMore.addClass("x-group-more")}this.ribbonMoreBody=Ext.get(this.id+"_more_body");this.el.addClassOnOver("x-ribbon-item-over");Artery.plugin.RibbonItem.superclass.onRender.call(this,C,A);this.el.on("click",function(F){Artery.get(this.pItemId).fireEvent("active",this);if(this.onClickEvent){Artery.regItemEvent(this,"onClickEvent","onClickServer")}},this);this.el.on("dblclick",function(F){Artery.get(this.pItemId).toggle()},this);this.ribbonMore.on("click",function(F){this.onRibbonMoreClick()},this);this.ribbonBody.setWidth(10000);var B=0;var D=this.items.length-1;for(;B<D;B++){var E=Artery.get(this.items[B].id);E.elWidth=E.el.getWidth()}this.ribbonBody.setWidth("auto");this.pack();Ext.EventManager.onWindowResize(function(){this.pack()},this)},onRibbonMoreClick:function(){this.showMenu()},showMenu:function(){if(!this.menu){this.createMenu()}this.menu.show(this.ribbonMoreCellEl,"tl-bl?");this.menu.hide();this.menu.setWidth(this.ribbonMoreBody.getWidth());this.menu.show(this.ribbonMoreCellEl,"tl-bl?");this.menu.setWidth(this.ribbonMoreBody.getWidth());var B=this.menu.ul.getWidth();var A=Ext.getBody().getWidth();if(B-A>10){this.menu.el.setStyle("overflow-x","auto");this.menu.setWidth(A-10);this.menu.ul.setWidth(B);if(!this.menu.height4Scroll){this.menu.height4Scroll=this.menu.getHeight()+17}this.menu.setHeight(this.menu.height4Scroll)}},createMenu:function(){this.menu=new Ext.menu.Menu({plain:true,minWidth:10,cls:this.themeName?"x-theme-ribbonArea-"+this.themeName+" x-menu-ribbon-"+this.themeName:"",defaultOffsets:[0,10],items:[{xtype:"panel",border:false,bodyStyle:"background-color:transparent;",contentEl:this.id+"_more_body"}]})},updateMore:function(A){this.ribbonMoreCellEl.removeClass("x-ribbon-cell-active");if(Artery.get(A.ribbonGroupId).showInMenu){this.ribbonMoreCellEl.addClass("x-ribbon-cell-active")}},pack:function(){var C=this.ribbonBody.getWidth();var E=0;var A=0;var B=this.items.length-1;if(B==0){return }for(;A<B;A++){var D=Artery.get(this.items[A].id);if(D.showInMenu){D.el.insertBefore(this.ribbonMore);D.showInMenu=false}E+=D.elWidth;if(E>=C){if(E-D.elWidth+80>C){A--}break}}if(B>A){this.ribbonMore.show()}else{this.ribbonMore.hide()}for(;B>A&&B>=1;B--){var D=Artery.get(this.items[B-1].id);if(!D.showInMenu){this.ribbonMoreBody.insertFirst(D.id);D.showInMenu=true}}},select:function(){this.el.addClass("x-ribbon-item-active");this.active=true;this.ribbonBody.removeClass("x-hidden");this.pack()},deselect:function(){this.el.removeClass("x-ribbon-item-active");this.active=false;this.ribbonBody.addClass("x-hidden")}});Ext.reg("apRibbonItem",Artery.plugin.RibbonItem);Artery.plugin.RibbonMenu=Ext.extend(Artery.plugin.BaseComponent,{ribbonAreaId:null,pItemId:null,pMenuId:null,themeName:null,initComponent:function(){Artery.plugin.RibbonMenu.superclass.initComponent.call(this)},onRender:function(B,A){this.el=Ext.get(this.id);Artery.plugin.RibbonMenu.superclass.onRender.call(this,B,A);this.el.addClassOnOver("x-ribbon-cell-over");this.el.on("click",function(D,C){this.onClick()},this)},onClick:function(){this.showMenu()},showMenu:function(){if(!this.menu){this.createMenu()}var C=Ext.get(this.id).getXY();C[1]=C[1]+Ext.get(this.id).getHeight();if(C[0]+this.menu.minWidth>document.body.scrollWidth){C[0]=C[0]+Ext.get(this.id).getWidth()-this.menu.minWidth}this.menu.showAt(C,this.getParentMenu());var B=this.menu.ul.getWidth();var A=Ext.getBody().getWidth();if(B-A>10){this.menu.setPosition(5);this.menu.el.setStyle("overflow-x","auto");this.menu.setWidth(A-10);this.menu.ul.setWidth(B);if(!this.menu.height4Scroll){this.menu.height4Scroll=this.menu.getHeight()+17}this.menu.setHeight(this.menu.height4Scroll)}},getParentMenu:function(){if(this.pMenuId){return Artery.get(this.pMenuId).menu}if(Artery.get(this.pItemId).showInMenu){return Artery.get(Artery.get(this.pItemId).pItemId).menu}return null},createMenu:function(){this.menu=new Ext.menu.Menu({plain:true,id:this.id+"_ribbonMenu",cls:this.themeName?"x-theme-ribbonArea-"+this.themeName+" x-menu-ribbon-"+this.themeName:"",defaultOffsets:[0,-4],items:[{xtype:"panel",border:false,contentEl:this.id+"_menu"}]})},select:function(){this.el.addClass("x-ribbon-cell-active");this.active=true;Artery.get(this.ribbonAreaId).activeCell=this},deselect:function(){this.el.removeClass("x-ribbon-cell-active");this.active=false;Artery.get(this.ribbonAreaId).activeCell=null}});Ext.reg("apRibbonMenu",Artery.plugin.RibbonMenu);Artery.initTabHeaderScroll=function(C){var H=Ext.get(C.id);var E=H.child(".x-tab-panel-header");var D=H.child(".x-tab-strip-wrap");var F=D.child(".x-tab-strip");var A=E.child(".x-tab-scroller-left");var G=E.child(".x-tab-scroller-right");if(C.scrollLeft!==false){D.scrollTo("left",0,false)}var B=0;Ext.select("li",false,F.dom).each(function(I){B+=I.dom.offsetWidth+2});if(B>D.getWidth()){E.addClass("x-tab-scrolling");A.removeClass("x-hide-visibility");G.removeClass("x-hide-visibility")}else{E.removeClass("x-tab-scrolling");A.addClass("x-hide-visibility");G.addClass("x-hide-visibility")}};Artery.plugin.TabArea=Ext.extend(Ext.TabPanel,{enableTabScroll:true,suspendUpdates:true,tabWidth:null,onRender:function(C,A){this.on("beforetabchange",this.beforetabchangeHandler,this);this.on("tabchange",this.onTabChangeHandler,this);Artery.plugin.BasePanel.prototype.onRender.call(this,C,A);var B=this[this.stripTarget];this.stripWrap=B.child(".x-tab-strip-wrap");this.stripSpacer=B.child(".x-tab-strip-spacer");this.strip=new Ext.Element(this.stripWrap.child(".x-tab-strip"));this.edge=this.strip.child(".x-tab-edge");if(!this.itemTpl){var D=new Ext.Template('<li class="{cls}" id="{id}"><a class="x-tab-strip-close" onclick="return false;"></a>','<a class="x-tab-right" href="#" onclick="return false;"><em class="x-tab-left">','<span class="x-tab-strip-inner"><span {iconPath} style="{textStyle}" title="{textTitle}" class="x-tab-strip-text {iconCls}">{text}</span></span>',"</em></a></li>");D.disableFormats=true;D.compile();Artery.plugin.TabArea.prototype.itemTpl=D}this.items.each(this.initHTMLTab,this);this.createScrollers()},beforetabchangeHandler:function(B,A,C){if(A&&A.id&&!A.rendered){Artery.get(A.id)}},afterRender:function(){Ext.TabPanel.superclass.afterRender.call(this);if(this.autoTabs){this.readTabs(false)}if(this.activeTab!==undefined){var A=Ext.isObject(this.activeTab)?this.activeTab:this.items.get(this.activeTab);delete this.activeTab;Ext.each(this.items,function(B,C){if(C&&C.id&&C.formUrl){Artery.get(C.id)}});if(A){if(A.id){this.setActiveTabOnRender(Artery.get(A.id))}else{this.setActiveTabOnRender(A)}}}},setActiveTabOnRender:function(C){C=this.getComponent(C);if(!C||this.fireEvent("beforetabchange",this,C,this.activeTab)===false){return }if(this.activeTab!=C){if(this.activeTab){var A=this.getTabEl(this.activeTab);if(A){Ext.fly(A).removeClass("x-tab-strip-active")}this.activeTab.fireEvent("deactivate",this.activeTab)}var B=this.getTabEl(C);Ext.fly(B).addClass("x-tab-strip-active");this.activeTab=C;this.stack.add(C);this.layout.setActiveItem(C);if(this.scrolling){this.scrollToTab(C,this.animScroll)}this.fireEvent("tabchange",this,C)}},setSize:function(A,B){},initEvents:function(){Artery.plugin.TabArea.superclass.initEvents.call(this);this.on("remove",function(A){if(this.activeTab==null){this.hide()}},this);this.on("beforeadd",function(A){this.show()},this);this.on("beforeremove",function(B,A){this.onTabBeforeRemoveHandler(A)},this);this.on("remove",function(A){Artery.initTabHeaderScroll({id:this.id})},this)},onTabChangeHandler:function(B,A){if(Ext.isEmpty(this.onTabChangeEvent)){return }Artery.regItemEvent(this,"onTabChangeEvent","onTabChangeServer",{tab:A})},onTabBeforeRemoveHandler:function(A){try{var C=A.getFrame();C.contentWindow.document.write("");C.contentWindow.close()}catch(B){}},initTab:function(D,A){var B=-1;var E;Ext.select("li",false,this.strip.dom).each(function(G){B++;if(B==A){E=G.dom}});var F=this.getTemplateArgs(D);var C=E?this.itemTpl.insertBefore(E,F):this.itemTpl.append(this.strip,F);Ext.fly(C).addClassOnOver("x-tab-strip-over");if(D.tabTip){Ext.fly(C).child("span.x-tab-strip-text",true).qtip=D.tabTip}D.tabEl=C;D.on("disable",this.onItemDisabled,this);D.on("enable",this.onItemEnabled,this);D.on("titlechange",this.onItemTitleChanged,this);D.on("iconchange",this.onItemIconChanged,this);D.on("beforeshow",this.onBeforeShowItem,this)},initHTMLTab:function(C,A){var D=this.id+this.idDelimiter+C.getItemId();var B=Ext.getDom(D);if(C.tabTip){Ext.fly(B).child("span.x-tab-strip-text",true).qtip=C.tabTip}C.tabEl=B;C.on("disable",this.onItemDisabled,this);C.on("enable",this.onItemEnabled,this);C.on("titlechange",this.onItemTitleChanged,this);C.on("iconchange",this.onItemIconChanged,this);C.on("beforeshow",this.onBeforeShowItem,this)},getTemplateArgs:function(D){var B="";var A=D.closable?"x-tab-strip-closable":"";if(D.disabled){A+=" x-item-disabled"}if(D.iconCls){A+=" x-tab-with-icon"}else{if(D.icon){A+=" x-tab-with-icon";B='style="background-image:url('+D.icon+') !important;"'}}if(D.tabCls){A+=" "+D.tabCls}var C=function(){var E="";if(!Ext.isEmpty(D.tabWidth)){E=D.tabWidth}else{if(!Ext.isEmpty(this.tabWidth)){E=this.tabWidth}}if(Ext.isEmpty(E)){return""}return"width:"+E+"px;"};return{id:this.id+this.idDelimiter+D.getItemId(),text:D.title,cls:A,iconCls:D.iconCls||"",iconPath:B,textStyle:C.call(this),textTitle:D.title.replace(/"/g,"&quot;")}},createScrollers:function(){this.pos=this.tabPosition=="bottom"?this.footer:this.header;var C=this.stripWrap.dom.offsetHeight;var A=this.pos.child(".x-tab-scroller-left");A.setHeight(C);A.addClassOnOver("x-tab-scroller-left-over");this.leftRepeater=new Ext.util.ClickRepeater(A,{interval:this.scrollRepeatInterval,handler:this.onScrollLeft,scope:this});this.scrollLeft=A;var B=this.pos.child(".x-tab-scroller-right");B.setHeight(C);B.addClassOnOver("x-tab-scroller-right-over");this.rightRepeater=new Ext.util.ClickRepeater(B,{interval:this.scrollRepeatInterval,handler:this.onScrollRight,scope:this});this.scrollRight=B},updateScrollButtons:function(){},addLinkto:function(D,G){if(D.id){if(this.getItem(D.id)){this.setActiveTab(this.getItem(D.id));return }}else{D.id=Ext.id()}if(!D.params){D.params={}}var C=Ext.tusc.getLinkUrl(D);var B={id:D.id,tabWidth:D.tabWidth,html:{tag:"iframe",frameborder:0,style:"width:100%;height:100%",src:C,id:D.id+"_iframe",name:D.id+"_iframe"}};if(this.dealMoreProp){this.dealMoreProp(D,B)}if(D.onActive){B.onActivateHandler=D.onActive}var A=new Artery.plugin.TabItem(B);var F=this.items.getCount();this.add(A);var E=this.items.getCount();if(G&&(E>F)){this.setActiveTab(A)}Artery.initTabHeaderScroll({id:this.id,scrollLeft:false});this.scrollToTab(this.activeTab,false)},dealMoreProp:function(B,A){if(B.closable){A.closable=B.closable}if(B.title){A.title=B.title}else{A.title="<空>"}if(B.titleEscape){A.title=A.title.replace(/</g,"&lt;").replace(/>/g,"&gt;")}if(B.iconpath){A.icon=sys.getContextPath()+B.iconpath}else{if(B.icon){A.icon=sys.getContextPath()+B.icon}}},setActiveNext:function(){var B=this.items.items;for(var A=0;A<B.length;A++){if(this.activeTab.id!=B[A].id&&!B[A].tabEl.hidden){this.setActiveTab(B[A]);return true}}}});Ext.reg("apTabArea",Artery.plugin.TabArea);Artery.plugin.TabPanel=Ext.extend(Artery.plugin.BasePanel,{layout:"card",layoutConfig:{deferredRender:true},monitorResize:true,render:function(){Artery.plugin.TabPanel.superclass.render.apply(this,arguments);if(this.activeTab!==undefined){var A=this.activeTab;delete this.activeTab;this.setActiveTab(A)}},setActiveTab:function(A){A=this.getComponent(A);if(!A){return }if(!this.rendered){this.activeItem=A;return }this.layout.setActiveItem(A);A.fireEvent("activate",A);if(A.doLayout){A.doLayout()}},getItem:Artery.plugin.TabArea.prototype.getItem,addLinkto:Artery.plugin.TabArea.prototype.addLinkto});Ext.reg("apTabPanel",Artery.plugin.TabPanel);Artery.plugin.TabItem=Ext.extend(Artery.plugin.BasePanel,{onRender:function(ct,position){this.on("activate",this.onActivateHandler,this);if(Ext.get(this.id)){Artery.plugin.TabItem.superclass.onRender.call(this,ct,position)}else{Ext.Panel.prototype.onRender.call(this,ct,position);if(!ct){ct=Ext.get(Ext.get(this.pid+"__"+this.id).dom.parentNode)}ct.dom.insertBefore(this.el.dom,position);this.el.setStyle({height:"100%"});this.bwrap.setStyle({height:"100%"});this.body.setStyle({height:"100%"})}if(this.formUrl){this.getFrame().style.height=this.body.getHeight();this.autoOpenLink(this.getFrame())}if(!this.ownerCt&&this.pid!==undefined){this.ownerCt=eval("Artery.get('"+this.pid+"');")}},changeHeightStyle:function(B,A){try{B.setStyle("height",A)}catch(B){}},onActivateHandler:function(){if(document.getElementById(this.id+"_iframe")!=null){this.getFrame()}Ext.get(this.tabEl.id).removeClass("x-hide-display");Ext.get(this.id).removeClass("x-hide-display");if(this.formUrl){this.getFrame().style.height=this.body.getHeight()}else{if(!this.hasInitSubItems){Artery.initSubItems(this);this.hasInitSubItems=true}}if(Ext.isEmpty(this.onActivateEvent)){return }Artery.regItemEvent(this,"onActivateEvent","onActivateServer");this.active(this.isReloadIframe)},setSize:function(A,B){},active:function(A){this.ownerCt.setActiveTab(this);var D=window.frames[this.id+"_iframe"];if(D){try{var C=D.location.href;if(Ext.isEmpty(C)||C=="about:blank"){return }if(A){D.location.reload()}}catch(B){}}},openForm:function(A){this.ownerCt.setActiveTab(this);this.getFrame().style.height=this.body.getHeight();this.getFrame().src=Ext.tusc.getLinkUrl(A)},autoOpenLink:function(C){if(this.formUrl.length>1000){var E="url="+this.formUrl.replace("?","&");var B=Ext.urlDecode(E,true);if(!B.formType||!B.formid){C.src=this.formUrl;return }var A={id:this.id,url:this.formUrl,formType:B.formType,formId:B.formid,forceContextPath:false};var D=C.contentWindow;Artery.autoSubmitForm(D,A)}else{this.getFrame().src=this.formUrl}},getFrame:function(){var A=document.getElementById(this.id+"_iframe");if(A==null){this.body.update('<iframe frameborder=0 id="'+this.id+"_iframe\" style='width: 100%; height: 100%;' onload='this.style.height="+this.body.getHeight()+";'></iframe>");A=document.getElementById(this.id+"_iframe")}if(!A.isInitIframeResizeEvent){this.initIframeResizeEvent();A.isInitIframeResizeEvent=true}return A},initIframeResizeEvent:function(){var A=Ext.get(this.id+"_iframe");var B=this;if(A&&B.ownerCt){Artery.Event.onResizestart(function(){B.changeHeightStyle(A,"100%")});Artery.Event.onResizend(function(){if(B.ownerCt&&B.ownerCt.activeTab){B.changeHeightStyle(A,B.ownerCt.activeTab.body.getHeight())}})}},setTitle:function(A){this.superclass().setTitle.call(this,A)},getTitle:function(){return this.title},showItem:function(){if(this.tabEl){Ext.get(this.tabEl.id).removeClass("x-hide-display");Ext.get(this.id).removeClass("x-hide-display");Artery.get(this.pid).setActiveTab(this)}},hideItem:function(){if(this.tabEl){Ext.get(this.tabEl.id).addClass("x-hide-display");Ext.get(this.id).addClass("x-hide-display");Artery.get(this.pid).setActiveNext()}}});Ext.reg("apTabItem",Artery.plugin.TabItem);Artery.plugin.HtmlArea=Ext.extend(Artery.plugin.BaseContainer,{initComponent:function(){Artery.plugin.HtmlArea.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.HtmlArea.superclass.onRender.call(this,B,A)},setHtml:function(A){this.el.update(A);this.value=A},setValue:function(A){this.setHtml(A)},setText:function(A){this.setHtml(A)},getText:function(){return this.value}});Ext.reg("aphtmlarea",Artery.plugin.HtmlArea);Artery.plugin.LinkArea=Ext.extend(Artery.plugin.BaseContainer,{initComponent:function(){Artery.plugin.LinkArea.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.LinkArea.superclass.onRender.call(this,B,A);this.el.on("click",function(C){this.fireEvent("click",this,C)},this)},setText:function(A){this.el.update(A)},setValue:function(A){this.setText(A)},setHtml:function(A){this.setText(A)},click:function(){this.fireEvent("click",this)}});Ext.reg("apLinkArea",Artery.plugin.LinkArea);Artery.plugin.flashUpload=Ext.extend(Ext.form.Field,{id:null,swfu:null,settings:null,button_placeholder_id:null,formId:null,Other_form_ID:null,file_types:"*.*",file_types_description:"所有文件",file_size_limit:20,total_file_size_limit:100,file_queue_limit:0,containerWidth:"100%",containerHeight:"100%",button_image_url:"chooseButton.png",button_width:"62",button_height:"22",button_text:null,button_text_style:null,button_text_left_padding:0,button_text_top_padding:0,buttonDisabled:false,inputDisabled:false,handCursor:false,singleFile:true,showStatus:false,showBar:false,sessionid:null,deleteFile:"",submitName:null,value:null,initValue:function(){if(this.value){this.setValue(this.value)}else{if(!Ext.isEmpty(this.el.dom.value)&&this.el.dom.value!=this.emptyText){this.setValue(this.el.dom.value)}}this.originalValue=this.getValue();this.previousValue=this.originalValue;this.sessionid=this.GetCookie("JSESSIONID")||this.sessionid},swfupload_loaded_function:function swfupload_loaded_function(){this.totalFileSize=0},file_dialog_start_function:function file_dialog_start_function(){},file_queued_function:function file_queued_function(C){this.customSettings.validate=false;this.totalFileSize+=C.size;if(this.totalFileSize>this.customSettings.component.total_file_size_limit){var B=new FileProgress(C,this.customSettings.progressTarget);B.setStatus("文件总大小超限");if(this.customSettings.component.showErrorTime<=0){B.toggleCancel(true,this);B.setError()}else{B.setError(this.customSettings.component.showErrorTime);var A=this;setTimeout(function(){B.toggleCancel(false,A)},this.customSettings.component.showErrorTime)}return }if(this.settings.button_action==SWFUpload.BUTTON_ACTION.SELECT_FILE){if(this.customSettings.component.currentFile){var B=new FileProgress(this.customSettings.component.currentFile,this.customSettings.progressTarget);B.setCancelled(this.customSettings.component.showCancelTime);B.setStatus("已取消");this.cancelUpload(this.customSettings.component.currentFile.id,false)}var E=document.getElementById(this.customSettings.component.id+"_list");if(E){E.style.display="none"}}var D={};D.id=C.id;D.name=C.name;if(this.settings.button_action==SWFUpload.BUTTON_ACTION.SELECT_FILE){this.customSettings.newValue=D}else{if(!this.customSettings.newValue){this.customSettings.newValue=[]}this.customSettings.newValue.push(D)}document.getElementById(this.settings.post_params.itemid).value=C.name;this.customSettings.component.currentFile=C;var B;B=new FileProgress(C,this.customSettings.progressTarget,this.customSettings.component.showFileSize);B.setStatus("等待中..");B.toggleCancel(true,this);B.toggleStatus(this.customSettings.showStatus);B.toggleBar(this.customSettings.showBar);B.appear()},file_queue_error_function:function file_queue_error_function(B,D,C){if(D===SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){this.component.markInvalid("队列中文件过多.\n"+(C===0?"超过文件上传限制.":"你可以选择 "+(C>1?"最多"+C+"个文件。":"一个文件.")));return }var A=new FileProgress(B,this.customSettings.progressTarget,this.customSettings.component.showFileSize);A.setError(this.customSettings.component.showErrorTime);if(this.customSettings.component.showErrorTime<=0){A.toggleCancel(true,this)}else{A.toggleCancel(false)}switch(D){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:A.setStatus("文件过大。");break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:A.setStatus("不能上传0比特文件。");break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:A.setStatus("无效文件类型。");break;case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:alert("选择了过多文件。  "+(C>1?"你只能再添加"+C+"个文件":"不能添加更多文件。"));break;default:if(B!==null){A.setStatus("文件异常")}break}},file_dialog_complete_function:function file_dialog_complete_function(){this.customSettings.component.onValueChange()},upload_start_function:function upload_start_function(B){var A=new FileProgress(B,this.customSettings.progressTarget,this.customSettings.component.showFileSize);A.setStatus("上传中..");A.toggleCancel(true);return true},upload_progress_function:function upload_progress_function(B,E,D){var C=Math.ceil((E/D)*100);var A=new FileProgress(B,this.customSettings.progressTarget,this.customSettings.component.showFileSize);A.setProgress(C);A.setStatus("上传中..")},upload_success_function:function upload_success_function(file,serverData){if(!Ext.isEmpty(serverData)){if(/^arterycmd:.*\.jsp$/.test(serverData)){var loginUrl=serverData.replace(/arterycmd:/,"");alert(Artery.ajaxLoginTip);top.window.location.href=loginUrl;return }}var progress=new FileProgress(file,this.customSettings.progressTarget,this.customSettings.component.showFileSize);if(this.getStats().files_queued==0){var callback=this.callbackQueue.pop();eval("var message="+serverData+";");if(message.success){progress.setComplete();progress.setStatus("已完成");progress.toggleCancel(false);callback.call(this,message["return"])}}},upload_error_function:function upload_error_function(B,F,D){var A=new FileProgress(B,this.customSettings.progressTarget,this.customSettings.component.showFileSize);A.setError(this.customSettings.component.showErrorTime);switch(F){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:A.setStatus("上传异常: "+D);break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:A.setStatus("配置错误");break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:A.setStatus("Upload Failed.");break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:A.setStatus("服务器IO 异常");break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:A.setStatus("安全 异常");break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:A.setStatus("上传超过限制");break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:A.setStatus("文件为找到。");break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:A.setStatus("文件验证失败，取消上传");break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:if(this.totalFileSize>this.customSettings.component.total_file_size_limit){A.setError(this.customSettings.component.showErrorTime);A.setStatus("文件总大小超限")}else{A.setStatus("已取消");A.setCancelled(this.customSettings.component.showCancelTime)}this.totalFileSize-=B.size;this.customSettings.component.deleteFileValue(B.id);var E="";if(this.customSettings.component.singleFile){var B=this.customSettings.component.getFile();if(B){E=B.name}}else{var C=this.customSettings.component.getFile();if(C){E=C[C.length-1].name}}document.getElementById(this.settings.post_params.itemid).value=E;break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:A.setStatus("已停止");break;default:A.setError(this.customSettings.component.showErrorTime);A.setStatus("上传失败");A.toggleCancel(false);break}},upload_complete_function:function upload_complete_function(A){if(this.getStats().files_queued!=0){this.startUpload()}else{if(document.getElementById(this.customSettings.component.id+"_list")){document.getElementById(this.customSettings.component.id+"_list").style.display="none"}document.getElementById(this.settings.post_params.itemid).value="";Ext.select("a.x-flashUpload-progressCancel",false).each(function(C,D,B){C.removeClass("x-hide-display")})}},startUpload:function startUpload(object){var p=Artery.getParams({},this);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=CheckSessionOutTime&method=test;jsessionid="+this.sessionid,scope:this,params:p,success:function(response,options){var text=response.responseText;if(!Ext.isEmpty(text)){if(/^arterycmd:.*\.jsp$/.test(text)){var loginUrl=text.replace(/arterycmd:/,"");alert(Artery.ajaxLoginTip);top.window.location.href=loginUrl;return }try{text=Ext.decode(text);text=text["return"]}catch(e){Artery.showError("出错啦，请检查！");return }}}});if(object==null){object={params:{}}}else{if(object.params==null){object.params={}}}if(Artery.params){Ext.apply(object.params,Artery.params)}if(object.params.itemid){delete object.params.itemid}if(object.params.formid){delete object.params.formid}Ext.select("a.x-flashUpload-progressCancel",false).each(function(el,cmp,idx){el.addClass("x-hide-display")});var formValues;if(this.singleFile){var form=Artery.get(this.Other_form_ID);if(form!=null){if(form.isValid()){formValues=form.getValues()}else{return }}}if(!this.validateValue(this.value)){return }if(!this.hidden&&this.swfu.getStats().files_queued!=0){Ext.iterate(object.params,function(key,value,Object){this.swfu.addPostParam(key,value)},this);if(Artery.params.itemid){this.swfu.addPostParam("buttonItemid",Artery.params.itemid)}if(this.deleteFile){this.swfu.addPostParam(this.id+"Clear",this.deleteFile)}if(formValues){Ext.iterate(formValues,function(key,value,Object){this.swfu.addPostParam(key,value)},this)}this.swfu.addPostParam("jsessionid",this.sessionid);this.swfu.startUpload();delete this.deleteFile;if(object.callback!=null){this.swfu.callbackQueue=new Array();this.swfu.callbackQueue.push(object.callback)}}else{Ext.applyIf(object.params,{formid:this.formId,itemid:this.id,itemType:"flashUpload"});if(Artery.params.itemid){object.params.buttonItemid=Artery.params.itemid}if(this.deleteFile){eval("object.params."+this.id+"Clear='"+this.deleteFile+"';")}if(formValues){Ext.applyIf(object.params,formValues)}Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=onUpload;jsessionid="+this.sessionid,success:function(response,options){delete this.deleteFile;if(object.callback!=null&&typeof object.callback=="function"){object.callback.call(this,response.responseText)}},params:object.params,scope:this})}},removeUpload:function(){Ext.select(".x-flashUpload-progressWrapper").each(function(C,D,A){var B=document.getElementById(C.dom.id);B.style.display="none"})},clearFileQueue:function(){while(this.getFileSize()!=0){this.swfu.cancelUpload(this.getFile()[0].id)}this.removeUpload()},GetCookie:function(D){var B=D+"=";var F=B.length;var A=document.cookie.length;var E=0;while(E<A){var C=E+F;if(document.cookie.substring(E,C)==B){return this.getCookieVal(C)}E=document.cookie.indexOf(" ",E)+1;if(E==0){break}}return null},getCookieVal:function(B){var A=document.cookie.indexOf(";",B);if(A==-1){A=document.cookie.length}return unescape(document.cookie.substring(B,A))},setValue:function(A){Ext.select(".x-flashUpload-progressWrapper").each(function(D,E,B){var C=document.getElementById(D.dom.id);C.style.display="none"});this.value=A;if(this.isDisplayType()){if(this.el&&!(this.el.dom.tagName.toLowerCase()=="input"&&this.el.dom.type.toLowerCase()=="hidden")){this.el.dom.innerHTML=A}return }if(this.rendered){if(this.el.dom.value!=A){this.el.dom.value=(A===null||A===undefined?"":A)}}this.updateValueTip();this.afterSetValue()},getStats:function(){return this.swfu.getStats()},getFile:function(){if(this.singleFile){if(this.currentFile){return this.swfu.getFile(this.currentFile.id)}}else{var D=[];var C=0;var B=0;while(B<this.swfu.getStats().files_queued){var A=this.swfu.getFile(C);if(A!=null&&A.filestatus==SWFUpload.FILE_STATUS.QUEUED){D[B]=A;B++}C++}if(D.length>0){return D}}return null},getFileName:function(){var C="";if(this.singleFile){A=this.getFile();if(A){C=A.name}}else{var D=this.getFile();if(D){for(var B=0;B<D.length;B++){var A=D[B];C+=A.name+","}if(C.length>0){C=C.substring(0,C.length-1)}}}return C},getFileSize:function(F){var C="";var E=F||"";if(this.singleFile){var B=this.getFile();if(B){if(E.toLowerCase()=="kb"){size=B.size/1024;size=size.toFixed(2)}else{if(E.toLowerCase()=="mb"){size=B.size/1024/1024;size=size.toFixed(2)}else{size=B.size}}C+=size}}else{var D=this.getFile();if(D){for(var A=0;A<D.length;A++){var B=D[A];if(E.toLowerCase()=="kb"){size=B.size/1024;size=size.toFixed(2)}else{if(E.toLowerCase()=="mb"){size=B.size/1024/1024;size=size.toFixed(2)}else{size=B.size}}C+=size+","}if(C.length>0){C=C.substring(0,C.length-1)}}}return C},getAllValues:function(){var A="";if(this.singleFile){if(this.settings.custom_settings.newValue.name){A=this.settings.custom_settings.newValue.name}}else{var A=Ext.pluck(this.settings.custom_settings.newValue,"name").join()}return A},getDeletedFile:function(){return this.deleteFile},getTotalFileSize:function(){return this.swfu.totalFileSize},setFileSizeLimit:function(A){A=A*1024;this.swfu.setFileSizeLimit(Math.floor(A))},setFileTypes:function(B,C){var D=B.split(",");var A="";Ext.each(D,function(F,E,G){A+="*."+F+";"});if(A.length>0){A=A.substring(0,A.length-1)}this.swfu.setFileTypes(A,C)},deleteFileValue:function(D){if(!this.settings.custom_settings.newValue){return }var B=D;var A=this.settings.custom_settings;if(this.singleFile){if(A.newValue.id==B){A.newValue={};A.validate=false}}else{var C=[];Ext.each(this.settings.custom_settings.newValue,function(G,E,F){if(B!=G.id){C.push(G)}else{A.validate=false}},this);this.settings.custom_settings.newValue=C}this.onValueChange()},onValueChange:function(){if(this.settings.custom_settings.validate){return }if(this.settings.button_action==SWFUpload.BUTTON_ACTION.SELECT_FILE){var A="";var C="";if(this.settings.custom_settings.newValue&&this.settings.custom_settings.newValue.name){A=this.settings.custom_settings.newValue.name}if(this.settings.custom_settings.oldValue&&this.settings.custom_settings.oldValue.name){C=this.settings.custom_settings.oldValue.name}}else{var A=Ext.pluck(this.settings.custom_settings.newValue,"name").join();var C=Ext.pluck(this.settings.custom_settings.oldValue,"name").join()}Artery.regItemEvent(this.settings.custom_settings.component,"onChangeEvent","onChangeServer",{newValue:A,oldValue:C});if(this.settings.button_action==SWFUpload.BUTTON_ACTION.SELECT_FILE){this.settings.custom_settings.oldValue=this.settings.custom_settings.newValue}else{this.settings.custom_settings.oldValue=[];var B=this.settings.custom_settings.oldValue;Ext.each(this.settings.custom_settings.newValue,function(F,D,E){B.push(F)},this)}this.settings.custom_settings.validate=true},initComponent:function(){Artery.plugin.flashUpload.superclass.initComponent.call(this);this.sessionid=this.GetCookie("JSESSIONID")||this.sessionid;this.settings={flash_url:sys.getContextPath()+"/artery/arteryPlugin/tool/flashUpload/swfupload.swf",upload_url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=onUpload;jsessionid="+this.sessionid,preserve_relative_urls:true,file_post_name:this.submitName||this.id,post_params:{formid:this.formId,itemid:this.id,itemType:"flashUpload"},button_placeholder_id:this.id+"_chooseFile",custom_settings:{progressTarget:this.id+"_progress",showStatus:this.showStatus,showBar:this.showBar,component:this,validate:true},file_types:this.file_types,file_types_description:this.file_types_description,file_size_limit:this.file_size_limit,file_queue_limit:this.file_queue_limit,button_width:this.button_width,button_height:this.button_height,button_text:this.button_text,button_text_style:this.button_text_style,button_text_left_padding:this.button_text_left_padding,button_text_top_padding:this.button_text_top_padding,button_disabled:this.buttonDisabled,swfupload_loaded_handler:this.swfupload_loaded_function,file_queued_handler:this.file_queued_function,file_queue_error_handler:this.file_queue_error_function,file_dialog_start_handler:this.file_dialog_start_function,file_dialog_complete_handler:this.file_dialog_complete_function,upload_start_handler:this.upload_start_function,upload_progress_handler:this.upload_progress_function,upload_error_handler:this.upload_error_function,upload_success_handler:this.upload_success_function,upload_complete_handler:this.upload_complete_function};if(this.button_image_url!=null){this.settings.button_image_url=sys.getContextPath()+this.button_image_url}if(this.handCursor==true){this.settings.button_cursor=SWFUpload.CURSOR.HAND}if(this.singleFile==true){this.settings.button_action=SWFUpload.BUTTON_ACTION.SELECT_FILE}else{this.settings.button_action=SWFUpload.BUTTON_ACTION.SELECT_FILES}document.getElementById(this.id+"component").style.width=this.containerWidth;document.getElementById(this.id+"component").style.height=this.containerHeight;var tempValue="";if(this.value){if(this.singleFile==true){var file=Ext.util.JSON.decode(this.value);tempValue={};tempValue.id=file.value;tempValue.name=file.name;this.settings.custom_settings.oldValue=Ext.apply({},tempValue);this.settings.custom_settings.newValue=Ext.apply({},tempValue)}else{var files=Ext.util.JSON.decode(this.value);tempValue="[";for(var i=0;i<files.length-1;i++){tempValue+="{id:'"+files[i].value+"',name:'"+files[i].name+"'},"}tempValue+="{id:'"+files[files.length-1].value+"',name:'"+files[files.length-1].name+"'}";tempValue+="]";tempValue=eval(tempValue);this.settings.custom_settings.oldValue=Ext.apply([],tempValue);this.settings.custom_settings.newValue=Ext.apply([],tempValue)}this.value=null}},onRender:function(B,A){this.el=Ext.get(this.id);if(!this.el){Artery.plugin.flashUpload.superclass.onRender.call(this,B,A)}this.settings.id=this.id;this.swfu=new SWFUpload(this.settings)},afterRender:function(){Artery.plugin.flashUpload.superclass.afterRender.call(this);if(this.inputDisabled){this.disabled=true}},validateValue:function(B){var A="";if(this.singleFile){if(this.settings.custom_settings.newValue&&this.settings.custom_settings.newValue.name){A=this.settings.custom_settings.newValue.name}}else{var A=Ext.pluck(this.settings.custom_settings.newValue,"name").join()}if(Ext.isFunction(this.validator)){var C=this.validator(A);if(C!==true){this.markInvalid(C);return false}}if(this.allowBlank==false){if(Ext.isEmpty(A)&&this.swfu.getStats().files_queued==0){this.markInvalid("请输入必填项");return false}}this.clearInvalid();return true}});Ext.reg("apFlashUpload",Artery.plugin.flashUpload);var SWFUpload;var codeBase=sys.getContextPath()+"/artery/arteryConsole/ocx/Flash32_12_0_0_77.ocx#version=12.0.0.77";if(SWFUpload==undefined){SWFUpload=function(A){this.initSWFUpload(A)}}SWFUpload.prototype.initSWFUpload=function(B){try{this.customSettings={};this.settings=B;this.eventQueue=[];this.movieName="SWFUpload_"+B.id+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(A){delete SWFUpload.instances[this.movieName];throw A}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.completeURL=function(A){if(typeof (A)!=="string"||A.match(/^https?:\/\//i)||A.match(/^\//)){return A}var C=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var B=window.location.pathname.lastIndexOf("/");if(B<=0){path="/"}else{path=window.location.pathname.substr(0,B)+"/"}return path+A};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(B,A){this.settings[B]=(this.settings[B]==undefined)?A:this.settings[B]};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.TRANSPARENT);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime()}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){var A,B;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}A=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(A==undefined){throw"Could not find the placeholder element: "+this.settings.button_placeholder_id}B=document.createElement("div");B.innerHTML=this.getFlashHTML();A.parentNode.replaceChild(B.firstChild,A);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement()}};SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" codeBase="',codeBase,'" height="',this.settings.button_height,'" class="swfupload" >','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var B=this.buildParamString();var A=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(A),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(B),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var C=this.settings.post_params;var B=[];if(typeof (C)==="object"){for(var A in C){if(C.hasOwnProperty(A)){B.push(encodeURIComponent(A.toString())+"="+encodeURIComponent(C[A].toString()))}}}return B.join("&amp;")};SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,false);var A=null;A=this.getMovieElement();if(A&&typeof (A.CallFunction)==="unknown"){for(var C in A){try{if(typeof (A[C])==="function"){A[C]=null}}catch(E){}}try{A.parentNode.removeChild(A)}catch(B){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true}catch(D){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))};SWFUpload.prototype.addSetting=function(B,C,A){if(C==undefined){return(this.settings[B]=A)}else{return(this.settings[B]=C)}};SWFUpload.prototype.getSetting=function(A){if(this.settings[A]!=undefined){return this.settings[A]}return""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement();var returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(A){this.callFlash("StartUpload",[A])};SWFUpload.prototype.cancelUpload=function(A,B){if(B!==false){B=true}this.callFlash("CancelUpload",[A,B])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(A){this.callFlash("SetStats",[A])};SWFUpload.prototype.getFile=function(A){if(typeof (A)==="number"){return this.callFlash("GetFileByIndex",[A])}else{return this.callFlash("GetFile",[A])}};SWFUpload.prototype.addFileParam=function(A,B,C){return this.callFlash("AddFileParam",[A,B,C])};SWFUpload.prototype.removeFileParam=function(A,B){this.callFlash("RemoveFileParam",[A,B])};SWFUpload.prototype.setUploadURL=function(A){this.settings.upload_url=A.toString();this.callFlash("SetUploadURL",[A])};SWFUpload.prototype.setPostParams=function(A){this.settings.post_params=A;this.callFlash("SetPostParams",[A])};SWFUpload.prototype.addPostParam=function(A,B){this.settings.post_params[A]=B;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(A){delete this.settings.post_params[A];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(A,B){this.settings.file_types=A;this.settings.file_types_description=B;this.callFlash("SetFileTypes",[A,B])};SWFUpload.prototype.setFileSizeLimit=function(A){this.settings.file_size_limit=A;this.callFlash("SetFileSizeLimit",[A])};SWFUpload.prototype.setFileUploadLimit=function(A){this.settings.file_upload_limit=A;this.callFlash("SetFileUploadLimit",[A])};SWFUpload.prototype.setFileQueueLimit=function(A){this.settings.file_queue_limit=A;this.callFlash("SetFileQueueLimit",[A])};SWFUpload.prototype.setFilePostName=function(A){this.settings.file_post_name=A;this.callFlash("SetFilePostName",[A])};SWFUpload.prototype.setUseQueryString=function(A){this.settings.use_query_string=A;this.callFlash("SetUseQueryString",[A])};SWFUpload.prototype.setRequeueOnError=function(A){this.settings.requeue_on_error=A;this.callFlash("SetRequeueOnError",[A])};SWFUpload.prototype.setHTTPSuccess=function(A){if(typeof A==="string"){A=A.replace(" ","").split(",")}this.settings.http_success=A;this.callFlash("SetHTTPSuccess",[A])};SWFUpload.prototype.setAssumeSuccessTimeout=function(A){this.settings.assume_success_timeout=A;this.callFlash("SetAssumeSuccessTimeout",[A])};SWFUpload.prototype.setDebugEnabled=function(A){this.settings.debug_enabled=A;this.callFlash("SetDebugEnabled",[A])};SWFUpload.prototype.setButtonImageURL=function(A){if(A==undefined){A=""}this.settings.button_image_url=A;this.callFlash("SetButtonImageURL",[A])};SWFUpload.prototype.setButtonDimensions=function(C,A){this.settings.button_width=C;this.settings.button_height=A;var B=this.getMovieElement();if(B!=undefined){B.style.width=C+"px";B.style.height=A+"px"}this.callFlash("SetButtonDimensions",[C,A])};SWFUpload.prototype.setButtonText=function(A){this.settings.button_text=A;this.callFlash("SetButtonText",[A])};SWFUpload.prototype.setButtonTextPadding=function(B,A){this.settings.button_text_top_padding=A;this.settings.button_text_left_padding=B;this.callFlash("SetButtonTextPadding",[B,A])};SWFUpload.prototype.setButtonTextStyle=function(A){this.settings.button_text_style=A;this.callFlash("SetButtonTextStyle",[A])};SWFUpload.prototype.setButtonDisabled=function(A){this.settings.button_disabled=A;this.callFlash("SetButtonDisabled",[A])};SWFUpload.prototype.setButtonAction=function(A){this.settings.button_action=A;this.callFlash("SetButtonAction",[A])};SWFUpload.prototype.setButtonCursor=function(A){this.settings.button_cursor=A;this.callFlash("SetButtonCursor",[A])};SWFUpload.prototype.queueEvent=function(B,C){if(C==undefined){C=[]}else{if(!(C instanceof Array)){C=[C]}}var A=this;if(typeof this.settings[B]==="function"){this.eventQueue.push(function(){this.settings[B].apply(this,C)});setTimeout(function(){A.executeNextEvent()},0)}else{if(this.settings[B]!==null){throw"Event handler "+B+" is unknown or is not a function"}}};SWFUpload.prototype.executeNextEvent=function(){var A=this.eventQueue?this.eventQueue.shift():null;if(typeof (A)==="function"){A.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(C){var E=/[$]([0-9a-f]{4})/i;var F={};var D;if(C!=undefined){for(var A in C.post){if(C.post.hasOwnProperty(A)){D=A;var B;while((B=E.exec(D))!==null){D=D.replace(B[0],String.fromCharCode(parseInt("0x"+B[1],16)))}F[D]=C.post[A]}}C.post=F}return C};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(A){return false}};SWFUpload.prototype.flashReady=function(){var A=this.getMovieElement();if(!A){this.debug("Flash called back ready but the flash movie can't be found.");return }this.cleanUp(A);this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(A){try{if(this.movieElement&&typeof (A.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var C in A){try{if(typeof (A[C])==="function"){A[C]=null}}catch(B){}}}}catch(D){}window.__flash__removeCallback=function(E,F){try{if(E){E[F]=null}}catch(G){}}};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("file_queued_handler",A)};SWFUpload.prototype.fileQueueError=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("file_queue_error_handler",[A,C,B])};SWFUpload.prototype.fileDialogComplete=function(B,C,A){this.queueEvent("file_dialog_complete_handler",[B,C,A])};SWFUpload.prototype.uploadStart=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("return_upload_start_handler",A)};SWFUpload.prototype.returnUploadStart=function(A){var B;if(typeof this.settings.upload_start_handler==="function"){A=this.unescapeFilePostParams(A);B=this.settings.upload_start_handler.call(this,A)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(B===undefined){B=true}B=!!B;this.callFlash("ReturnUploadStart",[B])};SWFUpload.prototype.uploadProgress=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("upload_progress_handler",[A,C,B])};SWFUpload.prototype.uploadError=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("upload_error_handler",[A,C,B])};SWFUpload.prototype.uploadSuccess=function(B,A,C){B=this.unescapeFilePostParams(B);this.queueEvent("upload_success_handler",[B,A,C])};SWFUpload.prototype.uploadComplete=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("upload_complete_handler",A)};SWFUpload.prototype.debug=function(A){this.queueEvent("debug_handler",A)};SWFUpload.prototype.debugMessage=function(C){if(this.settings.debug){var A,D=[];if(typeof C==="object"&&typeof C.name==="string"&&typeof C.message==="string"){for(var B in C){if(C.hasOwnProperty(B)){D.push(B+": "+C[B])}}A=D.join("\n")||"";D=A.split("\n");A="EXCEPTION: "+D.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(A)}else{SWFUpload.Console.writeLine(C)}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(D){var B,A;try{B=document.getElementById("SWFUpload_Console");if(!B){A=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(A);B=document.createElement("textarea");B.id="SWFUpload_Console";B.style.fontFamily="monospace";B.setAttribute("wrap","off");B.wrap="off";B.style.overflow="auto";B.style.width="700px";B.style.height="350px";B.style.margin="5px";A.appendChild(B)}B.value+=D+"\n";B.scrollTop=B.scrollHeight-B.clientHeight}catch(C){alert("Exception: "+C.name+" Message: "+C.message)}};function getContextPath(){var C=document.location.pathname;var B=C.substr(1).indexOf("/");var A=C.substr(0,B+1);return A}function FileProgress(C,A,F){this.fileProgressID=C.id;this.opacity=100;this.height=0;this.showFileSize=F;this.fileProgressWrapper=document.getElementById(this.fileProgressID);if(!this.fileProgressWrapper){this.fileProgressWrapper=document.createElement("div");this.fileProgressWrapper.className="x-flashUpload-progressWrapper";this.fileProgressWrapper.id=this.fileProgressID;this.fileProgressElement=document.createElement("div");this.fileProgressElement.className="x-flashUpload-progressContainer";var H=document.createElement("a");H.className="x-flashUpload-progressCancel";H.style.visibility="hidden";H.innerHTML="click";H.appendChild(document.createTextNode(" "));var B=document.createElement("div");B.className="x-flashUpload-progressName";if(this.showFileSize){var E=C.name+"  ("+Number(C.size/1024/1024).toFixed(2)+"MB)";B.appendChild(document.createTextNode(E));this.fileProgressElement.title=E}else{B.appendChild(document.createTextNode(C.name));this.fileProgressElement.title=C.name}var G=document.createElement("div");G.className="x-flashUpload-progressBarInProgress";var D=document.createElement("div");D.className="x-flashUpload-progressBarStatus";D.innerHTML="&nbsp;";this.fileProgressElement.appendChild(H);this.fileProgressElement.appendChild(B);this.fileProgressElement.appendChild(D);this.fileProgressElement.appendChild(G);this.fileProgressWrapper.appendChild(this.fileProgressElement);document.getElementById(A).appendChild(this.fileProgressWrapper)}else{this.fileProgressElement=this.fileProgressWrapper.firstChild;this.reset()}this.height=this.fileProgressWrapper.offsetHeight;this.setTimer(null)}FileProgress.prototype.setTimer=function(A){this.fileProgressElement.FP_TIMER=A};FileProgress.prototype.getTimer=function(A){return this.fileProgressElement.FP_TIMER||null};FileProgress.prototype.reset=function(){this.fileProgressElement.className="x-flashUpload-progressContainer";this.fileProgressElement.childNodes[2].innerHTML="&nbsp;";this.fileProgressElement.childNodes[2].className="x-flashUpload-progressBarStatus";this.fileProgressElement.childNodes[3].className="x-flashUpload-progressBarInProgress";this.fileProgressElement.childNodes[3].style.width="0%";this.appear()};FileProgress.prototype.setProgress=function(A){this.fileProgressElement.className="x-flashUpload-progressContainer x-flashUpload-green";this.fileProgressElement.childNodes[3].className="x-flashUpload-progressBarInProgress";this.fileProgressElement.childNodes[3].style.width=A+"%";this.appear()};FileProgress.prototype.setComplete=function(A){this.fileProgressElement.className="x-flashUpload-progressContainer x-flashUpload-blue";this.fileProgressElement.childNodes[3].className="x-flashUpload-progressBarComplete";this.fileProgressElement.childNodes[3].style.width=""};FileProgress.prototype.setError=function(B){this.fileProgressElement.className="x-flashUpload-progressContainer x-flashUpload-red";this.fileProgressElement.childNodes[3].className="x-flashUpload-progressBarError";this.fileProgressElement.childNodes[3].style.width="";if(B){var A=2000;try{A=Number(B)}catch(D){}if(B>0){var C=this;this.setTimer(setTimeout(function(){C.disappear()},A))}else{this.disappear()}}};FileProgress.prototype.setCancelled=function(B){this.fileProgressElement.className="x-flashUpload-progressContainer";this.fileProgressElement.childNodes[3].className="x-flashUpload-progressBarError";this.fileProgressElement.childNodes[3].style.width="";this.fileProgressElement.childNodes[0].style.display="none";if(B){var A=2000;try{A=Number(B)}catch(D){}var C=this;if(B>0){this.setTimer(setTimeout(function(){C.disappear()},A))}else{this.setTimer(setTimeout(function(){C.disappear()},2000))}}};FileProgress.prototype.setStatus=function(A){this.fileProgressElement.childNodes[2].innerHTML=A};FileProgress.prototype.toggleCancel=function(A,C){this.fileProgressElement.childNodes[0].style.visibility=A?"visible":"hidden";var D=this;if(C){var B=C.getFile(D.fileProgressID);if(A){this.fileProgressElement.childNodes[0].onclick=function(){D.fileProgressElement.childNodes[0].style.visibility="hidden";if(B){C.cancelUpload(D.fileProgressID)}}}else{if(B){C.cancelUpload(D.fileProgressID)}}}};FileProgress.prototype.appear=function(){if(this.getTimer()!==null){clearTimeout(this.getTimer());this.setTimer(null)}if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=100}catch(A){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)"}}else{this.fileProgressWrapper.style.opacity=1}this.fileProgressWrapper.style.height="";this.height=this.fileProgressWrapper.offsetHeight;this.opacity=100};FileProgress.prototype.disappear=function(){var E=5;var C=1;var B=1;if(this.opacity>0){this.opacity-=E;if(this.opacity<0){this.opacity=0}if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=this.opacity}catch(D){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+this.opacity+")"}}else{this.fileProgressWrapper.style.opacity=this.opacity/100}}if(this.height>0){this.height-=C;if(this.height<0){this.height=0}this.fileProgressWrapper.style.height=this.height+"px"}if(this.height>0||this.opacity>0){var A=this;this.setTimer(setTimeout(function(){A.disappear()},B))}else{this.fileProgressWrapper.style.display="none";this.setTimer(null)}};FileProgress.prototype.toggleStatus=function(A){this.fileProgressElement.childNodes[2].style.display=A?"block":"none"};FileProgress.prototype.toggleBar=function(A){this.fileProgressElement.childNodes[3].style.display=A?"block":"none"};Artery.plugin.PercentBar=Ext.extend(Artery.plugin.BaseContainer,{showPercentNum:true,innerBarEl:null,numEl:null,initComponent:function(){Artery.plugin.PercentBar.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.PercentBar.superclass.onRender.call(this,B,A);this.innerBarEl=this.el.child(".x-percentBar-inner");if(this.showPercentNum){this.numEl=this.el.child(".x-percentBar-num")}},setPercentNum:function(A){this.innerBarEl.setStyle("width",A+"%");if(this.numEl){this.numEl.update(A+"%")}}});Ext.reg("appercentbar",Artery.plugin.PercentBar);Artery.plugin.Star=Ext.extend(Artery.plugin.BaseContainer,{starAllNum:null,starSelNum:null,starType:null,canSel:null,currentRatingEl:null,extInfoEl:null,initComponent:function(){Artery.plugin.Star.superclass.initComponent.call(this)},onRender:function(B,A){Artery.plugin.Star.superclass.onRender.call(this,B,A);this.extInfoEl=this.el.child(".star-extInfo");if(this.canSel){this.el.select(".star-item").each(function(E,D,C){E.on("click",function(G,F,H){if(this.currentRatingEl==null){this.currentRatingEl=Ext.get(this.id).child(".current-rating")}if(this.currentRatingEl!=null){this.currentRatingEl.removeClass("current-rating")}this.currentRatingEl=Ext.get(F).parent();this.currentRatingEl.addClass("current-rating");this.starSelNum=H.idx+1;this.currentRatingEl.setStyle("width",this.getStarWidth()*this.starSelNum)},this,{idx:C})},this)}},getStarWidth:function(){return this.starType=="big"?32:18},setStarSelNum:function(A){if(this.num<1||this.num>this.starAllNum){return }if(this.currentRatingEl==null){this.currentRatingEl=Ext.get(this.id).child(".current-rating")}if(this.currentRatingEl!=null){this.currentRatingEl.removeClass("current-rating")}this.starSelNum=A;this.currentRatingEl=this.el.select(".star-item").item(A-1).parent();this.currentRatingEl.addClass("current-rating");this.currentRatingEl.setStyle("width",this.getStarWidth()*this.starSelNum)},setExtInfo:function(A){this.extInfoEl.update(A)},getValue:function(){if(this.starSelNum==null){return 0}return this.starSelNum}});Ext.reg("apstar",Artery.plugin.Star);Artery.plugin.TbButton=Ext.extend(Artery.plugin.BaseButton,{});Ext.reg("apTbButton",Artery.plugin.TbButton);Artery.plugin.TbChangePassword=Ext.extend(Artery.plugin.BaseButton,{oldPasswordField:null,newPassword1Field:null,newPassword2Field:null,spanId:null,changeWindow:null,initComponent:function(){this.oldPasswordField=new Ext.form.TextField({fieldLabel:"旧密码",inputType:"password",anchor:"98%"});this.newPassword1Field=new Ext.form.TextField({fieldLabel:"新密码",inputType:"password",anchor:"98%"});this.newPassword2Field=new Ext.form.TextField({fieldLabel:"确认新密码",inputType:"password",anchor:"98%"});var A=new Ext.form.FormPanel({baseCls:"x-plain",labelWidth:70,items:[this.oldPasswordField,this.newPassword1Field,this.newPassword2Field]});var B=this;this.spanId=Ext.id();this.changeWindow=new Ext.Window({layout:"anchor",title:"修改密码",width:400,height:190,plain:true,resizable:true,closeAction:"hide",bodyStyle:"padding:5px;",buttonAlign:"right",modal:true,items:[A,{baseCls:"x-plain",html:"<span id='"+this.spanId+'\' style="color:red;"></span>'}],buttons:[{text:"确 定",handler:function(){B.changepw()}},{text:"取消",handler:function(){B.changeWindow.setVisible(false)}}]});this.mon(this,this.clickEvent,this.clickHandler,this);Artery.plugin.TbChangePassword.superclass.initComponent.call(this)},clickHandler:function(){this.oldPasswordField.setValue();this.newPassword1Field.setValue();this.newPassword2Field.setValue();var A=document.getElementById(this.spanId);if(A){A.innerHTML=""}this.changeWindow.show()},changepw:function(){var C=this.oldPasswordField.getValue();var B=this.newPassword1Field.getValue();var A=this.newPassword2Field.getValue();if(B!=A){document.getElementById(this.spanId).innerHTML="‘新密码’与‘确认新密码’不一致";return }if(C==B){document.getElementById(this.spanId).innerHTML="‘新密码’与‘旧密码’一样";return }var D=Artery.getParams({oldvalue:C,newvalue:B,method:"alterPassword"},this);Artery.request({url:sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic",success:function(E,F){var G=E.responseText;if(G.trim()=="ok"){this.changeWindow.setVisible(false);Ext.getBody().mask("<font color=red>修改密码成功</font>");(function(){Ext.getBody().unmask()}).defer(2000)}else{document.getElementById(this.spanId).innerHTML=G}Artery.regItemEvent(this,"onPassModiEvent","onPassModiServer",{msg:G})},params:D,scope:this})}});Ext.reg("apTbChangePassword",Artery.plugin.TbChangePassword);Artery.plugin.TbLogout=Ext.extend(Artery.plugin.BaseButton,{clickHandler:function(){Artery.runLogic({params:{itemid:this.id,method:"logout",formid:Artery.getFormId(this)},scope:this,callback:function(A){if(A.success){window.location.href=sys.getContextPath()}}})},initComponent:function(){Artery.plugin.BaseButton.superclass.initComponent.call(this);this.mon(this,this.clickEvent,this.clickHandler,this)}});Ext.reg("apTblogout",Artery.plugin.TbLogout);Artery.plugin.TbSearch=Ext.extend(Artery.plugin.BaseButton,{clickHandler:function(){var B={target:this.target};var A="/artery/search.do?action=make";if(this.params){var D=null;if((typeof this.params)=="object"){D=this.params}else{D=Ext.decode(this.params)}for(var C in D){A=A+"&"+C+"="+D[C]}}B.url=A;Artery.openForm(B)},initComponent:function(){Artery.plugin.BaseButton.superclass.initComponent.call(this);this.mon(this,this.clickEvent,this.clickHandler,this)}});Ext.reg("apTbSearch",Artery.plugin.TbSearch);Artery.plugin.sysChange=function(B){var C=Ext.getDom(B).value;if(C!="-1"){var A=sys.getContextPath()+"/artery/subsys.do?action=enterSystem&sysID="+C;window.location=A}};Artery.plugin.TbSysChangeButton=Ext.extend(Artery.plugin.BaseButton,{sysArray:null,sysStore:null,myDataView:null,selectWindow:null,isWindow:false,selectEl:null,onRender:function(B,A){this.selectEl=Ext.get(this.id);if(this.isWindow){Artery.plugin.TbSysChangeButton.superclass.onRender.call(this,B,A)}},onDestroy:function(){Ext.Button.superclass.onDestroy.call(this);if(this.container){this.container.remove()}},openWindow:function(){this.selectWindow.show()},hide:function(){if(this.isWindow){Ext.BoxComponent.superclass.hide.call(this)}else{this.hideSelect()}},hideSelect:function(){var A=this.selectEl.findParent("td",3,true);if(A&&A!=null){A.addClass("x-hide-"+this.hideMode)}},show:function(){if(this.isWindow){Ext.BoxComponent.superclass.hide.call(this)}else{this.showSelect()}},showSelect:function(){var A=this.selectEl.findParent("td",3,true);if(A&&A!=null){A.removeClass("x-hide-"+this.hideMode)}},disable:function(){if(this.isWindow){Ext.BoxComponent.superclass.disable.call(this)}else{this.disableSelect()}},disableSelect:function(){var A=this.selectEl.findParent("td",3,true);A.addClass(this.disabledClass);this.selectEl.dom.disabled=true},enable:function(){if(this.isWindow){Ext.BoxComponent.superclass.enable.call(this)}else{this.enableSelect()}},enableSelect:function(){var A=this.selectEl.findParent("td",3,true);A.removeClass(this.disabledClass);this.selectEl.dom.disabled=false},initComponent:function(){if(!this.isWindow){return }if(this.sysArray===null){alert("必须设置子系统数组：sysArray");return }this.sysStore=new Ext.data.SimpleStore({fields:["name","url","id"],data:this.sysArray});var A=new Ext.XTemplate('<tpl for=".">','<div class="thumb-wrap" sysID="{id}" style="width:80;height:40;">','  <div class="thumb">','    <table width=100% height=100%><tr><td align="center" vertical-align="middle">','      <img src="{url}" title="{name}">',"    </td></tr></table>","  </div>",'  <span style="font: 11px Arial, Helvetica, sans-serif;">{shortName}</span>',"</div>","</tpl>",'<div class="x-clear"></div>');this.myDataView=new Ext.DataView({store:this.sysStore,tpl:A,autoHeight:true,autoWidth:true,overClass:"x-view-over",itemSelector:"div.thumb-wrap",emptyText:"No images to display",prepareData:function(B){B.shortName=Ext.util.Format.ellipsis(B.name,15);return B},listeners:{click:function(B,D,E,F){if(E.sysID){var C=sys.getContextPath()+"/artery/subsys.do?action=enterSystem&sysID="+E.sysID;window.location=C}}}});this.selectWindow=new Ext.Window({title:"子系统切换",width:445,resizable:false,bodyStyle:"background-color: #aabbdd;",closeAction:"hide",closable:true,border:false,layout:"fit",items:[this.myDataView]});this.mon(this,this.clickEvent,this.openWindow,this);Artery.plugin.TbSysChangeButton.superclass.initComponent.call(this)}});Ext.reg("apTbSysChangeButton",Artery.plugin.TbSysChangeButton);Artery.plugin.TbText=function(A){Artery.plugin.TbText.superclass.constructor.call(this,A);this.el=Ext.get(A.id)};Ext.extend(Artery.plugin.TbText,Ext.Toolbar.Item,{onRender:function(A){this.td=A;this.td.appendChild(this.el.dom);if(this.hidden){this.hide()}},updateText:function(A){this.el.dom.innerHTML=A},setValue:function(A){this.updateText(A)},setText:function(A){this.updateText(A)},setHtml:function(A){this.updateText(A)}});Ext.reg("apTbText",Artery.plugin.TbText);Artery.plugin.Toolbar=Ext.extend(Ext.Toolbar,{initComponent:function(){Artery.plugin.Toolbar.superclass.initComponent.call(this)},onRender:function(B,A){this.el=Ext.get(this.id)},getLayout:function(){return null}});Ext.reg("apToolbar",Artery.plugin.Toolbar);Artery.plugin.PagingToolbar=Ext.extend(Ext.PagingToolbar,{displayMsg:"本页显示:{0} - {1} 总记录数:{2}",beforePageText:"第",afterPageText:"页 共 {0} 页",emptyMsg:"无记录",initComponent:function(){var A=this.listItemId;Ext.apply(Artery["cfg_"+A+"_page_first"],{tooltip:this.firstText,overflowText:this.firstText,disabled:true,handler:this.moveFirst,scope:this});this.first=Artery.get(A+"_page_first");Ext.apply(Artery["cfg_"+A+"_page_prev"],{tooltip:this.prevText,overflowText:this.prevText,disabled:true,handler:this.movePrevious,scope:this});this.prev=Artery.get(A+"_page_prev");this.inputItem=Ext.getDom(this.listItemId+"_page_number");this.inputItem.setValue=function(B){this.value=B};this.inputItem.getValue=function(){return this.value};this.inputItem.select=function(){this.focus()};Ext.get(this.inputItem).on("keydown",this.onPagingKeyDown,this);this.afterTextItem=new Ext.Toolbar.TextItem({applyTo:this.listItemId+"_page_afterText",text:String.format(this.afterPageText,1)});Ext.apply(Artery["cfg_"+A+"_page_next"],{tooltip:this.nextText,overflowText:this.nextText,disabled:true,handler:this.moveNext,scope:this});this.next=Artery.get(A+"_page_next");Ext.apply(Artery["cfg_"+A+"_page_last"],{tooltip:this.lastText,overflowText:this.lastText,disabled:true,handler:this.moveLast,scope:this});this.last=Artery.get(A+"_page_last");Ext.apply(Artery["cfg_"+A+"_page_refresh"],{tooltip:this.refreshText,overflowText:this.refreshText,handler:this.refresh,scope:this});this.refresh=Artery.get(A+"_page_refresh");if(this.displayInfo){this.displayItem=new Ext.Toolbar.TextItem({applyTo:this.listItemId+"_page_info"})}Ext.PagingToolbar.superclass.initComponent.call(this);this.addEvents("change","beforechange");this.on("afterlayout",this.onFirstLayout,this,{single:true});this.cursor=0;this.bindStore(this.store);this.el=this.container=Ext.get(this.id);this.layout=null;this.rendered=true},updatePageNumber:function(B){try{if(B>0){B=1}else{if(B<0){B=-1}else{return }}var D="";var I=Ext.get(this.listItemId+"_page_info");if(!I){return }D=I.dom.innerText;var G=this.displayMsg.indexOf("{1}");var E=this.displayMsg.indexOf("{2}");var F="";if(G>-1&&E>G){var C=this.displayMsg.substring(G+3,E);F=D.indexOf(C)!=-1?D.substring(D.indexOf(C)+C.length):""}if(F!=""){F=parseInt(F);if(F>1){var A=new RegExp(F,"gm");D=D.replace(A,F+B)}else{if(F==1){if(B>0){D=this.displayMsg.format(1,2,2)}else{D=this.emptyMsg}}}}else{if(B>0){D=this.displayMsg.format(1,1,1)}else{D=this.emptyMsg}}I.dom.innerText=D}catch(H){}},onPagingKeyDown:function(E,D){var B=E.getKey(),F=this.getPageData(),C;if(B==E.RETURN){E.stopEvent();C=this.readPage(F);if(C!==false){C=Math.min(Math.max(1,C),F.pages)-1;this.doLoad(C*this.pageSize)}}else{if(B==E.HOME||B==E.END){E.stopEvent();C=B==E.HOME?1:F.pages;D.dom.setValue(C)}else{if(B==E.UP||B==E.PAGEUP||B==E.DOWN||B==E.PAGEDOWN){E.stopEvent();if((C=this.readPage(F))){var A=E.shiftKey?10:1;if(B==E.DOWN||B==E.PAGEDOWN){A*=-1}C+=A;if(C>=1&C<=F.pages){D.dom.setValue(C)}}}}}},getLayout:function(){return null},bindStore:function(B,C){var A;if(!C&&this.store){if(B!==this.store&&this.store.autoDestroy){this.store.destroy()}else{this.store.un("beforeload",this.beforeLoad,this);this.store.un("load",this.onLoad,this);this.store.un("exception",this.onLoadError,this)}if(!B){this.store=null}}if(B){if(Ext.StoreMgr){B=Ext.StoreMgr.lookup(B)}B.on({scope:this,beforeload:this.beforeLoad,load:this.onLoad,exception:this.onLoadError});A=true}this.store=B;if(A){this.onLoad(B,null,{})}},updateInfo:function(){this.cursor=(this.store.currPageNo-1)*this.store.rowsPerPage;if(this.displayItem){var D=this.store.getCount();var B=this.store.getTotalCount();var H=this.store.currPageNo*this.store.rowsPerPage;var A=H<B?H:B;var G=D==0?this.emptyMsg:String.format(this.displayMsg,(this.store.currPageNo-1)*this.store.rowsPerPage+1,A,B);this.displayItem.setText(G)}if(this.inputItem){this.inputItem.setValue(this.store.currPageNo)}var F=this.getPageData(),C=F.activePage,E=F.pages;this.first.setDisabled(C==1);this.prev.setDisabled(C==1);this.next.setDisabled(C==E);this.last.setDisabled(C==E)},doLoad:function(C){var B={},A=this.getParams();B[A.start]=C;B[A.limit]=this.pageSize;B.totalCount=this.store.getTotalCount();if(this.store.lastOptions){Artery.applyIf(B,this.store.lastOptions.params)}if(this.fireEvent("beforechange",this,B)!==false){this.store.load({params:B})}}});Ext.reg("apPagingToolbar",Artery.plugin.PagingToolbar);Artery.plugin.TreeArea=Ext.extend(Ext.tree.TreePanel,{treeLoaderData:null,selType:"none",expandTree:false,value:"",vo:null,cascade:false,cascadeParent:"allchild",autoScroll:true,animate:false,enableDD:false,rootVisible:false,reloadParams:null,initComponent:function(){this.reloadParams={};this.vo={};if(this.hidden){this.hidden=false;this.on("render",function(){this.hide()},this);this.on("show",function(){this.doLayout()},this)}var tree=this;var treeLoaderCfg={};if(this.selType=="radio"){var uuid=Ext.id();treeLoaderCfg={baseAttrs:{uiProvider:Ext.tree.TreeSingleNodeUI,uuid:uuid,cls:"x-btn-text-icon",disable:true}};this.eventModel=Ext.tusc.TreeRadioEvent}else{if(this.selType=="checkbox"){}else{treeLoaderCfg.createNode=function(attr){if(this.baseAttrs){Ext.applyIf(attr,this.baseAttrs)}if(this.applyLoader!==false){attr.loader=this}attr.checked=null;if(typeof attr.uiProvider=="string"){attr.uiProvider=this.uiProviders[attr.uiProvider]||eval(attr.uiProvider)}if(attr.nodeType){return new Ext.tree.TreePanel.nodeTypes[attr.nodeType](attr)}else{return attr.leaf?new Ext.tree.TreeNode(attr):new Ext.tree.AsyncTreeNode(attr)}}}}if(this.treeLoaderData==null){treeLoaderCfg.dataUrl=sys.getContextPath()+"/artery/form/dealParse.do?action=runItemLogic&method=loadCustTreeNode";treeLoaderCfg.listeners={beforeload:function(treeLoader,node){Ext.apply(this.baseParams,tree.reloadParams);this.baseParams.itemid=tree.dynamicNodeId;this.baseParams.node_type=node.attributes.type;this.baseParams.node_cid=node.attributes.cid;this.baseParams.node_name=node.text;this.baseParams.node_leaf=node.isLeaf()+"";if(node.attributes.cfg){this.baseParams.node_cfg=Ext.encode(node.attributes.cfg)}if(node.attributes.iconId){this.baseParams.node_iconId=node.attributes.iconId}Ext.applyIf(this.baseParams,Artery.getParams({},tree));this.baseParams.custParams=Ext.encode(tree.custParams);if(tree.onBeforeLoadEvent){Artery.regItemEvent(tree,"onBeforeLoadEvent",null,{loader:treeLoader,node:node})}}}}this.loader=new Ext.tree.TreeLoader(treeLoaderCfg);this.loader.on("load",this.onLoadHandler,this);this.on("expandnode",this.onExpandnode,this);this.on("checkchange",this.onCheckchange,this);this.on("click",this.onNodeClickHandler);Artery.plugin.TreeArea.superclass.initComponent.call(this);this.setRootNode(new Ext.tree.AsyncTreeNode({text:"root",id:"root",type:"root",cid:"root",expanded:true,children:this.treeLoaderData}))},onLoadHandler:function(H,C){var A=C.childNodes;if(A==null||A.length==0){return }var I=null;for(var E=0;E<A.length;E++){if(A[E].attributes.selected){A[E].fireEvent("click",A[E])}if(I==null&&!A[E].leaf&&A[E].attributes.children!=null){var G=A[E].attributes.children;var B=G.length;for(var D=0;D<B;D++){I=this.findSelectedNodePath(G[D]);if(I!=null){var F=A[E].attributes.cid;if(!F){F=Ext.id();A[E].attributes.cid=F}I.push(F)}}}}if(I!=null){this.expandNode(I.reverse().join(","))}},onNodeClickHandler:function(A){if(A.disabled===true){return }if(this.onNodeClick){this.onNodeClick(A)}},findSelectedNodePath:function(C){var F=C.cid;if(!F){F=Ext.id();C.cid=F}if(C.selected){var D=[];D.push(F);return D}var D;if(!C.leaf&&C.children){var E=C.children;var B=E.length;for(var A=0;A<B;A++){D=this.findSelectedNodePath(E[A]);if(D!=null){D.push(F);return D}}}},reload:function(A){this.reloadParams=null;this.setValue("");if(A==null){A={}}if(A.params==null){this.reloadParams={}}else{this.reloadParams=A.params}this.root.reload(A.callback,this)},onRender:function(B,A){Artery.plugin.BasePanel.prototype.onRender.call(this,B,A);this.el.addClass("x-tree");this.innerCt=this.body.createChild({tag:"ul",cls:"x-tree-root-ct "+(this.useArrows?"x-tree-arrows":this.lines?"x-tree-lines":"x-tree-no-lines")});this.setValue(this.value);if(this.treeLoaderData==null&&this.expandTree){this.root.expand(true,false)}},getLayout:function(){return null},getValue:function(){var A=[];for(var B in this.vo){A.push(B)}var C=Artery.getMultiSelectSeparator();return A.join(C)},setValue:function(E){this.vo={};if(E!=null){E=Artery.getCommaSplitValue(E);var F=Artery.getMultiSelectSeparator();var A=E.split(F);for(var B=0;B<A.length;B++){this.vo[A[B]]=""}}if(!this.rendered){return l}var C=this;var D=function(G){C.sureNode(G,true,true);G.isClick=false;if(!G.isLeaf()&&(!G.isLoaded||G.isLoaded())){G.eachChild(D)}};D(this.root)},onExpandnode:Artery.plugin.faTreeFunc.onExpandnode,sureNode:function(C,B,A){if(this.vo[C.attributes.cid]!=undefined||((A==undefined||!A)&&C.ui.checkbox&&C.ui.checkbox.checked)){if(C.ui.checkbox){C.ui.checkbox.checked=true;this.addRecord(C)}if(this.cascade){C.attributes.cascadestatus="2"}}else{if(C.ui.checkbox){C.ui.checkbox.checked=false}if(this.cascade&&C.attributes.cascadestatus!==undefined){C.attributes.cascadestatus="0"}}if(B===true){delete C.attributes.cascadestatus}},delRecord:function(A){var B=A.attributes.cid;if(this.vo[B]!=undefined){delete this.vo[B]}if(A.ui&&A.ui.checkbox){A.ui.checkbox.checked=false}},addRecord:function(A){var B=A.attributes.cid;if(this.selType=="checkbox"){if(this.vo[B]==undefined){this.vo[B]=""}}else{this.vo={};this.vo[B]=""}},onCheckchange:Artery.plugin.faTreeFunc.onCheckchange,onCascadeNode:Artery.plugin.faTreeFunc.onCascadeNode});Ext.reg("aptreearea",Artery.plugin.TreeArea);Artery.plugin.NTKOPanel=Ext.extend(Ext.BoxComponent,{Caption:"",Menubar:true,ToolBars:true,Statusbar:true,BorderStyle:0,FileNew:true,FileOpen:true,FileClose:false,FileSave:false,FileSaveAs:true,FilePrint:true,FilePrintPreview:true,FilePageSetup:true,FileProperties:true,IsStrictNoCopy:false,IsUseUTF8Data:true,loadDoc:function(A){if(A){this.ntko.BeginOpenFromURL(A,true)}else{this.ntko.BeginOpenFromURL(sys.getContextPath()+"/artery/pub/_blank.doc")}},openDoc:function(){this.ntko.ShowDialog(1)},saveAs:function(){this.ntko.ShowDialog(3)},printSetup:function(){this.ntko.ShowDialog(5)},preview:function(){this.ntko.PrintPreview()},print:function(A){this.ntko.PrintOut(A)},save:function(){var E=sys.getContextPath()+"/artery/writparse.do?action=uploadFile";E+="&runTimeType="+Artery.params.runTimeType+"&writtplid="+Artery.params.writtplid;E+="&writid="+Artery.params.writid;var A="doc";var B=Artery.params.writid+".doc";var C=this.ntko.SaveToURL(E,A,"",B,"");if(C.length>100){var D=window.open("","_blank","left=200,top=200,width=400,height=300,status=0,toolbar=0,menubar=0,location=0,scrollbars=1,resizable=1",false);newdoc=D.document;newdoc.open();newdoc.write("<html><head><title>返回的数据</title></head><body><center><hr>");newdoc.write(C+"<hr>");newdoc.write("<input type=button VALUE='关闭窗口' onclick='window.close()'>");newdoc.write("</center></body></html>");return"{success:false}"}else{Artery.params.runTimeType="update";return"{success:true}"}},showHistory:function(){var A=sys.getContextPath()+"/artery/writparse.do?action=showHis";A+="&writid="+Artery.params.writid;A+="&writtplid="+Artery.params.writtplid;window.open(A,"_blank")},onRender:function(C,B){this.el=Ext.get(this.id);if(this.el==null){Artery.plugin.NTKOPanel.superclass.onRender.call(this,C,B)}var A=C.getHeight()?C.getHeight()-3:"100%";this.ntko=this.el.createChild({tag:"object",classid:"clsid:6AA93B0B-D450-4a80-876E-3909055B0640",codebase:sys.getContextPath()+"/artery/arteryConsole/ocx/OfficeControl.cab#version=5,0,2,1",width:C.getWidth()-5,height:A,id:"NTKO_OCX",cn:[{tag:"param",name:"MakerCaption",value:"北京紫光华宇软件股份有限公司"},{tag:"param",name:"MakerKey",value:"29159DF3EEF0FB2ED177390A6BC536A584A541F2"},{tag:"param",name:"ProductCaption",value:"通用MIS系统构建平台"},{tag:"param",name:"ProductKey",value:"3F34B9CBD465FFF26C0A74ED2DB3435331AE5D88"},{tag:"SPAN",STYLE:"color:red",html:"不能装载文档控件。请在检查浏览器的选项中检查浏览器的安全设置。"}]},null,true);if(Ext.isEmpty(this.Caption)){this.ntko.Titlebar=false}else{this.ntko.Titlebar=true;this.ntko.Caption=this.Caption}this.ntko.Menubar=this.Menubar;this.ntko.ToolBars=this.ToolBars;this.ntko.Statusbar=this.Statusbar;this.ntko.BorderStyle=this.BorderStyle;this.ntko.FileNew=this.FileNew;this.ntko.FileOpen=this.FileOpen;this.ntko.FileClose=this.FileClose;this.ntko.FileSave=this.FileSave;this.ntko.FileSaveAs=this.FileSaveAs;this.ntko.FilePrint=this.FilePrint;this.ntko.FilePrintPreview=this.FilePrintPreview;this.ntko.FilePageSetup=this.FilePageSetup;this.ntko.FileProperties=this.FileProperties;this.ntko.IsStrictNoCopy=this.IsStrictNoCopy;this.ntko.IsUseUTF8Data=this.IsUseUTF8Data}});Ext.reg("apNTKOpanel",Artery.plugin.NTKOPanel);